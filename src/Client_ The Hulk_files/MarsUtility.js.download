var __extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},_MicrosoftMars;(function(n){var t;(function(n){var t;(function(n){"use strict";var t,i,r,u,f,e,o,s,h,c,l;(function(n){n[n.Unchanged=0]="Unchanged";n[n.Added=1]="Added";n[n.Modified=2]="Modified";n[n.Deleted=3]="Deleted"})(n.LearningPathObjectState||(n.LearningPathObjectState={}));t=n.LearningPathObjectState,function(n){n[n.Sidebar=1]="Sidebar";n[n.GuidedTask=2]="GuidedTask";n[n.ActiveStep=3]="ActiveStep";n[n.InfoBubble=4]="InfoBubble";n[n.Section=5]="Section";n[n.PassiveStep=6]="PassiveStep";n[n.HybridStep=7]="HybridStep";n[n.WaitingStep=8]="WaitingStep";n[n.ExistingGTStep=9]="ExistingGTStep"}(n.ControlTypes||(n.ControlTypes={}));i=n.ControlTypes,function(n){n[n.Published=0]="Published";n[n.Failed=1]="Failed";n[n.NotStarted=2]="NotStarted"}(n.PublishStatus||(n.PublishStatus={}));r=n.PublishStatus,function(n){n[n.Draft=1]="Draft";n[n.Review=2]="Review";n[n.ReadytoPublish=3]="ReadytoPublish";n[n.Published=4]="Published";n[n.Archive=5]="Archive";n[n.Hold=6]="Hold";n[n.ReadytoPublishonHold=7]="ReadytoPublishonHold";n[n.ContentCheck=8]="ContentCheck";n[n.ReviewDone=9]="ReviewDone";n[n.LocHandoff=10]="LocHandoff";n[n.LocHandbackComplete=11]="LocHandbackComplete";n[n.InProgress=12]="InProgress";n[n.FailedPublish=13]="FailedPublish"}(n.StatusType||(n.StatusType={}));u=n.StatusType,function(n){n[n.Product=1]="Product";n[n.ProductVersion=2]="ProductVersion";n[n.UserRole=3]="UserRole";n[n.LifecycleStage=4]="LifecycleStage";n[n.FormFactor=5]="FormFactor";n[n.ClientType=6]="ClientType";n[n.Locale=7]="Locale";n[n.PageNavigationInfo=8]="PageNavigationInfo";n[n.DynamicContext=9]="DynamicContext";n[n.AppModule=10]="AppModule"}(n.ContextTypeMetaData||(n.ContextTypeMetaData={}));f=n.ContextTypeMetaData,function(n){n[n.None=0]="None";n[n.GuidedTask=1]="GuidedTask";n[n.Sidebar=2]="Sidebar";n[n.WebPage=3]="WebPage";n[n.PageInApp=4]="PageInApp";n[n.DialogBox=5]="DialogBox"}(n.LinkType||(n.LinkType={}));e=n.LinkType,function(n){n[n.Unknown=0]="Unknown";n[n.Desktop=1]="Desktop";n[n.Tablet=2]="Tablet";n[n.Phone=3]="Phone";n[n.ExtraLarge=4]="ExtraLarge";n[n.Large=5]="Large";n[n.Medium=6]="Medium";n[n.Small=7]="Small"}(n.FormFactorEnum||(n.FormFactorEnum={}));o=n.FormFactorEnum,function(n){n[n.TabKey=9]="TabKey";n[n.EnterKey=13]="EnterKey";n[n.ShiftKey=16]="ShiftKey";n[n.CtrlKey=17]="CtrlKey";n[n.Altkey=18]="Altkey";n[n.EscapeKey=27]="EscapeKey";n[n.SpaceKey=32]="SpaceKey";n[n.LeftArrowKey=37]="LeftArrowKey";n[n.UpArrowKey=38]="UpArrowKey";n[n.RightArrowKey=39]="RightArrowKey";n[n.DownArrowKey=40]="DownArrowKey";n[n.GKey=71]="GKey";n[n.IKey=73]="IKey";n[n.KKey=75]="KKey";n[n.LKey=76]="LKey";n[n.MKey=77]="MKey";n[n.NKey=78]="NKey";n[n.OKey=79]="OKey";n[n.PKey=80]="PKey";n[n.QKey=81]="QKey";n[n.RKey=82]="RKey";n[n.SKey=83]="SKey";n[n.TKey=84]="TKey";n[n.UKey=85]="UKey";n[n.WKey=87]="WKey";n[n.YKey=89]="YKey";n[n.F6Key=117]="F6Key"}(n.KeyCodeEnum||(n.KeyCodeEnum={}));s=n.KeyCodeEnum,function(n){n[n.Draft=1]="Draft";n[n.OrgLevel=2]="OrgLevel";n[n.Global=4]="Global";n[n.Specific=5]="Specific"}(n.PublishGroupType||(n.PublishGroupType={}));h=n.PublishGroupType,function(n){n[n.VersionTypeError=0]="VersionTypeError";n[n.MajorVersionChange=1]="MajorVersionChange";n[n.MinorVersionChange=2]="MinorVersionChange";n[n.PatchVersionChange=3]="PatchVersionChange";n[n.BuildVersionChange=4]="BuildVersionChange"}(n.VersionChangeType||(n.VersionChangeType={}));c=n.VersionChangeType,function(n){n[n.polite=0]="polite";n[n.assertive=1]="assertive";n[n.off=2]="off";n[n.rude=3]="rude"}(n.AriaLiveType||(n.AriaLiveType={}));l=n.AriaLiveType})(t=n.Utility||(n.Utility={}))})(t=n.Client||(n.Client={}))})(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(t){var i;(function(i){"use strict";var c=function(){function n(){}return n}(),e,o,f,s,h,r,u;i.QSMap=c;e=function(){function n(){}return n}();i.QsMapItem=e;o=function(){function n(){}return n}();i.QSMapperObject=o;f=function(){function n(){}return n}();i.MARSPageNavigationObject=f;s=function(){function t(t){this.jqElement=t;this.element=n.Client.Loader.$mars(t)}return t.prototype.getCtrlObj=function(){return this.element},t.prototype.getProperties=function(){return this.element.attr(r.LPIdAttributeName)},t.prototype.getChildControls=function(){return[]},t.prototype.getBoundingBox=function(){return{pageX:this.element.left,pageY:this.element.top,width:this.element.width(),height:this.element.height()}},t}();i.RegisteredClientControl=s;h=function(){function e(){this._draftPublishGroup=null;this._authoringId=null;this._version=null;this.PageHierarchy="";this.Product=""}return e.getAvailableFormFactors=function(){return[1,2,3]},Object.defineProperty(e.prototype,"AppId",{get:function(){return"00000000-0000-0000-0000-000000000000"},set:function(n){this.appId=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserDetails",{get:function(){return this.userDetails},set:function(n){this.userDetails=n},enumerable:!0,configurable:!0}),e.prototype.getDefaultUserRole=function(){return"User"},e.prototype.getDefaultLifeCycleStage=function(){return"Test Drive"},e.prototype.getMarsRequestContext=function(){return{ProductOrgId:t.Loader.appContext.getOrgId(),AuthoringID:t.Loader.appContext.getAuthoringId(),UserId:this.UserId,RequestId:window._MicrosoftMars.Client.Utility.Util.newGuid()}},e.prototype.getCurrentAppModule=function(){return window.APP_MODULE_UNIQUE_NAME},Object.defineProperty(e.prototype,"AppModuleUniqueName",{set:function(n){this.appModuleUniqueName=n},enumerable:!0,configurable:!0}),e.prototype.isInternalEnvironment=function(){return!0},Object.defineProperty(e.prototype,"UserId",{get:function(){return this.userId},set:function(n){this.userId=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LoginCount",{get:function(){return this.loginCount},set:function(n){this.loginCount=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserName",{get:function(){return this.userName},set:function(n){this.userName=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserRoles",{get:function(){return this.userRoles||(this.userRoles=""),this.userRoles},set:function(n){this.userRoles=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserRoleNames",{get:function(){return this.userRoleNames||(this.userRoleNames=""),this.userRoleNames},set:function(n){this.userRoleNames=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Locale",{get:function(){return this.locale||(this.locale="1033"),this.locale},set:function(n){this.locale=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserTimeZoneOffset",{get:function(){return this.userTimeZoneOffset||(this.userTimeZoneOffset=""),this.userTimeZoneOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AppVersion",{get:function(){return this.appVersion||(this.appVersion="1.1"),this.appVersion},set:function(n){this.appVersion=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FormFactor",{get:function(){return this.formFactor||(this.formFactor="1,2,3"),this.formFactor},set:function(n){this.formFactor=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ClientType",{get:function(){return this.clientType||(this.clientType=r.WebClient),this.clientType},set:function(n){this.clientType=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ProductEnvironmentType",{get:function(){return this.productEnvironmentType||(this.productEnvironmentType="2"),this.productEnvironmentType},set:function(n){this.productEnvironmentType=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PageNavigationInfo",{get:function(){return this.pageNavigationInfo||(this.pageNavigationInfo=""),this.pageNavigationInfo},set:function(n){this.pageNavigationInfo=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ElementIdentifier",{get:function(){return this.elementIdentifier||(this.elementIdentifier=""),this.elementIdentifier},set:function(n){this.elementIdentifier=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PublishEnvironment",{get:function(){return this.publishEnvironment===undefined&&(this.publishEnvironment="-1"),this.publishEnvironment},set:function(n){this.publishEnvironment=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LifeCycleStages",{get:function(){return this.lifeCycleStages||(this.lifeCycleStages=""),this.lifeCycleStages},set:function(n){this.lifeCycleStages=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TenantId",{get:function(){return this.tenantId||(this.tenantId="00000000-0000-0000-0000-000000000000"),this.tenantId},set:function(n){this.tenantId=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TenantName",{get:function(){return this.tenantName||(this.tenantName=""),this.tenantName},set:function(n){this.tenantName=n},enumerable:!0,configurable:!0}),e.prototype.setTenantProperties=function(){throw new Error("Not Implemented");},Object.defineProperty(e.prototype,"TenantSku",{get:function(){return this.tenantSku||(this.tenantSku="TenantSKU"),this.tenantSku},set:function(n){this.tenantSku=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Util",{get:function(){return this.util||(this.util=new u),this.util},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentStage",{get:function(){return this.currentStage||(this.currentStage="Test Drive"),this.currentStage},set:function(n){this.currentStage=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PublishGroupId",{get:function(){return this.publishGroupId||(this.publishGroupId=""),this.publishGroupId},set:function(n){this.publishGroupId=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NextLifeCycleStageConditions",{get:function(){return this.nextLifeCycleStageConditions||(this.nextLifeCycleStageConditions=[]),this.nextLifeCycleStageConditions},set:function(n){this.nextLifeCycleStageConditions=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDesignerEnabledforUser",{get:function(){var n=i.$mars.Deferred();return n.resolve(!0),n.promise()},enumerable:!0,configurable:!0}),e.prototype.isMarsEnabled=function(){return!0},e.prototype.getScenariosList=function(){return[]},e.prototype.getScenariosIgnoredOrCompleted=function(){return[]},e.prototype.isMinLoginDone=function(){return!0},e.prototype.handleCustomizationContainerInMoca=function(){},e.prototype.getWildcardedPageKeys=function(t){var u=[],i=n.Client.Loader.appContext.Util.getConfigurationData("WildcardConfig"),f=t.KeyParams,e,r;return i&&(i=i.filter(function(n){return f.indexOf(n)!==-1}),i.length>0&&(e=this,r=function(i,o){for(var h=o.length,s=0;s<h;s++)u.push(n.Client.Loader.marsEncodeDecode.MarsUrlDecode(e.buildURLStringFromQs(t.KeyPrefix,t.Attributes,f.filter(function(n){return i.concat(o[s]).indexOf(n)===-1})))),r(i.concat(o[s]),o.slice(s+1))},r([],i))),u},e.prototype.getPageNavigationObject=function(n,t,i){var r,u,e;if(i===void 0&&(i=[]),!n)return null;r=new f;e=n.indexOf("?");u=e===-1?["&",n.substring(1)]:[n.substring(0,e+1),n.substring(e+1)];var h=u[0].replace(/\?$/,""),o=this.getPageAttributes(u[1],t),s=this.getPageKey(u[0],o,i);return r.Path=h,r.Page=h.split("/").reverse()[0],r.Module=this.getModule(o),r.Attributes=o,r.KeyParams=s.params,r.KeyPrefix=u[0],r.PageKey=s.pageKey,s.hasOwnProperty("wcPageKey")&&(r.WildCardPageKey=s.wcPageKey),r.URL=this.buildURLStringFromQs(u[0],this.addSystemDependentParams(t,o)),r},e.prototype.getPageAttributes=function(n,t){var i=this.getObjectFromUrlString(n);return this.removeSystemDependentParams(t,i)},e.prototype.getObjectFromUrlString=function(n){var t={},i=n.replace("?","").split("&");return i.forEach(function(n){var i=n.split("=");i.length>1&&(t[i[0]]=i[1])}),t},e.prototype.removeSystemDependentParams=function(n,t){var r,i,u;if(n!=null&&n.trim()!=""){r=JSON.parse(n);for(i in r)t.hasOwnProperty(i)&&(u=r[i],t[u.key]=u.value,delete t[i])}return t},e.prototype.getModule=function(){return""},e.prototype.getDefaultWhiteListedKeys=function(){return null},e.prototype.getPageKey=function(t,r,u){var f=Object.keys(r).sort(),o,e,s;if(f.length>0){o=null;try{o=window.parent.getWhitelistedPageTokens()}catch(h){o=this.getDefaultWhiteListedKeys()}f=f.filter(function(n){return o.indexOf(n)!=-1})}return e={},e.params=f,e.pageKey=n.Client.Loader.marsEncodeDecode.MarsUrlDecode(this.buildURLStringFromQs(t,r,f)),u.length>0&&i.FFFUtility.isFeatureEnabled(i.FFFUtility.WildcardingFeatureName)&&(s=n.Client.Loader.marsEncodeDecode.MarsUrlDecode(this.buildURLStringFromQs(t,r,f.filter(function(n){return u.indexOf(n)===-1}))),s!==e.pageKey&&(e.wcPageKey=s)),e},e.prototype.buildURLStringFromQs=function(n,t,i){var u=n,i=i?i:Object.keys(t),r;return i.length>0&&(r="",i.forEach(function(n){r+=n+"="+t[n]+"&"}),u+=r.replace(/&$/,"")),u},e.prototype.addSystemDependentParams=function(t,i){var u,f,r;if(t&&t.trim()!=""){u=JSON.parse(t);for(f in u)r=u[f],i.hasOwnProperty(r.key)&&(i[f]=n.Client.Loader.appContext.Util.executeAppMethod(r.api,JSON.stringify(new Array(r.value))))}return i},e.prototype.getElement=function(t,i,r){var e,f,s,o;if(i===void 0&&(i=!1),r===void 0&&(r=!0),t==="")return"";e=null;try{try{f=JSON.parse(t)}catch(h){return e=this.getElementUsingDOM(t)}if(!f||!f.resultPathDOM||f.resultPathDOM==="")throw new Error;if(f.resultPathDOM instanceof Array){for(s in f.resultPathDOM)if(e=this.getElementUsingDOM(f.resultPathDOM[s],f.resultPathClientAPI),e)break}else e=this.getElementUsingDOM(f.resultPathDOM,f.resultPathClientAPI,i)}catch(h){n.Client.Loader.clientAPIEnabled=!1;e=null;f&&f.resultPathClientAPI&&f.resultPathClientAPI!==""&&(e=u.isJsonString(f.resultPathClientAPI)?this.getElementUsingClientApi(JSON.parse(f.resultPathClientAPI)):this.getElementUsingClientApi(f.resultPathClientAPI),n.Client.Loader.clientAPIEnabled=!0);!e&&r&&(o=new Error(n.Client.Loader.marsLocale.TargetElementNotVisibleOnPage),o.message="targetelementmissing",n.Client.Loader.marsExceptionHandler.execute(window._MicrosoftMars.Client.Utility.launchStepException,o.message,null,o))}return e},e.prototype.getErrorElementDivMOCA=function(n){for(var e,r,u,l,c=[],s=0,h=0,o=n.split(">"),i=t.Loader.$mars(window.parent.document).find("body"),f=1;f<o.length;f++)e=o[f].substr(0,o[f].indexOf("/")),r=o[f].substr(o[f].indexOf("/")+1),r.indexOf("#")===0?(r=r.substr(1),r="#"+r.replace(/([.*+?#^${}()|\[\]\/\\])/g,"\\$1"),i=e==="IFRAME"&&r.indexOf("contentIFrame")!==-1?this.getCurrentContentFrame(i,r):i.find(r).length>0?i.find(r):i.find(e+"[id^='"+r.substr(1)+"']")):(u=i.find("> "+e),u.length>1?u=u.eq(r):u.length==0&&(l=e.split("."),u=i.children(l[0]),u.length>1&&(u=u.eq(r))),i=u),e==="IFRAME"&&(c.push(r),s+=i.offset().left,h+=i.offset().top,i=i.contents().find("body"));return i.length>0&&i.offset()!=null?(s+=i.offset().left>0?i.offset().left:0,h+=i.offset().top>0?i.offset().top:0,{element:i,elementX:s,elementY:h,elementWidth:i.width(),elementHeight:i.height(),elementIframeContainers:c}):null},e.prototype.getElementUsingDOM=function(n,i,u){var p=n,c=n.split(">"),v=[],f=t.Loader.$mars("body"),l,a,s,h,e,o,y;if(t.Loader.appContext.ClientType===r.MobileClient&&(f=t.Loader.$mars(window.parent.document).find("body"),u))return this.getErrorElementDivMOCA(p);for(l=0,a=0,s=1;s<c.length;s++)h=c[s].substr(0,c[s].indexOf("/")),e=c[s].substr(c[s].indexOf("/")+1),e.indexOf("#")===0?(e=e.substr(1),e="#"+e.replace(/([.*+?#^${}()|\[\]\/\\])/g,"\\$1")+":visible",f=h==="IFRAME"&&e.indexOf("contentIFrame")!==-1?this.getCurrentContentFrame(f,e):f.find(e).length>0?f.find(e):f.find(h+"[id^='"+e.substr(1)+"']")):(o=f.find("> "+h),o.length>1?o=o.eq(e):o.length==0&&(y=h.split("."),o=f.children(y[0]),o.length>1&&(o=o.eq(e))),f=o),h==="IFRAME"&&(v.push(e),l+=f.offset().left,a+=f.offset().top,f=f.contents().find("body"));return f.length>0&&f.offset()!=null?(l+=f.offset().left>0?f.offset().left:0,a+=f.offset().top>0?f.offset().top:0,{element:f,elementX:l,elementY:a,elementWidth:f.width(),elementHeight:f.height(),elementIframeContainers:v}):null},e.prototype.getElementUsingClientApi=function(n){return this.getControl(n)},e.prototype.getPageInAppPageNavigationInfo=function(n){return typeof n=="string"?JSON.parse(n.replace(/\\/g,'"')):n},e.prototype.compareNavInfo=function(t,i){var f,e,u;if(i||(i=n.Client.Loader.appContext.getPageNavigationInfo()),!t||!(this.ClientType in t)||!(this.ClientType in i))return!1;if(this.ClientType===r.WebClient){f=this.getParamsDictionary(t[this.ClientType]);e=this.getParamsDictionary(i[this.ClientType]);for(u in f)if(f.hasOwnProperty(u)){if(e[u]==null||e[u]===undefined)continue;if(f[u]!==e[u])return!1}}else if(i[this.ClientType]!==t[this.ClientType])return!1;return!0},e.prototype.allowBindHelpNavTab=function(){return!0},e.prototype.shouldDefaultContentToCurrentApp=function(){return!1},e.prototype.getDraftPublishGroupId=function(){if(this._draftPublishGroup!==null)return this._draftPublishGroup;var t=n.Client.Loader.appContext.Util.getConfigurationData("PublishGroupSetting"),i=t.filter(function(n){if(n.PublishGroupType==1)return!0});return this._draftPublishGroup=i[0].Id,this._draftPublishGroup},e.prototype.isHebrewEnv=function(){return this.locale===1037?!0:!1},e.prototype.isArabicEnv=function(){return this.locale===1025?!0:!1},e.prototype.isShimDisabled=function(){return!1},e.prototype.getUserInfo=function(){try{var u=this.getClientUrl(),f=this.UserId,e=u+"/XRMServices/2011/OrganizationData.svc",o=e+"/SystemUserSet(guid'"+f+"')",n={FirstName:this.UserName,LastName:"",Email:""},r=t.Loader.$mars.getJSON(o),s=this;r.done(function(t){if(t!=null&&t.d!=null){var i=t.d;n.FirstName=i.FirstName;n.LastName=i.LastName;n.Email=i.InternalEMailAddress;s.userDetails=n}else console.log("An Error occurred while retrieving user details : empty response received from Server"),localStorage.setItem("userdetails",JSON.stringify(n))});r.fail(function(i){console.log("An Error occurred while retrieving user details : Retrieve User Info Call failed ");localStorage.setItem("userdetails",JSON.stringify(n));t.Loader.marsExceptionHandler.execute(i.statusText,i.responseText)})}catch(i){console.log("An Error occurred while retrieving user details "+i);t.Loader.marsExceptionHandler.execute(i.name,i.message)}},e.prototype.getPageNavigationInfo=function(){},e.prototype.navigateToPage=function(){},e.prototype.getOrgId=function(){},e.prototype.isFirstLogin=function(){},e.prototype.getAppName=function(){},e.prototype.getFormFactor=function(){},e.prototype.isMarsEnabledForUser=function(){},e.prototype.isMarsEnabledForOrg=function(){},e.prototype.isInAppSupportEnabledForUser=function(){},e.prototype.isInAppSupportEnabledForOrg=function(){},e.prototype.getAppVersion=function(){},e.prototype.getDefaultFormFactor=function(){},e.prototype.getClient=function(){},e.prototype.getOrgName=function(){},e.prototype.getOrgLcid=function(){},e.prototype.getAvailableClients=function(){},e.prototype.getAvailableFormFactors=function(){},e.prototype.getAllChildRegisteredControl=function(){},e.prototype.getCookieForUsingClientApi=function(){},e.prototype.setCookieForUsingClientApi=function(){},e.prototype.getControl=function(){},e.prototype.checkIfActivityPostTab=function(){},e.prototype.getCurrentContentFrame=function(){},e.prototype.isRTL=function(){},e.prototype.getClientUrl=function(){},e.prototype.getClientName=function(){},e.prototype.getClientState=function(){},e.prototype.openExternalUrl=function(n){var t=window.Xrm?window.Xrm:window.parent.Xrm;t.Navigation.openUrl(n)},e.prototype.getOwnAuthoringGroup=function(){},e.prototype.isISHPage=function(){return!1},e.prototype.getDesignerPrivilagedRoles=function(){},e.prototype.openDialog=function(){},e.prototype.openAlertDialog=function(){},e.prototype.appLPAuthoringEnabled=function(){return!0},e.prototype.isAuthoringGroupEnabled=function(){var t=!1,i=n.Client.Loader.appContext.Util.getConfigurationData("AuthoringGroup");return(i==null||i.Status==1)&&(t=!0),t},e.prototype.getAppModuleListFromAPI=function(){var n=new XMLHttpRequest,t;return(n.open("GET",this.getClientUrl()+"/api/data/v8.2/RetrievePublishedAppModuleWithLocale(LcId="+this.locale.toString()+")",!1),n.send(null),n.status===200&&(t=JSON.parse(n.responseText),t.AppModuleCollection.AppModuleInfoCollection.length>0))?t.AppModuleCollection.AppModuleInfoCollection:[]},e.prototype.isPageLoadEventSupported=function(){return!1},e.prototype.addPageLoadEventListener=function(n,t){t===void 0&&(t=null);throw new Error("PageLoad Event is not supported");},e.prototype.addPageUnLoadEventListener=function(n,t){t===void 0&&(t=null);throw new Error("PageUnLoad Event is not supported");},Object.defineProperty(e.prototype,"Country",{get:function(){return this.country||(this.country=""),this.country},set:function(n){this.country=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OrgType",{get:function(){return this.orgType||(this.orgType=""),this.orgType},set:function(n){this.orgType=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OrgSize",{get:function(){return this.orgSize||(this.orgSize=""),this.orgSize},set:function(n){this.orgSize=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OrgLicenses",{get:function(){return this.orgLicenses||(this.orgLicenses=""),this.orgLicenses},set:function(n){this.orgLicenses=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MNC",{get:function(){return this.mnc||(this.mnc=""),this.mnc},set:function(n){this.mnc=n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsPaid",{get:function(){return this.isPaid},set:function(n){this.isPaid=n},enumerable:!0,configurable:!0}),e.prototype.getActiveRegisteredControl=function(){},e.prototype.scrollTheIframes=function(){return!1},e.prototype.isMobileClient=function(){return this.ClientType===r.MobileClient?!0:!1},e.prototype.isUSD=function(){return window.isUSD&&window.isUSD===!0},e.prototype.getAuthoringId=function(){if(this._authoringId!=null)return this._authoringId},e.prototype.setAuthoringID=function(n){this._authoringId=n},e.prototype.checkForPageLoad=function(n,t,i){t===void 0&&(t=null);i===void 0&&(i=0)},e.prototype.checkForPageIdle=function(n,t,i){t===void 0&&(t=null);i===void 0&&(i=0);this.checkForPageLoad(n,t,i)},e.prototype.isPageLoaded=function(){},e.prototype.loadStaticHelp=function(){},e.prototype.getOrganizationUserRoles=function(){var n=new XMLHttpRequest,t=this;n.onreadystatechange=function(){t.acceptCrmUserRoles(n)};this.oDataGet(n,this.apiDataVersion,"roles?$select=name,_roletemplateid_value,_parentrootroleid_value,roleid")},e.prototype.setAriaHiddenForElementsExceptMars=function(n){i.$mars("body").children().not("script, noscript, #marsIFrame, #lpathRuntimeOverlay, .mars-help-visuallyhidden, #lpathRuntimeFeedbackOverlay, #lpathRuntimeSupportSidebarOverlay, #lPathDesignerContainer, #lPathDesignerOverlay").attr("aria-hidden",n)},e.prototype.acceptCrmUserRoles=function(n){var o,u,f,r,h,s,c;if(n.readyState==4&&n.status==200){for(o=JSON.parse(n.responseText).value,e.organizationUserRoles=[],u={},f=0;f<o.length;f++)r=o[f],h=r._roletemplateid_value!==null?r._roletemplateid_value:r._parentrootroleid_value,u[h]=r.name;for(s in u)c=window._MicrosoftMars.Client.Utility.Util.newGuid(),e.organizationUserRoles.push(new i.UserRoles(u[s],s,c,t.Loader.appContext.getOrgId(),0,i.UserRoleState.added,!1,!0)),e.isAppUserRoleCallSucceeded=!0}else e.isAppUserRoleCallSucceeded=!1},e.prototype.oDataGet=function(n,i,r){var u=t.Loader.appContext.getClientUrl(),f;u&&(f=u+i,n.open("GET",f+r,!1),n.setRequestHeader("Accept","application/json"),n.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.send())},e.prototype.getParamsDictionary=function(n){var t={},r="",e="",u,f,i;if(n.indexOf("?")!==-1?(u=n.split("?"),r=u[0],e=u[1]):r=n,t.baseUrl=r,n.indexOf("&")===-1)return t;for(f=e.split("&"),i=0;i<f.length;i++){var o=f[i].split("="),s=o[0],h=o[1];t[s]=h}return t},e.prototype.isOnline=function(){return!0},e.isAppUserRoleCallSucceeded=!1,e}();i.AppContext=h;r=function(){function n(){}return n.MobileClient="Mobile",n.WebClient="Web",n.USD="UnifiedServiceDesk",n.MobileClientType="MoCA",n.WebClientType="Web client",n.TabletDeviceSupportSetting="TabletDeviceSupportSetting",n.UCI="UCI",n.LPIdAttributeName="data-lp-id",n.AutomationJS="Automation.js",n.MouseDownEventName=window.PointerEvent?"pointerdown":"mousedown",n}();i.Constants=r;u=function(){function u(){this.LifeCycleStageSetting="LifeCycleStageSetting";this.CustomAttributeSetting="CustomAttributeSetting";this.UserRoleSetting="UserRoleSetting";this.ProductVersionMatchCriteria="AuthoringGroupSetting.ProductVersionMatchCriteria";this.BackupLcid="OrgDetailSetting.BackupLcid";this.DefaultLcid="OrgDetailSetting.DefaultLcid";this.PublishGroupSetting="PublishGroupSetting";this.OrgDetailSetting="OrgDetailSetting";this.AuthoringId="authoringId";this.AuthoringGroup="AuthoringGroup";this.WildcardConfig="WildcardConfig";this.AuthoringDetails="AuthoringDetails";this.AuthoringGroupDetail="AuthoringGroupAndSubscribedPgDetail";this.ThemeMetaData="ThemeMetaData";this.AuthoringGroupLifeCycleStageMap={};this.isInGTPreview=!1;this.isQuickCreateFormOpen=!1;this.pgDetails={}}return u.newGuid=function(){for(var i,r="xx-x-4m-ym-xxx",n="",t=0;t<r.length;t++){i=Math.floor(Math.random()*Date.now());switch(r[t]){case"x":n+=i.toString(16).substring(0,4);break;case"m":n+=i.toString(16).substring(0,3);break;case"y":n+=(i&3|8).toString(16);break;default:n+=r[t]}}return n},u.isJsonString=function(n){try{JSON.parse(n)}catch(t){return!1}return n!=null},u.TryRetrieve=function(n,t,i){var e;(i==null||i==undefined)&&(i=300);var r=t,u=localStorage.getItem(r),f=localStorage.getItem(r+":ts");if(u!==null&&f!==null){if(e=(Date.now()-f)/1e3,e<i)return u;localStorage.removeItem(r);localStorage.removeItem(r+":ts")}return(n.open("GET",t,!1),n.send(null),n.readyState==4&&n.status==200)?(localStorage.setItem(r,n.responseText),localStorage.setItem(r+":ts",""+Date.now()),n.responseText):n.responseText},u.TryRetrieveAsync=function(n,t){var u=i.$mars.Deferred(),s,f;(t==null||t==undefined)&&(t=300);var r=n,e=localStorage.getItem(r),o=localStorage.getItem(r+":ts");return e!==null&&o!==null&&(s=(Date.now()-o)/1e3,s<t?u.resolve(e):(localStorage.removeItem(r),localStorage.removeItem(r+":ts"))),f=jQuery.ajax({url:n,type:"GET",dataType:"json"}),f.done(function(n){var t=JSON.stringify(n);localStorage.setItem(r,t);localStorage.setItem(r+":ts",""+Date.now());u.resolve(t)}),f.fail(function(n){var t=JSON.stringify(n);u.reject(t)}),u.promise()},u.CreateGroup=function(){var u,i,r;try{return(u=new n.Client.Loader.ConfigurationAPI,i=t.Loader.$mars.Deferred(),n.Client.Loader.allowUnAuthorize)?(i.resolve({}),i):(r=u.post({},"CreateGroup"),r.done(function(n){n!=null&&n.Result!=null&&i.resolve(n.Result)}),r.fail(function(){console.log("Create group failed.");i.reject()}),i)}catch(f){t.Loader.marsExceptionHandler.execute(f.name,f.message)}},u.isOngoingAutomation=function(){var t=!1,n=window._MicrosoftMars.Client.Automation;return n&&n.Automation.AUTOMATION_STATE!=n.AutomationConstants.IDLE&&(t=!0),t},u.getParsedGuid=function(t){var i=n.Client.Loader.marsEncodeDecode.MarsUrlDecode(t.toLowerCase());return u.getBraceAndHyphenGuidVerifierPattern().test(i)?i.replace(u.getGuidStripperPattern(),""):i},u.resolveTitle=function(t){var i=t;return n.Client.Loader.$mars("<p>"+u.decodeSpecialCharacters(i)+"<\/p>").text()},u.validateWhiteListLCID=function(){for(var r=n.Client.Loader.appContext.Locale,i=u.WhitelistedLCIDs(),t=0;t<i.length;t++)if(i[t]==r)return!0;return!1},u.validateNumbers=function(n){var t=window.event?n.keyCode:n.which;return n.keyCode==8||n.keyCode==46||n.keyCode==37||n.keyCode==39||n.keyCode==9?!0:t<48||t>57?!1:!0},u.getAppIdFromName=function(t){var r,i;return u.appNameIdMap[t]?u.appNameIdMap[t]:(r=new XMLHttpRequest,r.open("GET",n.Client.Loader.appContext.getClientUrl()+"/api/data/v8.2/appmodules?$filter=uniquename eq '"+t+"'&$select=appmoduleid",!1),r.send(null),r.status===200&&(i=JSON.parse(r.responseText),i&&i.value&&i.value.length>0))?(u.appNameIdMap[t]=i.value[0].appmoduleid,i.value[0].appmoduleid):[]},u.addClassInElement=function(n,t){var i=n.attr("class");i===undefined&&(i="");t.trim();i.search(t)===-1&&(i=i+" "+t);n=n.attr("class",i)},u.removeClassInElement=function(n,t){var i=n.attr("class"),r,u;i===undefined&&(i="");r=i.split(" ");t.trim();u=r.indexOf(t);u!==-1&&(r.splice(u,1),i=r.toString(),i=i.replace(/,/g," "),n=n.attr("class",i))},u.addClassInSVGs=function(n,i){t.Loader.$mars(n).each(function(){u.addClassInElement(t.Loader.$mars(this),i)})},u.removeClassInSVGs=function(n,i){t.Loader.$mars(n).each(function(){u.removeClassInElement(t.Loader.$mars(this),i)})},u.replaceSVGImageWithInlineInternal=function(n){var r=i.$mars.Deferred(),u=n.attr("id"),f=n.attr("class"),e=n.attr("tabindex"),h=n.attr("src"),o=n.attr("focusable"),s=jQuery.ajax({url:h,type:"GET",dataType:"text"});return s.done(function(i){var h=new DOMParser,s;i=h.parseFromString(i,"image/svg+xml");s=t.Loader.$mars(i).find("svg");typeof u!="undefined"&&(s=s.attr("id",u));typeof o!="undefined"&&(s=s.attr("focusable",o));typeof f!="undefined"&&(s=s.attr("class",f));typeof e!="undefined"&&(s=s.attr("tabindex",e));s=s.removeAttr("xmlns:a");n.replaceWith(s);n.css("display")==="none"&&s.hide();r.resolve()}),s.fail(function(){t.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.WARNING,"Failed to download SVG image");r.resolve()}),r.promise()},u.replaceSVGImageWithInline=function(n){var r=[],f=i.$mars.Deferred();return t.Loader.$mars(n).each(function(){var n=t.Loader.$mars(this);r.push(u.replaceSVGImageWithInlineInternal(n))}),t.Loader.$mars.when.apply(r).done(function(){f.resolve()}),f.promise()},u.getThemeName=function(){var r="GreenTheme.css",t;return i.FFFUtility.isFeatureEnabled(i.FFFUtility.ThemeabilityFeatureName)&&(t=n.Client.Loader.appContext.Util.getConfigurationData("ThemeMetaData"),t&&t[n.Client.Loader.appContext.ClientType]&&(r=t[n.Client.Loader.appContext.ClientType])),r},u.getAnyRoleUserId=function(){return"BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBBB"},u.decodeSpecialCharacters=function(n){if(n){var t={"&#48;":"0","&#49;":"1","&#50;":"2","&#51;":"3","&#52;":"4","&#53;":"5","&#54;":"6","&#55;":"7","&#56;":"8","&#57;":"9","&#61;":"=","&#63;":"?","&#64;":"@","&#91;":"[","&#92;":"\\","&#93;":"]","&#94;":"^","&#95;":"_","&#96;":"`","&#58;":":","&#59;":";","&#32;":" ","&#33;":"!","&#34;":'"',"&#35;":"#","&#36;":"$","&#37;":"%","&#38;":"&","&#39;":"'","&#40;":"(","&#41;":")","&#42;":"*","&#43;":"+","&#44;":",","&#45;":"-","&#46;":".","&#47;":"/","&#123;":"{","&#124;":"|","&#125;":"}","&#126;":"~","&#x27;":"'","&rsquo;":"'","\r":"<br/>","\n":"","&lsquo;":"‘","&sbquo;":"‚","&ldquo;":"“","&rdquo;":"”","&bdquo;":"„","&dagger;":"†","&Dagger;":"‡","&permil;":"‰","&lsaquo;":"‹","&rsaquo;":"›","&spades;":"♠","&clubs;":"♣","&hearts;":"♥","&diams;":"♦","&oline;":"‾","&larr;":"←","&uarr;":"↑","&rarr;":"→","&darr;":"↓","&trade;":"™","&quot;":'"',"&amp;":"&","&frasl;":"/","&lt;":"<","&gt;":">","&hellip;":"…","&ndash;":"–","&mdash;":"—","&nbsp;":" ","&iexcl;":"¡","&cent;":"¢","&pound;":"£","&curren;":"¤","&yen;":"¥","&brvbar;":"¦","&brkbar;":"¦","&sect;":"§","&uml;":"¨"," &die;":"¨","&copy;":"©","&ordf;":"ª","&laquo;":"«","&not;":"¬","&shy;":"","&reg;":"®","&macr;":"¯","&hibar;":"¯","&deg;":"°","&plusmn;":"±","&sup2;":"²","&sup3;":"³","&acute;":"´","&micro;":"µ","&para;":"¶","&middot;":"·","&cedil;":"¸","&sup1;":"¹","&ordm;":"º","&raquo;":"»","&frac14;":"¼","&frac12;":"½","&frac34;":"¾","&iquest;":"¿","&Agrave;":"À","&Aacute;":"Á","&Acirc;":"Â","&Atilde;":"Ã","&Auml;":"Ä","&Aring;":"Å","&AElig;":"Æ","&Ccedil;":"Ç","&Egrave;":"È","&Eacute;":"É","&Ecirc;":"Ê","&Euml;":"Ë","&Igrave;":"Ì","&Iacute;":"Í","&Icirc;":"Î","&Iuml;":"Ï","&ETH;":"Ð","&Ntilde;":"Ñ","&Ograve;":"Ò","&Oacute;":"Ó","&Ocirc;":"Ô","&Otilde;":"Õ","&Ouml;":"Ö","&times;":"×","&Oslash;":"Ø","&Ugrave;":"Ù","&Uacute;":"Ú","&Ucirc;":"Û","&Uuml;":"Ü","&Yacute;":"Ý","&THORN;":"Þ","&szlig;":"ß","&agrave;":"à","&aacute;":"á","&acirc;":"â","&atilde;":"ã","&auml;":"ä","&aring;":"å","&aelig;":"æ","&ccedil;":"ç","&egrave;":"è","&eacute;":"é","&ecirc;":"ê","&euml;":"ë","&igrave;":"ì","&iacute;":"í","&icirc;":"î","&iuml;":"ï","&eth;":"ð","&ntilde;":"ñ","&ograve;":"ò","&oacute;":"ó","&ocirc;":"ô","&otilde;":"õ","&ouml;":"ö","&divide;":"÷","&oslash;":"ø","&ugrave;":"ù","&uacute;":"ú","&ucirc;":"û","&uuml;":"ü","&yacute;":"ý","&thorn;":"þ","&yuml;":"ÿ"},i=new RegExp(Object.keys(t).join("|"),"gi");n=n.replace(i,function(n){return t[n]})}return n},u.loadAutomationJS=function(){var i=t.Loader.serverUrl+r.AutomationJS,n;document.getElementById(i)||(n=document.createElement("script"),n.onerror=function(){console.log("Error in loading script")},n.onload=function(){console.log(i+" loaded ")},n.src=i,n.id=i,n.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(n))},u.getLPTagSectionValue=function(){return u.getLPTagsectionFromLocale()},u.getHtmlFromTemplate=function(n,t){var i=Handlebars.compile(n);return i(t)},u.WhitelistedLCIDs=function(){return u.whitelistedLCIDs.length!=0?u.whitelistedLCIDs:(u.whitelistedLCIDs=i.FFFUtility.isFeatureEnabled(i.FFFUtility.LiveChatv2FeatureName)?[1030,1031,1033,1036,1040,1041,1043,1046,1049,1053,2055,2057,2058,3081,3082,4105,4108]:[3081,3079,2060,2067,1046,4105,3084,1030,1036,1031,16393,1040,1041,2058,1043,1049,1034,1053,2055,4108,2057,1033],u.whitelistedLCIDs)},u.getLPTagsectionFromLocale=function(){var t=n.Client.Loader.appContext.Locale.toString();return{"1030":"dynamics-leadgen-da-dk-trial","2055":"dynamics-leadgen-de-ch-trial","1031":"dynamics-leadgen-de-de-trial","3081":"dynamics-leadgen-en-us-trial","2057":"dynamics-leadgen-en-gb-trial","4105":"dynamics-leadgen-en-ca-trial","1033":"dynamics-leadgen-en-us-trial","3082":"dynamics-leadgen-es-es-trial","2058":"dynamics-leadgen-es-ww-trial","4108":"dynamics-leadgen-fr-ch-trial","1040":"dynamics-leadgen-it-it-trial","1041":"dynamics-leadgen-ja-jp-trial","1043":"dynamics-leadgen-nl-nl-trial","1049":"dynamics-leadgen-ru-ru-trial","1036":"dynamics-leadgen-fr-fr-trial","1046":"dynamics-leadgen-pt-br-trial","1053":"dynamics-leadgen-sv-se-trial"}[t]},u.getBraceAndHyphenGuidVerifierPattern=function(){return new RegExp("^{(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}}$")},u.getGuidStripperPattern=function(){return new RegExp("{|}|","g")},u.prototype.showXButton=function(){t.Loader.$mars("#xbutton:not(.mars-xbutton-show)").addClass("mars-xbutton-show");t.Loader.$mars("#xbutton").removeClass("mars-xbutton-hide")},u.prototype.hideXButton=function(){t.Loader.$mars("#xbutton:not(.mars-xbutton-hide)").addClass("mars-xbutton-hide");t.Loader.$mars("#xbutton").removeClass("mars-xbutton-show")},u.prototype.getApiRequest=function(){return{marsRequestContext:t.Loader.appContext.getMarsRequestContext(),Request:{}}},u.prototype.setAuthoringGroupLifeCycleStageMap=function(n,t){this.AuthoringGroupLifeCycleStageMap[n]=t},u.prototype.getAuthoringGroupLifeCycleStageMap=function(n){return this.AuthoringGroupLifeCycleStageMap[n]},u.prototype.getPublishGroupDetails=function(n,t){var i,r,u;if(!this.pgDetails[n])for(i=this.getConfigurationData(this.AuthoringDetails),r=0;i&&r<i.length;r++)if(i[r].SubscribedPGDetails)for(u=0;u<i[r].SubscribedPGDetails.length;u++)this.pgDetails[i[r].SubscribedPGDetails[u].PgId]=i[r].SubscribedPGDetails[u].PublishGroup;return t&&this.pgDetails[n]?this.pgDetails[n][t]:this.pgDetails[n]},u.prototype.getConfigurationData=function(n){var t=JSON.parse(localStorage["allConfigurationKey"]);if(t.ProductOrgDetail!=null&&t.ProductOrgDetail){if(t.AuthoringDetails==null&&!t.AuthoringDetails)return null;var u=t.ProductOrgDetail.AuthoringId,r=this.getOwnAuthoringGroup(t,u),i=r.AuthoringGroupDetail;switch(n){case this.OrgDetailSetting:return t.ProductOrgDetail;case this.AuthoringId:return u;case this.AuthoringGroup:return i?i:null;case this.AuthoringGroupDetail:return r?r:null;case this.LifeCycleStageSetting:return i?i.ConfigurationLifeCycleStages:null;case this.CustomAttributeSetting:return i?i.ConfigurationCustomAttributes:null;case this.UserRoleSetting:return i?i.ConfigurationUserRoles:null;case this.ProductVersionMatchCriteria:return i?i.ProductVersionMatchCriteria:null;case this.BackupLcid:return t.ProductOrgDetail.BackupLcid;case this.DefaultLcid:return t.ProductOrgDetail.DefaultLcid;case this.PublishGroupSetting:return i?i.PublishGroups:null;case this.WildcardConfig:return JSON.parse(t[this.WildcardConfig]);case this.AuthoringDetails:return t[this.AuthoringDetails];case this.ThemeMetaData:return t[this.ThemeMetaData];default:return t[n]}}},u.prototype.getOwnAuthoringGroup=function(t,i){var r=!1;return n.Client.Loader.$mars.each(t.AuthoringDetails,function(){var t=this;n.Client.Loader.$mars.each(t.AuthoringGroupDetail,function(){if(i==t.AuthoringGroupDetail.AuthoringId)return r=t,!1})}),r},u.prototype.loadScripts=function(n,t){for(var i,u=document.getElementsByTagName("head")[0],r=0;r<n.length;r++)i=null,t.toLowerCase()=="js"?(i=document.createElement("script"),i.setAttribute("type","text/javascript"),i.setAttribute("src",n[r])):t.toLowerCase()=="css"&&(i=document.createElement("link"),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",n[r])),i!=null&&u.appendChild(i)},u.prototype.getMarsLauncher=function(){var t=".navTabHelpImageWeb";return n.Client.Loader.appContext.getClientName()===r.MobileClient&&(t="button[data-id='GuidedHelpButton']",i.CrmAppContext.crmXRM.Internal.isEnabledForInteractionCentric()&&(t=".navBarHelp")),t},u.prototype.isMarsEnabledForUser=function(){},u.prototype.isMarsEnabledForOrg=function(){},u.prototype.isInAppSupportEnabledForUser=function(){},u.prototype.isInAppSupportEnabledForOrg=function(){},u.prototype.getMaxZIndex=function(){var r=100001,i,t;for(n.Client.Loader.appContext.isMobileClient()&&(r=14001),i=Array.prototype.slice.call(window.parent.document.getElementsByTagName("*")).concat(Array.prototype.slice.call(window.document.getElementsByTagName("*"))),t=0;t<i.length;t++)i[t].style&&!isNaN(i[t].style.zIndex)&&isFinite(i[t].style.zIndex)&&(r=Math.max(r,i[t].style.zIndex));return r},u.prototype.showCustomizationContainer=function(){n.Client.Loader.appContext.isMobileClient()&&n.Client.Loader.$mars(window.parent.document).find(".customizationContainer")&&n.Client.Loader.$mars(window.parent.document)&&(n.Client.Loader.$mars(window.parent.document).find(".customizationContainer").css({top:"0px",display:"block",height:"100%",width:"100%",position:"absolute","z-index":n.Client.Loader.appContext.util.getMaxZIndex()}),n.Client.Loader.$mars(window.parent.document).find(".customizationContainer #PersistentScriptsIFrame").css({width:"100%",height:"100%"}))},u.prototype.hideCustomizationContainer=function(){n.Client.Loader.appContext.isMobileClient()&&n.Client.Loader.$mars(window.parent.document).find(".customizationContainer")&&n.Client.Loader.$mars(window.parent.document)&&(n.Client.Loader.$mars(window.parent.document).find(".customizationContainer").css({display:"none",height:"0%",width:"0%",position:"absolute","z-index":n.Client.Loader.appContext.util.getMaxZIndex()}),n.Client.Loader.$mars(window.parent.document).find(".customizationContainer #PersistentScriptsIFrame").css({width:"0%",height:"0%"}))},u.prototype.setSelectionState=function(n){var i,r="position:absolute; left:"+n.elementX+"px; top:"+n.elementY+"px; width: "+n.elementWidth+"px; height: "+n.elementHeight+"px; box-shadow: 1px 1px 5px 6px blue; -webkit-box-shadow:1px 1px 5px 6px blue; -moz-box-shadow:1px 1px 5px 6px blue";document.getElementById("highlighter")?(i=document.getElementById("highlighter"),i.style.cssText=r):(i=document.createElement("div"),i.id="highlighter",i.style.cssText=r,t.Loader.$mars("#designerOverlay").append(i))},u.prototype.addOnPageNavigationHandler=function(n){var t=this;document.readyState==="complete"?n():window.setTimeout(function(){return t.addOnPageNavigationHandler(n),100})},u.prototype.getBrowserInfo=function(){var i=navigator.userAgent,n,t=i.match(/(opera|chrome|safari|firefox|msie|trident|crios(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(t[1]))return n=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE",version:n[1]||""};if(t[1]==="Chrome"){if(n=i.match(/\bOPR\/(\d+)/),n!=null)return{name:"Opera ",version:n[1]};if(n=i.match(/\Edge\/(\d+)/),n!=null)return{name:"Edge",version:n[1]}}return t[1]==="CriOS"?(n=i.match(/\CriOS\/(\d+)/),{name:"Chrome",version:n[1]||""}):(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],(n=i.match(/version\/(\d+)/i))!=null&&t.splice(1,1,n[1]),{name:t[0],version:t[1]})},u.prototype.getOS=function(){var n="",t,i=navigator.userAgent,r=navigator.appVersion;return r.indexOf("Win")!=-1?n="WINDOWS":r.indexOf("Mac")!=-1&&i.match(/iPhone|iPad|iPod/i)==null?n="MAC":i.match(/Android/i)?(n="ANDROID",t=/Android ([\.\_\d]+)/.exec(i)[1]):r.indexOf("X11")!=-1?n="UNIX":r.indexOf("Linux")!=-1?n="LINUX":r.indexOf("SunOS")!=-1?n="SOLARIS":i.match(/BlackBerry/i)?(n="BLACKBERRY",t=/BlackBerry ([\.\_\d]+)/.exec(i)[1]):i.match(/iPhone|iPad|iPod/i)?(n="IOS",t=/OS (\d+)_(\d+)_?(\d+)?/.exec(r),t=t[1]+"."+t[2]+"."+(t[3]|0)):i.match(/IEMobile/i)&&(n="WINDOWS PHONE",t=/Windows Phone ([\.\_\d]+)/.exec(r)[1]),{Os:n,OsVersion:t}},u.prototype.validateRuntimeSupport=function(n){return this.isWebClientAndDesktop()||this.isMobileClientAndShimDisabled||this.isWebClientAndTabletDeviceShimDisabled(n.isTabletBrowserSupported)||this.isMobileClientTabletDeviceShimEnabled(n.isTabletOSSupported)?!0:!1},u.prototype.isRuntimeSupported=function(t){var o=this.getBrowserInfo(),r=this.getOS(),e={isTabletOSSupported:!1,isTabletBrowserSupported:!1},f,u,i;if(n.Client.Loader.appContext._formFactor.toString()==n.Client.Utility.FormFactorEnum.Tablet&&(this.isWindowSupportedTablet()&&(r.Os=r.Os?r.Os:"WINDOWS",r.OsVersion=r.OsVersion?r.OsVersion:"10"),f=r,f.Os&&f.OsVersion)){for(u=[],i=0;i<t.length;i++)t[i].Device.toLowerCase()==f.Os.toLowerCase()&&parseFloat(t[i].MinOsVersion)<=parseFloat(f.OsVersion)&&(e.isTabletOSSupported=!0,u.push(t[i].Browser));if(u.length>0)for(i=0;i<u[0].length;i++)u[0][i].name.toLowerCase()==o.name.toLowerCase()&&parseFloat(u[0][i].minVersion)<=parseFloat(o.version)&&(e.isTabletBrowserSupported=!0)}return this.validateRuntimeSupport(e)},u.prototype.isTabletDeviceShimEnabled=function(){return n.Client.Loader.appContext.ClientType===r.MobileClient&&n.Client.Loader.appContext._formFactor.toString()==n.Client.Utility.FormFactorEnum.Tablet&&!n.Client.Loader.appContext.isShimDisabled()?!0:!1},u.prototype.isWebClientAndDesktop=function(){return n.Client.Loader.appContext.ClientType===r.WebClient&&n.Client.Loader.appContext._formFactor.toString()==n.Client.Utility.FormFactorEnum.Desktop?!0:!1},u.prototype.isWebClientAndTabletDeviceShimDisabled=function(t){return n.Client.Loader.appContext.ClientType===r.WebClient&&n.Client.Loader.appContext._formFactor.toString()==n.Client.Utility.FormFactorEnum.Tablet&&n.Client.Loader.appContext.isShimDisabled()&&t?!0:!1},u.prototype.isMobileClientAndShimDisabled=function(){return n.Client.Loader.appContext.ClientType===r.MobileClient&&n.Client.Loader.appContext.isShimDisabled()?!0:!1},u.prototype.isMobileClientTabletDeviceShimEnabled=function(n){return this.isTabletDeviceShimEnabled()&&n?!0:!1},u.prototype.isWindowSupportedTablet=function(){if(navigator.userAgent.indexOf("Windows NT")!=-1){var n=/Windows NT ([\.\_\d]+)/.exec(navigator.userAgent)[1];return n&&parseFloat(n)>=10&&navigator.maxTouchPoints>0}return!1},u.prototype.initializeConfiguration=function(){n.Client.Loader.appContext.setAuthoringID(n.Client.Loader.appContext.Util.getConfigurationData(this.AuthoringId));n.Client.Loader.contextAppVersionType=this.getConfigurationData(this.ProductVersionMatchCriteria);n.Client.Loader.backupLanguageLcid=n.Client.Loader.appContext.Util.getConfigurationData(this.BackupLcid);n.Client.Loader.defaultLanguageLcid=n.Client.Loader.appContext.Util.getConfigurationData(this.DefaultLcid);var i=n.Client.Loader.appContext.Util.getConfigurationData(this.LifeCycleStageSetting);i&&i.length>0&&(t.Loader.appContext.CurrentStage=i[0].Name);this.initializeOnLoadAnswerPanelThreshold()},u.prototype.assignCkEditorInstance=function(n){window._MicrosoftMars.Client.Loader.appContext.isISHPage()&&n&&(window.CKEDITOR=n)},u.prototype.handleAnswerPanelScroll=function(){var n=t.Loader.$mars(".mars-preview-answerPanel-sections");(n.length<0||n==null||n===undefined)&&(n=t.Loader.$mars(".mars-ap-custom-section-preview"));n.length>0&&n!=null&&n!==undefined&&(n.get(0).scrollHeight>n.height()?n.hasClass("mars-answerPanel-withScroll")||n.addClass("mars-answerPanel-withScroll"):n.hasClass("mars-answerPanel-withScroll")&&n.removeClass("mars-answerPanel-withScroll"))},u.prototype.executeFwLink=function(t){var r=this,u,f,i;r.iswindows8Shim()?t.find("[class='crm-mars-title']").empty().text(n.Client.Loader.marsLocale.videoNotSupportedinWindows8):t.length>0&&(u=t.data("videosource"),n.Client.Loader.ServiceProxy.webApiBaseUrl=n.Client.Loader.webApiBaseUrl,f=new n.Client.Loader.UtilityAPI,i=f.getResolveUrl(u),i.done(function(i){var u=i.Result,o=window.Microsoft.Mars.Client.Runtime.Controls,s=o.ScenarioManager.isBubbleVisible(),h=s?1:0,f,e;u=r.getFormatedYouTubeVideoUrl(u);f=u.indexOf("?")<0?"?":"&";e='<iframe id="YTplayer" name="mars-videoPreview" title="'+u+'" tabindex="'+h+'" class="mars-section-video" type="text/html" src="'+u+f+"enablejsapi=1&origin="+n.Client.Loader.appContext.getClientUrl()+'" frameborder="0" allowfullscreen="allowfullscreen"><\/iframe><script>var tag = document.createElement("script");tag.src = "//www.youtube.com/iframe_api";var firstScriptTag = document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);var playerObj; function onYouTubeIframeAPIReady(){playerObj = new YT.Player("YTplayer");} <\/script>';t.replaceWith(e)}),i.fail(function(){t.find("[class='crm-mars-title']").empty().text(n.Client.Loader.marsLocale.errorLoadingVideoCaption)}))},u.prototype.isWindowsOs=function(){var t=n.Client.Loader.appContext.Util.getOS().Os;return t==="WINDOWS"||t==="WINDOWS PHONE"?!0:!1},u.prototype.iswindows8Shim=function(){if(n.Client.Loader.appContext.clientType==="Mobile"){var i=window.parent.Microsoft.Crm.Client.Core.Framework.UserAgent,t=i.getInstance();return t.get_IsWindows()&&t.get_PALEnabled()&&window.toStaticHTML!==undefined}return!1},u.prototype.getFormatedYouTubeVideoUrl=function(n){var r="https://www.youtube.com/embed/",i,u,t;if(n.indexOf("youtube.com/watch")>0)return i=this.getQueryStringByName(n,"v"),r+i;if(n.indexOf("youtu.be/")>0)for(u=n,t=n.length-1;t>=0;t--)if(n[t]=="/"||n[t]=="=")return i=u.substring(t+1),r+i;return n},u.prototype.getQueryStringByName=function(n,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+t+"=([^&#]*)"),i=r.exec(n);return i===null?"":decodeURIComponent(i[1].replace(/\+/g," "))},u.prototype.showOverlay=function(){var i=this,t;n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:showOverlay START");t=n.Client.Loader.$mars("#lpathRuntimeOverlay");t.hasClass("lpath-overlay-show")||t.addClass("lpath-overlay-show");t.off(r.MouseDownEventName).on(r.MouseDownEventName,function(n){return i.stopImmediatePropagation(n)});n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:showOverlay END")},u.prototype.hideOverlay=function(){var i=this,t;n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:hideOverlay START");t=n.Client.Loader.$mars("#lpathRuntimeOverlay");t.off(r.MouseDownEventName,function(n){return i.stopImmediatePropagation(n)});t.hasClass("lpath-overlay-show")&&t.removeClass("lpath-overlay-show");n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:hideOverlay END")},u.prototype.hideDesignerOverlay=function(){n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:hideDesignerOverlay START");t.Loader.$mars("#lPathDesignerOverlay").hasClass("lpath-overlay-show")&&t.Loader.$mars("#lPathDesignerOverlay").removeClass("lpath-overlay-show");n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:hideDesignerOverlay END")},u.prototype.getOrCreateFeedbackOverlay=function(){var t,i;return n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:getOrCreateFeedbackOverlay START"),u.feedbackOverlayDiv==null&&(t=n.Client.Loader.$mars("#lpathRuntimeFeedbackOverlay"),t.length>0?(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"getting the overlay"),u.feedbackOverlayDiv=t[0]):(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"creating the overlay"),u.feedbackOverlayDiv=document.createElement("div"),u.feedbackOverlayDiv.id="lpathRuntimeFeedbackOverlay",u.feedbackOverlayDiv.tabIndex=-1,i=this.getMaxZIndex()+1,u.feedbackOverlayDiv.className=n.Client.Loader.appContext.isRTL()?"lpath-overlay-initial lpath-runtime-overlay lpath-rtl":"lpath-overlay-initial lpath-runtime-overlay",u.feedbackOverlayDiv.style.cssText="top:0; left:0; width:100%; height:100%;background: rgba(0,0,0,0.5); display:none; z-index:"+i,document.getElementsByTagName("body")[0].appendChild(u.feedbackOverlayDiv))),n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:getOrCreateFeedbackOverlay END"),u.feedbackOverlayDiv},u.prototype.getOrCreateOverlay=function(){var t,i;return n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:getOrCreateOverlay START"),u.overlayDiv==null&&(t=n.Client.Loader.$mars("#lpathRuntimeOverlay"),t.length>0?(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"getting the overlay"),u.overlayDiv=t[0]):(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"creating the overlay"),u.overlayDiv=document.createElement("div"),u.overlayDiv.id="lpathRuntimeOverlay",u.overlayDiv.tabIndex=-1,i=this.getMaxZIndex(),u.overlayDiv.className=n.Client.Loader.appContext.isRTL()?"lpath-overlay-initial lpath-runtime-overlay lpath-rtl":"lpath-overlay-initial lpath-runtime-overlay",u.overlayDiv.style.cssText="z-index:"+i,document.getElementsByTagName("body")[0].appendChild(u.overlayDiv))),n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:getOrCreateOverlay END"),u.overlayDiv},u.prototype.setGTPreviewState=function(n){this.isInGTPreview=n},u.prototype.getGTPreviewState=function(){return this.isInGTPreview},u.prototype.getNearestFocusableElement=function(n){if(!this.focusable(n)){var i=t.Loader.$mars(n).parent();return i.length>0?this.getNearestFocusableElement(i[0]):null}return n},u.prototype.setQuickCreateFormOpen=function(n){this.isQuickCreateFormOpen=n},u.prototype.getQuickCreateFormOpen=function(){return this.isQuickCreateFormOpen},u.prototype.executeAppMethod=function(i,r){var f=i.split("."),u=window,o,s,e;if(!this.checkIfMethodExists(f,window)&&(u=window.parent,!this.checkIfMethodExists(f,u)&&(u=t.Loader.appContext.context,!this.checkIfMethodExists(f,u))))return[];for(o=f.pop(),s=0;s<f.length;s++)u=u[f[s]];try{return(e=JSON.parse(r),Array.isArray(e)&&e.length>1&&(e=new Array(e)),typeof u[o]!="function")?u[o]:u[o].apply(this,e)}catch(h){n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Exception"+h.toString()+"encountered in executing app method "+i)}},u.prototype.getHelpIcon=function(){throw new Error("Not Implemented");},u.prototype.getXrmObject=function(){throw new Error("Not Implemented");},u.prototype.setHelpIconStyle=function(){throw new Error("Not Implemented");},u.prototype.getHelpIconClickableElement=function(){throw new Error("Not Implemented");},u.prototype.getHelpIconParent=function(){var n=this.getHelpIcon();return n.parent().parent().parent()},u.prototype.getHelpIconParentBackgroundColor=function(){var t=n.Client.Loader.$mars(window.parent.document).find(".navigationControl");return t.css("background-color")},u.prototype.updateHelpIconBackground=function(t){var i,r;i=n.Client.Loader.appContext.Util.getHelpIconParent();r=t?n.Client.Loader.appContext.Util.getHelpIconParentBackgroundColor():"white";i.css("background-color",r)},u.prototype.isEnterPressed=function(n,t){return n.keyCode===i.KeyCodeEnum.EnterKey||n.which===i.KeyCodeEnum.EnterKey?!0:t&&(n.keyCode===i.KeyCodeEnum.SpaceKey||n.which===i.KeyCodeEnum.SpaceKey)?!0:!1},u.prototype.visible=function(n){return i.$mars.expr.filters.visible(n)&&!i.$mars(n).parents().addBack().filter(function(){return t.Loader.$mars(this).css("visibility")==="hidden"}).length},u.prototype.checkIfMethodExists=function(n,t){var i=n.reduce(function(n,t){return typeof n=="undefined"?n:n[t]},t);return i!=null&&i!=undefined},u.prototype.focusable=function(n){var r,u,f,e=n.nodeName.toLowerCase(),o=!isNaN(t.Loader.$mars(n).attr("tabindex"));return"area"===e?(r=n.parentNode,u=r.name,!n.href||!u||r.nodeName.toLowerCase()!=="map")?!1:(f=i.$mars("img[usemap=#"+u+"]")[0],!!f&&this.visible(f)):(/input|select|textarea|button|object/.test(e)?!n.disabled:"a"===e?n.href||o:o)&&this.visible(n)},u.prototype.initializeOnLoadAnswerPanelThreshold=function(){var i=n.Client.Loader.appContext.Util.getConfigurationData("GlobalConfiguration");t.Loader.answerPanelOnLoadThreshold=i.Configuration.onLoadAnswerPanelThreshold},u.prototype.stopImmediatePropagation=function(n){n.stopImmediatePropagation()},u.whitelistedLCIDs=[],u.isPageLoading=!1,u.overlayDiv=null,u.feedbackOverlayDiv=null,u.appNameIdMap={},u}();i.Util=u})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(){var n=window._MicrosoftMars.Client.Loader.$mars;n.fn.extend({marsAppend:function(n,t){_MicrosoftMars.Client.Loader.appContext.Util.iswindows8Shim()?n.append(window.toStaticHTML(t)):n.append(t)},marsSetInnerHTML:function(n,t){n.innerHTML=_MicrosoftMars.Client.Loader.appContext.Util.iswindows8Shim()?window.toStaticHTML(t):t},marsHasScroll:function(n){var t=this.css("overflow-x"),i=this.css("overflow-y");if(typeof n=="undefined")return t==="scroll"||i==="scroll"||t==="auto"||i==="auto"?!0:!1;switch(n){case"x":return t==="scroll"||t==="auto"?!0:!1;case"y":return i==="scroll"||i==="auto"?!0:!1}return!1},marsScrollComplete:function(t,i){n(this).off("scroll").on("scroll",function(){setTimeout(t,i)})},triggerAll:function(n){var t=this,i=n.split(" ");return i.forEach(function(n){t.trigger(n)}),t}})}(),function(n){var t;(function(t){var i;(function(t){"use strict";var r=function(r){function u(n){r.call(this);u._instance?console.log("Singleton instance already exists for MdmAppContext. Access it via MdmAppContext.getInstance()"):u.mdmXRM=n}return __extends(u,r),u.getInstance=function(n){return u._instance===null&&(u._instance=new u(n)),u._instance},u.getAvailableClients=function(){return"Web"},u.getAvailableFormFactors=function(){return[1,2,3]},u.prototype.isPageLoaded=function(){return!0},u.prototype.getPageType=function(){return""},u.prototype.insertCustomScript=function(n){u.mdmXRM.Internal.insertCustomScript(n)},u.prototype.getPageNavigationInfo=function(){return"http://MDM.testOrg.extest.microsoft.com/Main.aspx"},u.prototype.navigateToPage=function(n){t.CrmAppContext.crmXRM.Internal.navigateToPage(n)},u.prototype.isFirstLogin=function(){return!0},u.prototype.scrollTheIframes=function(){return!1},u.prototype.checkForPageLoad=function(t,i){var u=this.isPageLoaded(),r;u?n.Client.Loader.$mars("body").find("InlineDialog")?setTimeout(function(){t(i)},1e3):t(i):(r=this,setTimeout(function(){r.checkForPageLoad(t,i)},1e3))},u.prototype.loadStaticHelp=function(){},u.prototype.getAppName=function(){return"MDM"},u.prototype.getFormFactor=function(){return"FormFactor"},u.prototype.isMarsEnabled=function(){return!0},u.prototype.isInternalEnvironment=function(){return!0},u.prototype.getDefaultUserRole=function(){return""},u.prototype.getDefaultLifeCycleStage=function(){return""},u.prototype.getOrgName=function(){return"OrgName"},u.prototype.getOrgLcid=function(){return""},u.prototype.getCurrentContentFrame=function(n,t){return n.find(t)},u.prototype.isRTL=function(){return!1},u.prototype.getAppModuleListFromAPI=function(){return[]},u.prototype.getClientUrl=function(){return null},u.prototype.getClientName=function(){return""},u.prototype.getClientState=function(){return""},Object.defineProperty(u.prototype,"UserId",{get:function(){return"UserID"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"UserName",{get:function(){return"UserName"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"UserRoles",{get:function(){return this.userRoles||(this.userRoles=["Admin","User"]),this.userRoles},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"Locale",{get:function(){return this.locale||(this.locale="1033"),this.locale},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"AppVersion",{get:function(){return this.appVersion||(this.appVersion="7.1.0.0"),this.appVersion},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"ProductEnvironmentType",{get:function(){return this.productEnvironmentType||(this.productEnvironmentType="2"),this.productEnvironmentType},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"LifeCycleStages",{get:function(){return this.lifeCycleStages||(this.lifeCycleStages="First Run (Buy)"),this.lifeCycleStages},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"TenantId",{get:function(){return this.tenantId||(this.tenantId="TenantId"),this.tenantId},enumerable:!0,configurable:!0}),u.prototype.setTenantProperties=function(n){n&&n()},Object.defineProperty(u.prototype,"TenantSku",{get:function(){return this.tenantSku||(this.tenantSku="TenantSKU"),this.tenantSku},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"Util",{get:function(){return this.util||(this.util=new i),this.util},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"ClientType",{get:function(){return this.clientType||(this.clientType="Web"),this.clientType},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"CurrentStage",{get:function(){return this.currentStage||(this.currentStage="Test Drive"),this.currentStage},set:function(n){this.currentStage=n},enumerable:!0,configurable:!0}),u._instance=null,u}(t.AppContext),i;t.MdmAppContext=r;i=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.getMarsLauncher=function(){return null},t.prototype.getHelpIcon=function(){return[]},t.prototype.executeAppMethod=function(){return[]},t}(t.Util);t.MDMUtils=i})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(n){var t;(function(t){"use strict";var i=function(){function t(){}return t.isFeatureEnabled=function(t){var i,r;return t==this.AppModuleContext&&!this.versionCheck(n.Loader.appContext.getAppVersion())?!1:(i=!1,t&&localStorage.allEnabledFeatures)?(r=JSON.parse(localStorage.allEnabledFeatures),r[t])?JSON.parse(r[t].isEnabled):i:i},t.versionCheck=function(n){if(n){var t=n.split("."),i=parseInt(t[0]),r=parseInt(t[1]);return i==8&&r>=2||i>8?!0:!1}return!1},t.GuidedTaskFeatureName="GuidedTask",t.SidebarFeatureName="Sidebar",t.TokensFeatureName="Tokens",t.CommentsFeatureName="Comments",t.ClientContextResolutionFeatureName="ClientContextResolution",t.WildcardingFeatureName="Wildcarding",t.LifeCycleStageFeatureName="LifeCycleStage",t.AnalyzeFeatureName="Analyze",t.BulkEditFeatureName="BulkEdit",t.ConfigurationFeatureName="Configuration",t.DeleteFeatureName="Delete",t.ExportControlFeatureName="ExportControl",t.ViewReportsFeatureName="ViewReports",t.XliffExportFeatureName="XliffExport",t.XliffImportFeatureName="XliffImport",t.PublishFeatureName="Publish",t.MSSetting="MSSetting",t.FooterSection="FooterSection",t.AddExistingGuidedTask="AddExistingGuidedTask",t.RegisteredControl="RegisteredControl",t.DomControl="DomControl",t.WaitingBubble="WaitingBubble",t.AppModuleContext="AppModuleContext",t.MarsOnUCIFeatuerName="MarsOnUCI",t.UCISideBarFeatureName="UCISideBar",t.UCIGuidedTaskFeatureName="UCIGuidedTask",t.ThemeabilityFeatureName="Themeability",t.LiveChatFeatureName="LiveChat",t.LiveChatv2FeatureName="LiveChatv2",t.InAppsFeatureName="InAppSupport",t.IASLaunchThroughSmileyFeatureName="IASLaunchThroughSmiley",t.TrialOrgFeatureName="NonTrialOrg",t.NPSSurvey="NPSSurvey",t.GDPRUpdate="GDPRUpdate",t}();t.FFFUtility=i})(t=n.Utility||(n.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(n){var t;(function(t){"use strict";var u=function(){function u(){}return u.prototype.invokeUserRoleSync=function(){var f=this;n.Loader.appContext.getOrganizationUserRoles();t.AppContext.isAppUserRoleCallSucceeded||this.showPostControlActionFlyout(n.Loader.marsLocale.crmUserRoleFetchFailed);this.marsUserRoles=[];var o=new n.Loader.ConfigurationAPI,e=o.post("","GetCurrentOrgMarsUserRoles"),u=this;e.done(function(t){var e,o,s;if(u.result=t.Result,!u.result){f.showPostControlActionFlyout(n.Loader.marsLocale.marsUserRoleFetchFailed);return}for(e=0;e<u.result.length;e++)u.marsUserRoles.push(new r(u.result[e].Name,u.result[e].Value,u.result[e].Id,u.result[e].AuthoringId,u.result[e].Precedence,i.untouched,u.result[e].IsAdmin,u.result[e].IsActive));if(o=u.compareUserRoles(u),o==null){s=window._MicrosoftMars.Client.Designer.Util.Common;s.showErrorMessage([n.Loader.marsLocale.crmAndMarsInSyncMessage],function(){jQuery(n.Loader.$mars.find('button[id="syncRoleButton"]')).focus()},function(){jQuery(n.Loader.$mars.find('button[id="syncRoleButton"]')).focus()},n.Loader.marsLocale.syncRolesCaption);return}u.syncUserRole(o)});e.fail(function(){f.showPostControlActionFlyout(n.Loader.marsLocale.marsUserRoleFetchFailed)})},u.prototype.compareUserRoles=function(n){for(var f,u,e=[],o=n.marsUserRoles.length,r=0;r<n.marsUserRoles.length;r++){if(n.marsUserRoles[r].value.toUpperCase()=="11111111-1111-1111-1111-111111111111"||n.marsUserRoles[r].value.toUpperCase()=="22222222-2222-2222-2222-222222222222"||n.marsUserRoles[r].value.toUpperCase()=="33333333-3333-3333-3333-333333333333"){n.marsUserRoles[r].objectState=i.untouched;continue}for(f=0;f<t.AppContext.organizationUserRoles.length;f++)if(n.marsUserRoles[r].value.toUpperCase()===t.AppContext.organizationUserRoles[f].value.toUpperCase()){n.marsUserRoles[r].objectState=n.marsUserRoles[r].isActive?i.untouched:i.modified;t.AppContext.organizationUserRoles[f].objectState=i.untouched;n.marsUserRoles[r].isActive=!0;n.marsUserRoles[r].objectState!==i.untouched&&e.push(n.marsUserRoles[r]);break}}for(u=0;u<t.AppContext.organizationUserRoles.length;u++)t.AppContext.organizationUserRoles[u].objectState===i.added&&(n.marsUserRoles.push(t.AppContext.organizationUserRoles[u]),t.AppContext.organizationUserRoles[u].precedence=o,o++,e.push(t.AppContext.organizationUserRoles[u]));return e.length>0?e:null},u.prototype.syncUserRole=function(t){var i=this,f=new n.Loader.ConfigurationAPI,r=f.post(t,"SyncUserRole"),u=window._MicrosoftMars.Client.Designer.Util.Common;r.done(function(){i.onSuccess&&i.onSuccess();var t=window._MicrosoftMars.Client.Designer.App,r=t.lPathDesignerContainer;u.showAlertMessage(n.Loader.marsLocale.syncRolesCaption,n.Loader.marsLocale.userRoleSyncedMessage,r,!1,n.Loader.marsLocale.okCaption,!1,function(){n.Loader.$mars(".lpath-gt-config-sync-role").focus()},function(){n.Loader.$mars(".lpath-gt-config-sync-role").focus()})});r.fail(function(){i.onFailure&&i.onFailure();u.showErrorMessage([n.Loader.marsLocale.crmAndMarsInSyncMessage],function(){jQuery(n.Loader.$mars.find('button[id="syncRoleButton"]')).focus()},function(){jQuery(n.Loader.$mars.find('button[id="syncRoleButton"]')).focus()},n.Loader.marsLocale.userRoleSyncFailedMessageTitle)})},u.prototype.showPostControlActionFlyout=function(n){var t=window._MicrosoftMars.Client.Designer.PostControlActionHandler.getInstance();t.createPostControlActionFlyout(n)},u}(),r,i;t.UserRoleSync=u;r=function(){function n(n,t,r,u,f,e,o,s){e===void 0&&(e=i.untouched);o===void 0&&(o=!0);s===void 0&&(s=!0);this.name=n;this.value=t;this.objectState=e;this.id=r;this.AuthoringId=u;this.precedence=f;this.isActive=s;this.isAdmin=o}return n}();t.UserRoles=r,function(n){n[n.untouched=0]="untouched";n[n.added=1]="added";n[n.modified=2]="modified";n[n.deleted=3]="deleted"}(t.UserRoleState||(t.UserRoleState={}));i=t.UserRoleState})(t=n.Utility||(n.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(t){var i;(function(i){"use strict";var u=function(t){function u(n,r){var f,e;t.call(this);this.roleTemplates=null;this._orgId=null;this._rootBusinessUnit=null;u._instance?console.log("Singleton instance already exists for CrmAppContext. Access it via CrmAppContext.getInstance()"):(u.crmXRM=n,u.crmXRMUI=r,this._formFactor=u.crmXRM.Page.context.client.getFormFactor(),this._isMarsEnabledForUser=u.crmXRM.Internal.isGuidedHelpEnabledForUser(),this._availableFormFactor=u.crmXRM.Internal.getAvailableFormFactors(),f=this._availableFormFactor.indexOf(i.FormFactorEnum.Phone),f>=0&&this._availableFormFactor.splice(f,1),this._availableClients=u.crmXRM.Internal.getAvailableClients(),this._orgName=u.crmXRM.Page.context.getOrgUniqueName(),this._orgLcid=u.crmXRM.Page.context.getOrgLcid(),this.apiDataVersion="/api/data/V8.0/",this.designerPrivilege="9FD3540F-E2C1-4EEA-B7E2-620C3719DDC5",this.appModuleUniqueName=window.APP_MODULE_UNIQUE_NAME,this._version=u.crmXRM.Page.context.getVersion(),e=this._version.split(".")[0],e&&(this.apiDataVersion="/api/data/V"+e+".0/"),this._context=u.crmXRM.Page.context)}return __extends(u,t),u.getInstance=function(n,t){return u._instance==null&&(u._instance=new u(n,t)),u._instance},u.prototype.getAuthoringId=function(){if(this._authoringId!=null)return this._authoringId},u.prototype.setAuthoringID=function(n){this._authoringId=n},u.prototype.getOrgId=function(){if(this._orgId!=null)return this._orgId;var i=n.Client.Loader.appContext.getClientUrl(),t,r=new XMLHttpRequest;t=n.Client.Utility.Util.TryRetrieve(r,i+this.apiDataVersion+"WhoAmI",3600);try{return t=jQuery.parseJSON(t),this._orgId=t.OrganizationId,this._orgId}catch(u){throw new Error("Error: Getting orgId failed...!");}},u.prototype.getPageType=function(){if(u._instance.ClientType===i.Constants.WebClient){if(window.Xrm.Internal.getPageContext().XrmUI!=null&&window.Xrm.Internal.getPageContext().XrmUI.Manager.getActivePage()!=null)return window.Xrm.Internal.getPageContext().XrmUI.Manager.getActivePage().getName()}else if(u._instance.ClientType===i.Constants.MobileClient&&window.parent.XrmUI.Manager.getActivePage()!=null)return window.parent.XrmUI.Manager.getActivePage().getName();return""},u.prototype.insertCustomScript=function(t){n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:insertCustomScript START");n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"scriptString: "+t);u.crmXRM.Internal.insertCustomScript(t);n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:insertCustomScript END")},u.prototype.getPageNavigationInfo=function(){var t,s,h,r,f,e,c,o,l,a;return n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:getPageNavigationInfo START"),t=u.crmXRM.Internal.getPageNavigationInfo(),t[i.Constants.WebClient]&&t[i.Constants.WebClient].indexOf("home_dashboards.aspx")!==-1&&t[i.Constants.WebClient].indexOf("dashboardId")===-1&&(s=t[i.Constants.MobileClient].indexOf("id=")+3,h=t[i.Constants.MobileClient].substring(s),t[i.Constants.WebClient]=t[i.Constants.WebClient]+"&dashboardId="+h),r={},f=r[this.ClientType]=t[this.ClientType],f&&(e=f.indexOf("etc="),e!==-1&&(c=f.substring(e+4).split("&")[0],o=u.crmXRM.Internal.getEntityName(parseInt(c)),o!==null&&(l={key:"etn",value:o,api:"Xrm.Internal.getEntityCode"},a={etc:l},r.QSMap=JSON.stringify(a)))),n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"The page navigation received for "+this.ClientType+" : "+r[this.ClientType]),n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:getPageNavigationInfo END"),r},u.prototype.navigateToPage=function(t){n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:navigateToPage START");n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"pageNavigationInfo"+JSON.stringify(t));u.crmXRM.Internal.navigateToPage(t);n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:navigateToPage END")},u.prototype.isFirstLogin=function(){return!0},u.prototype.getDraftPublishGroupId=function(){if(this._draftPublishGroup!==null)return this._draftPublishGroup;var t=n.Client.Loader.appContext.Util.getConfigurationData("PublishGroupSetting"),i=t.filter(function(n){if(n.PublishGroupType==1)return!0});return this._draftPublishGroup=i[0].Id,this._draftPublishGroup},u.prototype.checkForPageLoad=function(t,i,r){var u,f;i===void 0&&(i=null);r===void 0&&(r=0);n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:checkForPageLoad START");r==100&&n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"CrmAppContext:checkForPageLoad : Time out. Assuming page load is complete.");u=this.isPageLoaded()||r==100;u?(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"calling the callback"),n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_MARS_CRM_PAGE_LOAD_COMPLETE_END"),t(i)):r<100?(f=this,setTimeout(function(){f.checkForPageLoad(t,i,r+1)},200)):n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.ERROR,"count exceeded 20. Error Encountered");n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:checkForPageLoad END")},u.prototype.isPageLoaded=function(){var t,i,o,s,f,h,r,e;if(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:isPageLoaded START"),t=u.getXrmClientType(),t==="Mobile")return n.Client.Loader.appContext.Util.getQuickCreateFormOpen()?!n.Client.Loader.appContext.isQuickCreateFormOpen():(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Checking for metadata download"),window.parent.UserEducation==null||window.parent.UserEducation===undefined||window.parent.UserEducation.style.display!=="block"?(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Page Loaded"),!0):(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Page Not Loaded"),!1));if(window.pageLoadedCheckForNavigateApi){if(!this.checkFormAndPageLoaded())return!1;if(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Page Loaded, but checking for inner frames"),i=n.Client.Loader.appContext.getPageNavigationInfo(),i[t]&&i[t].indexOf("dashboardId")!==-1&&(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"For dashboard page, checking if dashboard id has been set."),o=i[t].indexOf("dashboardId=")+12,s=i[t].substring(o),s==="00000000-0000-0000-0000-000000000000"))return n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"dashboard id has not been set"),!1;if(n.Client.Loader.$mars(".navActionGroupContainer").length>0)return parseInt(n.Client.Loader.$mars(".navActionGroupContainer").css("height"))>1?!0:!1;if(n.Client.Loader.$mars("#globalquickcreate_loading_bar_NavBarGloablQuickCreate").length>0)return n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Checking for quick create form "),n.Client.Loader.$mars("#globalquickcreate_loading_bar_NavBarGloablQuickCreate").css("visibility")!=="hidden"||window.QuickCreateFormLoadStartTime!=null&&window.QuickCreateFormLoadStartTime!==undefined&&window.QuickCreateFormLoadEndTime===undefined?(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Quick Create Form not loaded"),!1):(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Quick Create Form loaded"),f=n.Client.Loader.$mars("#globalquickcreate_container_NavBarGloablQuickCreate"),f.length>0)?(h=parseInt(f.css("top")),h>0)?!0:!1:!0;if(n.Client.Loader.$mars("#InlineDialog").length>0&&n.Client.Loader.$mars("#InlineDialog").is(":visible"))return n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Checking for Inline Dialog"),n.Client.Loader.$mars("#DialogLoadingDiv").css("display")!=="none"||n.Client.Loader.$mars("#DialogLoadingDiv").is(":visible")?(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Inline Dialog not loaded"),!1):(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Inline Dialog loaded"),!0);if(n.Client.Loader.$mars("#"+n.Client.Loader.$mars("#crmContentPanel").attr("currentcontentid")).contents().find("body").find("#dashboardFrame").length>0&&(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Checking for Personal Wall"),r=n.Client.Loader.$mars("#"+n.Client.Loader.$mars("#crmContentPanel").attr("currentcontentid")).contents().find("body").find("#dashboardFrame").contents().find("body").find("#WebResource_PersonalWall"),r.length>0&&r.is(":visible")))return(e=r.contents().find("body").find("#activityFeedsWall"),e.length>0&&e.attr("iswallrenderingcomplete")!==undefined)?(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Personal wall loaded"),!0):(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Personal wall not loaded"),!1)}return n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"isPageLoaded: "+window.pageLoadedCheckForNavigateApi),n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:isPageLoaded END"),window.pageLoadedCheckForNavigateApi},u.prototype.loadStaticHelp=function(){if(this.ClientType==="Web")window.loadHelp();else if(this.ClientType==="Mobile")if(n.Client.Loader.appContext.isISHPage()){var t="http://go.microsoft.com/fwlink/p/?LinkID=616286&area=interactive_service_hub&user_lcid="+this.locale.toString();window.open(t,"_blank")}else this.openExternalUrl("http://go.microsoft.com/fwlink/?LinkId=296267&clcid=0x"+this.locale.toString(16))},u.prototype.getAppName=function(){return"Crm"},u.prototype.getFormFactor=function(){return this._formFactor},u.prototype.getClientUrl=function(){return u.crmXRM.Page.context.getClientUrl()},u.prototype.getClientName=function(){return u.getXrmClientType()},u.prototype.getClientState=function(){return u.crmXRM.Page.context.client.getClientState()},u.prototype.isMarsEnabledForUser=function(){return this._isMarsEnabledForUser},u.prototype.isMarsEnabledForOrg=function(){return u.crmXRM.Internal.isFeatureEnabled("FCB.GuidedHelp")},u.prototype.isInAppSupportEnabledForUser=function(){return u.crmXRM.Internal.isFeatureEnabled("FCB.InAppSupport")},u.prototype.isInAppSupportEnabledForOrg=function(){return u.crmXRM.Internal.isFeatureEnabled("FCB.InAppSupportOrg")},u.prototype.isISHPage=function(){return u.crmXRM.Internal.isEnabledForInteractionCentric()},u.prototype.getAppVersion=function(){return this.appVersion||(this.appVersion=u.crmXRM.Page.context.getVersion()),this.appVersion},u.prototype.getDefaultUserRole=function(){return""},u.prototype.getDefaultLifeCycleStage=function(){return""},u.prototype.getDefaultFormFactor=function(){return"1,2,3"},u.prototype.getOrgName=function(){return this._orgName},u.prototype.getOrgLcid=function(){return this._orgLcid},u.prototype.getCurrentClient=function(){var r,t=u.getXrmClientType();return n.Client.Loader.appContext.isISHPage()?(r="Ish",t="ishClientCaption"):t===i.Constants.WebClient?(r=t,t="webClientCaption"):t===i.Constants.MobileClient&&(r=t,t="mobileClientCaption"),{clientDisplayValue:n.Client.Loader.marsLocale[t],clientKey:r}},u.prototype.getAvailableClients=function(){return this._availableClients},u.prototype.getAvailableFormFactors=function(){return this._availableFormFactor},u.prototype.getControl=function(t){var i,r,u;return n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:getControl START"),i=null,r=this.getAllChildRegisteredControl(),r!=null&&(i=this.checkForControl(r,t)),i==null&&(u=this.getActiveRegisteredControl(),u!=null&&(i=this.checkForControl(u,t))),n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:getControl END"),i},u.prototype.getActiveRegisteredControl=function(){var n=u.crmXRMUI.Manager.getActiveControls();return n.getAll()},u.prototype.getAllChildRegisteredControl=function(){var n=u.crmXRMUI.Manager.getAllChildControls();return n.getAll()},u.prototype.getCookieForUsingClientApi=function(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)===" ";)t=t.substring(1);if(t.indexOf(r)===0)return t.substring(r.length,t.length)}return""},u.prototype.setCookieForUsingClientApi=function(n,t,i){var r=new Date,u;r.setTime(r.getTime()+i*864e5);u="expires="+r.toUTCString();document.cookie=n+"="+t+"; "+u},u.prototype.getCurrentContentFrame=function(n){return n.find("#"+n.find("#crmContentPanel").attr("currentcontentid"))},u.prototype.allowBindHelpNavTab=function(){return u._instance.ClientType==i.Constants.MobileClient&&!n.Client.Loader.appContext.isISHPage()?!1:!0},u.prototype.isRTL=function(){return window.LOCID_UI_DIR==="RTL"},u.prototype.appLPAuthoringEnabled=function(){var n=new XMLHttpRequest,t;return(n.open("GET",u.crmXRM.Page.context.getClientUrl()+"/api/data/v8.0/organizations?$select=enablelpauthoring",!1),n.send(null),n.status===200&&(t=JSON.parse(n.responseText),t.value.length>0))?t.value[0].enablelpauthoring:!1},Object.defineProperty(u.prototype,"UserId",{get:function(){return this.userId||(this.userId=u.crmXRM.Page.context.getUserId()),this.userId},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"ClientType",{get:function(){return this.clientType||(this.clientType=u.getXrmClientType()),this.clientType},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"UserName",{get:function(){return this.userName||(this.userName=u.crmXRM.Page.context.getUserName()),this.userName},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"UserRoles",{get:function(){return this.userRoles=u.crmXRM.Page.context.getUserRoles(),this.userRoles||(this.userRoles=["Admin"]),this.userRoles},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"RoleTemplates",{get:function(){var e,o,s,f,i,r,t;if(this.roleTemplates!=null)return this.roleTemplates;if(this.userRoles=u.crmXRM.Page.context.getUserRoles(),e=this.UserRoles.length,e>0)for(s="(roleid eq "+this.UserRoles[0]+")",o=1,e=this.UserRoles.length;o<e;o++)s+=" or (roleid eq "+this.UserRoles[o]+")";else return this.userRoles;if(f=new XMLHttpRequest,f.open("GET",n.Client.Loader.appContext.getClientUrl()+"/api/data/V8.0/roles?$select=_roletemplateid_value,_parentrootroleid_value&$filter="+s,!1),f.send(null),i=[],f.status===200)for(r=jQuery.parseJSON(f.responseText),t=0;t<r.value.length;t++)r.value[t]._roletemplateid_value?i.push(r.value[t]._roletemplateid_value):r.value[t]._parentrootroleid_value?i.push(r.value[t]._parentrootroleid_value):i.push(r.value[t].roleid);else return n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.WARNING,"Cant find role templates"),i;return this.roleTemplates=i,i},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"Locale",{get:function(){return this.locale||(this.locale=u.crmXRM.Page.context.getUserLcid()),this.locale},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"AppModuleUniqueName",{get:function(){return this.appModuleUniqueName||(this.appModuleUniqueName=window.APP_MODULE_UNIQUE_NAME),this.appModuleUniqueName},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"UserTimeZoneOffset",{get:function(){return this.userTimeZoneOffset||(this.userTimeZoneOffset=u.crmXRM.Page.context.getTimeZoneOffsetMinutes()),this.userTimeZoneOffset},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"ProductEnvironmentType",{get:function(){return this.publishEnvironment===undefined&&(this.productEnvironmentType="2"),this.productEnvironmentType},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"LifeCycleStages",{get:function(){return this.lifeCycleStages||(this.lifeCycleStages="First Run (Buy)"),this.lifeCycleStages},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"TenantSku",{get:function(){return this.tenantSku||(this.tenantSku="TenantSKU"),this.tenantSku},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"CurrentStage",{get:function(){return this.currentStage||(this.currentStage=""),this.currentStage},set:function(n){this.currentStage=n},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"PublishGroupId",{get:function(){return this.publishGroupId||(this.publishGroupId=""),this.publishGroupId},set:function(n){this.publishGroupId=n},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isDesignerEnabledforUser",{get:function(){var e=this,t=i.$mars.Deferred(),r=!1,f,u;return this.ClientType!==i.Constants.MobileClient&&this._formFactor===i.FormFactorEnum.Tablet?t.resolve(r):(f="roleprivilegescollection?$filter=privilegeid%20eq%20"+this.designerPrivilege,u=n.Client.Utility.Util.TryRetrieveAsync(n.Client.Loader.appContext.getClientUrl()+"/api/data/V8.0/"+f,3600),u.done(function(i){var f=JSON.parse(i).value,u,o;if(f.length>0)for(u=0;u<f.length;u++)o=f[u],n.Client.Loader.$mars.inArray(o.roleid,e.userRoles)>-1&&(r=!0,t.resolve(r));t.resolve(r)}),u.fail(function(){n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.WARNING,"Can not find designer privilage.");throw new Error("Retrieveing Role privileges Failed!");})),t.promise()},enumerable:!0,configurable:!0}),u.prototype.openExternalUrl=function(n,t){t===void 0&&(t={openInNewWindow:!0});u.crmXRM.Internal.openUrl(n,t)},u.prototype.getRootBusinessUnit=function(){if(this._rootBusinessUnit==null){var n=new XMLHttpRequest,t=this;n.onreadystatechange=function(){t.findRootBusinessUnit(n)};this.oDataGet(n,this.apiDataVersion,"businessunits?$select=name,businessunitid&$filter=_parentbusinessunitid_value%20eq%20null")}return this._rootBusinessUnit},u.prototype.findRootBusinessUnit=function(n){if(n.readyState==4&&n.status==200){var t=JSON.parse(n.responseText).value;t.length>0&&(this._rootBusinessUnit=t[0].businessunitid)}else this._rootBusinessUnit=null},u.prototype.isShimDisabled=function(){var n=window.parent.Microsoft.Crm.Client.Core.Framework.UserAgent;return n&&n.getInstance().get_PALEnabled()?!1:!0},u.prototype.openDialog=function(n,t,i,r){var f=window.Xrm?window.Xrm:window.parent.Xrm,u=new f.DialogOptions;u.height=t;u.width=i;f.Internal.openDialog(n,u,null,null,new Function(r))},u.prototype.openAlertDialog=function(n,t){var i=new window.parent.Xrm.AlertDialogStrings,r;i.text=n;i.confirmButtonLabel=this.locale.okCaption;t||(t=new window.parent.Xrm.DialogOptions,t.height="auto");r=window.Xrm?window.Xrm:window.parent.Xrm;r.Dialog.openAlertDialog(i,t)},u.prototype.getCurrentAppModule=function(){return t.prototype.getCurrentAppModule.call(this)},u.prototype.handleCustomizationContainerInMoca=function(t){var u=n.Client.Loader.appContext.isMobileClient();if(u){var r=n.Client.Loader.$mars(window.parent.document).find(".customizationContainer"),f=r.find("#PersistentScriptsIFrame"),e=i.$mars(f).contents().find("body");t?r.css({height:"100%",width:"100%"}):(r.css({height:"31px",width:"34px"}),e.css({overflow:"hidden"}))}},u.prototype.isQuickCreateFormOpen=function(){return n.Client.Loader.$mars(window.parent.document).find(".dialogConductor").children().length>0},u.prototype.getXrmObject=function(){var t=n.Client.Loader.$mars("#crmContentPanel"),i;return t.length>0?(i=t.find("iframe").filter(function(){return this.style.visibility=="visible"})[0].contentWindow,i.Xrm):null},u.prototype.getPageAttributes=function(i,r){var u=t.prototype.getPageAttributes.call(this,i,r),e,f;return u&&u.hasOwnProperty("pagetype")&&u.pagetype==="entityrecord"&&!u.hasOwnProperty("id")&&u.hasOwnProperty("extraqs")&&(e=n.Client.Loader.marsEncodeDecode.MarsUrlDecode(u.extraqs),f=this.getObjectFromUrlString(e),f&&f.hasOwnProperty("id")&&(u.id=f.id)),u},u.prototype.getObjectFromUrlString=function(n){var r={};return r=t.prototype.getObjectFromUrlString.call(this,n),r.id&&(r.id=i.Util.getParsedGuid(r.id)),r.dashboardId&&(r.dashboardId=i.Util.getParsedGuid(r.dashboardId)),r},u.prototype.getDefaultWhiteListedKeys=function(){var n=u.getXrmClientType();return n=="Web"?["dashboardId","pagetype","id","etn","pid"]:["pagetype","id","etn"]},u.prototype.getModule=function(t){var i="",r;return t.hasOwnProperty("sitemappath")&&(r=n.Client.Loader.marsEncodeDecode.MarsUrlDecode(t.sitemappath),i=r.split("|")[0]),i},u.prototype.setTenantProperties=function(n){if(this.tenantId){n&&n();return}var i=u.crmXRM.Internal.getTenantProperties(),t=this;i.done(function(i){var r=JSON.parse(i);t.TenantId=r.S2STenantId;t.TenantName=r.TenantName;t.MNC=r.IsMnc;t.OrgType=r.OrgType;t.OrgLicenses=r.UserLicensesUsed;t.OrgSize=r.CompanySize;t.IsPaid=parseInt(r.IsPaid);n&&n()})},u.getXrmClientType=function(){var t="";try{t=u.crmXRM.Page.context.client.getClient()}catch(r){n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.ERROR,"CrmAppContext.getXrmClientType() failed"+r)}return t===i.Constants.USD&&(t=i.Constants.WebClient),t},u.prototype.checkFormAndPageLoaded=function(){var i=n.Client.Loader.$mars("#crmContentPanel"),t,r;if(i.length>0&&i.attr("src").indexOf("entityrecord")>0)if(t=i.find("iframe").filter(function(){return this.style.visibility=="visible"})[0].contentWindow,r=t!=null&&t!=undefined?t.IsTurboForm:!1,r){if(!t.Mscrm.TurboForm.Control.PageBootstrapper.hasPageLoaded)return!1}else if(!(t.InlineEditInitializationCompletedTimestamp&&t.InlineEditInitializationCompletedTimestamp>t.StartLoadFormLayoutTimestamp))return!1;return!0},u.prototype.checkForControl=function(t,i){var e,r,s,h,u,f;for(e in t){var l=t[e],c=l.getCtrlObj(),o=this.isMobileClient()?this.getDOMElement(window.parent,c):c[0];if(o!=null&&n.Client.Loader.$mars(o).is(":visible")){if(r=t[e].getProperties(),r!=null){if(r.type===undefined&&r.id===undefined)continue;s=!0;for(h in i)if(u={key:h,value:i[h]},!(u.key in r)||r[u.key]==null||r[u.key].toString()!==u.value){s=!1;break}if(s===!1)continue;if(i.type===undefined&&r.type!==undefined||i.id===undefined&&r.id!==undefined)continue}return f=t[e].getBoundingBox(),{element:n.Client.Loader.$mars(o),elementX:f.pageX,elementY:f.pageY,elementWidth:f.width,elementHeight:f.height}}}return null},u.prototype.getDOMElement=function(n,t){return t&&t!=null&&t.isMounted()?n.ReactDOM.findDOMNode(t):null},Object.defineProperty(u.prototype,"Util",{get:function(){return this.util||(this.util=new r),this.util},enumerable:!0,configurable:!0}),u._instance=null,u}(i.AppContext),r;i.CrmAppContext=u;r=function(i){function r(){i.apply(this,arguments)}return __extends(r,i),r.prototype.getHelpIcon=function(){var t;return u.crmXRM.Internal.isEnabledForInteractionCentric()?(t=n.Client.Loader.$mars(window.parent.document).find(".Help-symbolISH"),t.length<=0&&(t=n.Client.Loader.$mars(window.parent.document).find(".Help-symbol"),t.removeClass("Help-symbol").addClass("Help-symbolISH"),t.length>0&&(t=n.Client.Loader.$mars(window.parent.document).find(".Help-symbolISH")))):t=n.Client.Loader.$mars(window.parent.document).find(".navTabHelpImage"),t},r.prototype.getHelpIconClickableElement=function(){return t.Loader.$mars(this.getHelpIcon()).parents("a")},r.prototype.getHelpIconParent=function(){var t=this.getHelpIcon();return n.Client.Loader.appContext.isISHPage()?t.parent():t.parent().parent().parent()},r.prototype.setHelpIconStyle=function(){var t=this.getHelpIcon().parent(),i=t.find(".navTabHelpImageWeb");n.Client.Loader.appContext.isISHPage()?(t.css({"padding-left":"0px","padding-top":"0px"}),i.css({padding:"12.5px 17px",display:"-webkit - inline - box"})):(t.parent().css({"padding-left":"0px","padding-top":"0px"}),i.css({margin:"19px 17px"}))},r}(i.Util);i.CRMUtils=r})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(t){var i;(function(i){"use strict";var u=function(u){function f(){u.call(this);this._availableFormFactor=[];this._orgId=null;f._instance?console.log("Singleton instance already exists for SinglePageAppContext. Access it via SinglePageAppContext.getInstance()"):(this._formFactor=1,this._isMarsEnabledForUser=!0,this._availableClients="Web",this._orgName="TCS",this._availableFormFactor=[1,2],this._orgId="b8318d27-9d21-e611-80d3-00155dbec4ee",this._orgLcid=1033,this.IsPaid=1)}return __extends(f,u),f.getInstance=function(){return f._instance==null&&(f._instance=new f),f._instance},Object.defineProperty(f.prototype,"UserId",{get:function(){return this.userId||(this.userId="{A1E4A633-9D21-E611-80D3-00155DBEC4EE}"),this.userId},set:function(n){this.userId=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"AppVersion",{get:function(){return this.appVersion||(this.appVersion="1.1"),this.appVersion},set:function(n){this.appVersion=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"ClientType",{get:function(){return this.clientType||(this.clientType=i.Constants.WebClient),this.clientType},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"UserName",{get:function(){return this.userName||(this.userName="First name Last name"),this.userName},set:function(n){this.userName=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"UserRoles",{get:function(){return this.userRoles||(this.userRoles=["Admin"]),this.userRoles},set:function(n){this.userRoles=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Locale",{get:function(){return this.locale||(this.locale="1033"),this.locale},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"UserTimeZoneOffset",{get:function(){return this.userTimeZoneOffset||(this.userTimeZoneOffset=""),this.userTimeZoneOffset},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"ProductEnvironmentType",{get:function(){return this.productEnvironmentType||(this.productEnvironmentType="2"),this.productEnvironmentType},set:function(n){this.productEnvironmentType=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"TenantSku",{get:function(){return this.tenantSku||(this.tenantSku="Online"),this.tenantSku},set:function(n){this.tenantSku=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"CurrentStage",{get:function(){return this.currentStage||(this.currentStage="Test Drive"),this.currentStage},set:function(n){this.currentStage=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"PublishGroupId",{get:function(){return this.publishGroupId||(this.publishGroupId=""),this.publishGroupId},set:function(n){this.publishGroupId=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"LoginCount",{get:function(){return this.loginCount},set:function(n){this.loginCount=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"TenantId",{get:function(){return this.tenantId||(this.tenantId="980FAE94-0493-4410-B08B-63EB27FE0E78"),this.tenantId},set:function(n){this.tenantId=n},enumerable:!0,configurable:!0}),f.prototype.setTenantProperties=function(n){n&&n()},Object.defineProperty(f.prototype,"OrgType",{get:function(){return this.orgType||(this.orgType=""),this.orgType},set:function(n){this.orgType=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"OrgSize",{get:function(){return this.orgSize||(this.orgSize=""),this.orgSize},set:function(n){this.orgSize=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"OrgLicenses",{get:function(){return this.orgLicenses||(this.orgLicenses=""),this.orgLicenses},set:function(n){this.orgLicenses=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"MNC",{get:function(){return this.mnc||(this.mnc=""),this.mnc},set:function(n){this.mnc=n},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Util",{get:function(){return this.util||(this.util=new r),this.util},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"RoleTemplates",{get:function(){return["248090ff-40a3-4053-8790-584edc5be201"]},enumerable:!0,configurable:!0}),f.prototype.getOrgId=function(){return this._orgId},f.prototype.getPageType=function(){return"workplace"},f.prototype.isFirstLogin=function(){return!0},f.prototype.getAppName=function(){return"SinglePageApp"},f.prototype.getFormFactor=function(){return this._formFactor},f.prototype.getClientUrl=function(){return window.location.href},f.prototype.getClientName=function(){return"First Name"},f.prototype.getClientState=function(){return""},f.prototype.getAppModuleListFromAPI=function(){return[]},f.prototype.getCurrentClient=function(){var t,n=this.ClientType;return n===i.Constants.WebClient?(t=n,n=i.Constants.WebClientType):n===i.Constants.MobileClient&&(t=n,n=i.Constants.MobileClientType),{clientDisplayValue:n,clientKey:t}},f.prototype.isMarsEnabledForUser=function(){return!0},f.prototype.navigateToPage=function(){},f.prototype.isMarsEnabledForOrg=function(){return!0},f.prototype.isInAppSupportEnabledForUser=function(){return!0},f.prototype.isInAppSupportEnabledForOrg=function(){return!0},f.prototype.isInternalEnvironment=function(){return!0},f.prototype.getAppVersion=function(){return this.appVersion||(this.appVersion="8.0.0.0"),this.appVersion},f.prototype.getDefaultUserRole=function(){return"Admin"},f.prototype.getDefaultFormFactor=function(){return"1,2,3"},f.prototype.getOrgName=function(){return"SinglePageApp"},f.prototype.getOrgLcid=function(){return this._orgLcid},f.prototype.getDefaultLifeCycleStage=function(){return"Test Drive"},f.prototype.getAvailableClients=function(){return this._availableClients},f.prototype.getAvailableFormFactors=function(){return this._availableFormFactor},f.prototype.getControl=function(){return{}},f.prototype.getCookieForUsingClientApi=function(){},f.prototype.setCookieForUsingClientApi=function(){},f.prototype.getCurrentContentFrame=function(n,t){return n.find(t)},f.prototype.isRTL=function(){return!1},f.prototype.isPageLoaded=function(){return!0},f.prototype.getPageNavigationInfo=function(){var t={};return t[this.ClientType]=window.location.href,n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"The page navigation received for "+this.ClientType+" : "+t[this.ClientType]),n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"AppContext:getPageNavigationInfo END"),t},f.prototype.getPageNavigationObject=function(n,t,r){if(r===void 0&&(r=[]),!n)return null;var u=new i.MARSPageNavigationObject,f=["&",n];return u.Path=f[0],u.Page=f[0],u.Module="",u.Attributes={},u.KeyParams={pagekey:"&",params:[]}.params,u.KeyPrefix=f[0],u.PageKey=n,u.URL="&",u},f.prototype.getWildcardedPageKeys=function(){return[]},f.prototype.checkForPageLoad=function(t,i,r){var u,f;i===void 0&&(i=null);r===void 0&&(r=0);n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"SinglePageAppContext:checkForPageLoad START");u=this.isPageLoaded();u?(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"calling the callback"),t(i)):r<100?(f=this,setTimeout(function(){f.checkForPageLoad(t,i,r+1)},200)):n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.ERROR,"count exceeded 20. Error Encountered");n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"SinglePageAppContext:checkForPageLoad END")},f.prototype.loadStaticHelp=function(){},f.prototype.openExternalUrl=function(){},f.prototype.getOrganizationUserRoles=function(){var r=[{name:"Dummy Role_1",roleid:"248090ff-40a3-4053-8790-584edc5be201"},{name:"Dummy Role_2",roleid:"bdfd0b44-5720-45e3-ae68-417ddb0fb654"},{name:"Dummy Role_3",roleid:"4caba073-59a8-4d6b-8e7b-4ccb50c5166b"}],n,u;for(i.AppContext.organizationUserRoles=[],n=0;n<r.length;n++)u=window._MicrosoftMars.Client.Utility.Util.newGuid(),i.AppContext.organizationUserRoles.push(new i.UserRoles(r[n].name,r[n].roleid,u,t.Loader.appContext.getOrgId(),0,i.UserRoleState.added,!1,!0)),i.AppContext.isAppUserRoleCallSucceeded=!0},f._instance=null,f}(i.AppContext),r;i.SinglePageAppContext=u;r=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getMarsLauncher=function(){return".navTabButtonHelp"},i.prototype.getHelpIcon=function(){return n.Client.Loader.$mars(window.parent.document).find(".navTabHelpImage")},i.prototype.getHelpIconParent=function(){var n=this.getHelpIcon();return n.parent().parent().parent()},i.prototype.getHelpIconParentBackgroundColor=function(){var t=n.Client.Loader.$mars(window.parent.document).find(".navigationControl");return t.css("background-color")},i.prototype.updateHelpIconBackground=function(t){var i,r;i=n.Client.Loader.appContext.Util.getHelpIconParent();r=t?n.Client.Loader.appContext.Util.getHelpIconParentBackgroundColor():"white";i.css("background-color",r)},i.prototype.executeAppMethod=function(n,i){switch(n){case"Xrm.Internal.getIsPaid":return 1;case"Xrm.Page.context.getVersion":return"8.2.0.0";case"_MicrosoftMars.Client.Utility.AppUtilityLifecycleStage.checkDateCondition":return 1;default:return t.prototype.executeAppMethod.call(this,n,i)}},i.prototype.setHelpIconStyle=function(){var n=this.getHelpIcon().parent(),t=n.find(".navTabHelpImageWeb");n.parent().css({"padding-left":"0px","padding-top":"0px"});t.css({margin:"19px 17px"})},i}(i.Util);i.SinglePageUtils=r})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function t(){}return t.createAppContext=function(){var i=t.getProductName();switch(i.toUpperCase()){case"CRM":return n.CrmAppContext.getInstance(window.parent.Xrm,window.parent.XrmUI);case"MDM":return n.MdmAppContext.getInstance(null);case"SINGLEPAGEAPP":return n.SinglePageAppContext.getInstance();case"UCI":return n.UCIAppContext.getInstance();default:return undefined}},t.getProductName=function(){return t.isUCIClient()?"UCI":window.SinglePageApp?"SinglePageApp":window.parent.Xrm?"CRM":document.referrer.indexOf("mdm")>-1?"MDM":void 0},t.isUCIClient=function(){return document.getElementById("ClientApiFrame_MARS")?!0:!1},t}();n.AppContextFactory=t})(t=n.Utility||(n.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(t){var i;(function(t){"use strict";var i=function(){function i(){}return i.checkDateCondition=function(r,u,f){if(Array.isArray(r)&&(u=r[1],f=r[2],r=r[0]),r==="today")return i.isConditionSatisfied(f,new Date,new Date(u))?1:0;var o=n.Client.Loader.$mars.Deferred(),s=new XMLHttpRequest,e=n.Client.Utility.Util.TryRetrieve(s,n.Client.Loader.appContext.getClientUrl()+"/api/data/V8.0/organizations?$select="+r,86400);try{e=t.$mars.parseJSON(e);o.resolve(i.isConditionSatisfied(f,new Date(e.value[0][r]),new Date(u))?1:0)}catch(h){throw new Error("Error: organization createdOn call failed");}return o},i.isConditionSatisfied=function(n,i,r){switch(n){case t.Operators.Equal:return i===r;case t.Operators.LessThan:return i<r;case t.Operators.GreaterThan:return i>r;case t.Operators.LessThanOrEqual:return i<=r;case t.Operators.GreaterThanOrEqual:return i>=r;case t.Operators.NotEqual:return i!==r}},i}();t.AppUtilityLifecycleStage=i})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(n){var t;(function(t){"use strict";var u,f,i,r;(function(n){n[n.AppDefined=1]="AppDefined";n[n.LPDefined=2]="LPDefined"})(t.DynamicContextType||(t.DynamicContextType={}));u=t.DynamicContextType,function(n){n[n.String=0]="String";n[n.Boolean=1]="Boolean";n[n.Number=2]="Number"}(t.DynamicContextValueType||(t.DynamicContextValueType={}));f=t.DynamicContextValueType;i=function(){function n(){}return n}();t.DynamicContextJsonValue=i;r=function(){function i(){this.Id=t.Util.newGuid();this.ObjectState=n.Utility.LearningPathObjectState.Added}return i.parseValue=function(t){try{t.JsonValue=JSON.parse(t.Value)}catch(i){n.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Dynamic property evaluation: Parsing Dyanmic property "+t.Name+"failed")}},i}();t.DynamicContext=r})(t=n.Utility||(n.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(t){var i;(function(t){"use strict";var i=function(){function i(){}return i.evaluateDynamicProperties=function(i,r,u){var f,e,o,s;if(u===void 0&&(u=0),!i||i.length==0||u==i.length){r();return}f=i[u];e=null;f.DynamicContextType===t.DynamicContextType.AppDefined&&f.Library&&(e=n.Client.Loader.appContext.getClientUrl()+f.Library);o=this;s=function(){try{var t=n.Client.Loader.appContext.Util.executeAppMethod(f.JsonValue.ApiMethod,f.JsonValue.ApiParams);o.isConditionSatisfied(f.JsonValue.ExpectedValue,t,f.JsonValue.Comparator,f.JsonValue.ValueType)?(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Dynamic property evaluation: Dynamic property"+f.Name+"evaluated to true"),o.evaluateDynamicProperties(i,r,u+1)):n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Dynamic property evaluation: Dynamic property"+f.Name+"evaluated to fasle");return}catch(e){n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Dynamic property evaluation: Error"+e.toString()+" in evaluating dynamic property"+f.Name)}};e&&!document.getElementById(e)?window.marsLoader.loadScript(e,s):s()},i.isConditionSatisfied=function(n,i,r,u){var e=JSON.parse(u)===t.DynamicContextValueType.Number?parseFloat(n):n,f=JSON.parse(u)===t.DynamicContextValueType.Number?parseFloat(i):i;switch(JSON.parse(r)){case t.Operators.Equal:return f===e;case t.Operators.LessThan:return f<e;case t.Operators.GreaterThan:return f>e;case t.Operators.LessThanOrEqual:return f<=e;case t.Operators.GreaterThanOrEqual:return f>=e;case t.Operators.NotEqual:return f!==e;case t.Operators.Contains:return f.indexOf(e)!==-1;case t.Operators.DoesNotContain:return f.indexOf(e)===-1;case t.Operators.StartsWith:return f.startsWith(e);case t.Operators.EndsWith:return f.endsWith(e);case t.Operators.True:return f==!0;case t.Operators.False:return f==!1;default:return!1}},i}();t.DynamicContextUtil=i})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(t){var i;(function(t){"use strict";var i=function(){function i(){}return i.executeAppMethodAndEvaluate=function(t,r,u){var s=t.contextEvaluationRules.length;if(r==s){i.performInfixExpressionEvaluation(t,u);return}if(Object.keys(t.contextEvaluationRules[r]).length>1){var h=t.contextEvaluationRules[r].name,e=t.contextEvaluationRules[r].value,o=parseInt(t.contextEvaluationRules[r].operator),c=t.contextEvaluationRules[r].parameters,f=n.Client.Loader.appContext.Util.executeAppMethod(h,JSON.stringify(c));typeof f.then=="function"?f.done(function(n){t.contextEvaluationRules[r].result=i.isConditionSatisfied(o,n,e);i.executeAppMethodAndEvaluate(t,r+1,u)}):(t.contextEvaluationRules[r].result=i.isConditionSatisfied(o,f,e),i.executeAppMethodAndEvaluate(t,r+1,u))}else i.executeAppMethodAndEvaluate(t,r+1,u)},i.isConditionSatisfied=function(n,i,r){switch(n){case t.Operators.LessThan:return i<r;case t.Operators.LessThanOrEqual:return i<=r;case t.Operators.Equal:return i==r;case t.Operators.GreaterThan:return i>r;case t.Operators.GreaterThanOrEqual:return i>=r;case t.Operators.NotEqual:return i!=r;default:return!1}},i.performInfixExpressionEvaluation=function(n,t){for(var e,r=[],u=[],f=null,o=0;o<n.contextEvaluationRules.length;o++)if(Object.keys(n.contextEvaluationRules[o]).length>1)r.push(n.contextEvaluationRules[o].result);else if(e=n.contextEvaluationRules[o].operator,e==="(")u.push(e);else if(e===")")while(u[u.length-1]!="(")f=i.applyOperation(r.pop(),r.pop(),u.pop()),r.push(f);else if(e==="|"||e==="&"){while(u.length>0&&i.hasPrecedence(e,u[u.length-1]))f=i.applyOperation(r.pop(),r.pop(),u.pop()),r.push(f);u.push(e)}while(u.length>0)f=i.applyOperation(r.pop(),r.pop(),u.pop()),r.push(f);f=r.pop();t(f)},i.hasPrecedence=function(n,t){return t=="("||t==")"?!1:n=="&"&&t=="|"?!1:!0},i.applyOperation=function(n,t,i){switch(i){case"&":return n&t;case"|":return n|t;default:return 0}},i}();t.FCBClientContextEvaluation=i})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.ImagePath={closeIcon:"close-icon_black-small_12x12.png",closeSidebarIcon:"close_sidebar.png",closeSidebarIconHCB:"close_sidebar_hcb.png",closeSidebarIconHCW:"close_sidebar_hcw.png",homeIcon:"home-icon_white_16x16.png",feedbackSmileyIcon:"feedback_smiley-icon_white_16x16.png",feedbackOptionSmileyIcon:"feedback_smiley-icon_16x16.png",feedbackOptionFrownyIcon:"feedback_frowny-icon_16x16.png",sectionGuidedTaskIcon:"sidebar_guided-task-icon_16x16.png",searchGuidedTaskIcon:"GuidedTask.svg",expandedIcon:"expand_section.png",collapsedIcon:"collapsed_section.png",expandedIconInHCB:"expand_section_hcb.png",collapsedIconInHCB:"collapsed_section_hcb.png",expandedIconInHCW:"expand_section_hcw.png",collapsedIconInHCW:"collapsed_section_hcw.png",bubbleCloseIcon:"bubble_close_white_16x16.png",closeIconInHighContrast:"close-icon_white-small_hi-contrast_12x12.png",closeIconInHCW:"close_sidebar_hcw.png",txtSearchIcon:"search-icon_16x16.png",sidebarContextHomeIcon:"contexthome.png",sidebarContextHomeIconInHCB:"contexthome_hcb.png",sidebarContextHomeIconInHCW:"contexthome_hcw.png",smileyIconInHCB:"smile_hcb.png",smileyIconInHCW:"smile_hcw.png",frownyIconInHCB:"frown_hcb.png",frownyIconInHCW:"frown_hcw.png",searchSidebarIcon:"SearchContentLibrary.svg",sidebarSmileyIcon:"smiley.png",sidebarSmileyIconInHCB:"smiley_hcb.png",sidebarSmileyIconInHCW:"smiley_hcw.png",sidebarCallMe:"sidebar_callme_20x20.png",sidebarCallMeHover:"sidebar_callme_hover-click_20x20.png",sidebarLiveChat:"sidebar_livechat_20x20.png",sidebarLiveChatHover:"sidebar_livechat_hover-click_20x20.png",sidebarBack:"sidebar_nav-Back_32x32.png",sidebarBackDisabled:"sidebar_nav-Back_disabled_32x32.png",sidebarNext:"sidebar_nav-Next_32x32.png",sidebarNextDisabled:"sidebar_nav-Next_disabled_32x32.png",bubbleRuntimeInfoIcon:"MARS_runtime_info-bubble_icon.png",helpIconOFFHiContrastInHebrew:"MARS-icon_OFF_Hebrew_hi-contrast_50x50.png",helpIconONHiContrastInHebrew:"MARS-icon_ON_Hebrew_hi-contrast_50x50.png",ISHhelpIconOnState:"MARS-icon_ON_ISH_50x41.png",ISHhelpIconOffState:"MARS-icon_OFF_ISH_50x41.png",toolbarInactiveSetting:"Configuration.svg",toolbarInactiveFlowEditor:"Floweditor.svg",toolbarInactivePreview:"Preview.svg",toolbarInactivePublish:"Publish.svg",toolbarInactiveEdit:"edit.svg",toolbarInactivecheckin:"Checkin.svg",toolbarHome:"home.png",toolbarActivePreview:"Preview.svg",toolbarActiveSettings:"Configuration.svg",toolbarActiveFlowEditor:"Floweditor.svg",tagInfoquestionMark:"helptext_info.png",toolbarActivePublish:"Publish.svg",toolbarActiveEdit:"edit.svg",sectionToolbarActiveEdit:"edit.svg",toolbarActivecheckin:"Checkin.svg",controlActionToolTabPinIcon:"Pin.svg",controlActionToolTabUnPincIcon:"Unpin.svg",controlActionToolTabSavecIcon:"save.png",controlActionToolTabSavecIconHCB:"save_hcb.png",controlActionToolTabDeletecIconHCB:"delete_hcb.png",controlActionToolTabSavecIconHCW:"save_hcw.png",controlActionToolTabDeletecIconHCW:"deletes_hcw.png",controlActionToolTabDeletecIcon:"delete.png",runtimeSidebarEditHome:"edit.svg",runtimeSidebarLibrary:"OpenTheContentLibrary.svg",footerSectionBuilderText:"text.png",footerSectionBuilderTextHCB:"text_hcb.png",footerSectionBuilderTextHCW:"text_hcw.png",footerSectionBuilderVideo:"video.png",footerSectionBuilderVideoHCB:"video_hcb.png",footerSectionBuilderVideoHCW:"video_hcw.png",footerSectionBuilderMore:"more.png",footerSectionBuilderMoreHCB:"more_hcb.png",footerSectionBuilderMoreHCW:"more_hcw.png",footerSectionBuilderLOL:"listoflinks.png",footerSectionBuilderLOLHCB:"listoflinks_hcb.png",footerSectionBuilderLOLHCW:"listoflinks_hcw.png",addControls:"addsection.png",addControlsHCB:"addsection_hcb.png",addControlsHCW:"addsection_hcw.png",editSectionControl:"edit_section.png",editSectionControlHCB:"edit_hcb.png",editSectionControlHCW:"edit_hcw.png",deleteSectionControl:"delete.png",sidebarFooterCallMeEdit:"Callme.svg",sidebarFooterCallMe:"Callme.svg",sidebarFooterChatEdit:"Livechat.svg",sidebarFooterChat:"Livechat.svg",sidebarFooterLeftArrow:"left_arrow_footer.png",sidebarFooterRightArrow:"right_arrow_footer.png",sidebarFooterLeftArrowEdit:"left_arrow_footer_onedit.png",sidebarFooterLeftArrowEditHCW:"left_arrow_footer_onedit_hcw.png",sidebarFooterRightArrowEdit:"right_arrow_footer_onedit.png",sidebarFooterRightArrowEditHCW:"right_arrow_footer_onedit_hcw.png",toggleIconLeft:"Sidebar_expand.svg",toggleIconRight:"Sidebar_collapse.svg",buttonLink:"button_link.png",buttonLinkHCB:"button_link_hcb.png",buttonLinkHCW:"button_link_hcw.png",buttonLinkClose:"button_link_close.png",alertWarningIcon:"warning.png",deletestage:"deletestage.png",addcondition:"addcondition.png",deleteSectionContent:"removecondition.png",deleteSectionContentHCW:"removecondition_hcw.png",deleteSectionContentHCB:"removecondition_hcb.png",defaultSidebar:"SetAsDefaultSidebar_solid.svg",editTitle:"edit_title.png",editTitleHCB:"edit_title_hcb.png",editTitleHCW:"edit_title_hcw.png",sortAscending:"SortAscending.svg",sortDescending:"SortDescending.svg",guidedTaskAsLink:"GuidedTask.svg",gridNextHighContrast:"grid_next_highcontrast.png",gridLastHighContrast:"grid_last_highcontrast.png",gridPrevHighContrast:"grid_prev_highcontrast.png",gridFirstHighContrast:"grid_first_highcontrast.png",gridFilter:"Filter_filled.svg",deletestageHC:"deletecondition_highcontrast.png",addconditionHC:"addcondition_highcontrast.png",landingPageMenuDropdown:"menu_downarrow.png",landingPageMenuDropdownHover:"menu_downarrow_hover.png",landingPageMenuManage:"manage.png",landingPageMenuManageHover:"manage_hover.png",landingPageMenuPublish:"publish_lp_menu.png",landingPageMenuPublishHover:"publish_hover_lp_menu.png",landingPageMenuLocalization:"localization.png",landingPageMenuLocalizationHover:"localization_hover.png",landingPageMenuAnalyze:"analyze_lp_menu.png",landingPageMenuAnalyzeHover:"analyze_hover_lp_menu.png",landingPageMenuConfiguration:"configuration_lp_menu.png",landingPageMenuConfigurationHover:"configuration_hover_lp_menu.png",landingPageMenuMangeHighContrast:"manage_hc.png",landingPageMenuPublishHighContrast:"publish_hc.png",landingPageMenuLocalizationHighContrast:"localization_hc.png",landingPageMenuAnalyzeHighContrast:"analyze_hc.png",landingPageMenuConfigurationHighContrast:"configuration_hc.png",landingPageMenuDropDownHighContrast:"menu_downarrow_hc.png",librarySearch:"SearchContentLibrary.svg",librarySearchHighContrast:"library_search_hc.png",libraryRefresh:"Refresh.svg",libraryRefreshHighContrast:"library_refresh_hc.png",landingPageNewControl:"CreateNewSidebar.svg",landingPageNewControlHC:"CreateNewSidebar.svg",gridDesktop:"FormFactorXL.svg",gridTablet:"FormFactorTablet.svg",gridMobile:"FormFactorMobile.svg",gridMedium:"FormFactorM.svg",gridGT:"GridGuidedTask.svg",gridSidebar:"GridSidebar.svg",gridDesktopHighContrast:"desktop_hc.png",gridTabletHighContrast:"tablet_hc.png",gridMobileHighContrast:"mobile_hc.png",gridGTHighContrast:"gt_hc.png",gridSidebarHighContrast:"sidebar_hc.png",configPrecedenceArrowUp:"Arrow_Up_WF.png",configPrecedenceArrowDown:"Arrow_Down_WF.png",configNewStage:"Newstage.png",configNewStageHighContrast:"Newstage_hcb.png",configNewStageHover:"newstage_hover.png",marshelpIconLoadingCompleted:"MARS_help_icon_completed_v22.png",marshelpIconLoadingCompletedRTL:"MARS_help_icon_completed_RTL_v22.png",marshelpIconSidebarLoadComplete:"marsHelpIconSidebarLoadComplete.png",marshelpIconSidebarLoadCompleteRTL:"marsHelpIconSidebarLoadCompleteRTL.png",bluePreviousImage:"blue_previous_step.png",blueNextImage:"blue_next_step.png",greenNextImage:"green_next_step.png",greenPreviousImage:"green_previous_step.png",copyBubbleEdit:"Copy.svg",saveBubbleEdit:"Save.svg",dragBubbleEdit:"DragBubble.svg",placementBubbleEdit:"ChangeBubblePlacementOption.svg",completionIndicator:"Completed.svg",contactSupport:"contact_support_icon.png",supportPortal:"open_support_portal_icon.png",loadingPanel:"publishloading.gif",deleteImageIcon:"deleteImageIcon.svg",uploadProgress:"uploadprogress.gif",uploadProgress_HighContrastBlack:"uploadprogress_HCB.gif",uploadProgress_HighContrastWhite:"uploadprogress_HCW.gif",removeFile:"removefile.png",removeFile_HighContrastWhite:"removefile_HCW.png",removeFile_HighContrastBlack:"removefile_HCB.png",closeContentLibrary_HCW:"close_grid_HCW.png",landingPageMenuMange_HCW:"manage_HCW.png",landingPageMenuPublish_HCW:"publish_HCW.png",landingPageMenuLocalization_HCW:"localization_HCW.png",landingPageMenuAnalyze_HCW:"analyze_HCW.png",landingPageMenuConfiguration_HCW:"configuration_HCW.png",landingPageMenuDropdown_HCW:"menu_downarrow_HCW.png",landingPageMenuDropdownHover_HCW:"menu_downarrow_hover_HCW.png",landingPageMenuMangeHover_HCW:"manage_hover_HCW.png",landingPageMenuPublishHover_HCW:"publish_hover_HCW.png",landingPageMenuLocalizationHover_HCW:"localization_hover_HCW.png",landingPageMenuAnalyzeHover_HCW:"analyze_hover_HCW.png",landingPageMenuConfigurationHover_HCW:"configuration_hover_HCW.png",gridFirst_HCW:"first_HCW.png",gridPrev_HCW:"prev_HCW.png",gridNext_HCW:"next_HCW.png",gridLast_HCW:"last_HCW.png",landingPageMenuDropdownHover_HCB:"menu_downarrow_HCW.png",landingPageMenuMangeHover_HCB:"manage_HCW.png",landingPageMenuPublishHover_HCB:"publish_HCW.png",landingPageMenuLocalizationHover_HCB:"localization_HCW.png",landingPageMenuAnalyzeHover_HCB:"analyze_HCW.png",landingPageMenuConfigurationHover_HCB:"configuration_HCW.png",toolbarHome_HighContrastWhite:"home_HCW.png",alertWarningIcon_HCB:"warning_HCB.png"},t}(n.Util);n.ImageMapping=t})(t=n.Utility||(n.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(t){var i;(function(Utility){"use strict";Utility.launchAnswerPanelException="LaunchAnswerPanelException";Utility.launchStepException="LaunchStepException";Utility.launchAnswerPanelExceptionCounter=0;Utility.launchBubbleExceptionCounter=0;Utility.disabledSidebarException="disabledsidebarexception";Utility.disabledGuidedTaskException="disabledguidedtaskexception";Utility.bubbleIsNotPlacedException="bubbleisnotplacedexception";Utility.importFailedException="importfailed";Utility.$mars=n.Client.Loader.$mars;var i=function(){function MarsExceptionHandler(){}return MarsExceptionHandler.getExceptionScenarioId=function(){return"999zzz99-z9zz-99z9-z999-9999z9z9zz9z"},MarsExceptionHandler.execute=function(exceptionType,statusText,responseJSON,errorObject){var messageList,i,localeKey,localeMessage;if(this.exceptionType=exceptionType,messageList=[],Utility.$mars("body").trigger("exceptionRaised",{Message:statusText,ErrorObject:errorObject}),responseJSON&&responseJSON.Result)if(typeof responseJSON.Result=="string")messageList.push(responseJSON.Result);else if(responseJSON.Result.length>0)for(i=0;i<responseJSON.Result.length;i++)responseJSON.Result[i].Message&&messageList.push(responseJSON.Result[i].Message);switch(exceptionType.toString().toLowerCase()){case"0":case"400":case"404":case"500":case"304":case"401":case"409":responseJSON.ErrorCode>0?(localeKey="Error_"+responseJSON.ErrorCode,localeMessage=eval("_MicrosoftMars.Client.Loader.marsLocale."+localeKey),localeMessage?(messageList[0]=localeMessage+messageList[0],MarsExceptionHandler.showMessage(messageList,!1)):MarsExceptionHandler.showMessage(messageList)):MarsExceptionHandler.showMessage(messageList);break;case"evalerror":case"rangeerror":case"referenceerror":case"syntaxerror":case"typeerror":case"urierror":messageList.push(statusText);MarsExceptionHandler.showMessage(messageList);break;case Utility.launchAnswerPanelException.toLowerCase():errorObject?MarsExceptionHandler.executeErrorAnswerPanel(statusText,errorObject):MarsExceptionHandler.executeErrorAnswerPanel(statusText);break;case"targetelementmissing":case"nobubbledropforstep":errorObject?MarsExceptionHandler.executeErrorBubble(statusText,!1,errorObject):MarsExceptionHandler.executeErrorBubble(statusText,!1);break;case Utility.launchStepException.toLowerCase():errorObject?MarsExceptionHandler.executeErrorBubble(statusText,!0,errorObject):MarsExceptionHandler.executeErrorBubble(statusText,!0);break;case Utility.bubbleIsNotPlacedException.toLowerCase():case Utility.disabledSidebarException.toLowerCase():case Utility.disabledGuidedTaskException.toLowerCase():case Utility.importFailedException.toLowerCase():messageList.push(statusText);MarsExceptionHandler.showMessage(messageList,!1)}},MarsExceptionHandler.getFormatedExceptionMessage=function(n,i){var u;i===void 0&&(i=!0);var r="",f="",e="http://go.microsoft.com/fwlink/p/?LinkId=627294";if(n&&n.length>0){for(r='<ul class="marsexception-message-list">',u=0;u<n.length;u++)r+="<li>"+n[u]+" <\/li>";r+="<\/ul>"}return i&&(f="<div>"+t.Loader.marsLocale.exceptionMessage+"<\/div>"+("<div><a href='"+e+"' target='_blank' title='"+e+"'>"+t.Loader.marsLocale.reportThisCaption+"<\/a> "+t.Loader.marsLocale.tryAgainCaption+"<\/div>")),r&&(f+="<div>"+r+"<\/div>"),f},MarsExceptionHandler.showMessage=function(n,i){var f,u,e,r;i===void 0&&(i=!0);f=this.getFormatedExceptionMessage(n,i);u=window._MicrosoftMars.Client.Designer;u&&(e=Utility.$mars("#lPathDesignerContainer"),e.length>0?(r=new u.Renderer.SimpleDialogView({},e,"ExceptionHandlingDialog",t.Loader.marsLocale.exceptionTitle,f),r.showCancel=!1,u!=null&&u.Util.App!=null&&u.Util.App.store!=null&&u.Util.App.store.hideSavePopup(),r.zIndexPlus=111,r.addDefaultFocusOnOkOrClose=!0,t.Loader.$mars("#lPathskinnyToolbarContainer")?(r.cancelElementFocus=t.Loader.$mars('button[id="lPathSkinnyToolbarHomeButton"]'),r.okElementFocus=t.Loader.$mars('button[id="lPathSkinnyToolbarHomeButton"]')):t.Loader.$mars("#lPathlandingPageContainer")&&(r.cancelElementFocus=t.Loader.$mars('div[id="headerMars"]'),r.okElementFocus=t.Loader.$mars('div[id="headerMars"]')),r.show(),r.ariaDescribedById="ExceptionHandlingDialog"):console.log(f))},MarsExceptionHandler.executeErrorAnswerPanel=function(i,r,u){var e,s,f,o;r===void 0&&(r=!0);e=[];e.push(i);s=window.Microsoft.Mars.Client.Runtime.Controls.AnswerPanelLauncher;f=null;t.Loader.defaultExceptionControlList&&t.Loader.defaultExceptionControlList.length>0&&(f=t.Loader.$mars.grep(t.Loader.defaultExceptionControlList,function(n){return n.ControlType===1}));o="";u&&u.stack&&(o=u.stack);var c=window._MicrosoftMars.Client.Telemetry.ActivityName.answerpanel,l=navigator.userAgent,a=n.Client.Loader.appContext.getPageNavigationInfo(),v=n.Client.Loader.appContext.getPageType(),y=window._MicrosoftMars.AnswerPanelModel.controlName,p=window._MicrosoftMars.AnswerPanelModel.controlId,h=new window._MicrosoftMars.Client.Telemetry.ExceptionEvent,w=n.Client.Loader.appContext.CurrentStage,b=n.Client.Loader.appContext.locale;h.SetExceptionData(t.Loader.appContext.UserId,c,l,i,this.getErrorTypeForException(u),a,v,o,y,p,w,b);h.FinishActivity();f&&f.length>0&&Utility.launchAnswerPanelExceptionCounter<=0?(Utility.launchAnswerPanelExceptionCounter++,s.loadAnswerPanel(f[0]),window._MicrosoftMars.AnswerPanel.getInstance().show(0),Utility.launchAnswerPanelExceptionCounter=0):(Utility.launchAnswerPanelExceptionCounter=0,MarsExceptionHandler.showMessage(e))},MarsExceptionHandler.executeErrorBubble=function(i,r,u){var f,s,o,a,c,v,y,l;r===void 0&&(r=!0);f=null;s=[];s.push(i);var k=window.Microsoft.Mars.Client.Runtime.Controls,h=k.ScenarioManager.getInstance(),e=h.activeScenarioId,o=null,p=null,w=null;if(e!=null&&e!==undefined&&e!==""&&(o=h.getScenario(e),a=o.getCurrentStepId(),w=o.getOriginalStepId(a),p=o.getStepBubbleModel(a).getControlName(),h.activeScenarioId=null,n.Client.Loader.appContext.util.hideOverlay(),o.cleanup(this.exceptionType),h.removeScenario(e)),t.Loader.defaultExceptionControlList&&t.Loader.defaultExceptionControlList.length>0&&(c=t.Loader.$mars.grep(t.Loader.defaultExceptionControlList[1].Steps,function(n){return n.ControlType===4}),c&&c.length>0&&(f=c[0])),v="",u&&u.stack&&(v=u.stack),o){var d=window._MicrosoftMars.Client.Telemetry.ActivityName.guidedtask,g=navigator.userAgent,nt=n.Client.Loader.appContext.getPageNavigationInfo(),tt=n.Client.Loader.appContext.getPageType(),b=new window._MicrosoftMars.Client.Telemetry.ExceptionEvent;b.SetExceptionData(t.Loader.appContext.UserId,d,g,i,this.getErrorTypeForException(u),nt,tt,v,p,"Scenario: "+e+" Step: "+w);b.FinishActivity()}f&&Utility.launchBubbleExceptionCounter<=0?(y=f.ControlId,f.ChildControls!=null&&f.ChildControls.length>0&&(f=f.ChildControls[0]),Utility.launchBubbleExceptionCounter++,l={resultPathDOM:">DIV.lpath-overlay-initial/0>DIV.mars-exceptioncontainer-centre/",resultPathClientAPI:""},n.Client.Loader.appContext.ClientType===window.Microsoft.Mars.Client.Runtime.Controls.BubbleUtilityConstants.mobileClientType&&(l=n.Client.Loader.appContext.getAppVersion()<"8.2"?{resultPathDOM:">DIV/0>DIV.customizationContainer/0>IFRAME/#PersistentScriptsIFrame>DIV#lpathRuntimeOverlay/0>DIV#mars-exceptionbubbleContainer/0",resultPathClientAPI:""}:{resultPathDOM:">DIV/0>DIV/0>DIV.customizationContainer/0>IFRAME/#PersistentScriptsIFrame>DIV#lpathRuntimeOverlay/0>DIV#mars-exceptionbubbleContainer/0",resultPathClientAPI:""}),Utility.$mars('div[id="mars-exceptionbubbleContainer"]').length<=0&&Utility.$mars("#lpathRuntimeOverlay").append('<div id="mars-exceptionbubbleContainer" class="mars-exceptioncontainer-centre"><\/div>'),f.AppContext!=null?f.AppContext.ElementIdentifier=JSON.stringify(l):(f.AppContext=n.Client.Loader.appContext,f.AppContext.ElementIdentifier=JSON.stringify(l)),u?MarsExceptionHandler.createExceptionScenario(f,y,i,u,s,r):MarsExceptionHandler.createExceptionScenario(f,y,"",null,s,r),Utility.launchBubbleExceptionCounter=0):(Utility.launchBubbleExceptionCounter=0,n.Client.Loader.appContext.util.hideOverlay(),MarsExceptionHandler.showMessage(s,r));return},MarsExceptionHandler.createExceptionScenario=function(t,i,r,u,f,e){var p,a;r===void 0&&(r="");e===void 0&&(e=!0);var h=window.Microsoft.Mars.Client.Runtime.Controls,s=h.ScenarioManager.getInstance(),w=[t.ControlId],c=i+t.ControlId;s.hasScenario(i)||s.addScenario(i,w);var l=s.getScenario(i),o=l.getStepBubbleModel(c),b="";if(u&&u.stack&&(b=u.stack),o&&!o.isInitialized()){o.setStepActive(t.ControlType);o.setAppContext(t.AppContext);o.setEvents(JSON.parse(t.Events));o.setTemplate(t.LanguageControlVersionContents[0].HtmlView);o.setCustomAttributes(t.CustomAttributes);o.setStepExceptionBubble(!0);var k=l.getTotalSteps(),v=new h.StepBubbleView(c,k),y=[];Utility.$mars.merge(y,t.CustomAttributes);v.setHtmlContent(h.CustomAttributeUtility.replaceCustomAttributes(t.LanguageControlVersionContents[0].HtmlView,y));p=l.getStep(c);p.setView(v);n.Client.Loader.appContext.util.showOverlay();n.Client.Loader.appContext.util.showCustomizationContainer();r==="targetelementmissing"?s.launchScenario(i,!0,!0):s.launchScenario(i,!1,!0);a=Utility.$mars(".mars-stepbubble-contentcontainer div.lpath-section-text");!e&&a&&a.html(this.getFormatedExceptionMessage(f,e))}else n.Client.Loader.appContext.util.hideOverlay(),MarsExceptionHandler.showMessage(f,!0);return},MarsExceptionHandler.getErrorTypeForException=function(n){var t;if(n)switch(n.name.toString().toLowerCase()){case"0":case"400":case"404":case"500":case"304":case"401":case"409":t=window._MicrosoftMars.Client.Telemetry.ExceptionConstants.ErrorType_Region;break;case"evalerror":case"rangeerror":case"referenceerror":case"syntaxerror":case"typeerror":case"urierror":t=window._MicrosoftMars.Client.Telemetry.ExceptionConstants.ErrorType_JS;break;case"targetelementmissing":t=window._MicrosoftMars.Client.Telemetry.ExceptionConstants.ErrorType_HTML}return t},MarsExceptionHandler}();Utility.MarsExceptionHandler=i})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(n){var t;(function(n){"use strict";(function(n){n[n.LessThan=1]="LessThan";n[n.LessThanOrEqual=2]="LessThanOrEqual";n[n.Equal=3]="Equal";n[n.GreaterThan=4]="GreaterThan";n[n.GreaterThanOrEqual=5]="GreaterThanOrEqual";n[n.NotEqual=6]="NotEqual";n[n.Contains=7]="Contains";n[n.DoesNotContain=8]="DoesNotContain";n[n.StartsWith=9]="StartsWith";n[n.EndsWith=10]="EndsWith";n[n.True=11]="True";n[n.False=12]="False"})(n.Operators||(n.Operators={}));var t=n.Operators})(t=n.Utility||(n.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(t){var i;(function(t){"use strict";var i=function(){function t(){t._instance?console.log("Singleton instance already exists for ParameterizedURLManager. Access it via ParameterizedURLManager.GetInstance()"):this.Initialize()}return t.GetInstance=function(){return t._instance==null&&(t._instance=new t),t._instance},t.prototype.Validate=function(t){for(var i=!0,u=t.indexOf(this.startTag),r,e,f;i&&u!=-1;)r=t.indexOf(this.endTag),(r==-1||r<=u+this.startTagLen)&&(i=!1),e=t.substring(u+this.startTagLen,r).toLowerCase(),this.AllowedParameters[e]||(i=!1),t=t.substring(r+this.endTagLen),u=t.indexOf(this.startTag);return t.indexOf(this.endTag)!=-1&&(i=!1),f={isValid:i},i||(f.errorMessages=[n.Client.Loader.marsLocale.IncorrectURLFormatMessage]),f},t.prototype.FormatUrl=function(n){for(var r="",t=n.indexOf(this.startTag),u,i;t!=-1;)u=n.indexOf(this.endTag),t>0&&(r+=n.substring(0,t)),i=n.substring(t+this.startTagLen,u).toLowerCase(),i=this.AllowedParameters[i],r+=this.startTag+i+this.endTag,n=n.substring(u+this.endTagLen),t=n.indexOf(this.startTag);return r+n},t.prototype.Initialize=function(){this.startTag="{{";this.endTag="}}";this.startTagLen=this.startTag.length;this.endTagLen=this.endTag.length;this.AllowedParameters={orgid:"orgID",orgname:"orgName",appmoduleuniquename:"appModuleUniqueName",sitewideurl:"siteWideUrl",tenantid:"tenantID"}},t._instance=null,t}();t.ParameterizedURLManager=i})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(n){var t;(function(t){"use strict";var i=function(){function t(){t._instance&&console.log("Singleton instance already exists for LifecycleStageManager. Access it via LifecycleStageManager.getInstance()");t._instance=this}return t.getInstance=function(){return t._instance===null&&(t._instance=new t),t._instance},t.prototype.currentStage=function(){return this.evaluateLifecycleStage(),n.Loader.appContext.CurrentStage},t.prototype.evaluateLifecycleStage=function(){switch(n.Loader.appContext.ProductEnvironmentType){case"Trial":this.checkCriteriaAndAdvance();break;case"Buy":this.proceedWithBuy()}},t.prototype.checkCriteria=function(){var t=n.Loader.appContext.getScenariosList(n.Loader.appContext.CurrentStage),i=n.Loader.appContext.getScenariosIgnoredOrCompleted();return n.Loader.appContext.isMinLoginDone()&&i.length>=t.length?!0:!1},t.prototype.advanceLifecycleStage=function(){},t.prototype.checkCriteriaAndAdvance=function(){this.checkCriteria()&&this.advanceLifecycleStage()},t.prototype.proceedWithBuy=function(){switch(n.Loader.appContext.CurrentStage){case"FirstRun (Trial)":n.Loader.appContext.CurrentStage=n.Loader.appContext.isFirstLogin()?"FirstRun (Buy)":"User (Buy)";break;case"User (Trial)":n.Loader.appContext.CurrentStage="User (Buy)";break;default:this.checkCriteriaAndAdvance()}},t._instance=null,t}();t.LifecycleStageManager=i})(t=n.Utility||(n.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(t){var i;(function(i){"use strict";var u=function(){function r(){}return r.prototype.getControlByContext=function(r,u,f,e,o,s){var h,w,b,k,c,a,g,y,p,nt;if(this.requestJson=[],h=[],o||s?(w=n.Client.Loader.appContext.Util.getConfigurationData("AuthoringGroupAndSubscribedPgDetail"),h.push(w)):(b="allConfigurationKey",k=JSON.parse(localStorage[b]),h=k.AuthoringDetails),h)for(c=0;c<h.length;c++){var l=h[c].AuthoringGroupDetail,v=h[c].SubscribedPGDetails,tt={AuthoringId:l.AuthoringId,ProductMatchVersionCriteria:l.ProductVersionMatchCriteria},d=[];if(v)for(a=0;a<v.length;a++)g={PublishGroupId:v[a].PgId,Precedence:v[a].Precedence},d.push(g);y="";l.ConfigurationLifeCycleStages&&l.ConfigurationLifeCycleStages.length>0&&(p=n.Client.Loader.appContext.util.getAuthoringGroupLifeCycleStageMap(l.AuthoringId),p&&(y=p.Id));t.Loader.appContext.RoleTemplates.indexOf(i.Util.getAnyRoleUserId())<0&&t.Loader.appContext.RoleTemplates.push(i.Util.getAnyRoleUserId());nt=this.getControlParamJson(tt,d,t.Loader.appContext.RoleTemplates,f,t.Loader.appContext.getAppName(),t.Loader.appContext.getAppVersion(),t.Loader.appContext.getPageNavigationInfo(),r,e,t.Loader.appContext.getFormFactor(),t.Loader.appContext.UserId,y,u,o,s);this.requestJson.push(nt)}return this.callService(this.requestJson)},r.prototype.callService=function(n){t.Loader.ServiceProxy.webApiBaseUrl=t.Loader.webApiBaseUrl;var i=new t.Loader.RuntimeControlApi;return i.post(n,"ControlByContext")},r.prototype.getControlById=function(n,i){var r=new t.Loader.RuntimeControlApi;return r.fireControlById(n,i)},r.prototype.getControlParamJson=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){return{AuthoringDetails:n,PublishGroupDetails:t,ContextValueMapping:{1:u,2:f,3:i,4:l,5:h,6:s,7:r,8:JSON.stringify(e)},HomeSidebarOnly:v,ErrorControlOnly:y}},r}(),r;i.ContextEngine=u;r=function(){function n(){}return n}();i.ControlFilters=r})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(t){var i;(function(t){"use strict";var r=function(r){function u(){var n,t;if(r.call(this),this.lcp=null,this.roleTemplates=[],this._formFactor=null,this._orgId=null,this._orgLcid=null,this.blacklistedUrlParameters=["org","liveid","perf"],u._instance){console.log("Singleton instance already exists for UCIAppContext. Access it via UCIAppContext.getInstance()");throw"Singleton instance already exists for UCIAppContext. Access it via UCIAppContext.getInstance()";}else{if(n=document.getElementById("ClientApiFrame_MARS"),n)this.lcp=n.contentWindow.Lcp,this.lcp&&(this._formFactor=this.getFormFactor(),this._version=this.lcp.App.getVersion(),this.apiDataVersion="/api/data/V8.0/",this._orgLcid=this.lcp.App.getOrgLcid().toString(),t=this._version.split(".")[0],t&&(this.apiDataVersion="/api/data/V"+t+".0/"));else throw new Error("Error: Getting Client API MARS IFrame failed...!");this.setOrgId();this.setRoleTemplates()}}return __extends(u,r),u.getInstance=function(){return u._instance==null&&(u._instance=new u),u._instance},u.prototype.getXrmObject=function(){return window.Xrm.xrmInstance},Object.defineProperty(u.prototype,"ClientType",{get:function(){return this.lcp.Client.getName()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"UserId",{get:function(){return this.userId||(this.userId=this.lcp.UserContext.getUserId()),this.userId},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"Locale",{get:function(){return this.locale||(this.locale=this.lcp.UserContext.getUserLcid()),this.locale},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"UserRoles",{get:function(){return this.userRoles=this.lcp.UserContext.getUserRoles(),this.userRoles||(this.userRoles=["Admin"]),this.userRoles},enumerable:!0,configurable:!0}),u.prototype.setRoleTemplates=function(){var n,t,i;if(this.userRoles=this.lcp.UserContext.getUserRoles(),n=this.UserRoles.length,n>0)for(i="(roleid eq "+this.UserRoles[0]+")",t=1,n=this.UserRoles.length;t<n;t++)i+=" or (roleid eq "+this.UserRoles[t]+")";else return this.userRoles;var u="?$select=_roletemplateid_value&$filter="+i,r=this,f=this.lcp.WebApi.online.retrieveMultipleRecords("role",u);f.then(function(n){var t;n.entities?t=n.entities:n.constructor===Array&&(t=n);t.forEach(function(n){n._roletemplateid_value?r.roleTemplates.push(n._roletemplateid_value):r.roleTemplates.push(n.roleid)})})},Object.defineProperty(u.prototype,"RoleTemplates",{get:function(){return this.roleTemplates.length>0?this.roleTemplates:null},enumerable:!0,configurable:!0}),u.prototype.checkForPageLoad=function(t,i,r){if(i===void 0&&(i=null),r===void 0&&(r=0),t==null||typeof t!="function")throw new Error("Cannot register PageLoad callback!");i&&(t=t.bind(i));this.isPageLoaded()?(n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_MARS_CRM_PAGE_LOAD_COMPLETE_END"),t()):this.lcp.Client.addPageLoadEventListener(t,!0)},u.prototype.checkForPageIdle=function(t,i,r){var u,f;i===void 0&&(i=null);r===void 0&&(r=0);n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:checkForPageIdle START");r==100&&n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"CrmAppContext:checkForPageIdle : Time out. Assuming page load is complete.");u=this.isPageIdle()||r==100;u?(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"calling the callback"),n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_MARS_CRM_PAGE_LOAD_COMPLETE_END"),t(i)):r<100?(f=this,setTimeout(function(){f.checkForPageIdle(t,i,r+1)},200)):n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.ERROR,"count exceeded 20. Error Encountered");n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"CrmAppContext:checkForPageIdle END")},u.prototype.compareNavInfo=function(t,i){var u,f,r;if(i||(i=n.Client.Loader.appContext.getPageNavigationInfo()),!t||!(this.ClientType in t)||!(this.ClientType in i))return!1;u=this.getParamsDictionary(t[this.ClientType]);f=this.getParamsDictionary(i[this.ClientType]);for(r in u)if(u.hasOwnProperty(r)&&!this.isBlacklistedParameter(r)){if(f[r]==null||f[r]===undefined)continue;if(u[r]!==f[r])return!1}return!0},u.prototype.isPageLoaded=function(){return this.lcp.Client.isPageLoaded()},u.prototype.isPageIdle=function(){return!this.lcp.Client.isAppBusy()},u.prototype.getPageType=function(){return this.lcp.Client.getPageType()},u.prototype.getCurrentClient=function(){return{clientDisplayValue:n.Client.Loader.marsLocale[t.Constants.UCI],clientKey:t.Constants.UCI}},u.prototype.getOrgId=function(){if(this._orgId!=null)return this._orgId;throw new Error("Error: Getting orgId failed...!");},u.prototype.getOrgLcid=function(){return this._orgLcid},u.prototype.setOrgId=function(){this.lcp&&(this._orgId=this.lcp.App.getOrgId())},u.prototype.setTenantProperties=function(n){if(this.tenantId){n&&n();return}var t=this,i=this.getODataContract(null,null,1,"RetrieveTenantInfo"),r=this.lcp.WebApi.online.execute(i);r.then(function(i){i.json().then(function(i){var r=JSON.parse(i.TenantInfo);t.TenantId=r.S2STenantId;t.TenantName=r.TenantName;t.MNC=r.IsMnc;t.OrgType=r.OrgType;t.OrgLicenses=r.UserLicensesUsed;t.OrgSize=r.CompanySize;t.IsPaid=parseInt(r.IsPaid);n&&n()})})},u.prototype.getPageNavigationInfo=function(){var n=null,t,i,r,u,f;return this.lcp&&(n=this.lcp.Navigation.getPageNavigationInfo(),n&&(n=n.replace("#",""))),t={},i=n.indexOf("app="),i!==-1&&(r=n.substring(i+4).split("&")[0],r!==null&&(u={key:"app",value:r,api:"_MicrosoftMars.Client.Utility.Util.getAppIdFromName"},f={appid:u},t.QSMap=JSON.stringify(f))),t[this.ClientType]=n,t},u.prototype.getDefaultWhiteListedKeys=function(){return["pagetype","id","etn","viewid"]},u.prototype.getODataContract=function(n,t,i,r){function u(){u.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:t,operationType:i,operationName:r}}}return new u},u.prototype.isMarsEnabledForOrg=function(){return this.lcp.App.isFeatureEnabled("GuidedHelp")},u.prototype.isInAppSupportEnabledForUser=function(){return this.lcp.App.isFeatureEnabled("InAppSupport")},u.prototype.isInAppSupportEnabledForOrg=function(){return this.lcp.App.isFeatureEnabled("InAppSupportOrg")},u.prototype.getAppVersion=function(){return this.appVersion||(this.appVersion=this.lcp.App.getVersion()),this.appVersion},u.prototype.getOrgName=function(){return this.lcp.App.getOrgUniqueName()},u.prototype.isRTL=function(){return this.lcp.Client.isRTL()},u.prototype.getAppName=function(){return"Crm"},u.prototype.getClientUrl=function(){return this.lcp.Client.getUrl()},u.prototype.getClientName=function(){return this.lcp.Client.getName()},Object.defineProperty(u.prototype,"UserTimeZoneOffset",{get:function(){return this.userTimeZoneOffset||(this.userTimeZoneOffset=this.lcp.Client.getTimeZoneOffsetMinutes()),this.userTimeZoneOffset},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"UserName",{get:function(){return this.userName||(this.userName=this.lcp.UserContext.getUserName()),this.userName},enumerable:!0,configurable:!0}),u.prototype.isPageLoadEventSupported=function(){return!0},u.prototype.addPageLoadEventListener=function(n,t){if(t===void 0&&(t=null),n==null||typeof n!="function")throw new Error("Cannot register PageLoad callback!");t&&(n=n.bind(t));this.lcp.Client.addPageLoadEventListener(n,!1)},u.prototype.addPageUnLoadEventListener=function(n,t){if(t===void 0&&(t=null),n==null||typeof n!="function")throw new Error("Cannot register PageUnLoad callback!");t&&(n=n.bind(t));this.lcp.Client.addPageUnLoadEventListener(n)},u.prototype.getFormFactor=function(){var i=window.innerWidth,n=t.FormFactorEnum;return i>=1024?n.ExtraLarge:i>=768?n.Large:i>=480?n.Medium:n.Small},u.prototype.getAvailableFormFactors=function(){var n=t.FormFactorEnum;return[n.ExtraLarge,n.Large,n.Medium,]},u.prototype.navigateToPage=function(n){n.callback&&this.lcp.Client.addPageLoadEventListener(n.callback,!0);var t=n[this.getClientName()];t&&(t=this.replaceSystemDependentParameters(t),t=this.appendClientUrlAndPath(t),this.lcp.Navigation.navigateTo(t))},u.prototype.openDialog=function(t,i,r,u){var f={width:r,height:i,position:1},e=this.lcp.Navigation.openDialog(t,f,null);e.then(function(t){n.Client.Loader.appContext.setAriaHiddenForElementsExceptMars(!0);u(t)},function(n){throw new Error("Failed to open dialog. "+n);})},u.prototype.openAlertDialog=function(n,t){var i={text:n,confirmButtonLabel:this.locale.okCaption};t||(t={height:"auto"});this.lcp.Navigation.openAlertDialog(i,t)},u.prototype.getCurrentAppModule=function(){return this.lcp.Navigation.getCurrentAppModuleName()},u.prototype.shouldDefaultContentToCurrentApp=function(){return!1},u.prototype.getCurrentContentFrame=function(n){return n},u.prototype.getActiveRegisteredControl=function(){var t=[];return this.getRegisteredControlsInsideContainer(n.Client.Loader.$mars(window.document),t),t},u.prototype.getAllChildRegisteredControl=function(){return[]},u.prototype.getControl=function(n){return this.getControlFromContainer(window.document,n)},u.prototype.appLPAuthoringEnabled=function(){var n=new XMLHttpRequest,t;return(n.open("GET",this.getClientUrl()+"/api/data/v9.0/organizations?$select=enablelpauthoring",!1),n.send(null),n.status===200&&(t=JSON.parse(n.responseText),t.value.length>0))?t.value[0].enablelpauthoring:!1},u.prototype.isOnline=function(){return this.lcp.Client.isOnline()},Object.defineProperty(u.prototype,"isDesignerEnabledforUser",{get:function(){var n=t.$mars.Deferred();return n.resolve(this.lcp.UserContext.isLpAuthoringEnabled()),n.promise()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"Util",{get:function(){return this.util||(this.util=new i),this.util},enumerable:!0,configurable:!0}),u.prototype.isBlacklistedParameter=function(n){return this.blacklistedUrlParameters.indexOf(n.toLowerCase())>-1},u.prototype.getRegisteredControlsInsideContainer=function(i,r){var u=n.Client.Loader.$mars(i).find("*["+t.Constants.LPIdAttributeName+"]:visible").toArray();u.forEach(function(n){r.push(new t.RegisteredClientControl(n))});this.getControlsInsideIframe(i,r)},u.prototype.getControlsInsideIframe=function(t,i){var r=n.Client.Loader.$mars(t).find("iframe:visible").toArray(),u=this;r.forEach(function(t){try{var r=n.Client.Loader.$mars(t).contents()[0];u.getRegisteredControlsInsideContainer(r,i)}catch(f){console.log("Cound not access "+t);console.log(f)}})},u.prototype.getControlFromContainer=function(i,r){var u=n.Client.Loader.$mars(i).find("["+t.Constants.LPIdAttributeName+'="'+r+'"]:visible').toArray(),e,f,o;if(u.length>0)return new t.RegisteredClientControl(u[0]);for(e=n.Client.Loader.$mars(i).find("iframe:visible").toArray(),f=0;f<e.length;f++)try{if(o=$(e[f]).contents()[0],u=this.getControlFromContainer(o,r),u)return u}catch(s){console.log("Unable to access iframe");console.log(s)}return null},u.prototype.appendClientUrlAndPath=function(n){if(!(n.indexOf("http://")>-1)&&!(n.indexOf("https://")>-1))return n.indexOf("app")?this.getClientUrl()+"/main.aspx"+n:this.getDomainFromUrl(this.getClientUrl())+"uclient/main.htm"+n},u.prototype.getDomainFromUrl=function(n){return n.indexOf("://")>-1?n.split("/")[2]:n.split("/")[0]},u.prototype.replaceSystemDependentParameters=function(t){var u=t.indexOf("app="),i,r;return u!==-1&&(i=t.substring(u+4).split("&")[0],r=n.Client.Utility.Util.getAppIdFromName(i),r&&(t=t.replace("app="+i,"appid="+r))),t},u._instance=null,u}(t.AppContext),i;t.UCIAppContext=r;i=function(i){function r(){i.call(this);this.registerHelpButtonListener()}return __extends(r,i),r.prototype.getHelpIcon=function(){var i=n.Client.Loader.$mars(window.parent.document).find("button["+t.Constants.LPIdAttributeName+"='help-button'] #help-button-icon");return i.length<=0&&(i=n.Client.Loader.$mars(".Help-symbol")),i},r.prototype.getHelpIconClickableElement=function(){return this.getHelpIconParent()},r.prototype.getHelpIconParent=function(){var n=this.getHelpIcon();return n.parent().parent()},r.prototype.getMarsLauncher=function(){var i="["+t.Constants.LPIdAttributeName+'="help-button"]',r=n.Client.Loader.$mars(i);return r.length<=0&&(i="#helpLauncher"),i},r.prototype.setHelpIconStyle=function(){var t=this.getHelpIconParent(),i=t.find(".navTabHelpImageWeb");t.css({"padding-left":"0px","padding-top":"1px"});n.Client.Loader.MarsLoader.isUCIShim()?i.css({padding:"0 0px"}):i.css({padding:"0 16px"});t.attr("tabindex",0)},r.prototype.registerHelpButtonListener=function(){var t=n.Client.Loader.currentInstance;if("MutationObserver"in window){var r=new MutationObserver(function(i){for(var u,r=0;r<i.length;++r)for(u=0;u<i[r].addedNodes.length;++u)if($(i[r].addedNodes[u]).find("#helpLauncher").length>0&&n.Client.Loader.appContext.isOnline()){t.updateHelpIcon();t.bindEventToNavTabHelp(t,!0);break}}),i=document.body;i!=null&&i!=undefined&&r.observe(i,{attributes:!0,childList:!0,subtree:!0})}},r}(t.Util);t.UCIUtils=i})(i=t.Utility||(t.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={})),function(n){var t;(function(n){var t;(function(n){"use strict";var t=function(){function n(){this.value=[];this.add=function(n){this.value.indexOf(n)===-1&&this.value.push(n);this.size=this.value.length};this.clear=function(){this.value=[];this.size=this.value.length};this.remove=function(n){var t=this.value.indexOf(n);t>-1&&this.value.splice(t,1);this.size=this.value.length};this.has=function(n){return this.value.indexOf(n)>-1}}return n}();n.CustomSet=t})(t=n.Utility||(n.Utility={}))})(t=n.Client||(n.Client={}))}(_MicrosoftMars||(_MicrosoftMars={}));
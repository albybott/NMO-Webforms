<!DOCTYPE html>
<!-- saved from url=(0116)https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&pagemode=iframe&sitemappath=SFA%7cInbox%7cnav_referrals -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript">var LoadStartTime = new Date().getTime();</script>
<script type="text/javascript">
			var isKeyPressed=false;
			var headElement = document.getElementsByTagName('head')[0];
			var style_element = document.createElement('style');
			style_element.id = 'focusStyle';
			var focusCss = ':focus{outline:2px dashed !important; outline-offset: 1px !important;}::-moz-focus-inner{border:0;}';
			var removefocusCss = ':focus{outline:0}::-moz-focus-inner{border:0;}';

			document.addEventListener('keydown', function(e) {
				isKeyPressed=true;

				// This class breaks drag/drop keyboard accessibility in the dashboard editor, so temporarily remove it.
				if (window.location.href.indexOf('dashboardEditor.aspx') > -1)
				{
					var target = e && e.target;
					if (target && target.classList && target.classList.contains('keyboardFocusClass')) {
						target.classList.remove('keyboardFocusClass');
						setTimeout(function() { target.classList.add('keyboardFocusClass'); }, 0);
					}
				}
			});

			document.addEventListener('focusin', function(e) {
				if (isKeyPressed) {
					if (document.body != 'undefined' && document.body != null) {
						document.body.classList.add('keyboardFocusClass');
					}
					
					if(e.target.classList){
						e.target.classList.add('keyboardFocusClass');
					}

					if (e.target.parentElementb != null && e.target.parentElement != 'undefined' && e.target.parentElement.classList) {
						e.target.parentElement.classList.add('keyboardFocusClass');
					}

					style_element.innerHTML = focusCss;
					headElement.appendChild(style_element);
					isKeyPressed=false;
				}
			 });

			document.addEventListener('focusout', function(e) {
				var existingStyles = document.getElementsByTagName('style');
				var i = 0;
				while (i < existingStyles.length) {
					if (existingStyles[i].id == 'focusStyle') {
						headElement.removeChild(existingStyles[i]);
					}
					else
					{
						i++;
					}
				}

				if (document.body != 'undefined' && document.body != null) {
					document.body.classList.remove('keyboardFocusClass');
				}
				if(e.target.classList){
					e.target.classList.remove('keyboardFocusClass');
				}
				
				if (e.target.parentElement != null && e.target.parentElement != 'undefined' && e.target.parentElement.classList) {
					e.target.parentElement.classList.remove('keyboardFocusClass');
				}
			 });

			document.addEventListener('mousedown', function(e) {
				isKeyPressed=false;
				if (document.body != 'undefined' && document.body != null) {
					document.body.classList.remove('keyboardFocusClass');
				}
				if(e.target.classList){
					e.target.classList.remove('keyboardFocusClass');
				}

				if (e.target.parentElement != null && e.target.parentElement != 'undefined' && e.target.parentElement.classList) {
					e.target.parentElement.classList.add('keyboardFocusClass');
				}

				var existingStyles = document.getElementsByTagName('style');
				var i = 0;
				while (i < existingStyles.length) {
					if (existingStyles[i].id == 'focusStyle') {
						headElement.removeChild(existingStyles[i]);
					}
					else
					{
						i++;
					}
				}

				style_element.innerHTML = removefocusCss;
				if (!(Mscrm.Utilities.isIE() && e.target.tagName==='SELECT')) {
					headElement.appendChild(style_element)
				}
			});
				
			</script>
<script type="text/javascript">var CDNURL = '';</script>
<script type="text/javascript">
						document.addEventListener('DOMContentLoaded', function() {
						  if (!window.PostRenderTime) 
							{
								window.PostRenderTime = (new Date()).getTime();
							}
						});
						</script>
<link rel="stylesheet" type="text/css" href="./fonts.css.aspx" id="/_common/styles/fonts.css.aspx?lcid=1033&amp;ver=1888157098">
<link rel="stylesheet" type="text/css" href="./global.css.aspx" id="/_common/styles/global.css.aspx?lcid=1033&amp;ver=1888157098">
<link rel="stylesheet" type="text/css" href="./theme.css.aspx" id="/_common/styles/theme.css.aspx?lcid=1033&amp;theme=outlook15white&amp;ver=1888157098">
<link rel="stylesheet" type="text/css" href="./configurabletheme.aspx" id="/_common/styles/configurabletheme.aspx?themeid=1eb9500d-8979-415c-b378-f5e8e52ff305&amp;updatetimestamp=636874335651413007&amp;ver=1888157098">
<link rel="stylesheet" type="text/css" href="./sessionmanagement.css" id="/_static/_common/styles/sessionmanagement.css?ver=1888157098">
<link rel="stylesheet" type="text/css" href="./controls.css.aspx" id="/_forms/controls/controls.css.aspx?lcid=1033&amp;ver=1888157098">
<link rel="stylesheet" type="text/css" href="./select.css.aspx" id="/_common/styles/select.css.aspx?lcid=1033&amp;ver=1888157098">
<link rel="stylesheet" type="text/css" href="./menu.css.aspx" id="/_nav/menu.css.aspx?lcid=1033&amp;ver=1888157098">
<link rel="stylesheet" type="text/css" href="./CompositeControl.css.aspx" id="/_controls/compositecontrol/compositecontrol.css.aspx?lcid=1033&amp;ver=1888157098">
<link rel="stylesheet" type="text/css" href="./appgrid.css.aspx" id="/_grid/appgrid.css.aspx?lcid=1033&amp;ver=1888157098">
<script id="/{636878706300003032}/webresources/main_system_library.js?ver=1888157098" type="text/javascript">var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)},MscrmControls;(function(MscrmControls){var Containers;(function(Containers){"use strict";var MetricObject=function(){function MetricObject(){}return MetricObject}(),MicrosoftFlowsTelemetryReporter=function(){function MicrosoftFlowsTelemetryReporter(){}MicrosoftFlowsTelemetryReporter.prototype.init=function(crmBaseUri,clientType){try{this.crmBaseUri=crmBaseUri;this.metricsReportingServiceUrl=this.crmBaseUri+"/AppWebServices/MetricsReportingService.asmx/Report";this.clientType=clientType}catch(exception){console.error(exception)}};MicrosoftFlowsTelemetryReporter.prototype.getBaseWindowUrl=function(){var protocol=location.protocol,hostName=location.hostname,port=location.port?":"+location.port:"";return protocol+"//"+hostName+port};MicrosoftFlowsTelemetryReporter.prototype.logFlowTelemetryEvent=function(eventName,properties){if(properties===void 0)properties=null;this.sendMetric("MsFlow"+eventName,properties)};MicrosoftFlowsTelemetryReporter.prototype.logFlowAuthenticationEvent=function(tenantId,result,timeTaken,isSilent){var metricProperties={TenantId:tenantId,Result:result,TimeTaken:timeTaken,IsSilent:isSilent};this.sendMetric("MsFlowUserAuthentication",metricProperties)};MicrosoftFlowsTelemetryReporter.prototype.logFlowTriggerEvent=function(tenantId,noOfEntityRecords,noOfProperties,entityLogicalName,flowId,flowRunResult,environmentId,flowTriggerWidgetInitTimeMs,authTokenRetrievalTimeMs,dataRetrievalTimeMs,userRunButtonClickTimeMs){var metricProperties={TenantId:tenantId,NoOfEntityRecords:noOfEntityRecords,NoOfProperties:noOfProperties,EntityLogicalName:entityLogicalName,FlowId:flowId,FlowRunResult:flowRunResult,FlowEnvironmentId:environmentId,FlowTriggerWidgetInitTimeMs:flowTriggerWidgetInitTimeMs,AuthTokenRetrievalTimeMs:authTokenRetrievalTimeMs,DataRetrievalTimeMs:dataRetrievalTimeMs,UserRunButtonClickTimeMs:userRunButtonClickTimeMs};this.sendMetric("MsFlowTriggered",metricProperties)};MicrosoftFlowsTelemetryReporter.prototype.logFlowErrorEvent=function(tenantId,env,errorSource,response,methodName,errMsg){if(methodName==="AttemptToSilentlyAuthenticate")response="";if(response&&response.stack)response=JSON.stringify(response.stack);if(errMsg&&errMsg.message)errMsg=JSON.stringify(errMsg.message);var metricProperties={TenantId:tenantId,FlowEnvironmentId:env,ErrorSource:errorSource,Response:response,MethodName:methodName,IsFailure:true,ErrorMessage:errMsg};this.sendMetric("MsFlowError",metricProperties)};MicrosoftFlowsTelemetryReporter.prototype.logFlowDefinitionsListEvent=function(tenantId,env,numDefinitionsLoaded,timeToLoadDefinitionsMs,timetoLoadDefFromService,entityLogicalName){var metricProperties={TenantId:tenantId,FlowEnvironmentId:env,NumDefinitionsLoaded:numDefinitionsLoaded,TimeToLoadDefinitionsMs:timeToLoadDefinitionsMs,TimetoLoadDefFromService:timetoLoadDefFromService,EntityLogicalName:entityLogicalName};this.sendMetric("MsFlowDefinitionsList",metricProperties)};MicrosoftFlowsTelemetryReporter.prototype.sendMetric=function(name,properties){var _this=this;try{var _window=window;if(_window.Xrm&&_window.Xrm.Internal&&_window.Xrm.Internal.addMetric){_window.Xrm.Internal.addMetric(name,properties);return Promise.resolve()}var outerRequest={request:{MetricsCollections:[{RequestId:this.newGuid(),Metrics:[{n:name,p:properties,t:Date.now()}]}]}};return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;xhr.open("POST",_this.metricsReportingServiceUrl,true);xhr.setRequestHeader("Content-type","application/json");_this.clientType&&xhr.setRequestHeader("ClientAppName",_this.clientType);xhr.onload=function(){var status=xhr.status;if(status===200||status===204)resolve(xhr.response);else reject(status)};xhr.send(JSON.stringify(outerRequest))})}catch(ex){}};MicrosoftFlowsTelemetryReporter.prototype.newGuid=function(){return "xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c==="x"?r:r&3|8;return v.toString(16)})};return MicrosoftFlowsTelemetryReporter}();Containers.MicrosoftFlowsTelemetryReporter=MicrosoftFlowsTelemetryReporter})(Containers=MscrmControls.Containers||(MscrmControls.Containers={}))})(MscrmControls||(MscrmControls={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var ActivateLibraryLegacy=function(){function ActivateLibraryLegacy(){this.activateRecordsLegacy=function(gridControl,records,entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.activate(gridControl,records,entityTypeCode):backCompatHeader.Mscrm.GridCommandActions.activate(gridControl,records,entityTypeCode)};this.activateRecords=function(gridControl,records,entityName,callback){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),entityTypeCode=Xrm.Internal.getEntityCode(entityName);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.activate(gridControl,records,entityTypeCode,callback):backCompatHeader.Mscrm.GridCommandActions.activate(gridControl,records,entityTypeCode)}}ActivateLibraryLegacy.prototype.activatePrimaryRecord=function(id,entityName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.activate(id,entityName):backCompatHeader.Mscrm.CommandBarActions.activate(id,entityName)};return ActivateLibraryLegacy}();Commands.ActivateLibraryLegacy=ActivateLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var ActivateLibrary=function(){function ActivateLibrary(){var _this=this;this.activateRecordsLegacy=function(gridControl,records,entityTypeCode){_this.activateRecords(gridControl,records,Xrm.Internal.getEntityName(entityTypeCode))}}ActivateLibrary.prototype.activatePrimaryRecord=function(id,entityName){Commands.Common.changeState(entityName,id,true)};ActivateLibrary.prototype.activateRecords=function(gridControl,records,entityName,callback){if(!records.length){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Action_NoItemSelected")});return}if(records.length>1&&(entityName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.KnowledgeSearchModel||entityName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.TopicModel)){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Grid_Action_Too_Many_Custom_Messages_Selected_Alert")});return}var dialogParams={};dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records]=records;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.action]=XrmCore.InternalUtilities.DialogUtilities.DialogConstants.activate;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]="";dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StateId]=-1;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StatusId]=-1;var dialogCallbackParams={},options=null,client=Xrm.Utility.getGlobalContext().client.getClient();if(client===Xrm.Constants.ClientNames.web||client==Xrm.Constants.ClientNames.outlook||client==Xrm.Constants.ClientNames.unifiedServiceDesk)options={height:250,width:600,position:1};Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.SetStateDialog,options,dialogParams).then(function(successParameter){Commands.Common.closeSetStateDialogFromGridCallback(successParameter.parameters,dialogCallbackParams,gridControl,callback)})};return ActivateLibrary}();Commands.ActivateLibrary=ActivateLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Activate=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.ActivateLibrary:new Commands.ActivateLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AddLibraryLegacy=function(){function AddLibraryLegacy(){var _this=this;this.AddActivityFromGrid=function(activityTypeName,contentId,entityReference){_this.addActivityFromGrid(activityTypeName,contentId,entityReference)};this.addActivityFromGrid=function(activityTypeName,contentId,entityReference){if(typeof activityTypeName==="number")activityTypeName=Xrm.Internal.getEntityName(activityTypeName);_this.addActivityFromGridLegacy(Xrm.Internal.getEntityCode(activityTypeName),contentId,entityReference)};this.addActivityFromGridLegacy=function(activityTypeCode,contentId,entityReference){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);if(Mscrm&&Mscrm.GridRibbonActions&&Mscrm.GridRibbonActions.addActivityFromGrid)Mscrm.GridRibbonActions.addActivityFromGrid(activityTypeCode,contentId,entityReference);else backCompatHeader.Mscrm.GridRibbonActions.addActivityFromGrid(activityTypeCode,contentId,entityReference)};this.addActivityToFormFromsubgrid=function(activityType,parentId,parentType){var activityCode=Xrm.Internal.getEntityCode(activityType),parentCode=Xrm.Internal.getEntityCode(parentType);_this.addActivityToFormFromsubgridLegacy(activityCode,parentId,parentCode)};this.addActivityToFormFromsubgridLegacy=function(activityType,parentId,parentType){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);if(Mscrm&&Mscrm.AddActivity&&Mscrm.AddActivity.addActivityToFormFromsubgrid)Mscrm.AddActivity.addActivityToFormFromsubgrid(activityType,parentId,parentType);else backCompatHeader.Mscrm.AddActivity.addActivityToFormFromsubgrid(activityType,parentId,parentType)};this.AddActivityOnForm=function(activityTypeName,contentId){_this.addActivityToForm(activityTypeName,contentId)};this.AddActivityToForm=function(activityTypeName,contentId){_this.addActivityToForm(activityTypeName,contentId)};this.addActivityOnForm=function(activityTypeName,contentId){_this.addActivityToForm(activityTypeName,contentId)};this.addActivityToForm=function(activityTypeName,contentId){if(typeof activityTypeName==="number")activityTypeName=Xrm.Internal.getEntityName(activityTypeName);var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);if(Mscrm&&Mscrm.RibbonActions&&Mscrm.RibbonActions.addActivityOnForm)Mscrm.RibbonActions.addActivityOnForm(Xrm.Internal.getEntityCode(activityTypeName),contentId);else backCompatHeader.Mscrm.RibbonActions.addActivityOnForm(Xrm.Internal.getEntityCode(activityTypeName),contentId)};this.AddActivityToFormLegacy=function(activityType,contentId){_this.addActivityToFormLegacy(activityType,contentId)};this.addActivityToFormLegacy=function(activityType,contentId){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);if(Mscrm&&Mscrm.RibbonActions&&Mscrm.RibbonActions.addActivityOnForm)Mscrm.RibbonActions.addActivityOnForm(activityType,contentId);else backCompatHeader.Mscrm.RibbonActions.addActivityOnForm(activityType,contentId)};this.addConnectionFromForm=function(objectId,objectTypeCode,primaryControl,connectToMe,gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);if(Mscrm&&Mscrm.RibbonActions&&Mscrm.RibbonActions.addConnectionFromForm)Mscrm.RibbonActions.addConnectionFromForm(objectId,objectTypeCode,primaryControl,connectToMe,gridControl);else backCompatHeader.Mscrm.RibbonActions.addConnectionFromForm(objectId,objectTypeCode,primaryControl,connectToMe,gridControl)}}return AddLibraryLegacy}();Commands.AddLibraryLegacy=AddLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AddLibrary=function(){function AddLibrary(){var _this=this;this.AddActivityOnForm=function(activityTypeName,contentId){_this.addActivityToForm(activityTypeName,contentId)};this.AddActivityToForm=function(activityTypeName,contentId){_this.addActivityToForm(activityTypeName,contentId)};this.addActivityOnForm=function(activityTypeName,contentId){_this.addActivityToForm(activityTypeName,contentId)};this.addActivityToForm=function(activityTypeName,contentId){if(typeof activityTypeName==="number")activityTypeName=Xrm.Internal.getEntityName(activityTypeName);var entity=Xrm.Page.data.entity;entity&&entity.getId()&&entity.getEntityName()&&entity.getPrimaryAttributeValue()&&_this._genericAddActivityInternal(activityTypeName,contentId,entity.getId(),entity.getEntityName(),entity.getPrimaryAttributeValue())};this.AddActivityToFormLegacy=function(activityTypeCode,contentId){_this.addActivityToFormLegacy(activityTypeCode,contentId)};this.addActivityToFormLegacy=function(activityTypeCode,contentId){_this.AddActivityToForm(Xrm.Internal.getEntityName(activityTypeCode),contentId)};this.addActivityToFormFromsubgrid=function(activityType,parentId,parentType,gridControl){var parentName=Xrm.Page.data.entity.getPrimaryAttributeValue();_this._genericAddActivityInternal(activityType,null,parentId,parentType,parentName,gridControl)};this.addActivityToFormFromsubgridLegacy=function(activityType,parentId,parentType){var activityTypeName=Xrm.Internal.getEntityName(activityType),parentTypeName=Xrm.Internal.getEntityName(parentType);_this.addActivityToFormFromsubgrid(activityTypeName,parentId,parentTypeName)};this.AddActivityFromGridLegacy=function(activityType,contentId,entityReference){_this.addActivityFromGridLegacy(activityType,contentId,entityReference)};this.addActivityFromGridLegacy=function(activityType,contentId,entityReference){if(typeof activityType!=="number")activityType=parseInt(activityType,10);var activityTypeName=Xrm.Internal.getEntityName(activityType);_this.AddActivityFromGrid(activityTypeName,contentId,entityReference)};this.AddActivityFromGrid=function(activityTypeName,contentId,entityReference){_this.addActivityFromGrid(activityTypeName,contentId,entityReference)};this.addActivityFromGrid=function(activityTypeName,contentId,entityReference){if(typeof activityTypeName==="number")activityTypeName=Xrm.Internal.getEntityName(activityTypeName);_this._addActivityToSelectedObject(activityTypeName,contentId,entityReference[0])};this.addConnectionFromForm=function(objectId,objectTypeCode,primaryControl,connectToMe,gridControl){var data={},parentEntityTypeName=Xrm.Page.data.entity.getEntityName(),parentEntityName=Xrm.Page.data.entity.getPrimaryAttributeValue(),fromEntity={id:objectId,name:parentEntityName,entityType:parentEntityTypeName};if(connectToMe){var formContext=Xrm.Page;data={record2id:{entityType:XrmCore.InternalUtilities.EntityUtilities.EntityNames.SystemUser,id:formContext.context.getUserId(),name:formContext.context.getUserName()},record1id:fromEntity}}else data={record1id:fromEntity};var openOptions={entityName:XrmCore.InternalUtilities.EntityUtilities.EntityNames.Connection};Xrm.Navigation.openForm(openOptions,data)};this._addActivityToSelectedObject=function(activityTypeName,contentId,entityReference){_this._genericAddActivityInternal(activityTypeName,contentId,entityReference.Id,entityReference.TypeName,entityReference.Name)};this._genericAddActivityInternal=function(activityTypeName,contentId,parentId,parentTypeName,parentName,gridControl){var partyId=null,partyType=null,partyName=null,partyLocation="";if(activityTypeName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.PhoneCall){var phoneCallCustomerValue=_this._getPhoneCallCustomerForEntity(parentTypeName,parentName,parentId);if(phoneCallCustomerValue&&phoneCallCustomerValue.Id&&phoneCallCustomerValue.Name&&phoneCallCustomerValue.Typename){partyId=phoneCallCustomerValue.Id;partyName=phoneCallCustomerValue.Name;partyType=phoneCallCustomerValue.Typename}if(parentTypeName==XrmCore.InternalUtilities.EntityUtilities.EntityNames.Account||parentTypeName==XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contact||parentTypeName==XrmCore.InternalUtilities.EntityUtilities.EntityNames.Lead){var partyAttribute=Xrm.Page.getAttribute("telephone1");if(partyAttribute&&partyAttribute.getValue()!=null)partyLocation=partyAttribute.getValue().toString()}}else if(activityTypeName!=XrmCore.InternalUtilities.EntityUtilities.EntityNames.Task)switch(parentTypeName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Account:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contact:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Lead:partyId=parentId;partyType=parentTypeName;partyName=parentName;var partyAttribute=null;switch(activityTypeName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Fax:if(Xrm.Page.data){partyAttribute=Xrm.Page.getAttribute("fax");var partyAttribute1=Xrm.Page.getAttribute("address1_fax");if(partyAttribute&&partyAttribute.getValue()!=null)partyLocation=partyAttribute.getValue().toString();if(partyAttribute1){var partyLocation1=partyAttribute1.getValue();if(partyLocation1)if(partyLocation)partyLocation+=";"+partyLocation1;else partyLocation=partyLocation1}}break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Letter:if(Xrm.Page.data!=null){partyAttribute=Xrm.Page.getAttribute("address1_name");if(partyAttribute)partyLocation=partyAttribute.getValue()}break}break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Incident:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Opportunity:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Quote:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Invoice:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SalesOrder:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contract:var partyElement=_this._getPartyDetailsForRefreshForm(parentTypeName);if(partyElement){partyId=partyElement.Id;partyType=partyElement.Typename;partyName=partyElement.Name}break;default:if(activityTypeName==XrmCore.InternalUtilities.EntityUtilities.EntityNames.Email&&Xrm.Internal.getEntityCode(parentTypeName)>=Xrm.Internal.getEntityCode(XrmCore.InternalUtilities.EntityUtilities.EntityNames.BaseAddEntityObjectTypeCode)){partyId=parentId;partyType=parentTypeName;partyName=parentName}break}_this._addActivityTo(activityTypeName,parentId,parentTypeName,parentName,partyId,partyType,partyName,partyLocation,contentId,gridControl)};this._getPartyDetailsForRefreshForm=function(entityTypeName){var partyElement=null;if(Xrm.Page.data&&Xrm.Page.data.entity){var entityUI=Xrm.Page.data.entity;switch(entityTypeName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Incident:partyElement=_this._getCustomerForIncident();break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Opportunity:partyElement=_this._getCustomerForOppurtunity();break;default:var attributes=entityUI.attributes;if(entityUI.attributes){var customerId=entityUI.attributes.get("customerid");if(customerId)partyElement=_this.getFirstLookupItem(customerId.getValue())}break}}return partyElement};this._getCustomerForOppurtunity=function(){for(var attributeNames=["parentcontactid","parentaccountid","parentaccountid"],_i=0,attributeNames_1=attributeNames;_i<attributeNames_1.length;_i++){var attributeName=attributeNames_1[_i],attribute=Xrm.Page.getAttribute(attributeName);if(attribute)return _this.getFirstLookupItem(attribute.getValue())}return null};this._getCustomerForIncident=function(){var customer=Xrm.Page.getAttribute("customerid"),contact=Xrm.Page.getAttribute("primarycontactid"),customerlookup=null,contactlookup=null;if(customer!=null)customerlookup=_this.getFirstLookupItem(customer.getValue());if(contact!=null)contactlookup=_this.getFirstLookupItem(contact.getValue());if(customerlookup!=null&&contactlookup==null)return customerlookup;else if(customerlookup&&contactlookup&&customerlookup.Typename==XrmCore.InternalUtilities.EntityUtilities.EntityNames.Account)return contactlookup;return customerlookup};this._getPhoneCallCustomerForEntity=function(parentTypeName,parentName,parentId){if(!parentName||parentName==="")parentName=Xrm.Page.data.entity.getPrimaryAttributeValue();var phoneCallCustomerValue=null,getEntityTypeCode=Xrm.Internal.getEntityCode;switch(parentTypeName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Incident:var customerIdAttribute=Xrm.Page.getAttribute("customerid");phoneCallCustomerValue=customerIdAttribute?_this.getFirstLookupItem(customerIdAttribute.getValue()):null;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Account:var primaryContact=Xrm.Page.getAttribute("primarycontactid");if(primaryContact&&primaryContact.getValue())phoneCallCustomerValue=_this.getFirstLookupItem(primaryContact.getValue());else if(parentId&&parentName){var entityTypeName=XrmCore.InternalUtilities.EntityUtilities.EntityNames.Account;phoneCallCustomerValue={Id:parentId,Name:parentName,Type:getEntityTypeCode(entityTypeName).toString(),Typename:entityTypeName}}break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contact:if(parentId&&parentName){var entityTypeName=XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contact;phoneCallCustomerValue={Id:parentId,Name:parentName,Type:getEntityTypeCode(entityTypeName).toString(),Typename:entityTypeName}}break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Opportunity:var parentContactId=Xrm.Page.getAttribute("parentcontactid");if(parentContactId)phoneCallCustomerValue=_this.getFirstLookupItem(parentContactId.getValue());var parentAccount=Xrm.Page.getAttribute("parentaccountid");if(parentAccount&&!phoneCallCustomerValue)phoneCallCustomerValue=_this.getFirstLookupItem(parentAccount.getValue());break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Lead:var parentContact=Xrm.Page.getAttribute("parentcontactid");if(parentContact&&parentContact.getValue())phoneCallCustomerValue=_this.getFirstLookupItem(parentContact.getValue());else if(parentId&&parentName){var entityTypeName=XrmCore.InternalUtilities.EntityUtilities.EntityNames.Lead;phoneCallCustomerValue=phoneCallCustomerValue={Id:parentId,Name:parentName,Type:getEntityTypeCode(entityTypeName).toString(),Typename:entityTypeName}}break;default:break}return phoneCallCustomerValue};this.getFirstLookupItem=function(parameterCustomerValue){var parameterReturnType=null;if(Array.isArray(parameterCustomerValue)&&parameterCustomerValue.length>0&&parameterCustomerValue[0].id&&parameterCustomerValue[0].name&&parameterCustomerValue[0].entityType)parameterReturnType={Id:parameterCustomerValue[0].id,Name:parameterCustomerValue[0].name,Type:Xrm.Internal.getEntityCode(parameterCustomerValue[0].entityType).toString(),Typename:parameterCustomerValue[0].entityType};return parameterReturnType};this._addActivityTo=function(activityTypeName,id,type,name,partyId,partyType,partyName,location,contentId,gridControl){var parameters={};if(id&&type&&activityTypeName!=XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignResponse){var lookupValue={id:id,name:name,entityType:type};parameters["regardingobjectid"]=JSON.stringify(lookupValue)}if(partyId){var partyLookupList=[{id:partyId,name:partyName,entityType:partyType}],temp=JSON.stringify(partyLookupList);parameters["partyaddressused"]="";parameters["contactInfo"]=location;switch(activityTypeName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Email:parameters["to"]=temp;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Appointment:parameters["requiredattendees"]=temp;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.PhoneCall:parameters["to"]=temp;break;default:break}}if(contentId)parameters["contentId"]=contentId;var options={};options.entityName=activityTypeName;options.useQuickCreateForm=true;if(gridControl&&gridControl.getRelationship&&gridControl.getRelationship()!=null&&gridControl.getRelationship().relationshipType==0){options.relationship=gridControl.getRelationship();var parentControl=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page;if(parentControl&&parentControl.data&&parentControl.data.entity&&parentControl.data.entity.getEntityReference)options.createFromEntity=parentControl.data.entity.getEntityReference()}Xrm.Navigation.openForm(options,parameters).then(function(){gridControl!=null&&gridControl!=undefined&&gridControl.refresh()})}}return AddLibrary}();Commands.AddLibrary=AddLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Add=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.AddLibrary:new Commands.AddLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Common;(function(Common){var EntitySpecificOverrideBase=function(){function EntitySpecificOverrideBase(entityName){this.overrideMethods={};this.entityName=entityName}EntitySpecificOverrideBase.prototype.call=function(method){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];if(this.overrideMethods&&this.overrideMethods[method]&&this.overrideMethods[method][this.entityName]){var childArgs=[method];childArgs.push.apply(childArgs,args);return this[this.overrideMethods[method][this.entityName]].apply(this,childArgs)}else return this[method].apply(this,args)};return EntitySpecificOverrideBase}();Common.EntitySpecificOverrideBase=EntitySpecificOverrideBase})(Common=XrmCore.Common||(XrmCore.Common={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AddExistingFromSubGridBase=function(_super){__extends(AddExistingFromSubGridBase,_super);function AddExistingFromSubGridBase(){_super.apply(this,arguments)}AddExistingFromSubGridBase.prototype.addExistingFromSubGrid=function(gridTypeName,gridControl){var subGridControl=gridControl;if(subGridControl){var gridControlType=subGridControl.getGridType?subGridControl.getGridType():3;if(gridControlType===3||gridControlType===2)return this.call("openLookupRecord",gridTypeName,gridControl)}return false};AddExistingFromSubGridBase.prototype.openLookupRecord=function(gridTypeName,gridControl){var parentForm=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page,currentEntity={entityType:parentForm.data.entity.getEntityName(),name:parentForm.data.entity.getPrimaryAttributeValue(),id:parentForm.data.entity.getId().replace("{","").replace("}","")},currentPage=Xrm.Internal.getCurrentPageUrl?Xrm.Internal.getCurrentPageUrl(currentEntity):null;if(currentPage&&-1!==currentPage.indexOf("pagetype=dashboard"))return false;return this.call("lookupRecord",gridTypeName,gridControl)};AddExistingFromSubGridBase.prototype.lookupRecord=function(gridTypeName,gridControl){var subGridControl=gridControl,relationship=subGridControl&&subGridControl.getRelationship?subGridControl.getRelationship():null;if(subGridControl){var entityName=gridControl&&gridControl.getEntityName?gridControl.getEntityName():"",lookup=Xrm.Utility.lookupObjects?Xrm.Utility.lookupObjects({allowMultiSelect:relationship?relationship.relationshipType===1:false,defaultEntityType:entityName,entityTypes:[entityName],lookupType:"Lookup.Simple"}):null;if(lookup){var _this_1=this;lookup.then(function(lookupValues){return _this_1.call("associateRecords",lookupValues,gridTypeName,gridControl)})}return true}return false};AddExistingFromSubGridBase.prototype.associateRecords=function(lookupValues,gridTypeName,gridControl){var _this=this;if(!lookupValues||lookupValues.length===0)return;var subGridControl=gridControl,relationship=subGridControl&&subGridControl.getRelationship?subGridControl.getRelationship():null,relationshipAttributeName=relationship?relationship.attributeName:null,parentForm=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page,parentId=parentForm.data.entity.getId().replace("{","").replace("}",""),parentEntity=parentForm.data.entity.getEntityName();if(!XrmCore.InternalUtilities.DialogUtilities.isOffline()){var requests_1=[],requestsPromises=[],_loop_1=function(key){var lookupValue=lookupValues[key],newRequest=Xrm.WebApi.retrieveRecord(lookupValue.entityType,lookupValue.id.toString());newRequest.then(function(childEntity){if(relationship&&relationship.relationshipType===0){var relationshipState=_this.getRelationshipStateOneToMany(lookupValue,childEntity,parentId,relationshipAttributeName,parentEntity);switch(relationshipState){case 0:Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Parent_Record_AlreadyExists")});return;case 2:return}}var request;if(gridControl.getTeamTemplateId&&gridControl.getTeamTemplateId()!==null)request=_this.call("createAddUserToRecordTeamRequest",lookupValue,gridControl);else request=_this.call("createAssociateRequest",lookupValue,gridControl,relationship);request&&requests_1.push(request)});requestsPromises.push(newRequest)};for(var key in lookupValues)_loop_1(key);Promise.all(requestsPromises).then(function(){if(0<requests_1.length)if(requests_1.length==1)Xrm.WebApi.online.execute(requests_1[0]).then(function(success){gridControl&&gridControl.refresh()},function(error){_this.onError(error,gridControl)});else Xrm.WebApi.online.executeMultiple(requests_1).then(function(success){XrmCore.InternalUtilities.DialogUtilities.onGridActionMultipleSuccess(gridControl,success)},function(error){_this.onError(error,gridControl)})},function(error){_this.onError(error,gridControl)})}else{var retrieveOptions="?$select="+relationshipAttributeName;Xrm.WebApi.retrieveRecord(lookupValues[0].entityType,lookupValues[0].id.toString(),retrieveOptions).then(function(childEntity){var relationshipState=_this.getRelationshipStateOneToMany(lookupValues[0],childEntity,parentId,relationshipAttributeName,parentEntity);if(relationshipState===2)return;if(relationshipState===0){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Parent_Record_AlreadyExists")});return}var regardingLookup={logicalname:parentEntity,id:parentId},updateEntityRecord={};updateEntityRecord[relationshipAttributeName]=regardingLookup;Xrm.WebApi.updateRecord(lookupValues[0].entityType,lookupValues[0].id.toString(),updateEntityRecord).then(function(entity){gridControl&&gridControl.refresh()},function(error){_this.onError(error,gridControl)})},function(error){_this.onError(error,gridControl)})}};AddExistingFromSubGridBase.prototype.createAssociateRequest=function(lookupValue,gridControl,relationship){var parentForm=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page,parentEntity=parentForm.data.entity.getEntityName(),parentId=parentForm.data.entity.getId().replace("{","").replace("}",""),childEntity=lookupValue.entityType||lookupValue.entityName,childId=lookupValue.id.replace("{","").replace("}",""),shouldSwapParentChild=relationship&&relationship.roleType===2&&relationship.relationshipType===1,request={getMetadata:function(){var ODataMetadata={boundParameter:null,parameterTypes:{},operationName:"Associate",operationType:2};return ODataMetadata},target:{id:shouldSwapParentChild?childId:parentId,entityType:shouldSwapParentChild?childEntity:parentEntity},relatedEntities:[{id:shouldSwapParentChild?parentId:childId,entityType:shouldSwapParentChild?parentEntity:childEntity}],relationship:relationship&&relationship.name};return request};AddExistingFromSubGridBase.prototype.createAddUserToRecordTeamRequest=function(lookupValue,gridControl){if(lookupValue&&lookupValue.id&&lookupValue.entityType){var userType=lookupValue.entityType,userId=lookupValue.id.replace("{","").replace("}",""),parentForm=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page;if(!parentForm||!parentForm.data||!parentForm.data.entity||!parentForm.data.entity.getEntityName||!parentForm.data.entity.getId)return null;var recordType=parentForm.data.entity.getEntityName(),recordId=parentForm.data.entity.getId().replace("{","").replace("}",""),user={id:userId,entityType:userType},record={id:recordId,entityType:recordType},teamTemplate={id:gridControl.getTeamTemplateId(),entityType:"teamtemplate"},request=new XrmCore.SdkContracts.AddUserToRecordTeamRequest(user,record,teamTemplate);return request}return null};AddExistingFromSubGridBase.prototype.onError=function(error,gridControl){gridControl.refresh();XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)};AddExistingFromSubGridBase.prototype.getRelationshipStateOneToMany=function(lookupValue,childEntity,parentId,relationshipAttributeName,parentEntity){var isModifiable=parentEntity===XrmCore.InternalUtilities.EntityUtilities.EntityNames.Territory&&lookupValue.entityType===XrmCore.InternalUtilities.EntityUtilities.EntityNames.SystemUser&&relationshipAttributeName==="territoryid",relatedEntityId=childEntity["_"+relationshipAttributeName+"_value"];return relatedEntityId&&!isModifiable?relatedEntityId.toLowerCase()===parentId.toLowerCase()?2:0:1};return AddExistingFromSubGridBase}(XrmCore.Common.EntitySpecificOverrideBase);Commands.AddExistingFromSubGridBase=AddExistingFromSubGridBase})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var GRID_TYPE_INLINE_SUB_GRID=3,GRID_TYPE_ASSOCIATED=2;Commands.ADD_EXISTING_FROM_SUB_GRID_OVERRIDES={addExistingFromSubGrid:{knowledgearticle:"translateArticle",connection:"openCaseResearchFlyout",contact:"checkInParentAndInvoke",account:"checkInParentAndInvoke",lead:"checkInParentAndInvoke",list:"checkInParentAndInvokeFromRelationship",campaign:"checkInParentAndInvokeFromRelationship",campaignactivity:"checkInParentAndInvokeFromRelationship"},openLookupRecord:{activitypointer:"openActivityMenu"},lookupRecord:{opportunityproduct:"openProductLookup",quotedetail:"openProductLookup",salesorderdetail:"openProductLookup",invoicedetail:"openProductLookup"},associateRecords:{list:"associateRecordsList",campaign:"associateRecordsCampaign",product:"associateRecordsProduct",systemuser:"associateRecordsSystemUser"},createAssociateRequest:{contact:"createAssociateRequestContact",list:"createAssociateRequestList",campaignactivity:"createAssociateRequestCampaignActivity",campaign:"createAssociateRequestCampaign",account:"createAssociateRequestAccount",systemuser:"createAssociateRequestSystemUser",lead:"createAssociateRequestLead",queue:"createAssociateRequestQueue",product:"createAssociateRequestProduct"}};var AddExistingFromSubGrid=function(_super){__extends(AddExistingFromSubGrid,_super);function AddExistingFromSubGrid(){_super.apply(this,arguments);this.overrideMethods=Commands.ADD_EXISTING_FROM_SUB_GRID_OVERRIDES}AddExistingFromSubGrid.prototype.translateArticle=function(base,gridTypeName,gridControl){return this[base](gridTypeName,gridControl)};AddExistingFromSubGrid.prototype.openCaseResearchFlyout=function(base,gridTypeName,gridControl){return this[base](gridTypeName,gridControl)};AddExistingFromSubGrid.prototype.checkInParentAndInvoke=function(base,gridTypeName,gridControl){return this[base](gridTypeName,gridControl)};AddExistingFromSubGrid.prototype.checkInParentAndInvokeFromRelationship=function(base,gridTypeName,gridControl){return this[base](gridTypeName,gridControl)};AddExistingFromSubGrid.prototype.openActivityMenu=function(base,gridTypeName,gridControl){return this[base](gridTypeName,gridControl)};AddExistingFromSubGrid.prototype.openProductLookup=function(base,gridTypeName,gridControl){return this[base](gridTypeName,gridControl)};AddExistingFromSubGrid.prototype.associateRecordsList=function(base,lookupValues,gridTypeName,gridControl){this[base](lookupValues,gridTypeName,gridControl)};AddExistingFromSubGrid.prototype.associateRecordsCampaign=function(base,lookupValues,gridTypeName,gridControl){this[base](lookupValues,gridTypeName,gridControl)};AddExistingFromSubGrid.prototype.associateRecordsProduct=function(base,lookupValues,gridTypeName,gridControl){this[base](lookupValues,gridTypeName,gridControl)};AddExistingFromSubGrid.prototype.associateRecordsSystemUser=function(base,lookupValues,gridTypeName,gridControl){this[base](lookupValues,gridTypeName,gridControl)};AddExistingFromSubGrid.prototype.createAssociateRequestContact=function(base,lookupValue,gridControl,relationship){return this[base](lookupValue,gridControl,relationship)};AddExistingFromSubGrid.prototype.createAssociateRequestList=function(base,lookupValue,gridControl,relationship){return this[base](lookupValue,gridControl,relationship)};AddExistingFromSubGrid.prototype.createAssociateRequestAccount=function(base,lookupValue,gridControl,relationship){return this[base](lookupValue,gridControl,relationship)};AddExistingFromSubGrid.prototype.createAssociateRequestCampaign=function(base,lookupValue,gridControl,relationship){return this[base](lookupValue,gridControl,relationship)};AddExistingFromSubGrid.prototype.createAssociateRequestCampaignActivity=function(base,lookupValue,gridControl,relationship){return this[base](lookupValue,gridControl,relationship)};AddExistingFromSubGrid.prototype.createAssociateRequestProduct=function(base,lookupValue,gridControl,relationship){return this[base](lookupValue,gridControl,relationship)};AddExistingFromSubGrid.prototype.createAssociateRequestQueue=function(base,lookupValue,gridControl,relationship){return this[base](lookupValue,gridControl,relationship)};AddExistingFromSubGrid.prototype.createAssociateRequestLead=function(base,lookupValue,gridControl,relationship){return this[base](lookupValue,gridControl,relationship)};AddExistingFromSubGrid.prototype.createAssociateRequestSystemUser=function(base,lookupValue,gridControl,relationship){return this[base](lookupValue,gridControl,relationship)};return AddExistingFromSubGrid}(Commands.AddExistingFromSubGridBase);Commands.AddExistingFromSubGrid=AddExistingFromSubGrid})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AddExistingFromSubGridStandardBase=function(_super){__extends(AddExistingFromSubGridStandardBase,_super);function AddExistingFromSubGridStandardBase(){_super.apply(this,arguments)}AddExistingFromSubGridStandardBase.prototype.addExistingFromSubGridStandard=function(gridTypeName,gridControl){var subGridControl=gridControl;!this.call("addExistingFromSubGrid",gridTypeName,gridControl)&&subGridControl&&this.call("locAssoc",gridTypeName,gridControl)};AddExistingFromSubGridStandardBase.prototype.locAssoc=function(gridTypeName,gridControl){var subGridControl=gridControl;if(subGridControl){var entityName=gridControl&&gridControl.getEntityName?gridControl.getEntityName():"",lookup=Xrm.Utility.lookupObjects?Xrm.Utility.lookupObjects({allowMultiSelect:true,defaultEntityType:entityName,entityTypes:[entityName],lookupType:"Lookup.PartyList"}):null;if(lookup){var _this_2=this;lookup.then(function(lookupValues){return _this_2.call("associateOneToManyRecords",lookupValues,gridControl,false)})}}};AddExistingFromSubGridStandardBase.prototype.associateOneToManyRecords=function(lookupValues,gridControl,overrideParent){if(!lookupValues||lookupValues.length===0)return;var subGridControl=gridControl,relationship=subGridControl&&subGridControl.getRelationship?subGridControl.getRelationship():null;if(relationship){var parentForm=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page,parentEntity=parentForm.data.entity.getEntityName(),parentId_1=parentForm.data.entity.getId().replace("{","").replace("}","");Xrm.Utility.getEntityMetadata(parentEntity).then(function(metadata){var recordCount=lookupValues.length,updatedRecords=0,updateRecord=function(lookupValue){var data={"@odata.type":"#Microsoft.Dynamics.CRM."+lookupValue.entityType};data[relationship.navigationPropertyName+"@odata.bind"]="/"+metadata.EntitySetName+"("+parentId_1+")";Xrm.WebApi.updateRecord(lookupValue.entityType,lookupValue.id,data).then(function(response){updatedRecords++;updatedRecords===recordCount&&gridControl&&gridControl.refresh&&gridControl.refresh()},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)},_loop_2=function(key){var lookupValue=lookupValues[key];if(overrideParent)updateRecord(lookupValue);else Xrm.WebApi.retrieveRecord(lookupValue.entityType,lookupValue.id).then(function(entity){!entity[relationship.attributeName]&&updateRecord(lookupValue)})};for(var key in lookupValues)_loop_2(key)})}};return AddExistingFromSubGridStandardBase}(Commands.AddExistingFromSubGrid);Commands.AddExistingFromSubGridStandardBase=AddExistingFromSubGridStandardBase})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AddExistingFromSubGridStandard=function(_super){__extends(AddExistingFromSubGridStandard,_super);function AddExistingFromSubGridStandard(){_super.apply(this,arguments);this.overrideMethods=AddExistingFromSubGridStandard.AddOverrideMethods(Commands.ADD_EXISTING_FROM_SUB_GRID_OVERRIDES)}AddExistingFromSubGridStandard.AddOverrideMethods=function(overrideMethods){overrideMethods["locAssoc"]={goal:"locAssocObjGoal"};overrideMethods["associateOneToManyRecords"]={territory:"associateOneToManyRecordsOverrideParent",mobileofflineprofile:"associateOneToManyRecordsOverrideParent"};return overrideMethods};AddExistingFromSubGridStandard.prototype.locAssocObjGoal=function(base,gridTypeName,gridControl){this[base](gridTypeName,gridControl)};AddExistingFromSubGridStandard.prototype.associateOneToManyRecordsOverrideParent=function(base,lookupValues,gridControl,overrideParent){this[base](lookupValues,gridControl,true)};return AddExistingFromSubGridStandard}(Commands.AddExistingFromSubGridStandardBase);Commands.AddExistingFromSubGridStandard=AddExistingFromSubGridStandard})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AddFromSubGridLibraryLegacy=function(){function AddFromSubGridLibraryLegacy(){}AddFromSubGridLibraryLegacy.prototype.addExistingFromSubGridAssociated=function(gridTypeName,gridControl){var gridTypeCode=Xrm.Internal.getEntityCode(gridTypeName),backCompatHeader=window.parent;Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.addExistingFromSubGridAssociated(gridTypeCode,gridControl):backCompatHeader.Mscrm.GridCommandActions.addExistingFromSubGridAssociated(gridTypeCode,gridControl)};AddFromSubGridLibraryLegacy.prototype.addExistingFromSubGridStandard=function(gridTypeName,gridControl){var gridTypeCode=Xrm.Internal.getEntityCode(gridTypeName),backCompatHeader=window.parent;Mscrm&&Mscrm.GridCommandActions&&Mscrm.GridControl?Mscrm.GridCommandActions.addExistingFromSubGridStandard(gridTypeCode,gridControl):backCompatHeader.Mscrm.GridCommandActions.addExistingFromSubGridStandard(gridTypeCode,gridControl)};return AddFromSubGridLibraryLegacy}();Commands.AddFromSubGridLibraryLegacy=AddFromSubGridLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AddFromSubGridLibrary=function(){function AddFromSubGridLibrary(){}AddFromSubGridLibrary.prototype.addExistingFromSubGridAssociated=function(gridTypeName,gridControl){var entityName=gridControl&&gridControl.getEntityName?gridControl.getEntityName():"",addExisting=new Commands.AddExistingFromSubGrid(entityName);addExisting.call("addExistingFromSubGrid",gridTypeName,gridControl)};AddFromSubGridLibrary.prototype.addExistingFromSubGridStandard=function(gridTypeName,gridControl){var entityName=gridControl&&gridControl.getEntityName?gridControl.getEntityName():"",addExisting=new Commands.AddExistingFromSubGridStandard(entityName);addExisting.addExistingFromSubGridStandard(gridTypeName,gridControl)};return AddFromSubGridLibrary}();Commands.AddFromSubGridLibrary=AddFromSubGridLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.AddFromSubGrid=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.AddFromSubGridLibrary:new Commands.AddFromSubGridLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AddToQueueLibraryLegacy=function(){function AddToQueueLibraryLegacy(){}AddToQueueLibraryLegacy.prototype.CommandBar=function(entityType){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);if(Mscrm&&Mscrm.CommandBarActions)Mscrm.CommandBarActions.addToQueue(Xrm.Internal.getEntityCode(entityType));else backCompatHeader.Mscrm.CommandBarActions.addToQueue(Xrm.Internal.getEntityCode(entityType))};AddToQueueLibraryLegacy.prototype.CommandBarLegacy=function(objectType){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);if(Mscrm&&Mscrm.CommandBarActions)Mscrm.CommandBarActions.addToQueue(objectType);else backCompatHeader.Mscrm.CommandBarActions.addToQueue(objectType)};AddToQueueLibraryLegacy.prototype.GridCommand=function(gridControl,records,entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);if(Mscrm&&Mscrm.CommandBarActions)Mscrm.GridCommandActions.addToQueue(gridControl,records,entityTypeCode);else backCompatHeader.Mscrm.GridCommandActions.addToQueue(gridControl,records,entityTypeCode)};return AddToQueueLibraryLegacy}();Commands.AddToQueueLibraryLegacy=AddToQueueLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AddToQueueLibrary=function(){function AddToQueueLibrary(){}AddToQueueLibrary.prototype.CommandBarLegacy=function(objectType){if(typeof objectType!=="number")objectType=parseInt(objectType,10);this.CommandBar(Xrm.Internal.getEntityName(objectType))};AddToQueueLibrary.prototype.CommandBar=function(entityType){var records=[],entityReference={Id:new Microsoft.Crm.Client.Core.Framework.Guid(Xrm.Page.data.entity.getId()),TypeName:entityType};records=[entityReference];var dialogParams={};dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records]=JSON.stringify(records);dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]=XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId;var options={},client=Xrm.Utility.getGlobalContext().client.getClient();if(client===Xrm.Constants.ClientNames.web||client==Xrm.Constants.ClientNames.outlook||client==Xrm.Constants.ClientNames.unifiedServiceDesk){options.height=235;options.width=450}Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.AddToQueueDialog,options,dialogParams).then(this.AddToQueueCommandBarDialogCloseCallback())};AddToQueueLibrary.prototype.GridCommand=function(gridControl,records,entityType){var selectedRecords=[];for(var i in records){var record=records[i],entityName=record.TypeName,entityReference={Id:new Microsoft.Crm.Client.Core.Framework.Guid(record.Id),TypeName:entityName};selectedRecords.push(entityReference)}var dialogParams={};dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records]=JSON.stringify(selectedRecords);dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]=XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.GridControl]=JSON.stringify(gridControl);var dialogOptions={},client=Xrm.Utility.getGlobalContext().client.getClient();if(client===Xrm.Constants.ClientNames.web||client==Xrm.Constants.ClientNames.outlook||client==Xrm.Constants.ClientNames.unifiedServiceDesk){dialogOptions.height=235;dialogOptions.width=450}Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.AddToQueueDialog,dialogOptions,dialogParams).then(Commands.Common.gridCommandDialogCloseCallback(gridControl))};AddToQueueLibrary.prototype.AddToQueueCommandBarDialogCloseCallback=function(){return function(callbackParams){var constants=XrmCore.InternalUtilities.DialogUtilities.DialogConstants,client=Xrm.Utility.getGlobalContext().client.getClient();(client===Xrm.Constants.ClientNames.web||callbackParams.parameters[constants.LastButtonClicked]==constants.DialogOkId)&&Xrm.Page.data.refresh(true)}};return AddToQueueLibrary}();Commands.AddToQueueLibrary=AddToQueueLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.AddToQueue=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.AddToQueueLibrary:new Commands.AddToQueueLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AssignLibraryLegacy=function(){function AssignLibraryLegacy(){this.assignObjectLegacy=function(objectType){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.assignObject(objectType):backCompatHeader.Mscrm.CommandBarActions.assignObject(objectType)};this.assignObject=function(entityTypeName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true),objectType=Xrm.Internal.getEntityCode(entityTypeName);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.assignObject(objectType):backCompatHeader.Mscrm.CommandBarActions.assignObject(objectType)};this.assignQueueLegacy=function(entityId,objectType){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.assignQueue(entityId,objectType):backCompatHeader.Mscrm.CommandBarActions.assignQueue(entityId,objectType)};this.assignQueue=function(entityId,entityTypeName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true),objectType=Xrm.Internal.getEntityCode(entityTypeName);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.assignQueue(entityId,objectType):backCompatHeader.Mscrm.CommandBarActions.assignQueue(entityId,objectType)};this.assignSelectedRecordsLegacy=function(gridControl,selectedRecords,entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.CommandBarActions?Mscrm.GridCommandActions.assignSelectedRecords(gridControl,selectedRecords,entityTypeCode):backCompatHeader.Mscrm.GridCommandActions.assignSelectedRecords(gridControl,selectedRecords,entityTypeCode)};this.assignSelectedRecords=function(gridControl,selectedRecords,entityName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),entityTypeCode=Xrm.Internal.getEntityCode(entityName);Mscrm&&Mscrm.CommandBarActions?Mscrm.GridCommandActions.assignSelectedRecords(gridControl,selectedRecords,entityTypeCode):backCompatHeader.Mscrm.GridCommandActions.assignSelectedRecords(gridControl,selectedRecords,entityTypeCode)};this.assignCloseDialog=function(){Commands.Common.closeDialogLegacy()};this.assignDialogAssignClick=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.assignDialogAssignClick():backCompatHeader.Mscrm.GridCommandActions.assignDialogAssignClick()};this.assignDialogAssignToChange=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.assignDialogAssignToChange():backCompatHeader.Mscrm.GridCommandActions.assignDialogAssignToChange()};this.assignDialogOnLoad=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.assignDialogOnLoad():backCompatHeader.Mscrm.GridCommandActions.assignDialogOnLoad()};this.assignDialogSystemUserChange=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.assignDialogSystemUserChange():backCompatHeader.Mscrm.CommandBarActions.assignDialogSystemUserChange()}}return AssignLibraryLegacy}();Commands.AssignLibraryLegacy=AssignLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var AssignLibrary=function(){function AssignLibrary(){var _this=this;this.assignObjectLegacy=function(objectType){if(typeof objectType!=="number")objectType=parseInt(objectType,10);_this.assignObject(Xrm.Internal.getEntityName(objectType))};this.assignObject=function(entityTypeName){var id=Xrm.Page.data.entity.getId();if(entityTypeName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.Incident||Xrm.Utility.isActivityType(entityTypeName))_this.assignQueue(id,entityTypeName);else{var entityReference={Id:id,TypeName:entityTypeName,Name:Xrm.Page.data.entity.getEntityReference().name},records=[entityReference],dialogParams={};dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityId]=id;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityName]=entityTypeName;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityTypeCode]=Xrm.Internal.getEntityCode(entityTypeName).toString();dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records]=XrmCore.InternalUtilities.DialogUtilities.serializeSdkEntityReferences(records);dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.SelectedRecordsCount]=records.length;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]="";dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerId]="";dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerType]="";var dialogOptions=null;switch(entityTypeName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SLA:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ConvertRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RoutingRule:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Workflow:break;default:break}Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.Assign,dialogOptions,dialogParams).then(_this.assignDialogCloseCallback(dialogParams))}};this.assignQueueLegacy=function(entityId,objectType){if(typeof objectType!=="number")objectType=parseInt(objectType,10);_this.assignQueue(entityId,Xrm.Internal.getEntityName(objectType))};this.assignQueue=function(entityId,entityTypeName){var entityReference={Id:entityId,TypeName:entityTypeName,Name:Xrm.Page.data.entity.getEntityReference().name},dialogParams={};dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityId]=entityId;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityTypeCode]=Xrm.Internal.getEntityCode(entityTypeName).toString();dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.SelectedRecordsCount]="1";dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityName]=entityTypeName;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]=XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerId]="";dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerType]="";dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.ShowAssignToMeOption]=true;var dialogWidth,dialogHeight;if(entityTypeName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.Incident){dialogWidth=456;dialogHeight=250}else if(Xrm.Utility.isActivityType(entityTypeName)){dialogWidth=500;dialogHeight=220}else return;var dialogOptions={height:dialogHeight,width:dialogWidth,position:null};Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.AssignQueue,dialogOptions,dialogParams).then(_this.assignQueueDialogCloseCallback(null,dialogParams,[entityReference]))};this.assignSelectedRecordsLegacy=function(gridControl,selectedRecords,entityTypeCode){_this.assignSelectedRecords(gridControl,selectedRecords,Xrm.Internal.getEntityName(entityTypeCode))};this.assignSelectedRecords=function(gridControl,selectedRecords,entityName){if(Xrm.Internal.isUci()&&entityName==Xrm.Constants.EntityNames.ActivityPointer){var thisObject=_this,promise=Xrm.Utility.getEntitiesMetadata(Commands.Common.GetEntityNamesFromActivityRecords(selectedRecords));selectedRecords.length>0&&promise.then(function(values){!Commands.Common.CheckIfIsReadOnlyInMobileClient(values)&&thisObject.assignSelectedRecordsCallBack(gridControl,selectedRecords,entityName)})}else _this.assignSelectedRecordsCallBack(gridControl,selectedRecords,entityName)};this.assignSelectedRecordsCallBack=function(gridControl,selectedRecords,entityName){if(selectedRecords.length<=0){var alert_1={text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Action_NoItemSelected")};Xrm.Navigation.openAlertDialog(alert_1);return}var dialogOptions=null,assignQueue=false,setSelectedSubTypes=false,height=285,width=456;if(Xrm.Utility.isActivityType(entityName))assignQueue=true;switch(entityName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.QueueItem:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.PhoneCall:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Appointment:setSelectedSubTypes=true;assignQueue=true;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityPointer:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Email:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Fax:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Letter:setSelectedSubTypes=true;assignQueue=true;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Incident:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Task:assignQueue=true;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignResponse:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignActivity:assignQueue=true;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SLA:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ConvertRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RoutingRule:break}var dialogParams={};dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityName]=entityName;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]="";dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerId]="";dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerType]="";if(assignQueue){if(selectedRecords.length>0){dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.SelectedRecordsCount]=String(selectedRecords.length);dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records]=XrmCore.InternalUtilities.DialogUtilities.serializeSdkEntityReferences(selectedRecords);dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.ShowAssignToMeOption]=true;Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.AssignQueue,dialogOptions,dialogParams).then(_this.assignQueueDialogCloseCallback(gridControl,dialogParams,selectedRecords))}}else if(selectedRecords.length>0){var callback=_this.gridAssignDialogCloseCallback(gridControl,selectedRecords,dialogParams);dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.SelectedRecordsCount]=selectedRecords.length;Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.Assign,dialogOptions,dialogParams).then(callback)}};this.assignCloseDialog=function(eventContext){XrmCore.InternalUtilities.DialogUtilities.closeDialog(eventContext)};this.assignDialogAssignClick=function(eventContext){var formContext=eventContext.getFormContext();if(!formContext)if(Xrm.Page)formContext=Xrm.Page;else return;var ownerId="",ownerType="",assignTo=formContext.data.attributes.get("rdoMe_id"),assignToLookupControl=formContext.data.attributes.get("systemuserview_id"),disableAssignToLookupControl=assignTo.getValue();if(disableAssignToLookupControl){var selectedUser=assignToLookupControl.getValue();if(!selectedUser||selectedUser.length===0){var errorStrings=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Web._grid.cmds.dlg_assignallrecords.aspx_60");Xrm.Navigation.openAlertDialog({text:errorStrings});return}else{ownerId=selectedUser[0].id;ownerType=selectedUser[0].entityType}}else{ownerId=formContext.context.getUserId();ownerType=XrmCore.InternalUtilities.EntityUtilities.EntityNames.SystemUser}formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerId).setValue(ownerId);formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerType).setValue(ownerType);formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked).setValue(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId);formContext.ui.close()};this.assignDialogAssignToChange=function(eventContext){var formContext=eventContext.getFormContext();if(!formContext)if(Xrm.Page)formContext=Xrm.Page;else return;var assignTo=formContext.data.attributes.get("rdoMe_id"),assignToLookupControl=formContext.getControl("systemuserview_id"),disableAssignToLookupControl=assignTo.getValue(),assignButton=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId);if(assignToLookupControl&&disableAssignToLookupControl){assignToLookupControl.setDisabled(false);var lookupValue=assignToLookupControl.getAttribute().getValue();assignButton&&(!lookupValue||lookupValue.length===0)&&assignButton.setDisabled(true)}else{assignToLookupControl.setDisabled(true);assignButton&&assignButton.setDisabled(false)}};this.assignDialogOnLoad=function(eventContext){var formContext=eventContext.getFormContext();if(!formContext)if(Xrm.Page)formContext=Xrm.Page;else return;var assignTo=formContext.data.attributes.get("rdoMe_id");assignTo&&assignTo.setValue(false);var entityName="",displayName="",entityDisplaySetName="",entityAttribute=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityName);if(entityAttribute){entityName=entityAttribute.getValue();var entityCallback=function(entityMap){var entityInfo=entityMap[entityName];displayName=entityInfo.DisplayName;entityDisplaySetName=entityInfo.DisplayCollectionName;var assignHeader=formContext.getControl("assignheader_id"),headerLabel=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Assign_Title");assignHeader.setLabel(XrmCore.InternalUtilities.GenericUtilities.stringFormat(headerLabel?headerLabel:"Assign",[displayName]));var headerDescription=formContext.getControl("label_headerdescription"),selectedRecordsCount=0,recordsCount=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.SelectedRecordsCount);if(recordsCount&&recordsCount.getValue())selectedRecordsCount=recordsCount.getValue();var titleDescription="";if(selectedRecordsCount===1){var singularDescription=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Assign_DescriptionSingular");titleDescription=XrmCore.InternalUtilities.GenericUtilities.stringFormat(singularDescription?singularDescription:" ",[selectedRecordsCount,displayName])}else if(selectedRecordsCount>1){var pluralDescription=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Assign_DescriptionPlural");titleDescription=XrmCore.InternalUtilities.GenericUtilities.stringFormat(pluralDescription?pluralDescription:" ",[selectedRecordsCount,entityDisplaySetName])}headerDescription.setLabel(titleDescription);_this.assignDialogAssignToChange(eventContext)};XrmCore.InternalUtilities.GenericUtilities.createChainedEntityMetadataMapWithCallback([entityName],0,{},entityCallback)}};this.assignDialogSystemUserChange=function(eventContext){var formContext=eventContext.getFormContext();if(!formContext)if(Xrm.Page)formContext=Xrm.Page;else return;var assignToLookupAttribute=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.SystemUserViewId);if(assignToLookupAttribute){var selectedItems=assignToLookupAttribute.getValue(),assignButton=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId);if(!assignButton)return;if(!selectedItems||selectedItems.length===0)assignButton.setDisabled(true);else assignButton.setDisabled(false)}};this.gridAssignDialogCloseCallback=function(gridControl,records,dialogParams){var assignMultiple=_this.assignMultipleRecords;return function(dialogResponse){if(dialogResponse&&dialogResponse.parameters&&dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId){var ownerId=dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerId].toString(),ownerType=dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerType].toString();if(XrmCore.InternalUtilities.DialogUtilities.isOffline()){XrmCore.InternalUtilities.DialogUtilities.showOfflineError();return}if(ownerId&&ownerType){XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();if(records.length===1){var assignRequest=new XrmCore.SdkContracts.AssignRequest;assignRequest.Target=XrmCore.InternalUtilities.GenericUtilities.ConvertEntityRefToLookUp(records[0]);assignRequest.Assignee={entityType:ownerType,id:ownerId};Xrm.WebApi.online.execute(assignRequest).then(function(response){Xrm.Utility.closeProgressIndicator();gridControl&&gridControl.refresh()},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)}else assignMultiple(ownerId,ownerType,gridControl,records)}}}};this.assignDialogCloseCallback=function(dialogParams){var shouldSaveBeforeAssigning=_this.shouldSaveBeforeAssigning;return function(dialogResponse){if(dialogResponse&&dialogResponse.parameters&&dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId){var ownerId_1=dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerId].toString(),ownerType_1=dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerType].toString(),entityName_1=dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityName].toString(),entityId_1=dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityId].toString();if(Xrm.Utility.getGlobalContext().client.getClientState()===Xrm.Constants.ClientStates.offline){XrmCore.InternalUtilities.DialogUtilities.showOfflineError();return}if(shouldSaveBeforeAssigning(entityName_1)){var saveOptions={useSchedulingEngine:false,saveMode:47};XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();Xrm.Page.data.save(saveOptions).then(function(success){var assignRequest=new XrmCore.SdkContracts.AssignRequest;assignRequest.Target={entityType:entityName_1,id:entityId_1};assignRequest.Assignee={entityType:ownerType_1,id:ownerId_1};Xrm.WebApi.online.execute(assignRequest).then(function(response){Xrm.Utility.closeProgressIndicator();Xrm.Page.data.refresh()},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)}else{var assignRequest=new XrmCore.SdkContracts.AssignRequest;assignRequest.Target={entityType:entityName_1,id:entityId_1};assignRequest.Assignee={entityType:ownerType_1,id:ownerId_1};XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();Xrm.WebApi.online.execute(assignRequest).then(function(response){Xrm.Utility.closeProgressIndicator();Xrm.Page.data.refresh()},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)}}}};this.shouldSaveBeforeAssigning=function(entityName){if(Xrm.Utility.getGlobalContext().client.getClient()!==Xrm.Constants.ClientNames.mobile||Xrm.Page.data.entity.getIsDirty())return true;return entityName!==XrmCore.InternalUtilities.EntityUtilities.EntityNames.Quote&&entityName!==XrmCore.InternalUtilities.EntityUtilities.EntityNames.QuoteDetail&&entityName!==XrmCore.InternalUtilities.EntityUtilities.EntityNames.SalesOrder&&entityName!==XrmCore.InternalUtilities.EntityUtilities.EntityNames.SalesOrderDetail&&entityName!==XrmCore.InternalUtilities.EntityUtilities.EntityNames.Invoice&&entityName!==XrmCore.InternalUtilities.EntityUtilities.EntityNames.InvoiceDetail}}AssignLibrary.prototype.assignQueueDialogCloseCallback=function(gridControl,dialogParams,records){var assignMultiple=this.assignMultipleRecords;return function(dialogResponse){if(dialogResponse&&dialogResponse.parameters&&dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]&&dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId){var ownerId_2=dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerId].toString(),ownerType_2=dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OwnerType].toString();if(ownerId_2&&ownerType_2){XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();var updatedGridControl=null;if(dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.GridControl])updatedGridControl=dialogResponse.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.GridControl];else updatedGridControl=gridControl;if(Xrm.Utility.getGlobalContext().client.getClientState()===Xrm.Constants.ClientStates.offline){XrmCore.InternalUtilities.DialogUtilities.showOfflineError();return}Xrm.Utility.getEntityMetadata(ownerType_2).then(function(metadata){if(records.length===1){var assignRequest=new XrmCore.SdkContracts.AssignRequest;assignRequest.Target=XrmCore.InternalUtilities.GenericUtilities.ConvertEntityRefToLookUp(records[0]);assignRequest.Assignee={entityType:ownerType_2,id:ownerId_2};Xrm.WebApi.online.execute(assignRequest).then(function(response){Xrm.Utility.closeProgressIndicator();gridControl&&gridControl.refresh();Xrm.Page.data&&Xrm.Page.data.refresh()},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)}else assignMultiple(ownerId_2,ownerType_2,gridControl,records)})}}}};AssignLibrary.prototype.assignMultipleRecords=function(ownerId,ownerType,gridControl,records){var assignBatch=records.map(function(record){var assignRequest=new XrmCore.SdkContracts.AssignRequest;assignRequest.Target=XrmCore.InternalUtilities.GenericUtilities.ConvertEntityRefToLookUp(record);assignRequest.Assignee={entityType:ownerType,id:ownerId};return assignRequest});Xrm.WebApi.online.executeMultiple(assignBatch).then(function(success){Xrm.Utility.closeProgressIndicator();XrmCore.InternalUtilities.DialogUtilities.onGridActionMultipleSuccess(gridControl,success)},function(error){gridControl.refresh();Xrm.Utility.closeProgressIndicator();XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)})};return AssignLibrary}();Commands.AssignLibrary=AssignLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Assign=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.AssignLibrary:new Commands.AssignLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var CloseLibraryLegacy=function(){function CloseLibraryLegacy(){this.closeActivityFromGrid=function(gridControl,records){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);if(Mscrm&&Mscrm.GridRibbonActions&&Mscrm.GridRibbonActions.addActivityFromGrid)Mscrm.GridCommandActions.closeActivityFromGrid(gridControl,records);else backCompatHeader.Mscrm.GridCommandActions.closeActivityFromGrid(gridControl,records)};this.closeActivityFromGridLegacy=function(gridControl,records){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);if(Mscrm&&Mscrm.GridRibbonActions&&Mscrm.GridRibbonActions.addActivityFromGrid)Mscrm.GridCommandActions.closeActivityFromGrid(gridControl,records);else backCompatHeader.Mscrm.GridCommandActions.closeActivityFromGrid(gridControl,records)}}return CloseLibraryLegacy}();Commands.CloseLibraryLegacy=CloseLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var CloseLibrary=function(){function CloseLibrary(){this.CloseActivity=function(entityId,entityName){Commands.Common.handleStateChangeAction(entityName,entityId,false)};this.closeActivityFromGrid=function(gridControl,records){for(var _i=0,records_1=records;_i<records_1.length;_i++){var entity=records_1[_i];Commands.Common.handleStateChangeAction(entity.TypeName,entity.Id,false,gridControl)}}}return CloseLibrary}();Commands.CloseLibrary=CloseLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Close=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.CloseLibrary:new Commands.CloseLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var ChangeStateLibraryLegacy=function(){function ChangeStateLibraryLegacy(){}ChangeStateLibraryLegacy.prototype.changeState=function(action,objectType,formEventId,objectSubtype){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.FormAction?Mscrm.FormAction.changeState(action,objectType,formEventId,objectSubtype):backCompatHeader.Mscrm.FormAction.changeState(action,objectType,formEventId,objectSubtype)};ChangeStateLibraryLegacy.prototype.deactivateClick=function(){Commands.Common.deactivateClickLegacy()};ChangeStateLibraryLegacy.prototype.onLoadSetState=function(){Commands.Common.onLoadSetStateLegacy()};ChangeStateLibraryLegacy.prototype.onStateChange=function(){Commands.Common.onStateChangeLegacy()};ChangeStateLibraryLegacy.prototype.changeStateCloseDialog=function(){Commands.Common.closeDialogLegacy()};return ChangeStateLibraryLegacy}();Commands.ChangeStateLibraryLegacy=ChangeStateLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var ChangeStateLibrary=function(){function ChangeStateLibrary(){}ChangeStateLibrary.prototype.changeState=function(action,objectType,formEventId,objectSubtype){var activate;switch(action){case "activate":activate=true;break;case "deactivate":activate=false;break;default:return}var id=Xrm.Page.data.entity.getId(),entityName=Xrm.Page.data.entity.getEntityName();Commands.Common.changeState(entityName,id,activate)};ChangeStateLibrary.prototype.changeStateCloseDialog=function(eventContext){XrmCore.InternalUtilities.DialogUtilities.closeDialog(eventContext)};ChangeStateLibrary.prototype.onLoadSetState=function(eventContext){Commands.Common.onLoadSetState(eventContext)};ChangeStateLibrary.prototype.onStateChange=function(eventContext){Commands.Common.onStateChange(eventContext)};ChangeStateLibrary.prototype.deactivateClick=function(eventContext){Commands.Common.deactivateClick(eventContext)};return ChangeStateLibrary}();Commands.ChangeStateLibrary=ChangeStateLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.ChangeState=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.ChangeStateLibrary:new Commands.ChangeStateLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var Common=function(){function Common(){}Common.changeState=function(entityType,id,activate){Common.handleStateChangeAction(entityType,id,activate)};Common.handleStateChangeAction=function(entityName,id,activate,gridControl){var options=null,client=Xrm.Utility.getGlobalContext().client.getClient();if(client===Xrm.Constants.ClientNames.web||client==Xrm.Constants.ClientNames.outlook||client==Xrm.Constants.ClientNames.unifiedServiceDesk)options={height:250,width:600,position:1};var dialogArguments={};dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.action]=activate?XrmCore.InternalUtilities.DialogUtilities.DialogConstants.activate:XrmCore.InternalUtilities.DialogUtilities.DialogConstants.deactivate;dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]="";dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StateId]=-1;dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StatusId]=-1;var records=[{TypeName:entityName,Id:id}];dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records]=records;Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.SetStateDialog,options,dialogArguments).then(function(successParameter){if(successParameter&&successParameter.parameters&&successParameter.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId){var state_3=successParameter.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StateId],status_1=successParameter.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StatusId];XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();if(gridControl)Common.SetEntityState(entityName,id,Number(state_3),Number(status_1)).then(function(successParameter){Xrm.Utility.closeProgressIndicator();gridControl.refresh();gridControl.refreshRibbon()},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog);else Xrm.Page.data.save({saveMode:activate?6:5}).then(function(successParameter){Common.SetEntityState(entityName,id,Number(state_3),Number(status_1)).then(function(successParameter){Xrm.Utility.closeProgressIndicator();Common.performPageRefresh(entityName,false)},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)}})};Common.SetEntityState=function(entityType,id,state,status){var entity={};entity["statecode"]=state;if(status||status===0)entity["statuscode"]=status;else entity["statuscode"]=-1;return Xrm.WebApi.updateRecord(entityType,id,entity)};Common.gridCommandDialogCloseCallback=function(_gridControl){return function(callbackParams){var constants=XrmCore.InternalUtilities.DialogUtilities.DialogConstants,gridControl=callbackParams.parameters[constants.GridControl]?callbackParams.parameters[constants.GridControl]:_gridControl;gridControl&&gridControl.refresh&&callbackParams.parameters[constants.LastButtonClicked]&&callbackParams.parameters[constants.LastButtonClicked]===constants.DialogOkId&&gridControl.refresh()}};Common.closeSetStateDialogFromGridCallback=function(dialogParams,callbackParams,gridControl,callback){if(dialogParams&&dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId){var records=dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records],selectedState_1=dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StateId],selectedStatus_1=dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StatusId];XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();if(records.length===1){var entityName=records[0].TypeName,entityId=records[0].Id;Common.SetEntityState(entityName,entityId,selectedState_1,selectedStatus_1).then(function(successParameter){Xrm.Utility.closeProgressIndicator();gridControl&&gridControl.refresh();callback&&callback()},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)}else{var setStateRequests=records.map(function(record){return new XrmCore.SdkContracts.SetStateRequest(record.Id,record.TypeName,selectedState_1,selectedStatus_1)});Xrm.WebApi.online.executeMultiple(setStateRequests).then(function(success){Xrm.Utility.closeProgressIndicator();if(success.every(function(response){return response.ok})){gridControl.refresh();callback&&callback()}else{Common.openAlertDialogForSetStateMultipleError(gridControl);gridControl.refresh()}},function(error){Xrm.Utility.closeProgressIndicator();Common.openAlertDialogForSetStateMultipleError(gridControl);gridControl.refresh()})}}};Common.openAlertDialogForSetStateMultipleError=function(gridControl){var alertDialogStrings={text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Action_MultipleErrorsFound")};Xrm.Navigation.openAlertDialog(alertDialogStrings).then(function(successParameter){gridControl.refresh()})};Common.setState=function(entityId,entityName,stateCode,statusCode,closeWindow,entityToOpen,entityIdToOpen,saveMode){if(Xrm.Page.data.entity.getId()===null||Xrm.Page.data.entity.getId()===undefined||!Xrm.Page.data.isValid())return;if(!statusCode&&statusCode!==0)statusCode=-1;else if(stateCode===-1){Xrm.Utility.getEntityMetadata(entityName,["statuscode"]).then(function(entityMetadata){var statusMetadata=entityMetadata.Attributes.get("statuscode"),stateCode=statusMetadata.getState(statusCode);Common.setStateInternal(entityId,entityName,stateCode,statusCode,closeWindow,entityToOpen,entityIdToOpen)},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog);return}Common.setStateInternal(entityId,entityName,stateCode,statusCode,closeWindow,entityToOpen,entityIdToOpen,saveMode)};Common.setStateInternal=function(entityId,entityName,stateCode,statusCode,closeWindow,entityToOpen,entityIdToOpen,saveMode){if(!Common.isBusy){Common.isBusy=true;var saveOptions={useSchedulingEngine:false};if(saveMode)saveOptions.saveMode=saveMode;Xrm.Page.data.save(saveOptions).then(function(successParameter){Common.setStateUpdate(entityId,entityName,stateCode,statusCode,closeWindow,entityToOpen,entityIdToOpen)},function(error){Common.isBusy=false;XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)})}};Common.setStateUpdate=function(entityId,entityName,stateCode,statusCode,closeWindow,entityToOpen,entityIdToOpen){if(!entityId||!entityId.length)entityId=Xrm.Page.data.entity.getId();Common.SetEntityState(entityName,entityId,stateCode,statusCode).then(function(setStateResponse){Common.postSetState(entityId,entityName,closeWindow,entityToOpen,entityIdToOpen)},function(error){Common.isBusy=false;XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)})};Common.postSetState=function(entityId,entityName,closeWindow,entityToOpen,entityIdToOpen){if(closeWindow){if(entityToOpen&&entityIdToOpen)Xrm.Utility.openEntityForm(entityToOpen,entityIdToOpen,null);else Xrm.Utility.getEntityMetadata(entityName).then(function(successParameter){var interactionCentric=successParameter.IsInteractionCentricEnabled,oneCount=false;if(!interactionCentric&&oneCount)Xrm.Page.data.refresh(true);else{Common.refreshParentGrid(entityId,entityName);Xrm.Page.ui.close()}},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog);Common.isBusy=false;return}if(entityToOpen&&entityIdToOpen)Xrm.Utility.openEntityForm(entityToOpen,entityIdToOpen,null);else{Xrm.Page.data.refresh(true);Common.refreshParentGrid(entityId,entityName);Common.performPageRefresh(entityName,true)}Common.isBusy=false};Common.refreshParentGrid=function(id,entityName){if(entityName);};Common.performPageRefresh=function(entityName,shouldSaveAndRefresh){Xrm.Utility.getEntityMetadata(entityName).then(function(successParameter){if(successParameter.IsInteractionCentricEnabled)if(shouldSaveAndRefresh)Xrm.Page.data.save().then(function(successParameter){Common.performPageDataAndRibbonRefresh()},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog);else Common.performPageDataAndRibbonRefresh();else Xrm.Page.data.refresh(true)},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)};Common.performPageDataAndRibbonRefresh=function(){Xrm.Page.data.refresh(true).then(function(successParameter){Xrm.Page.ui.refreshRibbon()},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)};Common.deactivateClick=function(eventContext){if(XrmCore.InternalUtilities.DialogUtilities.isOffline()){XrmCore.InternalUtilities.DialogUtilities.showOfflineError();return}XrmCore.InternalUtilities.DialogUtilities.setLastButtonClicked(eventContext,XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId);var formContext=eventContext.getFormContext();formContext.ui.close()};Common.onLoadSetState=function(eventContext){var formContext=eventContext.getFormContext();if(!formContext)if(Xrm.Page)formContext=Xrm.Page;else throw new Error("No Client API frame can be found");if(XrmCore.InternalUtilities.DialogUtilities.isOffline()){XrmCore.InternalUtilities.DialogUtilities.showOfflineError();formContext.ui.close();return}var actionName=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.action).getValue(),records=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records).getValue();if(!records||records.length===0)return;var entityName=records[0].TypeName,entityDisplayName="",entityDisplaySetName="",entityCallback=function(entityMap){var entityInfo=entityMap[entityName];entityDisplayName=entityInfo.DisplayName;entityDisplaySetName=entityInfo.DisplayCollectionName;Common.setLabelsForDeactivateDialog(formContext,entityName,entityDisplayName,entityDisplaySetName,records.length,actionName);if(!entityInfo.EnforceStateTransitions){Common.loadStates(formContext,entityName,actionName);return}var _failedCallback=function(recordId,entityName,functionName,errorResponse){throw new Error("Function: onLoadSetState: Retrieve record "+recordId+" from "+entityName+" failed from the Client API "+functionName)};Xrm.WebApi.online.retrieveRecord(entityName,records[0].Id).then(function(recordData){var statusCode=recordData["statuscode"];Xrm.Utility.getAllowedStatusTransitions(entityName,statusCode).then(function(allowedTransitions){if(!allowedTransitions||allowedTransitions.length===0)Common.setNoTransitionsWarning(formContext);else{formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.allowedTransitions).setValue(allowedTransitions);Common.setLabelsForDeactivateDialog(formContext,entityName,entityDisplayName,entityDisplaySetName,records.length,actionName);Common.loadStates(formContext,entityName,actionName)}},function(errorResponse){_failedCallback(records[0].Id,entityName,"Xrm.Utility.getAllowedStatusTransitions",errorResponse)})},function(errorResponse){_failedCallback(records[0].Id,entityName,"Xrm.WebApi.online.retrieveRecord",errorResponse)})};XrmCore.InternalUtilities.GenericUtilities.createChainedEntityMetadataMapWithCallback([entityName],0,{},entityCallback)};Common.setNoTransitionsWarning=function(formContext){var headerControl=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.HeaderTitleId),descriptionControl=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DescriptionId),okButtonControl=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId),cancelButtonControl=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogCancelId);headerControl!==undefined&&headerControl!==null&&headerControl.setLabel(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Web._grid.cmds.dlg_deactivate.aspx_200_Activate_warning_Title"));descriptionControl.setLabel("");okButtonControl.setLabel(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_OK")?"OK":"OK");okButtonControl.setVisible(false);cancelButtonControl.setLabel(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_OK")?XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_OK"):"OK");cancelButtonControl.setVisible(true);var action=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.action).getValue(),messageToDisplay=action===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.activate?"Web._grid.cmds.dlg_deactivate.aspx_200_Activate_warning":"Web._grid.cmds.dlg_deactivate.aspx_200_Deactivate_warning";formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.MessageId).setLabel(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString(messageToDisplay))};Common.onActionMenuClickLegacy=function(action,entityTypeCode,objectSubtype,callbackArgumentRef){return Common.onActionMenuClick(action,Xrm.Internal.getEntityName(entityTypeCode),objectSubtype,callbackArgumentRef)};Common.onActionMenuClick=function(action,entityName,objectSubtype,callbackArgumentRef){if(Xrm.Internal.isUci&&Xrm.Internal.isUci()){var clickContext={};clickContext["action"]=action;clickContext["objectType"]=Xrm.Internal.getEntityCode(entityName);clickContext["objectSubtype"]=objectSubtype;clickContext["callbackArgumentRef"]=callbackArgumentRef;return Common.handleActionMenuClick(clickContext)}else{var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),entityTypeCode=Xrm.Internal.getEntityCode(entityName);return Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.onActionMenuClick(action,entityTypeCode,objectSubtype,callbackArgumentRef):backCompatHeader.Mscrm.CommandBarActions.onActionMenuClick(action,entityTypeCode,objectSubtype,callbackArgumentRef)}};Common.handleActionMenuClick=function(clickContext){var action=null,objectType=null,objectTypeName=null,objectSubtype=null,callbackArgumentRef=null,recordId=null;if("action" in clickContext)action=clickContext["action"];if("objectType" in clickContext){objectTypeName=Xrm.Internal.getEntityName(clickContext["objectType"]);objectType=clickContext["objectType"]}if("objectSubtype" in clickContext)objectSubtype=clickContext["objectSubtype"];if("callbackArgumentRef" in clickContext)callbackArgumentRef=clickContext["callbackArgumentRef"];if("recordId" in clickContext)recordId=clickContext["recordId"];if(typeof objectType!=="number")objectType=parseInt(objectType,10);var x=400,y=200,close=false,reload=false,result=null,firstResult=null,callbackRef=null,isDialogInline=false,id=null;if(recordId)id=recordId;else id=Xrm.Page.data.entity.getId();var ids=[id],url=Xrm.Utility.getGlobalContext().prependOrgName("/_grid/cmds/dlg_");url=url.concat(encodeURIComponent(action.toString()),".aspx?dType=1");url=url.concat("&iObjType=",encodeURIComponent(objectType.toString()));url=url.concat("&iTotal=",encodeURIComponent("1"));url=url.concat("&sIds=",encodeURIComponent(id.toString()));if(objectSubtype!=null)url=url.concat("&iObjSubType=",encodeURIComponent(objectSubtype));switch(action){case "share":x=800;y=480;isDialogInline=true;break}if(action!=="delete")if(!callbackRef)firstResult=Common.handleCallbackFunction(result,url,action,objectType,ids,x,y,close,reload,id,callbackArgumentRef,isDialogInline);return firstResult};Common.handleCallbackFunction=function(result,url,action,objectType,ids,width,height,close,reload,id,callbackArgumentRef,isDialogInline){var parameters=null;parameters=[action,objectType,close,reload,id,callbackArgumentRef];var option={position:1,width:width,height:height},callbackFunction=Common.createCallbackFunctionFactory(Common.performActionAfterSwitch,parameters);Common.appendAppIdAndOpenLegacyWebDialog(url.toString(),option,ids,callbackFunction);return result};Common.performActionAfterSwitch=function(result,action,objectType,close,reload,id,callbackArgumentRef){callbackArgumentRef!=null&&Common.executeFunction(callbackArgumentRef,result);return result};Common.executeFunction=function(callbackReference,value){if(callbackReference==null)return null};Common.setLabelsForDeactivateDialog=function(formContext,entityName,entitySingularDisplayName,entityPluralDisplayName,total,action){var entityDisplayName="";if(total===1)entityDisplayName=entitySingularDisplayName;else entityDisplayName=entityPluralDisplayName;var titleControlName=XrmCore.InternalUtilities.DialogUtilities.DialogConstants.TitleId,descriptionLabelName=XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DescriptionId,messageLabelName=XrmCore.InternalUtilities.DialogUtilities.DialogConstants.MessageId,dialogOkControlName=XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId,deactivateTitle=null,deactivateDescription=null,deactivateMessageLabel=null,deactivateOkLabel=null;if(action===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.deactivate)switch(entityName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Account:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contact:deactivateTitle=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Grid_Deactivate_Title");deactivateDescription=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Deactivate_Description");deactivateMessageLabel=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Web._grid.cmds.dlg_deactivate.aspx_102_Title");deactivateOkLabel=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Deactivate");formContext.getControl(titleControlName).setLabel(deactivateTitle?deactivateTitle:"Deactivate");formContext.getControl(descriptionLabelName).setLabel(deactivateDescription?XrmCore.InternalUtilities.GenericUtilities.stringFormat(deactivateDescription,[total,entityDisplayName]):"Dialog_Deactivate_Description "+total+" "+entityDisplayName+"?");formContext.getControl(messageLabelName).setLabel(messageLabelName?XrmCore.InternalUtilities.GenericUtilities.stringFormat(deactivateMessageLabel,[entityDisplayName]):"Web._grid.cmds.dlg_deactivate.aspx_102_Title");formContext.getControl(dialogOkControlName).setLabel(deactivateOkLabel?XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Deactivate"):"Deactivate");break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ExternalParty:if(total==1);break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ExternalPartyItem:if(total==1);break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TopicModel:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SyncError:deactivateTitle=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Grid_Deactivate_Title");deactivateDescription=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Deactivate_Description");deactivateMessageLabel=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("SyncError.Dialog.Deactivate.Messsage.Text");deactivateOkLabel=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Deactivate");formContext.getControl(titleControlName).setLabel(deactivateTitle?deactivateTitle:"Deactivate");formContext.getControl(descriptionLabelName).setLabel(deactivateDescription?XrmCore.InternalUtilities.GenericUtilities.stringFormat(deactivateDescription,[total,entityDisplayName]):"Dialog_Deactivate_Description "+total+" "+entityDisplayName+"?");formContext.getControl(messageLabelName).setLabel(messageLabelName?XrmCore.InternalUtilities.GenericUtilities.stringFormat(deactivateMessageLabel,[entityDisplayName]):"SyncError.Dialog.Deactivate.Messsage.Text");formContext.getControl(dialogOkControlName).setLabel(deactivateOkLabel?XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Deactivate"):"Deactivate");break;default:if(Xrm.Utility.isActivityType(entityName)){var closeActivityTitle=XrmCore.InternalUtilities.GenericUtilities.stringFormat(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Close_Activity_Title"),[entityDisplayName]),closeActivityDescription=XrmCore.InternalUtilities.GenericUtilities.stringFormat(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Close_Activity_Description"),[total,entityDisplayName]),closeActivityMessage=XrmCore.InternalUtilities.GenericUtilities.stringFormat(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Web._grid.cmds.dlg_deactivate.aspx_85"),[entityDisplayName]),closeButtonText=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Close"),dialogTitle=XrmCore.InternalUtilities.GenericUtilities.stringFormat(closeActivityTitle,[entityDisplayName]);formContext.getControl(titleControlName).setLabel(dialogTitle?dialogTitle:"Dialog_Close_Activity_Title");formContext.getControl(descriptionLabelName).setLabel(closeActivityDescription?closeActivityDescription:"Dialog_Close_Activity_Description");formContext.getControl(messageLabelName).setLabel(closeActivityMessage?closeActivityMessage:"Web._grid.cmds.dlg_deactivate.aspx_85");formContext.getControl(dialogOkControlName).setLabel(closeButtonText?closeButtonText:"Button_Label_Close")}else{deactivateTitle=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Grid_Deactivate_Title");deactivateDescription=XrmCore.InternalUtilities.GenericUtilities.stringFormat(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Deactivate_Description"),[total,entityDisplayName]);deactivateMessageLabel=XrmCore.InternalUtilities.GenericUtilities.stringFormat(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Web._grid.cmds.dlg_deactivate.aspx_55"),[entityDisplayName]);deactivateOkLabel=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Deactivate");formContext.getControl(titleControlName).setLabel(deactivateTitle?deactivateTitle:"Dialog_Grid_Deactivate_Title");formContext.getControl(descriptionLabelName).setLabel(deactivateDescription?deactivateDescription:"");formContext.getControl(messageLabelName).setLabel(deactivateMessageLabel?deactivateMessageLabel:"");formContext.getControl(dialogOkControlName).setLabel(deactivateOkLabel?deactivateOkLabel:"Button_Label_Deactivate")}break}else{var statusString=null,activateTitle=null,activateDescription=null,activateMessage=null,activateButtonText=null;switch(entityName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ExternalParty:if(total==1);break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ExternalPartyItem:if(total==1);break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ConvertRule:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ConvertRuleItem:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RecommendationModel:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RoutingRule:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TopicModel:break;default:var statusString_1=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Label_Active"),activateTitle_1=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Activate_Title"),activateDescription_1=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_Activate_Description_Activate"),activateMessage_1=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Web._grid.cmds.dlg_activate.aspx_55"),activateButtonText_1=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Activate");formContext.getControl(titleControlName).setLabel(XrmCore.InternalUtilities.GenericUtilities.stringFormat(activateTitle_1,[entityDisplayName]));formContext.getControl(descriptionLabelName).setLabel(XrmCore.InternalUtilities.GenericUtilities.stringFormat(activateDescription_1,[total,entityDisplayName]));formContext.getControl(messageLabelName).setLabel(XrmCore.InternalUtilities.GenericUtilities.stringFormat(activateMessage_1,[entityDisplayName,statusString_1]));formContext.getControl(dialogOkControlName).setLabel(activateButtonText_1?activateButtonText_1:"Button_Label_Activate");break}}formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId).setVisible(true);formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogCancelId).setVisible(true)};Common.loadStates=function(formContext,entityName,action){Xrm.Utility.getEntityMetadata(entityName,["statecode"]).then(function(entityMetadata){var stateMetadata=entityMetadata.Attributes.get("statecode"),stateCodeControl=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StateId);stateCodeControl.clearOptions();var defaultState;if(Xrm.Utility.isActivityType(entityName)&&action===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.deactivate){var valueList=Object.keys(stateMetadata.OptionSet);valueList.forEach(function(key){var stateCode=stateMetadata.OptionSet[key].value;(stateCode===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Completed||stateCode===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Canceled)&&stateCodeControl.addOption({text:stateMetadata.OptionSet[key].text,value:stateCode})});var defaultCloseState=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.defaultCloseState).getValue();defaultState=defaultCloseState?defaultCloseState:XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Completed;stateCodeControl.setVisible(true);stateCodeControl.getAttribute().setValue(defaultState)}else{stateCodeControl.setVisible(false);defaultState=XrmCore.InternalUtilities.EntityUtilities.isStateCodeReversed(entityName)?action===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.activate?XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Inactive:XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Active:action===XrmCore.InternalUtilities.DialogUtilities.DialogConstants.activate?XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Active:XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Inactive;var valueList=Object.keys(stateMetadata.OptionSet);valueList.forEach(function(key){var stateCode=stateMetadata.OptionSet[key].value;stateCode===defaultState&&stateCodeControl.addOption({text:stateMetadata.OptionSet[key].text,value:stateCode})});stateCodeControl.getAttribute().setValue(defaultState)}var defaultStatus=stateMetadata.getDefaultStatus(defaultState);Common.loadStatusOptions(formContext,entityName,defaultState,defaultStatus)},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)};Common.loadStatusOptions=function(formContext,entityName,selectedState,defaultStatusCode){if(XrmCore.InternalUtilities.DialogUtilities.isOffline()){XrmCore.InternalUtilities.DialogUtilities.showOfflineError();return}var statusCodeControl=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StatusId),statusCodeOptionSet=statusCodeControl.getAttribute();statusCodeControl.clearOptions();statusCodeControl.setVisible(false);Xrm.Utility.getEntityMetadata(entityName,["statuscode"]).then(function(entityMetadata){var statusMetadata=entityMetadata.Attributes.get("statuscode"),allowedTransitions=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.allowedTransitions).getValue(),total=0,valueList=Object.keys(statusMetadata.OptionSet);valueList.forEach(function(key){var statusCode=statusMetadata.OptionSet[key].value,rawState=statusMetadata.getState(statusCode);if(rawState===selectedState)if(!allowedTransitions||allowedTransitions.indexOf(statusCode)!==-1){statusCodeControl.addOption({text:statusMetadata.OptionSet[key].text,value:statusCode});total++}});if(allowedTransitions&&total>0&&allowedTransitions.indexOf(defaultStatusCode)===-1){var statusCodeOptions=statusCodeControl.getOptions();if(statusCodeOptions!==undefined&&statusCodeOptions!==null&&statusCodeOptions.length>0)for(var i=0;i<statusCodeOptions.length;i++)if(statusCodeOptions[i].value!==NaN&&statusCodeOptions[i].text!==""){defaultStatusCode=statusCodeOptions[i].value;break}}switch(total){case 0:Common.setNoTransitionsWarning(formContext);break;case 1:statusCodeOptionSet.setValue(defaultStatusCode);break;default:entityName!=="businessunit"&&statusCodeControl.setVisible(true);statusCodeOptionSet.setValue(defaultStatusCode);break}},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)};Common.onStateChange=function(eventContext){var formContext=eventContext.getFormContext();if(!formContext)if(Xrm.Page)formContext=Xrm.Page;else throw new Error("No Client API frame can be found");if(XrmCore.InternalUtilities.DialogUtilities.isOffline()){XrmCore.InternalUtilities.DialogUtilities.showOfflineError();return}var recordsAttribute=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records),records=recordsAttribute.getValue(),entityName=records[0].TypeName,stateCodeControl=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StateId),selectedState=stateCodeControl.getAttribute().getValue();if(selectedState){formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.selectedState).setValue(selectedState);Xrm.Utility.getEntityMetadata(entityName,["statecode"]).then(function(entityMetadata){var stateMetadata=entityMetadata.Attributes.get("statecode"),defaultStatusCode=stateMetadata.getDefaultStatus(selectedState);Common.loadStatusOptions(formContext,entityName,selectedState,defaultStatusCode)},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)}};Common.deactivateClickLegacy=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.deactivateClick():backCompatHeader.Mscrm.CommandBarActions.deactivateClick()};Common.closeDialogLegacy=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.InternalUtilities?Mscrm.InternalUtilities.DialogUtility.closeDialog():backCompatHeader.Mscrm.InternalUtilities.DialogUtility.closeDialog()};Common.onLoadSetStateLegacy=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.onLoadSetState():backCompatHeader.Mscrm.CommandBarActions.onLoadSetState()};Common.onStateChangeLegacy=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.onStateChange():backCompatHeader.Mscrm.CommandBarActions.onStateChange()};Common.GetEntityNamesFromActivityRecords=function(records){for(var activityEntityNames={},i=0;i<records.length;i++)if(activityEntityNames[records[i].TypeName]==undefined)activityEntityNames[records[i].TypeName]=[];return activityEntityNames};Common.CheckIfIsReadOnlyInMobileClient=function(values){for(var returnValue=false,index=0;index<values.length;index++){var value=values[index];if(value["IsReadOnlyInMobileClient"]==true){returnValue=true;break}}if(returnValue){var errorStrings={text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("ReadOnlyEntity"),confirmButtonLabel:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_OK")};Xrm.Navigation.openAlertDialog(errorStrings)}return returnValue};Common.constructAndOpenLegacyWebDialog=function(entityName,gridControl,selectedRecords,dialogFileName,dialogWidth,dialogHeight,appendGridItemIdsToUri,dialogCallbackFunction,dialogCallbackParameters){if(!dialogFileName)return;if(!gridControl||!selectedRecords||!selectedRecords.length){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Action_NoItemSelected")});return}var entityTypeCode=Xrm.Internal.getEntityCode(entityName),actionUri=Xrm.Utility.getGlobalContext().prependOrgName("/_grid/cmds/");actionUri=actionUri.concat(encodeURIComponent(dialogFileName),"?dType=1");actionUri=actionUri.concat("&iObjType=",encodeURIComponent(entityTypeCode.toString()));actionUri=actionUri.concat("&iTotal=",encodeURIComponent(selectedRecords.length.toString()));if(appendGridItemIdsToUri){var parameterToEncode=(new String).concat("{",selectedRecords[0].Id.toString(),"}");actionUri=actionUri.concat("&sIds=",encodeURIComponent(parameterToEncode));for(var i_1=1;i_1<selectedRecords.length;i_1++){parameterToEncode=(new String).concat(";{",selectedRecords[i_1].Id.toString(),"}");actionUri=actionUri.concat(encodeURIComponent(parameterToEncode))}}for(var options={position:1,width:dialogWidth,height:dialogHeight},callbackRef=Common.createCallbackFunctionFactory(dialogCallbackFunction,dialogCallbackParameters),dialogArguments=new Array(selectedRecords.length),i=0;i<selectedRecords.length;i++)dialogArguments[i]=selectedRecords[i].Id;Common.appendAppIdAndOpenLegacyWebDialog(actionUri,options,dialogArguments,callbackRef)};Common.appendAppIdAndOpenLegacyWebDialog=function(actionUri,options,dialogArguments,callbackRef){if(dialogArguments===void 0)dialogArguments=null;if(callbackRef===void 0)callbackRef=null;if(actionUri.indexOf("appid=")<0){var globalContext=Xrm.Utility.getGlobalContext();globalContext.getCurrentAppProperties().then(function(appProperties){if(appProperties["appId"])actionUri=actionUri.concat("&appid=",encodeURIComponent(appProperties["appId"]));Xrm.Internal.openLegacyWebDialog(actionUri,options,dialogArguments,null,callbackRef)},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)}else Xrm.Internal.openLegacyWebDialog(actionUri,options,dialogArguments,null,callbackRef)};Common.isBusy=false;Common.createCallbackFunctionFactory=function(func,parameters){return function(retValue){parameters.unshift(retValue);return func.apply(null,parameters)}};return Common}();Commands.Common=Common})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var DeactivateLibraryLegacy=function(){function DeactivateLibraryLegacy(){this.deactivateRecordsLegacy=function(gridControl,records,entityTypeCode,defaultCloseState){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.deactivate(gridControl,records,entityTypeCode,defaultCloseState):backCompatHeader.Mscrm.GridCommandActions.deactivate(gridControl,records,entityTypeCode,defaultCloseState)}}DeactivateLibraryLegacy.prototype.deactivatePrimaryRecord=function(id,entityName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.deactivate(id,entityName):backCompatHeader.Mscrm.CommandBarActions.deactivate(id,entityName)};DeactivateLibraryLegacy.prototype.deactivateRecords=function(gridControl,records,entityName,defaultCloseState,callback){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),entityTypeCode=Xrm.Internal.getEntityCode(entityName);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.deactivate(gridControl,records,entityTypeCode,defaultCloseState,callback):backCompatHeader.Mscrm.GridCommandActions.deactivate(gridControl,records,entityTypeCode,defaultCloseState,callback)};return DeactivateLibraryLegacy}();Commands.DeactivateLibraryLegacy=DeactivateLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var DeactivateLibrary=function(){function DeactivateLibrary(){var _this=this;this.deactivateRecordsLegacy=function(gridControl,records,entityTypeCode,defaultCloseState){if(Xrm.Internal.isUci()&&entityTypeCode==4200){var thisObject=_this,promise=Xrm.Utility.getEntitiesMetadata(Commands.Common.GetEntityNamesFromActivityRecords(records));records.length>0&&promise.then(function(values){!Commands.Common.CheckIfIsReadOnlyInMobileClient(values)&&thisObject.deactivateRecords(gridControl,records,Xrm.Internal.getEntityName(entityTypeCode),defaultCloseState)})}else _this.deactivateRecords(gridControl,records,Xrm.Internal.getEntityName(entityTypeCode),defaultCloseState)}}DeactivateLibrary.prototype.deactivatePrimaryRecord=function(id,entityName){var stateCode=1;switch(entityName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DuplicateRule:stateCode=0;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ConvertRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RoutingRule:Commands.Common.changeState(entityName,id,false);return}Xrm.Utility.getEntityMetadata(entityName,["statecode"]).then(function(entityMetadata){if(entityMetadata.EnforceStateTransitions){Commands.Common.changeState(entityName,id,false);return}var stateMetadata=entityMetadata.Attributes.get("statecode"),statusCodes=stateMetadata.getStatusValuesForState(stateCode);if(statusCodes&&statusCodes.length>0)Commands.Common.changeState(entityName,id,false);else{Xrm.Page.data.save({saveMode:5});Commands.Common.setState(id,entityName,stateCode)}},function(errorParameter){XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(errorParameter)})};DeactivateLibrary.prototype.deactivateRecords=function(gridControl,records,entityName,defaultCloseState,callback){if(!records.length){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Action_NoItemSelected")});return}Xrm.Utility.getEntityMetadata(entityName).then(function(entityMetadata){if(entityMetadata.IsInteractionCentricEnabled)for(var logicalName=records[0].TypeName,i=1;i<records.length;i++)if(records[i].TypeName===logicalName)continue;else{Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Grid_Apply_Rule_Heterogenous_Activity_Type_Records_Selected")});return}var options={position:1,width:600,height:250};switch(entityName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.BusinessUnit:options.width=650;options.height=280;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DiscountType:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Account:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contact:options.height=200;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignActivity:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignResponse:options.height=250;options.width=400;break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityPointer:for(var record=records[0],i=1;i<records.length;i++)if(records[i].TypeName!==record.TypeName){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Grid_Apply_Rule_Heterogenous_Activity_Type_Records_Selected")});return}switch(record.TypeName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SocialActivity:Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Grid_Apply_Rule_Social_Activity_Type_Records_Selected_For_Invalid_Action")});return;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Email:Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Grid_Apply_Rule_Selected_Emails")});return;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignResponse:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignActivity:if(defaultCloseState===1){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Grid_Apply_Rule_Selected_Records")});return}break}entityName=record.TypeName;break}DeactivateLibrary.openDialog(gridControl,records,entityName,defaultCloseState,callback,options)},function(errorParameter){XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(errorParameter)})};DeactivateLibrary.openDialog=function(gridControl,records,entityName,defaultCloseState,callback,options){for(var i=0;i<records.length;i++){var resourceString=null;switch(records[i].TypeName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SocialActivity:resourceString="Grid_Apply_Rule_Social_Activity_Type_Records_Selected_For_Invalid_Action";break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Email:resourceString="Grid_Apply_Rule_Selected_Emails";break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignResponse:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignActivity:if(defaultCloseState===1)resourceString="Grid_Apply_Rule_Selected_Records";break}if(resourceString!=null){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString(resourceString)});return}}var dialogArguments={};dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records]=records;dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.action]=XrmCore.InternalUtilities.DialogUtilities.DialogConstants.deactivate;dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked]="";dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StateId]=-1;dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.StatusId]=-1;if((defaultCloseState||defaultCloseState===0)&&defaultCloseState!==-1)dialogArguments[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.defaultCloseState]=defaultCloseState;var client=Xrm.Utility.getGlobalContext().client.getClient();if(client===Xrm.Constants.ClientNames.web||client==Xrm.Constants.ClientNames.outlook||client==Xrm.Constants.ClientNames.unifiedServiceDesk)options={position:1,width:600,height:250};Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.SetStateDialog,options,dialogArguments).then(function(successParameter){var dialogCallbackParams={};Commands.Common.closeSetStateDialogFromGridCallback(successParameter.parameters,dialogCallbackParams,gridControl,callback)})};return DeactivateLibrary}();Commands.DeactivateLibrary=DeactivateLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Deactivate=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.DeactivateLibrary:new Commands.DeactivateLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var DeleteLibrary=function(){function DeleteLibrary(){var _this=this;this.deletePrimaryRecord=function(id,entityName){var dialogstrings={title:"",subtitle:"",text:"",confirmButtonLabel:"",cancelButtonLabel:""},url={},dialogOptions=null;Xrm.Utility.getEntityMetadata(entityName).then(function(metadata){switch(entityName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RecurringAppointmentMaster:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Appointment:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Account:dialogOptions=_this.GetDialogOptions(450,275,1);break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TopicModel:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contact:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DynamicProperty:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OpportunityProduct:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.QuoteDetail:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SalesOrderDetail:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.InvoiceDetail:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Queue:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SharePointSite:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Workflow:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Product:break;default:break}XrmCore.InternalUtilities.DialogUtilities.tryGetDialogStringsForEnabledMetadataDialogs(XrmCore.InternalUtilities.DialogUtilities.DialogName.DeleteDialog,dialogstrings,entityName,1,url,metadata.DisplayName,metadata.DisplayCollectionName,metadata.IsDocumentManagementEnabled,true);Xrm.Navigation.openConfirmDialog(dialogstrings,dialogOptions).then(function(result){if(result.confirmed){XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();Xrm.WebApi.deleteRecord(entityName,id).then(function(success){Xrm.Utility.closeProgressIndicator();if(success&&success.entityType&&success.id&&success.name)if(Xrm.Page.data.attributes["IsInteractionWallQuickAction"]&&Xrm.Page.data.attributes["IsInteractionWallQuickAction"].fireOnChange)Xrm.Page.data.attributes["IsInteractionWallQuickAction"].fireOnChange;else Xrm.Page.ui.close();else Xrm.Page.ui.close()},function(error){Xrm.Utility.closeProgressIndicator();XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)})}})})};this.deleteRecordsLegacy=function(gridControl,records,entityTypeCode){_this.deleteRecords(gridControl,records,Xrm.Internal.getEntityName(entityTypeCode))};this.deleteRecords=function(gridControl,records,entityTypeName){var actionUri={};if(records.length<=0){var alert={text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Action_NoItemSelected")};Xrm.Navigation.openAlertDialog(alert);return}var dialogstrings={title:"",subtitle:"",text:"",confirmButtonLabel:"",cancelButtonLabel:""};if(XrmCore.InternalUtilities.DialogUtilities.isOffline()&&records&&records.length===1&&entityTypeName===Xrm.Constants.EntityNames.ActivityPointer)entityTypeName=records[0].TypeName;Xrm.Utility.getEntityMetadata(entityTypeName).then(function(metadata){XrmCore.InternalUtilities.DialogUtilities.tryGetDialogStringsForEnabledMetadataDialogs(XrmCore.InternalUtilities.DialogUtilities.DialogName.DeleteDialog,dialogstrings,entityTypeName,records.length,actionUri,metadata.DisplayName,metadata.DisplayCollectionName,metadata.IsDocumentManagementEnabled);var dialogOptions=null;if(Xrm.Utility.isActivityType(entityTypeName));if(entityTypeName!==XrmCore.InternalUtilities.EntityUtilities.EntityNames.Workflow)switch(entityTypeName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.BulkOperation:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Queue:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ImportMap:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RecurringAppointmentMaster:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Appointment:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityPointer:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Equipment:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contract:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.QueueItem:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Solution:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SystemForm:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Audit:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SharePointSite:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Calendar:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Account:dialogOptions=_this.GetDialogOptions(450,275,1);break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contact:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OpportunityProduct:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.QuoteDetail:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SalesOrderDetail:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.InvoiceDetail:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CalendarRule:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Product:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DynamicProperty:break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Connection:var subGridControl=gridControl;if(subGridControl.getGridType&&(subGridControl.getGridType()===3||subGridControl.getGridType()===2)){var gridLabel=void 0;if(subGridControl.getLabel&&subGridControl.getLabel())gridLabel=subGridControl.getLabel();else gridLabel=metadata.DisplayName;if(records.length===1)dialogstrings.text=XrmCore.InternalUtilities.GenericUtilities.stringFormat(dialogstrings.text,[records[0].Name,gridLabel]);else dialogstrings.text=XrmCore.InternalUtilities.GenericUtilities.stringFormat(dialogstrings.text,[gridLabel])}default:break}Xrm.Navigation.openConfirmDialog(dialogstrings,dialogOptions).then(function(result){if(result.confirmed){if(XrmCore.InternalUtilities.DialogUtilities.isOffline()){if(Xrm.Mobile.offline.isOfflineEnabled(entityTypeName)){if(records.length>1){var alert_2={text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Delete_Multiple_Offline")};Xrm.Navigation.openAlertDialog(alert_2);return}XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();Xrm.WebApi.offline.deleteRecord(entityTypeName,records[0].Id).then(function(success){gridControl&&gridControl.refresh();Xrm.Utility.closeProgressIndicator()},function(error){gridControl&&gridControl.refresh();Xrm.Utility.closeProgressIndicator();XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)})}else XrmCore.InternalUtilities.DialogUtilities.showOfflineError();return}XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();if(records.length===1)Xrm.WebApi.online.deleteRecord(records[0].TypeName,records[0].Id).then(function(success){gridControl&&gridControl.refresh();Xrm.Utility.closeProgressIndicator()},function(error){gridControl&&gridControl.refresh();Xrm.Utility.closeProgressIndicator();XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)});else{var deleteBatch=records.map(function(record){var entityReference={entityType:record.TypeName,id:record.Id};return new XrmCore.SdkContracts.DeleteRequest(entityReference)});Xrm.WebApi.online.executeMultiple(deleteBatch).then(function(success){Xrm.Utility.closeProgressIndicator();XrmCore.InternalUtilities.DialogUtilities.onGridActionMultipleSuccess(gridControl,success);var postDeleteActionBatch=_this.postDeleteActions(records,gridControl,entityTypeName);postDeleteActionBatch&&postDeleteActionBatch.length>0&&Xrm.WebApi.online.executeMultiple(postDeleteActionBatch).then(function(success){},function(error){gridControl&&gridControl.refresh();XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)})},function(error){gridControl&&gridControl.refresh();Xrm.Utility.closeProgressIndicator();XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)})}}})})};this.postDeleteActions=function(records,gridControl,entityType){var postDeleteActionBatch;switch(entityType){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Connection:var SALES_TEAM_VIEW_ID="FE4BC089-8901-466C-A41B-1C1090F204D4",currentViewId=gridControl&&gridControl.getViewSelector().getCurrentView().id,viewId=currentViewId&&currentViewId.replace("{","").replace("}","").toUpperCase();if(viewId&&viewId==SALES_TEAM_VIEW_ID){var ACCESS_TEAM_TEMPLATE_ID_1="B3228218-B8F6-4A1B-A18D-552C6F980831",parentControl=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page,parentEntity_1=parentControl.data.entity;postDeleteActionBatch=records.map(function(record){return _this.removeUserFromRecordTeam(record.Id,parentEntity_1,ACCESS_TEAM_TEMPLATE_ID_1)})}break}return postDeleteActionBatch}}DeleteLibrary.prototype.GetDialogOptions=function(height,width,position){var dialogOptions={height:height,width:width,position:position};return dialogOptions};DeleteLibrary.prototype.removeUserFromRecordTeam=function(userId,parentEntity,teamTemplateId){var removeUserFromTeamRequest=new XrmCore.SdkContracts.RemoveUserFromRecordTeamRequest({id:userId,entityType:XrmCore.InternalUtilities.EntityUtilities.EntityNames.SystemUser},{id:parentEntity.getId(),entityType:parentEntity.getEntityName()},{id:teamTemplateId,entityType:XrmCore.InternalUtilities.EntityUtilities.EntityNames.TeamTemplate});return removeUserFromTeamRequest};return DeleteLibrary}();Commands.DeleteLibrary=DeleteLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var DeleteLibraryLegacy=function(){function DeleteLibraryLegacy(){}DeleteLibraryLegacy.prototype.deletePrimaryRecord=function(id,entityName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.deletePrimaryRecord(id,entityName):backCompatHeader.Mscrm.CommandBarActions.deletePrimaryRecord(id,entityName)};DeleteLibraryLegacy.prototype.deleteRecordsLegacy=function(gridControl,records,entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.deleteRecords(gridControl,records,entityTypeCode):backCompatHeader.Mscrm.GridCommandActions.deleteRecords(gridControl,records,entityTypeCode)};DeleteLibraryLegacy.prototype.deleteRecords=function(gridControl,records,entityTypeName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),entityTypeCode=Xrm.Internal.getEntityCode(entityTypeName);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.deleteRecords(gridControl,records,entityTypeCode):backCompatHeader.Mscrm.GridCommandActions.deleteRecords(gridControl,records,entityTypeCode)};return DeleteLibraryLegacy}();Commands.DeleteLibraryLegacy=DeleteLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var EmailCopyLinkLibraryLegacy=function(){function EmailCopyLinkLibraryLegacy(){this.sendCurrentViewUrl=function(useEmail,gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.sendCurrentViewUrl(useEmail,gridControl):backCompatHeader.Mscrm.Utilities.sendSelectedRecordsUrl(useEmail,gridControl)}}EmailCopyLinkLibraryLegacy.prototype.emailCopyLinkPrimaryRecord=function(usingEmail,form){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.sendFormShortcut(usingEmail,form):backCompatHeader.Mscrm.RibbonActions.sendFormShortcut(usingEmail,form)};EmailCopyLinkLibraryLegacy.prototype.emailCopyLinkRecordsLegacy=function(usingEmail,records,entityTypeCode,writeUrlOnly){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.Utilities?Mscrm.Utilities.sendSelectedRecordsUrl(usingEmail,records,entityTypeCode,writeUrlOnly):backCompatHeader.Mscrm.Utilities.sendSelectedRecordsUrl(usingEmail,records,entityTypeCode,writeUrlOnly)};EmailCopyLinkLibraryLegacy.prototype.emailCopyLinkRecords=function(usingEmail,records,entityName,writeUrlOnly){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),entityTypeCode=Xrm.Internal.getEntityCode(entityName);Mscrm&&Mscrm.Utilities?Mscrm.Utilities.sendSelectedRecordsUrl(usingEmail,records,entityTypeCode,writeUrlOnly):backCompatHeader.Mscrm.Utilities.sendSelectedRecordsUrl(usingEmail,records,entityTypeCode,writeUrlOnly)};return EmailCopyLinkLibraryLegacy}();Commands.EmailCopyLinkLibraryLegacy=EmailCopyLinkLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var EmailCopyLinkLibrary=function(){function EmailCopyLinkLibrary(){this.sendCurrentViewUrl=function(useEmail,gridControl){var clientTypeValue=Xrm.Utility.getGlobalContext().client.getClient(),clientType=clientTypeValue===Xrm.Constants.ClientNames.mobile?1:0,currentWebViewUrl=gridControl.getUrl(),currentBrowserViewUrl=gridControl.getUrl(clientType),webLinkResourceString=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Web Link")||"Web Link",title=gridControl.getViewSelector().getCurrentView().name,encodedNewLine=encodeURIComponent("<br>"),formattedBrowserLink=XrmCore.InternalUtilities.GenericUtilities.stringFormat(EmailCopyLinkLibrary.generalEmailBodyFormat,[currentBrowserViewUrl,title]),body=encodeURIComponent(formattedBrowserLink);if(clientType===1){var formattedWebLink=EmailCopyLinkLibrary.isAndroid()?XrmCore.InternalUtilities.GenericUtilities.stringFormat(EmailCopyLinkLibrary.generalEmailLinkForAndroidIntoBrackets,[webLinkResourceString,currentWebViewUrl]):XrmCore.InternalUtilities.GenericUtilities.stringFormat(EmailCopyLinkLibrary.generalEmailLinkIntoBrackets,[currentWebViewUrl,webLinkResourceString]);body+=encodeURIComponent(formattedWebLink)+encodedNewLine}useEmail&&EmailCopyLinkLibrary.openEmailForm("",title,body,null)}}EmailCopyLinkLibrary.prototype.emailCopyLinkPrimaryRecord=function(usingEmail,form){var entity=Xrm.Page.data.entity,entityTitle=entity.getPrimaryAttributeValue(),recordId=entity.getId(),entityLogicalName=entity.getEntityName(),ccFieldValue="",records=[];records.push({Id:recordId,Name:entityTitle,TypeName:entityLogicalName});EmailCopyLinkLibrary.emailCopyLinks(usingEmail,records,entityLogicalName,false,ccFieldValue)};EmailCopyLinkLibrary.prototype.emailCopyLinkRecordsLegacy=function(usingEmail,records,entityTypeCode,writeUrlOnly){EmailCopyLinkLibrary.emailCopyLinks(usingEmail,records,Xrm.Internal.getEntityName(entityTypeCode),writeUrlOnly)};EmailCopyLinkLibrary.prototype.emailCopyLinkRecords=function(usingEmail,records,entityName,writeUrlOnly){EmailCopyLinkLibrary.emailCopyLinks(usingEmail,records,entityName,writeUrlOnly)};EmailCopyLinkLibrary.emailCopyLinks=function(usingEmail,records,entityName,writeUrlOnly,ccFieldValue){if(!records||!records.length){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Action_NoItemSelected")});return}if(records.length>10){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Max_Shortcut_Record_Reached")});return}if(!writeUrlOnly)writeUrlOnly=!usingEmail&&records.length===1;for(var subject=" ",body="",clientTypeValue=Xrm.Utility.getGlobalContext().client.getClient(),clientType=clientTypeValue===Xrm.Constants.ClientNames.mobile?1:0,i=0;i<records.length;i++){var record=records[i],value={entityType:record.TypeName,id:record.Id,name:record.Name},pageUrl=Xrm.Internal.getCurrentPageUrl(value,clientType),browserUrl=Xrm.Internal.getEmailLink(value),entityTitle=record.Name,url=clientType==1||record.TypeName==="report"?browserUrl:pageUrl,encodedNewLine=encodeURIComponent("<br>"),linkBracket=EmailCopyLinkLibrary.isAndroid()?EmailCopyLinkLibrary.newLineReplaceWithBreak(EmailCopyLinkLibrary.generalEmailLinkForIntoBrackets)+"<br>":EmailCopyLinkLibrary.generalEmailLinkForIntoBrackets,formattedWebLink=XrmCore.InternalUtilities.GenericUtilities.stringFormat(linkBracket,[writeUrlOnly?url:entityTitle,url]);if(clientType===1&&EmailCopyLinkLibrary.isiOSdevice()){body+=encodeURIComponent(entityTitle);var webLinkResourceString=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("EmailLink_WebLinkText")||"Web Link",formattediOSLink=XrmCore.InternalUtilities.GenericUtilities.stringFormat(EmailCopyLinkLibrary.generalEmailLinkIntoBrackets,[browserUrl,webLinkResourceString]);body+=encodeURIComponent(formattediOSLink)+encodedNewLine}else body+=encodeURIComponent(formattedWebLink);if(i===0&&records.length===1)subject=entityTitle}EmailCopyLinkLibrary.openEmailForm("",subject,body,ccFieldValue)};EmailCopyLinkLibrary.openEmailForm=function(to,subject,body,cc){var mailtoLink="mailto:";if(to){var index=to.lastIndexOf("@");if(index>=0&&index<to.length)mailtoLink+=encodeURIComponent(to.substr(0,index))+"@"+encodeURIComponent(to.substr(index+1));else mailtoLink+=encodeURIComponent(to)}var seporator="?";if(cc){mailtoLink+=seporator+"cc="+encodeURIComponent(cc);seporator="&"}if(subject){mailtoLink+=seporator+"subject="+encodeURIComponent(subject);seporator="&"}if(body)mailtoLink+=seporator+"body="+body;var maxAllowableLength=2020;if(mailtoLink.length>maxAllowableLength){var errorDialogOptions={message:"",errorCode:-2147204303};Xrm.Navigation.openErrorDialog(errorDialogOptions)}else Xrm.Navigation.openUrl(mailtoLink,{isExternal:true})};EmailCopyLinkLibrary.isAndroid=function(){return navigator.platform&&/Android|Linux/g.test(navigator.platform)};EmailCopyLinkLibrary.isiOSdevice=function(){return navigator.platform=="iPad"||navigator.platform=="iPhone"};EmailCopyLinkLibrary.newLineReplaceWithBreak=function(str){return str.replace("\n","<br/>")};EmailCopyLinkLibrary.generalEmailBodyFormat='<a href="{0}">{1}</a>';EmailCopyLinkLibrary.generalEmailLinkForAndroidIntoBrackets=" ({0}: {1})";EmailCopyLinkLibrary.generalEmailLinkForIntoBrackets="{0}\n({1})\n";EmailCopyLinkLibrary.generalEmailLinkIntoBrackets=" ("+EmailCopyLinkLibrary.generalEmailBodyFormat+")";return EmailCopyLinkLibrary}();Commands.EmailCopyLinkLibrary=EmailCopyLinkLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.EmailCopyLink=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.EmailCopyLinkLibrary:new Commands.EmailCopyLinkLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var EntityImageUpload=function(){function EntityImageUpload(){}EntityImageUpload.DialogLoad=function(eventContext){var formContext=eventContext.getFormContext(),dialogAttributes=formContext.data.attributes,entityImageUrl=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityImageUrlParameter).getValue(),entityPrimaryAttribute=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityPrimaryAttributeParameter).getValue(),entityImageData=JSON.stringify({mode:entityImageUrl?0:1,entityPrimaryField:entityPrimaryAttribute,imageSrc:entityImageUrl,dialogModeLabel:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_EntityImage_CurrentEntityImage")});dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityImagePreviewId).setValue(entityImageData);if(entityImageUrl===null)formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.UseDefaultId).setVisible(false);else formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.UseDefaultId).setVisible(true);var isNotMobile=Xrm.Utility.getGlobalContext().client.getClient()!=Xrm.Constants.ClientNames.mobile;if(isNotMobile)formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.TakePhotoId).setVisible(false);else formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.TakePhotoId).setVisible(true);formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.UploadImageId).setVisible(true);formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId).setVisible(false);formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogCancelId).setVisible(false)};EntityImageUpload.TakePhoto=function(eventContext){var formContext=eventContext.getFormContext(),dialogAttributes=eventContext.getFormContext().data.attributes,options={height:144,width:144,quality:50,allowEdit:true,preferFrontCamera:false};Xrm.Device.captureImage(options).then(function(file){EntityImageUpload._switchDialogMode(eventContext,true);EntityImageUpload._setEntityImagePreivewData(file,dialogAttributes)},function(error){var alert={text:error.message};Xrm.Navigation.openAlertDialog(alert)})};EntityImageUpload.UploadPhoto=function(eventContext){var formContext=eventContext.getFormContext(),dialogAttributes=eventContext.getFormContext().data.attributes,options={allowMultipleFiles:false,accept:"image/*"},imageFormats=/(\.jpg|\.png|\.JPG|\.PNG|\.gif|\.GIF|\.jpeg|\.JPEG|\.tif|\.TIF|.\tiff|.\TIFF|.\bmp|.\BMP)$/;Xrm.Utility.getGlobalContext().client.getClient()===Xrm.Constants.ClientNames.mobile&&XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();Xrm.Device.pickFile(options).then(function(files){if(files[0].fileName.match(imageFormats)){EntityImageUpload._switchDialogMode(eventContext,true);EntityImageUpload._setEntityImagePreivewData(files[0],dialogAttributes)}else{var alert_3={text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_UploadImage_ErrorMsg")};Xrm.Navigation.openAlertDialog(alert_3)}Xrm.Utility.getGlobalContext().client.getClient()===Xrm.Constants.ClientNames.mobile&&Xrm.Utility.closeProgressIndicator()},function(error){if(error.errorCode!=0){var alert_4={text:error.message};Xrm.Navigation.openAlertDialog(alert_4)}Xrm.Utility.getGlobalContext().client.getClient()===Xrm.Constants.ClientNames.mobile&&Xrm.Utility.closeProgressIndicator()})};EntityImageUpload.UseDefault=function(eventContext){EntityImageUpload._switchDialogMode(eventContext,true);var dialogAttributes=eventContext.getFormContext().data.attributes,entityPrimaryAttribute=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityPrimaryAttributeParameter).getValue(),entityImageData=JSON.stringify({mode:1,entityPrimaryField:entityPrimaryAttribute,imageSrc:"",dialogModeLabel:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_EntityImage_NewEntityImage")});dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityImagePreviewId).setValue(entityImageData);dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityImageDataParameter).setValue("")};EntityImageUpload.Update=function(eventContext){var dialogAttributes=eventContext.getFormContext().data.attributes,imageData=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityImageDataParameter).getValue(),entityImageData={entityimage:imageData},entityLogicalName=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityLogicalNameParameter).getValue(),entityId=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityIdParameter).getValue();XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();Xrm.WebApi.updateRecord(entityLogicalName,entityId,entityImageData).then(function(){Xrm.Page.ui.close();Xrm.Utility.closeProgressIndicator()},function(error){var alert={text:error.message};Xrm.Navigation.openAlertDialog(alert);Xrm.Utility.closeProgressIndicator()})};EntityImageUpload.Cancel=function(eventContext){EntityImageUpload._switchDialogMode(eventContext,false);var dialogAttributes=eventContext.getFormContext().data.attributes,entityImageUrl=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityImageUrlParameter).getValue(),entityPrimaryAttribute=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityPrimaryAttributeParameter).getValue(),entityImageData=JSON.stringify({mode:entityImageUrl?0:1,entityPrimaryField:entityPrimaryAttribute,imageSrc:entityImageUrl,dialogModeLabel:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_EntityImage_CurrentEntityImage")});dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityImagePreviewId).setValue(entityImageData)};EntityImageUpload._switchDialogMode=function(eventContext,isConfirmation){var formContext=eventContext.getFormContext(),dialogAttributes=formContext.data.attributes,editModeLabel=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_EntityImage_ChangeImage"),confirmationModeLabel=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_EntityImage_UpdateImage"),entityImageUrl=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityImageUrlParameter).getValue(),editModeDescriptionLabel=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_EntityImage_ChangeImage_Description"),confirmationModeDescriptionLabel=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_EntityImage_UpdateImage_Description");formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.TitleId).setLabel(isConfirmation?confirmationModeLabel:editModeLabel);formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DescriptionId).setLabel(isConfirmation?confirmationModeDescriptionLabel:editModeDescriptionLabel);var isMobile=Xrm.Utility.getGlobalContext().client.getClient()===Xrm.Constants.ClientNames.mobile;isMobile&&formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.TakePhotoId).setVisible(!isConfirmation);formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.UploadImageId).setVisible(!isConfirmation);entityImageUrl!==null&&formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.UseDefaultId).setVisible(!isConfirmation);formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId).setVisible(isConfirmation);formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogCancelId).setVisible(isConfirmation);if(isConfirmation)formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId).setFocus();else if(isMobile)formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.TakePhotoId).setFocus();else formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.UploadImageId).setFocus()};EntityImageUpload._setEntityImagePreivewData=function(file,dialogAttributes){var base64FileContent=file.fileContent,entityPrimaryAttribute=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityPrimaryAttributeParameter).getValue(),entityImageData=JSON.stringify({mode:0,entityPrimaryField:entityPrimaryAttribute,imageSrc:"data:image;base64,"+base64FileContent,dialogModeLabel:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_EntityImage_NewEntityImage")});dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityImagePreviewId).setValue(entityImageData);dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityImageDataParameter).setValue(base64FileContent)};return EntityImageUpload}();Commands.EntityImageUpload=EntityImageUpload})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var DeviceSettings=function(){function DeviceSettings(){}DeviceSettings.onLoadDeviceSettings=function(eventContext){var formContext=eventContext.getFormContext(),dialogAttributes=formContext.data.attributes;dialogAttributes.get("is_saved").setValue(false);var deviceSettings=dialogAttributes.get("device_settings").getValue(),isOfflineControlHidden=dialogAttributes.get("is_offline_control_hidden").getValue(),isOfflineSyncEnabled=dialogAttributes.get("is_offlinesync_enabled").getValue(),isOfflineInitializing=dialogAttributes.get("is_offline_initializing").getValue();DeviceSettings.setOfflineSync(formContext,isOfflineControlHidden,isOfflineSyncEnabled,isOfflineInitializing);DeviceSettings.setUserContentAndLocation(dialogAttributes,deviceSettings);DeviceSettings.setCamera(dialogAttributes,deviceSettings);DeviceSettings.isLoaded=true};DeviceSettings.saveButtonClick=function(eventContext){var formContext=eventContext.getFormContext(),dialogAttributes=formContext.data.attributes,deviceSettings=dialogAttributes.get("device_settings").getValue(),isOfflineSyncEnabled=dialogAttributes.get("is_offlinesync_enabled").getValue(),oldDeviceSettings=JSON.stringify(deviceSettings);DeviceSettings.saveGeneralParameters(dialogAttributes,deviceSettings);DeviceSettings.saveCamera(dialogAttributes,deviceSettings);DeviceSettings.saveVideo(dialogAttributes,deviceSettings);if(JSON.stringify(deviceSettings)===oldDeviceSettings&&isOfflineSyncEnabled===dialogAttributes.get("offlineSync").getValue())dialogAttributes.get("is_saved").setValue(false);else{dialogAttributes.get("device_settings").setValue(deviceSettings);dialogAttributes.get("is_offlinesync_enabled").setValue(dialogAttributes.get("offlineSync").getValue());dialogAttributes.get("is_saved").setValue(true)}Xrm.Page.ui.close()};DeviceSettings.closeButtonClick=function(eventContext){var formContext=eventContext.getFormContext(),dialogAttributes=formContext.data.attributes;dialogAttributes.get("is_saved").setValue(false);Xrm.Page.ui.close()};DeviceSettings.onUserContentAndLocationChanged=function(eventContext){var formContext=eventContext.getFormContext(),dialogAttributes=formContext.data.attributes,userContentAndLocation=dialogAttributes.get("userContentAndLocation");if(DeviceSettings.isLoaded&&userContentAndLocation.getValue()){userContentAndLocation.setValueInternal(false);Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.DeviceSettingsConsentDialog,null,null).then(function(response){response.parameters["is_confirmed"]&&userContentAndLocation.setValueInternal(true)})}};DeviceSettings.setOfflineSync=function(formContext,isOfflineControlHidden,isOfflineSyncEnabled,isOfflineInitializing){var dialogAttributes=formContext.data.attributes,offlineSync=dialogAttributes.get("offlineSync"),offlineSyncControl=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OfflineSync);if(isOfflineControlHidden){offlineSyncControl.setVisible(false);offlineSync.setValueInternal(false)}else if(isOfflineSyncEnabled){offlineSync.setValueInternal(isOfflineSyncEnabled);isOfflineInitializing&&offlineSyncControl.setDisabled(true)}else offlineSync.setValueInternal(false)};DeviceSettings.setUserContentAndLocation=function(dialogAttributes,deviceSettings){var userContentAndLocation=dialogAttributes.get("userContentAndLocation");userContentAndLocation.setValueInternal(deviceSettings["microphone"].isEnabled&&deviceSettings["geolocation"].isEnabled)};DeviceSettings.setCamera=function(dialogAttributes,deviceSettings){var cameraEnabled=dialogAttributes.get("cameraEnabled");cameraEnabled.setValueInternal(deviceSettings["camera"].isEnabled);var savePhotoToLibrary=dialogAttributes.get("savePhotoToLibrary");savePhotoToLibrary.setValueInternal(deviceSettings["camera"].savePhoto);dialogAttributes.get("photoResolution").setValue(deviceSettings["camera"].imageRes)};DeviceSettings.saveGeneralParameters=function(dialogAttributes,deviceSettings){var parameters=["geolocation","microphone"],attributeName;parameters.forEach(function(item){attributeName="userContentAndLocation";if(deviceSettings[item])deviceSettings[item].isEnabled=dialogAttributes.get(attributeName).getValue();else{var feature=(_a={},_a[item]={featureName:item,isEnabled:dialogAttributes.get(attributeName).getValue()},_a);Object.assign(deviceSettings,feature)}var _a})};DeviceSettings.saveCamera=function(dialogAttributes,deviceSettings){var attribute=dialogAttributes.get("photoResolution");if(deviceSettings["camera"]){deviceSettings["camera"].isEnabled=dialogAttributes.get("cameraEnabled").getValue();deviceSettings["camera"].savePhoto=dialogAttributes.get("savePhotoToLibrary").getValue();deviceSettings["camera"].imageRes=attribute.getSelectedOption().value}else{var camera={camera:{featureName:"camera",isEnabled:dialogAttributes.get("cameraEnabled").getValue(),savePhoto:dialogAttributes.get("savePhotoToLibrary").getValue(),imageRes:attribute.getSelectedOption().value}};Object.assign(deviceSettings,camera)}};DeviceSettings.saveVideo=function(dialogAttributes,deviceSettings){var videoValue=dialogAttributes.get("cameraEnabled").getValue()&&dialogAttributes.get("userContentAndLocation").getValue();if(deviceSettings["video"])deviceSettings["video"].isEnabled=videoValue;else{var video={video:{featureName:"video",isEnabled:videoValue}};Object.assign(deviceSettings,video)}};DeviceSettings.isLoaded=false;return DeviceSettings}();Commands.DeviceSettings=DeviceSettings})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var ExportLibraryLegacy=function(){function ExportLibraryLegacy(){this.exportToExcelLegacy=function(gridControl,entityTypeCode,exportType){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.exportToXlsx(gridControl,entityTypeCode,exportType):backCompatHeader.Mscrm.GridRibbonActions.exportToXlsx(gridControl,entityTypeCode,exportType)};this.exportToExcel=function(gridControl,entityTypeName,exportType){var entityTypeCode=Xrm.Internal.getEntityCode(entityTypeName),backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.exportToXlsx(gridControl,entityTypeCode,exportType):backCompatHeader.Mscrm.GridRibbonActions.exportToXlsx(gridControl,entityTypeCode,exportType)};this.generateWordTemplateFlyout=function(commandProperties,entityTypeName,isForm,gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.generateWordTemplateFlyout(commandProperties,entityTypeName,isForm,gridControl):backCompatHeader.Mscrm.CommandBarActions.generateWordTemplateFlyout(commandProperties,entityTypeName,isForm,gridControl)};this.generateExcelTemplateFlyout=function(commandProperties,entityTypeName,gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.generateDocumentTemplateFlyout(commandProperties,entityTypeName,gridControl):backCompatHeader.Mscrm.CommandBarActions.generateDocumentTemplateFlyout(commandProperties,entityTypeName,gridControl)};this.runExcelTemplate=function(commandProperties,gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.runDocumentTemplate(commandProperties,gridControl):backCompatHeader.Mscrm.GridRibbonActions.runDocumentTemplate(commandProperties,gridControl)};this.runWordTemplate=function(commandProperties,entityTypeName,gridControl,selectedRecords){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.runWordTemplate(commandProperties,entityTypeName,gridControl,selectedRecords):backCompatHeader.Mscrm.GridRibbonActions.runWordTemplate(commandProperties,entityTypeName,gridControl,selectedRecords)}}return ExportLibraryLegacy}();Commands.ExportLibraryLegacy=ExportLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var ExportToExcelType;(function(ExportToExcelType){ExportToExcelType[ExportToExcelType["DynamicXlsx"]=2]="DynamicXlsx";ExportToExcelType[ExportToExcelType["PivotXlsx"]=3]="PivotXlsx";ExportToExcelType[ExportToExcelType["StaticXlsx"]=4]="StaticXlsx";ExportToExcelType[ExportToExcelType["AllStaticXlsx"]=5]="AllStaticXlsx";ExportToExcelType[ExportToExcelType["OnlineExcel"]=6]="OnlineExcel"})(ExportToExcelType||(ExportToExcelType={}));var ExportLibrary=function(){function ExportLibrary(){var _this=this;this.getExportTypeName=function(exportType){var exportTypeName="";switch(exportType){case ExportToExcelType.AllStaticXlsx:exportTypeName="AllStaticXlsx";break;case ExportToExcelType.StaticXlsx:exportTypeName="StaticXlsx";break;case ExportToExcelType.DynamicXlsx:exportTypeName="DynamicXlsx";break;case ExportToExcelType.PivotXlsx:exportTypeName="PivotXlsx";break;case ExportToExcelType.OnlineExcel:exportTypeName="OnlineExcel";break}return exportTypeName};this.exportToExcelLegacy=function(gridControl,entityTypeCode,exportType){var entityTypeName=Xrm.Internal.getEntityName(entityTypeCode);_this.exportToExcel(gridControl,entityTypeName,exportType,null)};this.exportToExcel=function(gridControl,entityTypeName,exportType,selectedRecords){var exportTypeName=_this.getExportTypeName(exportType);Commands.ExportTelemetryHelper.logExportInitTelemetry("ExportToExcel.Init",entityTypeName,exportTypeName);if(exportType==ExportToExcelType.OnlineExcel)_this.exportToExcelOnline(gridControl,entityTypeName,exportType);else if(exportType==ExportToExcelType.DynamicXlsx||exportType==ExportToExcelType.PivotXlsx)_this.exportToDynamicExcel(gridControl,entityTypeName,exportType);else _this.exportToStandardExcel(gridControl.getViewSelector().getCurrentView(),gridControl.getFetchXml(),entityTypeName,exportType,selectedRecords)};this.exportToStandardExcel=function(currentView,fetchXml,entityTypeName,exportType,selectedRecords){var exportTypeName=_this.getExportTypeName(exportType),documentType=1,openMode={openMode:2},dom_Fetch=XrmCore.InternalUtilities.ExportUtilities.getXmlDOMFromString(fetchXml);if(exportType==ExportToExcelType.AllStaticXlsx){dom_Fetch.getElementsByTagName("fetch")[0].removeAttribute("page");dom_Fetch.getElementsByTagName("fetch")[0].removeAttribute("count")}fetchXml=XrmCore.InternalUtilities.ExportUtilities.getXmlAsString(dom_Fetch);var keys=selectedRecords!=null?["selectedRecords"]:[],values=selectedRecords!=null?[{Type:"System.String",Value:selectedRecords.toString()}]:[],arg=new XrmCore.SdkContracts.InputArgument(selectedRecords!=null?1:0,true,keys,values),argCol=new XrmCore.SdkContracts.InputArgumentCollection(arg),r=new XrmCore.SdkContracts.ExportToExcelRequest(currentView,fetchXml,"","",argCol);Commands.ExportTelemetryHelper.logExportDetailsTelemetry("ExportToExcel.Details",entityTypeName,exportTypeName,currentView.name,currentView.entityType,currentView.id);Xrm.Utility.showProgressIndicator(Xrm.Utility.getResourceString("Main_system_library","ExportToXlsx_ProgressDialog_Header"));var deferred=Xrm.WebApi.online.execute(r).then(function(res){return res.json()}).then(function(odataResponse){var file={fileContent:odataResponse.ExcelFile,fileName:XrmCore.InternalUtilities.ExportUtilities.generateExportFileName(currentView.name,documentType),mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};return Xrm.Navigation.openFile(file,openMode)}).then(function(res){console.log(res);Commands.ExportTelemetryHelper.logExportSuccessTelemetry("ExportToExcel.Completed",entityTypeName,exportTypeName);Xrm.Utility.closeProgressIndicator()}).then(undefined,function(err){console.error(err);Commands.ExportTelemetryHelper.logFailureTelemetry("ExportToExcel.Failure",err,entityTypeName,exportTypeName);var errorMessage="";if(err.innerror&&err.innerror.message){if(err.innerror.message!="")errorMessage=err.innerror.message}else errorMessage=err.message;var errorDialogOptions={message:errorMessage,errorCode:err.errorCode};Xrm.Navigation.openErrorDialog(errorDialogOptions);Xrm.Utility.closeProgressIndicator()})};this.exportToDynamicExcel=function(gridControl,entityTypeName,exportType){var documentType=1,openMode={openMode:2},currentView=gridControl.getViewSelector().getCurrentView(),fetchXml=gridControl.getFetchXml(),entityTypeCode=Xrm.Internal.getEntityCode(gridControl.getEntityName()),dialogOption={height:600,width:800,position:1},dialogParams={};dialogParams["entity_typeName"]=gridControl.getEntityName();dialogParams["entity_typeCode"]=entityTypeCode;dialogParams["entity_fetchXml"]=fetchXml;dialogParams["entity_effectiveFetchXml"]=fetchXml;dialogParams["entity_exportType"]=exportType;dialogParams["entity_viewId"]=gridControl.getViewSelector().getCurrentView().id;dialogParams["entity_viewName"]=gridControl.getViewSelector().getCurrentView().name;dialogParams["entity_viewType"]=gridControl.getViewSelector().getCurrentView().entityType;dialogParams["entity_totalRecordCount"]=gridControl.getGrid().getTotalRecordCount();var entityName=currentView.entityType,columns=["layoutxml"],exportTypeName=_this.getExportTypeName(exportType);Commands.ExportTelemetryHelper.logExportDetailsTelemetry("ExportToExcel.Details",entityTypeName,exportTypeName,gridControl.getViewSelector().getCurrentView().name,gridControl.getViewSelector().getCurrentView().entityType,gridControl.getViewSelector().getCurrentView().id);Xrm.WebApi.online.retrieveRecord(entityName,currentView.id,"?$select="+columns).then(function(oppResponse){if(oppResponse.layoutxml){dialogParams["entity_layoutXml"]=oppResponse.layoutxml;dialogParams["entity_effectiveLayoutXml"]=oppResponse.layoutxml;Commands.ExportTelemetryHelper.logExportSuccessTelemetry("ExportToExcel.DialogOpened",entityTypeName,exportTypeName);Xrm.Navigation.openDialog("ExportToExcel",dialogOption,dialogParams)}},function(err){Commands.ExportTelemetryHelper.logFailureTelemetry("ExportToExcel.Failure",err,entityTypeName,exportTypeName);Xrm.Navigation.openAlertDialog({text:"No LayoutXml found for this View",confirmButtonLabel:"Error Dialog"})});return};this.exportToExcelOnline=function(gridControl,entityTypeName,exportType){var params={},currentView=gridControl.getViewSelector().getCurrentView(),fetchXml=gridControl.getFetchXml(),dom_Fetch=XrmCore.InternalUtilities.ExportUtilities.getXmlDOMFromString(fetchXml);dom_Fetch.getElementsByTagName("fetch")[0].removeAttribute("page");dom_Fetch.getElementsByTagName("fetch")[0].removeAttribute("count");fetchXml=XrmCore.InternalUtilities.ExportUtilities.getXmlAsString(dom_Fetch);var screenDimensions=_this.getScreenDimensions(),exportTypeName=_this.getExportTypeName(exportType);Xrm.Utility.getEntityMetadata(entityTypeName).then(function(entityMetadata){params["current_view"]=currentView.entityType+"/"+currentView.id;params["fetch_xml"]=fetchXml;params["entityType_name"]=entityTypeName;params["layout_xml"]=" ";params["entity_is_importable"]=entityMetadata.IsImportable;Commands.ExportTelemetryHelper.logExportDetailsTelemetry("ExportToExcel.Details",entityTypeName,exportTypeName,gridControl.getViewSelector().getCurrentView().name,gridControl.getViewSelector().getCurrentView().entityType,gridControl.getViewSelector().getCurrentView().id);Xrm.Navigation.openDialog("ExportToExcelOnlineDialog",{width:screenDimensions.width,height:screenDimensions.height,position:1},params)},function(err){Commands.ExportTelemetryHelper.logFailureTelemetry("ExportToExcel.Failure",err,entityTypeName,exportTypeName);var errorDialogOptions={message:Xrm.Utility.getResourceString("Main_system_library","ExportToXlsx_Error_Entity_Metadata_Not_Found"),errorCode:err.errorCode};Xrm.Navigation.openErrorDialog(errorDialogOptions)})};this.getScreenDimensions=function(){var screenWidth=window.screen.width,screenHeight=window.screen.height,screenDimensions={width:screenWidth,height:screenHeight};return screenDimensions};this.generateWordTemplateFlyout=function(commandProperties,entityTypeName,isForm,gridControl){var documentType=2,ribbonRelationshipType=-1,contextType=0;if(isForm)contextType=1;else if(typeof gridControl.getRelationship==="function"){contextType=2;var relationship=gridControl.getRelationship();if(relationship!==null&&relationship.relationshipType===0)ribbonRelationshipType=0;else if(relationship!==null&&relationship.relationshipType===1)ribbonRelationshipType=1}var deferred1=XrmCore.InternalUtilities.ExportUtilities.retrieveSystemDocumentTemplates(entityTypeName,documentType),deferred2=XrmCore.InternalUtilities.ExportUtilities.retrievePersonalDocumentTemplates(entityTypeName,documentType),menu=Promise.all([deferred1,deferred2]).then(function(_a){var systemTemplates=_a[0],personalTemplates=_a[1];ExportLibrary._systemTemplates=systemTemplates;ExportLibrary._personalTemplates=personalTemplates;return _this.buildMenu(systemTemplates,personalTemplates,entityTypeName,isForm,contextType,ribbonRelationshipType,documentType)});commandProperties["PopulationXML"]=menu;return};this.generateExcelTemplateFlyout=function(commandProperties,entityTypeName,gridControl){var isForm=false,documentType=1,contextType=0,ribbonRelationshipType=-1;if(typeof gridControl.getRelationship==="function"){contextType=2;var relationship=gridControl.getRelationship();if(relationship!==null&&relationship.relationshipType===0)ribbonRelationshipType=0;else if(relationship!==null&&relationship.relationshipType===1)ribbonRelationshipType=1}var deferred1=XrmCore.InternalUtilities.ExportUtilities.retrieveSystemDocumentTemplates(entityTypeName,documentType),deferred2=XrmCore.InternalUtilities.ExportUtilities.retrievePersonalDocumentTemplates(entityTypeName,documentType),menu=Promise.all([deferred1,deferred2]).then(function(_a){var systemTemplates=_a[0],personalTemplates=_a[1];ExportLibrary._systemTemplates=systemTemplates;ExportLibrary._personalTemplates=personalTemplates;return _this.buildMenu(systemTemplates,personalTemplates,entityTypeName,isForm,contextType,ribbonRelationshipType,documentType)});commandProperties["PopulationXML"]=menu;return};this.runExcelTemplate=function(commandProperties,gridControl){var documentType=1,openMode={openMode:2},contextType=0;if(typeof gridControl.getRelationship==="function")contextType=2;var personalTemplateKeyword="DocumentTemplates.Menu.PersonalExcelTemplates.",sourceControlId=commandProperties["SourceControlId"];if(sourceControlId=="ViewAllMyTemplatesId"){_this.navigateToPersonalDocumentTemplates("recordlist","personaldocumenttemplate");return}var templateEntityName="documenttemplate",templateId=sourceControlId.split(/[. ]+/).pop();if(sourceControlId.indexOf(personalTemplateKeyword)!==-1)templateEntityName="personaldocumenttemplate";if(templateId==="UploadTemplate"||templateId==="DownloadTemplate"){_this.openDocTemplateDialog(templateId,documentType,gridControl);return}var onlineTemplateKeyword="DocumentOnlineTemplates.Menu.",personalTemplateOnlineValidatorKeyword="PersonalExcelTemplates.Controls.",onlineExcelValidatorKeyword="Controls.OpenExcelOnline.";if(sourceControlId.indexOf(onlineTemplateKeyword)!==-1){if(sourceControlId.indexOf(personalTemplateOnlineValidatorKeyword)!==-1)templateEntityName="personaldocumenttemplate";if(sourceControlId.indexOf(onlineExcelValidatorKeyword)!==-1){var params={},screenDimensions=_this.getScreenDimensions(),fetchXml=gridControl.getFetchXml();params["current_view"]=templateEntityName+"/"+templateId;params["fetch_xml"]=fetchXml;params["entityType_name"]=gridControl.getEntityName();params["layout_xml"]="";Xrm.Navigation.openDialog("ExportToExcelOnlineDialog",{width:screenDimensions.width,height:screenDimensions.height,position:1},params);return}}var templateRef={id:"{"+templateId+"}",entityType:templateEntityName},r=null;if(contextType===0){var currentViewId=gridControl.getViewSelector().getCurrentView().id,currentView={id:currentViewId,entityType:"savedquery"};r=new XrmCore.SdkContracts.RenderTemplateFromViewRequest(templateRef,currentView)}else if(contextType===2){var fetchXml=gridControl.getFetchXml(),dom_Fetch=XrmCore.InternalUtilities.ExportUtilities.getXmlDOMFromString(fetchXml);dom_Fetch.getElementsByTagName("fetch")[0].removeAttribute("page");dom_Fetch.getElementsByTagName("fetch")[0].removeAttribute("count");fetchXml=XrmCore.InternalUtilities.ExportUtilities.getXmlAsString(dom_Fetch);var keys=[],values=[],arg=new XrmCore.SdkContracts.InputArgument(0,true,keys,values),argCol=new XrmCore.SdkContracts.InputArgumentCollection(arg);r=new XrmCore.SdkContracts.RenderTemplateRequest(templateRef,fetchXml,"",argCol)}Xrm.Utility.showProgressIndicator(Xrm.Utility.getResourceString("Main_system_library","ExportToXlsx_ProgressDialog_Header"));var deferred=Xrm.WebApi.online.execute(r).then(function(res){return res.json()}).then(function(odataResponse){var template=undefined;if(templateEntityName==="documenttemplate")template=ExportLibrary._systemTemplates.filter(function(obj){return obj.Id===templateId})[0];else template=ExportLibrary._personalTemplates.filter(function(obj){return obj.Id===templateId})[0];var file={fileContent:odataResponse.ExcelFile,fileName:XrmCore.InternalUtilities.ExportUtilities.generateExportFileName(template.Name,documentType),mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};Xrm.UI.addGlobalNotification(1,1,Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_SucessfullyDownloaded"),null,null);return Xrm.Navigation.openFile(file,openMode)},function(errorResponse){Xrm.Utility.closeProgressIndicator();console.log(errorResponse);var errorMessage="";if(errorResponse.innerror&&errorResponse.innerror.message){if(errorResponse.innerror.message!="")errorMessage=errorResponse.innerror.message}else errorMessage=errorResponse.message;var errorDialogOptions={message:errorMessage,errorCode:errorResponse.errorCode};Xrm.Navigation.openErrorDialog(errorDialogOptions)}).then(function(res){console.log(res);Xrm.Utility.closeProgressIndicator()});return};this.openDocTemplateDialog=function(dialogName,documentType,gridControl,isForm){var width=512,height=300,docDialog="DocumentTemplateUpload";if(documentType==2&&dialogName==="DownloadTemplate"){width=850;height=650}if(dialogName==="DownloadTemplate")docDialog="DocumentTemplateDownload";var params={};if(isForm)params["Entity_Name"]=gridControl.entityReference.entityType;else{var viewId=gridControl.getViewSelector().getCurrentView().id.replace("{","").replace("}",""),currentView=gridControl.getViewSelector().getCurrentView().name,fetchXmlData=gridControl.getFetchXml();params["Entity_Name"]=gridControl.getEntityName();params["View_Id"]=viewId;params["current_view"]=currentView;params["fetch_xmldata"]=fetchXmlData}params["DocTemplateFile_Type"]=documentType;params["DocTemplate_Type"]=9941;Xrm.Navigation.openDialog(docDialog,{width:width,height:height,position:1},params).then(function(result){if(result.parameters&&result.parameters["Is_DocumentTemplate_Uploaded"]!=undefined&&result.parameters["DocumentTemplate_index"]!=undefined)if(result.parameters["Is_DocumentTemplate_Uploaded"]==1){var entityFormOptions={};entityFormOptions["entityName"]="personaldocumenttemplate";entityFormOptions["entityId"]=result.parameters["DocumentTemplate_index"];var actionDescriptor={actionLabel:Xrm.Utility.getResourceString("Main_system_library","View_Personal_Document_Template"),eventHandler:function(){Xrm.Navigation.openForm(entityFormOptions)}};Xrm.UI.addGlobalNotification(1,1,Xrm.Utility.getResourceString("Main_system_library","DocTemplate_Successfully_Uploaded"),null,actionDescriptor)}});return};this.runWordTemplate=function(commandProperties,entityTypeCode,gridControl,selectedRecords){var isForm=false;if(typeof selectedRecords==="string"){selectedRecords=[selectedRecords];isForm=true}var documentType=2,openMode={openMode:2},personalTemplateKeyword="WordTemplates.Menu.PersonalWordTemplates.",sourceControlId=commandProperties["SourceControlId"];if(sourceControlId=="ViewAllMyTemplatesId"){_this.navigateToPersonalDocumentTemplates("recordlist","personaldocumenttemplate");return}var templateEntityName="documenttemplate";if(sourceControlId.indexOf(personalTemplateKeyword)!==-1)templateEntityName="personaldocumenttemplate";var templateId=sourceControlId.split(/[. ]+/).pop();if(templateId==="UploadTemplate"||templateId==="DownloadTemplate"){_this.openDocTemplateDialog(templateId,documentType,gridControl,isForm);return}var templateRef={id:"{"+templateId+"}",entityType:templateEntityName},recordsString=JSON.stringify(selectedRecords),r=new XrmCore.SdkContracts.ExportWordDocumentRequest(entityTypeCode,templateRef,recordsString);Xrm.Utility.showProgressIndicator(Xrm.Utility.getResourceString("Main_system_library","ExportToDocx_ProgressDialog_Header"));var deferred=Xrm.WebApi.online.execute(r).then(function(res){return res.json()}).then(function(odataResponse){var template=undefined;if(templateEntityName==="documenttemplate")template=ExportLibrary._systemTemplates.filter(function(obj){return obj.Id===templateId})[0];else template=ExportLibrary._personalTemplates.filter(function(obj){return obj.Id===templateId})[0];var file={fileContent:odataResponse.WordFile,fileName:XrmCore.InternalUtilities.ExportUtilities.generateExportFileName(template.Name,documentType),mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};Xrm.UI.addGlobalNotification(1,1,Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_Word_SucessfullyDownloaded"),null,null);return Xrm.Navigation.openFile(file,openMode)},function(errorResponse){Xrm.Utility.closeProgressIndicator();console.log(errorResponse);var errorMessage="";if(errorResponse.innerror&&errorResponse.innerror.message){if(errorResponse.innerror.message!="")errorMessage=errorResponse.innerror.message}else errorMessage=errorResponse.message;var errorDialogOptions={message:errorMessage,errorCode:errorResponse.errorCode};Xrm.Navigation.openErrorDialog(errorDialogOptions)}).then(function(res){console.log(res);Xrm.Utility.closeProgressIndicator()});return};this.navigateToPersonalDocumentTemplates=function(pageType,entityName){var personalDocTemplatePageInput={pageType:pageType,entityName:entityName};Xrm.Navigation.navigateTo(personalDocTemplatePageInput)};this.buildMenu=function(systemTemplates,personalTemplates,entityTypeName,isForm,contextType,ribbonRelationshipType,documentType){var menuId=XrmCore.InternalUtilities.ExportUtilities.determineRibbonMenuId(entityTypeName,isForm,contextType,ribbonRelationshipType,documentType,false),onlineMenuId=XrmCore.InternalUtilities.ExportUtilities.determineRibbonMenuId(entityTypeName,isForm,contextType,ribbonRelationshipType,documentType,true),commandId=XrmCore.InternalUtilities.ExportUtilities.determinRibbonCommandId(entityTypeName,isForm,contextType,ribbonRelationshipType,documentType,false),systemButtonsControl=XrmCore.InternalUtilities.ExportUtilities.buildControlsFromTemplates(menuId,onlineMenuId,commandId,systemTemplates,true,documentType),personalButtonsControl=XrmCore.InternalUtilities.ExportUtilities.buildControlsFromTemplates(menuId,onlineMenuId,commandId,personalTemplates,false,documentType),createcommandId=XrmCore.InternalUtilities.ExportUtilities.determinCreateRibbonCommandId(entityTypeName,isForm,contextType,documentType,true),createTemplates=XrmCore.InternalUtilities.ExportUtilities.retrieveCreateTemplates(),createuploadDownloadButtonsControl=XrmCore.InternalUtilities.ExportUtilities.buildControlsForCreate(menuId,createcommandId,createTemplates,false,documentType),menuSection1=XrmCore.InternalUtilities.ExportUtilities.buildMenuSection(menuId,false,documentType,true,10,createuploadDownloadButtonsControl),menuSection2=XrmCore.InternalUtilities.ExportUtilities.buildMenuSection(menuId,true,documentType,false,20,systemButtonsControl),menuSection3=XrmCore.InternalUtilities.ExportUtilities.buildMenuSection(menuId,false,documentType,false,30,personalButtonsControl),menuSections=[];menuSections.push(menuSection1);menuSections.push(menuSection2);menuSections.push(menuSection3);var menu=XrmCore.InternalUtilities.ExportUtilities.buildMenu(menuId,menuSections);return menu}}ExportLibrary._systemTemplates=[];ExportLibrary._personalTemplates=[];return ExportLibrary}();Commands.ExportLibrary=ExportLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Export=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.ExportLibrary:new Commands.ExportLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var ExportTelemetryHelper=function(){function ExportTelemetryHelper(){}ExportTelemetryHelper.getEventParams=function(entityTypeName,exportTypeName){var eventParams=[],entityTypeParam={name:"entityTypeName",value:entityTypeName},exportTypeParam={name:"exportTypeName",value:exportTypeName};eventParams.push(entityTypeParam);eventParams.push(exportTypeParam);return eventParams};ExportTelemetryHelper.logExportInitTelemetry=function(componentName,entityTypeName,exportTypeName){var eventParams=ExportTelemetryHelper.getEventParams(entityTypeName,exportTypeName);Xrm!=null&&Xrm.Reporting!=null&&Xrm.Reporting.reportSuccess(componentName,eventParams)};ExportTelemetryHelper.logExportDetailsTelemetry=function(componentName,entityTypeName,exportTypeName,viewName,viewEntityType,viewId){var viewNameParam={name:"viewName",value:viewName},viewEntityTypeParam={name:"viewEntityType",value:viewEntityType},viewIdParam={name:"viewId",value:viewId},eventParams=ExportTelemetryHelper.getEventParams(entityTypeName,exportTypeName);eventParams.push(viewEntityTypeParam);eventParams.push(viewIdParam);eventParams.push(viewNameParam);Xrm!=null&&Xrm.Reporting!=null&&Xrm.Reporting.reportSuccess(componentName,eventParams)};ExportTelemetryHelper.logExportSuccessTelemetry=function(componentName,entityTypeName,exportTypeName){var eventParams=ExportTelemetryHelper.getEventParams(entityTypeName,exportTypeName);Xrm!=null&&Xrm.Reporting!=null&&Xrm.Reporting.reportSuccess(componentName,eventParams)};ExportTelemetryHelper.logFailureTelemetry=function(componentName,err,entityTypeName,exportTypeName){var errorMessage;if(err.message&&err.message!=null&&err.message!="")errorMessage=err.message;else if(err.innerror&&err.innerror.message&&err.innerror.message!=null&&err.innerror.message!="")errorMessage=err.innerror.message;else errorMessage="Export to Excel Failed with unknown error";if(Xrm!=null&&Xrm.Reporting!=null){var errorParam={name:"ErrorResponse",message:errorMessage},eventParams=ExportTelemetryHelper.getEventParams(entityTypeName,exportTypeName);Xrm.Reporting.reportFailure(componentName,errorParam,"",eventParams)}};return ExportTelemetryHelper}();Commands.ExportTelemetryHelper=ExportTelemetryHelper})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var FlowsConstants=function(){function FlowsConstants(){}FlowsConstants.FlowFpiResponseIdsProcessed="FlowFpiResponseIdsProcessed";FlowsConstants.Flow_SessionStorage_CreateURL="flowCreateUrl";FlowsConstants.Flow_SessionStorage_ManageURL="flowManageUrl";FlowsConstants.Flow_SessionStorage_DefinitionList="flowDefinitionList";FlowsConstants.Flow_SessionStorage_UserLoginRequired="flowUserLoginRequired";FlowsConstants.Flow_SessionStorage_EntityLogicalName="dynamics365EntityLogicalName";FlowsConstants.Flow_SessionStorage_Dynamics365AccessToken="dynamics365AccessToken";FlowsConstants.Flow_LocalStorage_EnvironmentId="flowEnvironmentId";FlowsConstants.Flow_GlobalVar_EntityCollectionName="EntityLogicalCollectionName";FlowsConstants.Flow_GlobalVar_EntityLogicalName="EntityLogicalName";FlowsConstants.Flow_GlobalVar_IntegratedEnvironment="MICROSOFT_FLOW_INTEGRATED_ENVIRONMENT";FlowsConstants.Flow_GlobalVar_DestinationURL="MICROSOFT_FLOW_DESTINATIONURL";FlowsConstants.Flow_GlobalVar_FirstPartyURL="MICROSOFT_FLOW_FIRSTPARTYINTEGRATION_SITE_URL";FlowsConstants.Flow_GlobalVar_CrmOrgUniqueName="ORG_UNIQUE_NAME";FlowsConstants.Flow_GlobalVar_CrmOrgId="ORG_ID";FlowsConstants.Flow_Localization_CreateFlow="Flows_CreateFlow";FlowsConstants.Flow_Localization_ManageFlow="Flows_ManageFlows";FlowsConstants.Flow_Localization_LoginFlow="Flows_LoginFlow";FlowsConstants.Flow_Localization_RunWorkflow="Menu_Label_Run_Workflow";FlowsConstants.Flow_Localization_ManageFlowMenuSection="Flows_ManageFlowMenuSection";FlowsConstants.Flow_Localization_RunFlowMenuSection="Flows_RunFlowMenuSection";FlowsConstants.Flow_Localization_Authentication="SystemCustomization.SystemSettingsDialog.PreviewTab.IsMicrosoftFlowEnabled.AuthenticateButton.Text";FlowsConstants.Flow_Control_CreateFlow="Mscrm.Flows.TriggerFlow.CreateFlow";FlowsConstants.Flow_Control_ManageFlow="Mscrm.Flows.TriggerFlow.ManageFlows";FlowsConstants.Flow_Control_LoginFlow="Mscrm.Flows.TriggerFlow.LoginFlow";FlowsConstants.Flow_Settings_FlowSettings="ENABLE_MICROSOFT_FLOW_INTEGRATION";FlowsConstants.Flow_UciFpiUrl_ComponentId="FlowIntegrationUci";FlowsConstants.Flow_UciFpiUrl_ClientType="moca";FlowsConstants.Flow_UciFpiResources_FlowService="https://service.flow.microsoft.com/";FlowsConstants.Flow_UciFpiResources_GraphApi="https://graph.microsoft.com";return FlowsConstants}();Commands.FlowsConstants=FlowsConstants})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var FlowsDynamicMenuBuilder=function(){function FlowsDynamicMenuBuilder(){}FlowsDynamicMenuBuilder.buildMenuUCI=function(flowsLibrary,selectedEntityTypeName,isForm){var mainPromise=new Promise(function(resolve,reject){var menuXml=FlowsDynamicMenuBuilder.generateMenuXml(flowsLibrary,selectedEntityTypeName,isForm,true);resolve(menuXml)});return mainPromise};FlowsDynamicMenuBuilder.buildMenuWebClient=function(flowsLibrary,selectedEntityTypeName,isForm){var menuXml=FlowsDynamicMenuBuilder.generateMenuXml(flowsLibrary,selectedEntityTypeName,isForm,false);return menuXml};FlowsDynamicMenuBuilder.generateMenuXml=function(flowsLibrary,entityName,isForm,isUCI){menuSectionCount=1;var menuSection1Title=flowsLibrary.getLocalizedLabel(Commands.FlowsConstants.Flow_Localization_ManageFlowMenuSection),menuSection1='<MenuSection Id="Mscrm.DynamicMenu.Flows.MenuSection'+menuSectionCount+'" Title="'+menuSection1Title+'" Sequence="'+menuSectionCount*10+'"><Controls Id="Mscrm.DynamicMenu.Flows.Controls'+menuSectionCount+'">',controls="";menuSectionCount++;menuSequence=10;var label=flowsLibrary.getLocalizedLabel(Commands.FlowsConstants.Flow_Localization_CreateFlow);controls+=FlowsDynamicMenuBuilder.generateControlXml(label,menuSequence,Commands.FlowsConstants.Flow_Control_CreateFlow,entityName,isForm,isUCI);menuSequence+=10;label=flowsLibrary.getLocalizedLabel(Commands.FlowsConstants.Flow_Localization_ManageFlow);controls+=FlowsDynamicMenuBuilder.generateControlXml(label,menuSequence,Commands.FlowsConstants.Flow_Control_ManageFlow,entityName,isForm,isUCI);menuSequence+=10;var flowLoginRequired=sessionStorage.getItem(Commands.FlowsConstants.Flow_SessionStorage_UserLoginRequired);if(flowLoginRequired==null||flowLoginRequired=="true"){label=flowsLibrary.getLocalizedLabel(Commands.FlowsConstants.Flow_Localization_LoginFlow);controls+=FlowsDynamicMenuBuilder.generateControlXml(label,menuSequence,Commands.FlowsConstants.Flow_Control_LoginFlow,entityName,isForm,isUCI);menuSequence+=10}menuSection1+=controls+"</Controls></MenuSection>";var menuSection2Title=flowsLibrary.getLocalizedLabel(Commands.FlowsConstants.Flow_Localization_RunFlowMenuSection),menuSection2='<MenuSection Id="Mscrm.DynamicMenu.Flows.MenuSection'+menuSectionCount+'" Title="'+menuSection2Title+'" Sequence="'+menuSectionCount*10+'"><Controls Id="Mscrm.DynamicMenu.Flows.Controls'+menuSectionCount+'">',flowDefinitions=sessionStorage.getItem(Commands.FlowsConstants.Flow_SessionStorage_DefinitionList+"_"+entityName);menuSequence=10;controls="";if(flowDefinitions!=null&&flowLoginRequired=="false"){var flowDefinitionList=[];flowDefinitionList=JSON.parse(flowDefinitions);if(flowDefinitionList.length>0){flowDefinitionList.forEach(function(flow){controls+=FlowsDynamicMenuBuilder.generateControlXml(flow.displayName,menuSequence,flow.name,entityName,isForm,isUCI);menuSequence+=10});menuSection2+=controls+"</Controls></MenuSection>";menuSectionCount++}else menuSection2=""}else menuSection2="";var flowMenuSection=menuSection1+menuSection2;return flowMenuSection};FlowsDynamicMenuBuilder.generateControlXml=function(label,sequence,buttonId,entityName,isForm,isUCI){var page="HomePageGrid";if(isForm)page="Form";var commandId=entityName+"|NoRelationship|"+page+"|Mscrm.Flows.TriggerFlow";if(!isUCI)commandId="Mscrm.Flows.TriggerFlow";var button='<Button Id="'+buttonId+'" Command="'+commandId+'" Sequence="'+sequence+'" LabelText="'+label+'" Alt="'+label+'" Image16by16="/_imgs/Ribbon/OpenFlows_16.png" Image32by32="/_imgs/Ribbon/OpenFlows_32.png" ModernImage="Flows" />';return button};return FlowsDynamicMenuBuilder}();Commands.FlowsDynamicMenuBuilder=FlowsDynamicMenuBuilder;var WorkflowDynamicMenuBuilder=function(){function WorkflowDynamicMenuBuilder(){}WorkflowDynamicMenuBuilder.buildMenuUCI=function(flowsLibrary,entityCollection,selectedEntityTypeName,isForm){var menuXml=WorkflowDynamicMenuBuilder.generateMenuXml(flowsLibrary,entityCollection,selectedEntityTypeName,false,true);return menuXml};WorkflowDynamicMenuBuilder.generateMenuXml=function(flowsLibrary,entityCollection,entityName,isForm,isUCI){var workflowMenuSection="",menuSectionTitle=flowsLibrary.getLocalizedLabel(Commands.FlowsConstants.Flow_Localization_RunWorkflow),menuSection='<MenuSection Id="Mscrm.DynamicMenu.Flows.MenuSection'+menuSectionCount+'" Title="'+menuSectionTitle+'" Sequence="'+menuSectionCount*10+'"><Controls Id="Mscrm.DynamicMenu.Flows.Controls'+menuSectionCount+'">';menuSequence=10;var controls="";if(entityCollection.length>0){entityCollection.forEach(function(workflow){var label=workflow.name,buttonId=workflow.workflowid;controls+=WorkflowDynamicMenuBuilder.generateControlXml(label,menuSequence,buttonId,entityName,isForm,isUCI);menuSequence+=10});menuSection+=controls+"</Controls></MenuSection>"}else menuSection="";return workflowMenuSection=menuSection};WorkflowDynamicMenuBuilder.generateControlXml=function(label,sequence,buttonId,entityName,isForm,isUCI){var button="",page="HomePageGrid";if(isForm)page="Form";var commandId=entityName+"|NoRelationship|"+page+"|Mscrm.Flows.TriggerWorkflow";if(!isUCI)commandId="Mscrm.Flows.TriggerWorkflow";var button='<Button Id="'+buttonId+'" Command="'+commandId+'" Sequence="'+sequence+'" LabelText="'+label+'" Alt="'+label+'" Image16by16="/_imgs/Ribbon/OpenFlows_16.png" Image32by32="/_imgs/Ribbon/OpenFlows_32.png" ModernImage="Flows" />';return button};return WorkflowDynamicMenuBuilder}();Commands.WorkflowDynamicMenuBuilder=WorkflowDynamicMenuBuilder})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var MicrosoftFlowsTelemetryReporter=MscrmControls.Containers.MicrosoftFlowsTelemetryReporter,ExecuteOnDemandWorkflowRequest=function(){function ExecuteOnDemandWorkflowRequest(){}ExecuteOnDemandWorkflowRequest.prototype.getMetadata=function(){var metadata={boundParameter:"entity",parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.workflow",structuralProperty:5},EntityId:{typeName:"Edm.Guid",structuralProperty:1},InputArguments:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}},operationName:"ExecuteWorkflow",operationType:0};return metadata};return ExecuteOnDemandWorkflowRequest}();Commands.ExecuteOnDemandWorkflowRequest=ExecuteOnDemandWorkflowRequest;var FlowsLibrary=function(){function FlowsLibrary(){var _this=this;this.populateMenu=function(commandProperties,entityLogicalName,isForm){var context=Xrm.Utility.getGlobalContext();if(context&&context.client&&context.client.getClient()==Xrm.Constants.ClientNames.outlook){commandProperties["PopulationXML"]="";return}_this.populateFlowMenu(commandProperties,entityLogicalName,isForm)};this.populateFlowMenu=function(commandProperties,entityLogicalName,isForm){try{if(!entityLogicalName&&isForm&&Xrm.Page.data&&Xrm.Page.data.entity)entityLogicalName=Xrm.Page.data.entity.getEntityName();var flowEnvironmentID=_this.microsoftFlowEnvironmentId(),getFlowDefinitionListPromise_1=function(){return _this.getFlowDefinitionList(flowEnvironmentID,entityLogicalName,_this)};if(Xrm.Internal.isUci()){var buildMenuPromise=function(){return Commands.FlowsDynamicMenuBuilder.buildMenuUCI(_this,entityLogicalName,isForm)},menuXmlPromise=function(){return getFlowDefinitionListPromise_1().then(function(){return buildMenuPromise()},function(error){return buildMenuPromise()})},ovarallPromise=menuXmlPromise;if(_this.isInUciShim()){var fpiDomain=_this.getFirstPartyIntegrationDomain(),initTokensPromise=Xrm.Utility.beginSecureSessionForResource(Commands.FlowsConstants.Flow_UciFpiResources_FlowService,Commands.FlowsConstants.Flow_UciFpiUrl_ComponentId,fpiDomain);ovarallPromise=function(){return initTokensPromise.then(function(expDate){return menuXmlPromise()},function(errorCode){console.error("Shim failed to init the Flow Token with error code: %d",errorCode);return buildMenuPromise()})}}if(_this.isMicrosoftFlowEnabled()&&Xrm.Internal.isFeatureEnabled("OnDemandWorkflowUCI"))commandProperties["PopulationXML"]=ovarallPromise().then(function(flowMenuSectionPromise){var flowMenuPromise=(new Promise(function(resolve){resolve(_this.populateWorkflowMenu(commandProperties,entityLogicalName,isForm))})).then(function(workflowMenuSectionPromise){var flowMenu='<Menu Id="Mscrm.DynamicMenu.Flows">'+flowMenuSectionPromise+workflowMenuSectionPromise+"</Menu>";return flowMenu});return flowMenuPromise});else commandProperties["PopulationXML"]=ovarallPromise()}else{getFlowDefinitionListPromise_1();var webMenuSection=Commands.FlowsDynamicMenuBuilder.buildMenuWebClient(_this,entityLogicalName,isForm);commandProperties["PopulationXML"]='<Menu Id="Mscrm.DynamicMenu.Flows">'+webMenuSection+"</Menu>"}}catch(exception){console.error(exception);_this.microsoftFlowsTelemetryReporter.logFlowErrorEvent(_this.tenantId,null,"FlowsLibrary",exception,"PopulateMenu",exception);commandProperties["PopulationXML"]="";var errorResponse={errorCode:2147811937,message:exception};XrmCore.InternalUtilities.GenericUtilities.HandleErrorMessage(errorResponse)}};this.populateWorkflowMenu=function(commandProperties,entityLogicalName,isForm){try{if(!entityLogicalName&&isForm&&Xrm.Page.data&&Xrm.Page.data.entity)entityLogicalName=Xrm.Page.data.entity.getEntityName();var entityTypeCode=Xrm.Internal.getEntityCode(entityLogicalName),queryFetchXml="<fetch mapping='logical' distinct='true'><entity name='workflow'><attribute name='workflowid'/><attribute name='name'/>",queryConditionEntityCodeXml="<condition attribute='primaryentity' operator='eq' value='"+entityTypeCode+"' />",queryConditionOnDemandXml="<condition attribute='ondemand' operator='eq' value='1' />",queryConditionCategoryXml="<condition attribute='category' operator='eq' value='0' />",queryConditionTypeXml="<condition attribute='type' operator='eq' value='1' />",queryConditionStateXml="<condition attribute='statecode' operator='eq' value='1' />",queryConditionStatusXml="<condition attribute='statuscode' operator='eq' value='2' />",queryXml=queryFetchXml+"<filter type='and'>"+queryConditionEntityCodeXml+queryConditionOnDemandXml+queryConditionCategoryXml+queryConditionTypeXml+queryConditionStateXml+queryConditionStatusXml+"</filter></entity></fetch>",workflowMenuPromise=new Promise(function(resolve,reject){Xrm.WebApi.online.retrieveMultipleRecords("workflow","?fetchXml= "+queryXml).then(function(collection){var entityCollection=collection.entities;if(entityCollection.length>0)Xrm.Internal.isUci()&&resolve(Commands.WorkflowDynamicMenuBuilder.buildMenuUCI(_this,entityCollection,entityLogicalName,isForm));else resolve("")},function(errorResponse){console.error(errorResponse.message);_this.microsoftFlowsTelemetryReporter.logFlowErrorEvent(_this.tenantId,null,"FlowsLibrary",null,"PopulateWorkflowMenu",errorResponse.message);XrmCore.InternalUtilities.GenericUtilities.HandleErrorMessage(errorResponse);resolve("")})});return workflowMenuPromise}catch(exception){console.error(exception);_this.microsoftFlowsTelemetryReporter.logFlowErrorEvent(_this.tenantId,null,"FlowsLibrary",exception,"PopulateWorkflowMenu",exception);var errorResponse={errorCode:2147811937,message:exception};XrmCore.InternalUtilities.GenericUtilities.HandleErrorMessage(errorResponse);return ""}};this.getLocalizedLabel=function(lcid){if(Xrm.Internal.isUci())return Xrm.Utility.getResourceString("Main_system_library",lcid);else return Xrm.Internal.getResourceString(lcid)};this.getUrlVars=function(str){for(var vars=[],hash,hashes=str.slice(str.indexOf("?")+1).split("&"),i=0;i<hashes.length;i++){hash=hashes[i].split("=");vars.push(hash[0]);vars[hash[0]]=hash[1]}return vars};this.microsoftFlowDestinationUrl=function(){if(Xrm.Internal.isUci())return Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowDestinationUrl");else return window.parent[Commands.FlowsConstants.Flow_GlobalVar_DestinationURL]};this.getMicrosoftFlowFirstPartyIntegrationSiteUrl=function(){if(Xrm.Internal.isUci()){var url=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowFirstPartyIntegrationSiteUrl");if(_this.isInUciShim()){url+="&componentId="+Commands.FlowsConstants.Flow_UciFpiUrl_ComponentId;url+="&client="+Commands.FlowsConstants.Flow_UciFpiUrl_ClientType}return url}else return window.parent[Commands.FlowsConstants.Flow_GlobalVar_FirstPartyURL]};this.triggerFlow=function(commandProperties,selectedRecords,entityLogicalName){var controlId=commandProperties["SourceControlId"];if(!entityLogicalName&&Xrm.Page.data&&Xrm.Page.data.entity)entityLogicalName=Xrm.Page.data.entity.getEntityName();switch(controlId){case Commands.FlowsConstants.Flow_Control_CreateFlow:_this.createFlow(entityLogicalName);break;case Commands.FlowsConstants.Flow_Control_ManageFlow:_this.manageFlows();break;default:var orgUniqueName=FlowsLibrary.orgUniqueName();_this.getEntityCollectionNamePromise(entityLogicalName).then(function(entityLogicalCollectionName){_this.triggerFlowForDynamicDefinition(controlId,selectedRecords,orgUniqueName,entityLogicalName,entityLogicalCollectionName)});break}};this.triggerWorkflow=function(commandProperties,selectedRecords,entityLogicalName){var controlId=commandProperties["SourceControlId"];if(!entityLogicalName&&Xrm.Page.data&&Xrm.Page.data.entity)entityLogicalName=Xrm.Page.data.entity.getEntityName();var entityIds=[];if(selectedRecords!=null){var records=selectedRecords.length;if(records===0)try{Xrm.Page.data.entity&&Xrm.Page.data.entity.getEntityName()&&entityIds.push(_this.removeCurlyBracesFromEntityRecordId(Xrm.Page.data.entity.getId()))}catch(exception){var errorResponse={errorCode:2147811938,message:""};XrmCore.InternalUtilities.GenericUtilities.HandleErrorMessage(errorResponse);return}else for(var i=0;i<records;i++)entityIds.push(_this.removeCurlyBracesFromEntityRecordId(selectedRecords[i].Id))}var confirmSubtitle,confirmText,entityDisplayName,entityCollectionDisplayName;_this.getEntityDisplayNamePromiseUCI(entityLogicalName,true).then(function(collectionDisplayName){entityCollectionDisplayName=collectionDisplayName==null||collectionDisplayName.length==0?entityLogicalName:collectionDisplayName;_this.getEntityDisplayNamePromiseUCI(entityLogicalName,false).then(function(displayName){entityDisplayName=displayName==null||displayName.length==0?entityLogicalName:displayName;try{confirmSubtitle=Xrm.Utility.getResourceString("Main_system_library","Dialog_RunWorkflow_Description");confirmSubtitle=XrmCore.InternalUtilities.GenericUtilities.stringFormat(confirmSubtitle,[entityIds.length,entityIds.length>1?entityCollectionDisplayName:entityDisplayName]);confirmText=Xrm.Utility.getResourceString("Main_system_library","Dialog_RunWorkflow_Body")+" "+Xrm.Utility.getResourceString("Main_system_library","Dialog_RunWorkflow_Body_Confirm");confirmText=XrmCore.InternalUtilities.GenericUtilities.stringFormat(confirmText,[entityDisplayName]);var confirmOptions={title:_this.getLocalizedLabel("Dialog_Runworkflow_Title"),subtitle:confirmSubtitle,text:confirmText}}catch(exception){console.error(exception);_this.microsoftFlowsTelemetryReporter.logFlowErrorEvent(_this.tenantId,null,"FlowsLibrary",exception,"TriggerWorkflow",exception);var errorResponse={errorCode:2147811937,message:exception};XrmCore.InternalUtilities.GenericUtilities.HandleErrorMessage(errorResponse);return}Xrm.Navigation.openConfirmDialog(confirmOptions).then(function(dialogResponse){if(dialogResponse.confirmed)entityIds.length>0&&entityIds.forEach(function(entityId){var request=new ExecuteOnDemandWorkflowRequest;request.InputArguments=null;request.entity={id:controlId,entityType:"workflow"};request.EntityId={guid:entityId};Xrm.WebApi.online.execute(request).then(function(sucessResponse){var successProperties={TenantId:_this.tenantId,FlowRunResult:"Success",NoOfEntityRecords:1,EntityLogicalName:entityLogicalName,FlowId:controlId,FlowEnvironmentId:null};_this.microsoftFlowsTelemetryReporter.logFlowTelemetryEvent("Triggered",successProperties)},function(errorResponse){console.error(errorResponse.message);_this.microsoftFlowsTelemetryReporter.logFlowErrorEvent(_this.tenantId,null,"FlowsLibrary",null,"TriggerWorkflow",errorResponse.message);XrmCore.InternalUtilities.GenericUtilities.HandleErrorMessage(errorResponse)})})})})})};this.createFlow=function(entityLogicalName){var flowCreateUrl=sessionStorage[Commands.FlowsConstants.Flow_SessionStorage_CreateURL+"_"+entityLogicalName];if(flowCreateUrl!=null)if(_this.isInUciShim())Xrm.Navigation.openUrl(flowCreateUrl);else window.parent.open(flowCreateUrl,"_blank")};this.manageFlows=function(){var flowManageUrl=sessionStorage[Commands.FlowsConstants.Flow_SessionStorage_ManageURL];if(flowManageUrl!=null)if(_this.isInUciShim())Xrm.Navigation.openUrl(flowManageUrl);else window.parent.open(flowManageUrl,"_blank")};this.triggerFlowForDynamicDefinition=function(definitionId,selectedRecords,orgUniqueName,entityLogicalName,entityLogicalCollectionName){var entityIds=[];if(selectedRecords!=null){var records=selectedRecords.length;if(records===0)try{Xrm.Page.data.entity&&Xrm.Page.data.entity.getEntityName()&&entityIds.push(_this.removeCurlyBracesFromEntityRecordId(Xrm.Page.data.entity.getId()))}catch(exception){}else for(var i=0;i<records;i++)entityIds.push(_this.removeCurlyBracesFromEntityRecordId(selectedRecords[i].Id))}var flowLoginRequired=sessionStorage.getItem(Commands.FlowsConstants.Flow_SessionStorage_UserLoginRequired);if(entityIds.length===0&&flowLoginRequired&&flowLoginRequired==="false"){if(definitionId!==Commands.FlowsConstants.Flow_Control_LoginFlow){var errorResponse={errorCode:2147811938,message:""};XrmCore.InternalUtilities.GenericUtilities.HandleErrorMessage(errorResponse)}return}var entityIdCollection=JSON.stringify(entityIds),dynamics365AccessToken=sessionStorage.getItem(Commands.FlowsConstants.Flow_SessionStorage_Dynamics365AccessToken);if(_this.isInUciShim()){var authenticationManager=Microsoft.Crm.Client.Core.Framework.AuthenticationManager;if(authenticationManager){var authManagerInstance=authenticationManager.get_defaultInstance();if(authManagerInstance){if(authManagerInstance.get_authToken())dynamics365AccessToken=authManagerInstance.get_authToken();!dynamics365AccessToken&&console.error("Failed to get the token from the Shim")}}}var dialogParams={};dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityIdCollection]=entityIdCollection;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.FlowId]=definitionId;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.FlowsEnvironmentId]=_this.microsoftFlowEnvironmentId();dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.OrgUniqueName]=orgUniqueName;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityLogicalCollectionName]=entityLogicalCollectionName;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityLogicalName]=entityLogicalName;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Dynamics365AccessToken]=dynamics365AccessToken;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.FlowsDestinationURL]=_this.microsoftFlowDestinationUrl();dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.FlowsFPISiteURL]=_this.getMicrosoftFlowFirstPartyIntegrationSiteUrl();dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.FlowsAuthenticationString]=_this.getLocalizedLabel(Commands.FlowsConstants.Flow_Localization_Authentication);var dialogOptions={};dialogOptions.height=600;dialogOptions.width=600;Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.MicrosoftFlowsDialog,dialogOptions,dialogParams)};this.onFlowsDialogLoad=function(eventContext){var label="",flowLoginRequired=sessionStorage.getItem(Commands.FlowsConstants.Flow_SessionStorage_UserLoginRequired);if(flowLoginRequired==null||flowLoginRequired=="true")label=_this.getLocalizedLabel(Commands.FlowsConstants.Flow_Localization_LoginFlow);else if(eventContext!=null){var formContext=eventContext.getFormContext();if(formContext!=null&&formContext.data!=null&&formContext.data.attributes!=null){var dialogAttributes=formContext.data.attributes,definitionId=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.FlowId).getValue(),entityLogicalName=dialogAttributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityLogicalName).getValue();label=_this.getFlowDisplayName(eventContext,entityLogicalName,definitionId)}}if(!label)return;else Xrm.Page.ui.controls.get("lbl_flows").setLabel(label)};this.flowsDialogCloseCallback=function(eventContext){if(Xrm.Internal.isUci)XrmCore.InternalUtilities.DialogUtilities.closeDialog(eventContext);else Commands.Common.closeDialogLegacy();var flowEnvironmentId=_this.microsoftFlowEnvironmentId();_this.getFlowDefinitionList(flowEnvironmentId,window[Commands.FlowsConstants.Flow_GlobalVar_EntityLogicalName],_this)};this.getFlowDisplayName=function(eventContext,entityLogicalName,definitionId){var label="",flowDefinitions=sessionStorage.getItem(Commands.FlowsConstants.Flow_SessionStorage_DefinitionList+"_"+entityLogicalName);if(flowDefinitions!=null){var flowDefinitionList=[];flowDefinitionList=JSON.parse(flowDefinitions);flowDefinitionList!=null&&flowDefinitionList.length>0&&flowDefinitionList.forEach(function(flow){if(flow.name===definitionId)label=flow.displayName})}return label};this.removeCurlyBracesFromEntityRecordId=function(recordId){recordId=recordId.replace("{","");recordId=recordId.replace("}","");return recordId};this.isMicrosoftFlowEnabled=function(){try{var isFlowsEnabled=true;if(Xrm.Internal.isUci())isFlowsEnabled=!XrmCore.InternalUtilities.DialogUtilities.isOffline()&&Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("IsMicrosoftFlowEnabled")&&Xrm.Internal.isFeatureEnabled("FlowIntegration");else isFlowsEnabled=window.top[Commands.FlowsConstants.Flow_Settings_FlowSettings];return isFlowsEnabled}catch(ex){console.error(ex)}return false}}FlowsLibrary.prototype.microsoftFlowEnvironmentId=function(){return localStorage.getItem(Commands.FlowsConstants.Flow_LocalStorage_EnvironmentId)};FlowsLibrary.prototype.updateEnvironmentIdCache=function(environmentId){environmentId&&localStorage.setItem(Commands.FlowsConstants.Flow_LocalStorage_EnvironmentId,environmentId)};FlowsLibrary.prototype.clearEnvironmentIdCache=function(){localStorage.removeItem(Commands.FlowsConstants.Flow_LocalStorage_EnvironmentId)};FlowsLibrary.prototype.getFirstPartyIntegrationDomain=function(){var a=document.createElement("a");a.href=this.microsoftFlowDestinationUrl();return a.hostname};FlowsLibrary.prototype.isInUciShim=function(){if(Xrm.Internal.isUci()){var context=Xrm.Utility.getGlobalContext();if(context&&context.client)return context.client.getClient()==Xrm.Constants.ClientNames.mobile}return false};FlowsLibrary.prototype.getOrganizationId=function(){var orgSettings=Xrm.Utility.getGlobalContext().organizationSettings;if(orgSettings)return orgSettings.organizationId;else{var crmOrganizationId=window[Commands.FlowsConstants.Flow_GlobalVar_CrmOrgId];if(!crmOrganizationId&&window.parent)crmOrganizationId=window.parent[Commands.FlowsConstants.Flow_GlobalVar_CrmOrgId];return crmOrganizationId}};FlowsLibrary.prototype.getEntityCollectionNamePromise=function(entityName){var entityCollectionNamePromise;if(Xrm.Internal.isUci()){var entityMetadataPromise=Xrm.Utility.getEntityMetadata(entityName);entityCollectionNamePromise=entityMetadataPromise.then(function(entityMetadata){return entityMetadata.EntitySetName},function(){console.error("Failed to get EntityCollectionName for '%s' entity",entityName)})}else{var entityColllectionName=window[Commands.FlowsConstants.Flow_GlobalVar_EntityCollectionName];if(!entityColllectionName)if(Xrm.Page.data&&Xrm.Page.data.entity&&Xrm.Page.data.entity.getEntitySetName)entityColllectionName=Xrm.Page.data.entity.getEntitySetName();else if(Xrm.Internal&&Xrm.Internal.getEntitySetName)entityColllectionName=Xrm.Internal.getEntitySetName(entityName);entityCollectionNamePromise=Promise.resolve(entityColllectionName)}return entityCollectionNamePromise};FlowsLibrary.prototype.getEntityDisplayNamePromiseUCI=function(entityName,getCollectionName){var _this=this,entityDisplayNamePromise,entityMetadataPromise=Xrm.Utility.getEntityMetadata(entityName);entityDisplayNamePromise=entityMetadataPromise.then(function(entityMetadata){return getCollectionName?entityMetadata.DisplayCollectionName:entityMetadata.DisplayName},function(errorResponse){console.error(errorResponse.message);_this.microsoftFlowsTelemetryReporter.logFlowErrorEvent(_this.tenantId,null,"FlowsLibrary",null,"GetEntityDisplayNamePromiseUCI",errorResponse.message);return entityName});return entityDisplayNamePromise};FlowsLibrary.prototype.getFlowDefinitionList=function(environmentId,entityLogicalName,obj){var _this=this;try{this.microsoftFlowsTelemetryReporter=new MicrosoftFlowsTelemetryReporter;if(Xrm&&Xrm.Utility&&Xrm.Utility.getGlobalContext()){var clientType="";if(Xrm.Internal&&Xrm.Internal.isUci())clientType="UCI";this.microsoftFlowsTelemetryReporter.init(Xrm.Utility.getGlobalContext().getClientUrl(),clientType)}this.microsoftFlowFirstPartyIntegrationSiteUrl=this.getMicrosoftFlowFirstPartyIntegrationSiteUrl();if(this.microsoftFlowFirstPartyIntegrationSiteUrl)this.tenantId=this.getUrlVars(this.microsoftFlowFirstPartyIntegrationSiteUrl)["tenantId"]}catch(exception){console.error(exception)}var entityCollectionNamePromise=this.getEntityCollectionNamePromise(entityLogicalName);return entityCollectionNamePromise.then(function(dynamics365EntityLogicalCollectionName){return _this.getFlowDefinitionListPromise(environmentId,entityLogicalName,dynamics365EntityLogicalCollectionName)})};FlowsLibrary.prototype.getFlowDefinitionListPromise=function(environmentId,entityLogicalName,dynamics365EntityLogicalCollectionName){var _this=this,mainPromise=new Promise(function(resolve,reject){var performanceTrackers={};performanceTrackers.startFlowDefinitionsLoadTime=performance.now();performanceTrackers.startAttemptToSilentlyAuthenticateTime=null;var destinationOrigin=_this.microsoftFlowDestinationUrl(),dynamics365OrganizationUniqueName=FlowsLibrary.orgUniqueName(),targetURL=_this.microsoftFlowFirstPartyIntegrationSiteUrl,organizationId=_this.getOrganizationId(),iframeWindow,cachedDefinitionsListStr=sessionStorage.getItem(Commands.FlowsConstants.Flow_SessionStorage_DefinitionList+"_"+entityLogicalName);if(cachedDefinitionsListStr){var cachedDefinitionsList=JSON.parse(cachedDefinitionsListStr);cachedDefinitionsList&&resolve(cachedDefinitionsList)}if(document.getElementById("flowIframe"))iframeWindow=document.getElementById("flowIframe");else{iframeWindow=document.createElement("iframe");iframeWindow.style.display="none";iframeWindow.className="flowClassIframe";iframeWindow.name="flowIframe";iframeWindow.id="flowIframe";document.body.appendChild(iframeWindow)}iframeWindow.src=targetURL;window[Commands.FlowsConstants.FlowFpiResponseIdsProcessed]={};_this.activeMessageEventListener&&window.removeEventListener("message",_this.activeMessageEventListener);_this.activeMessageEventListener=function(e){_this.fpiMessageHandler(e,iframeWindow,targetURL,dynamics365OrganizationUniqueName,entityLogicalName,dynamics365EntityLogicalCollectionName,environmentId,destinationOrigin,organizationId,performanceTrackers,resolve,reject)};window.addEventListener&&window.addEventListener("message",_this.activeMessageEventListener,false)});return mainPromise};FlowsLibrary.prototype.fpiMessageHandler=function(e,iframeWindow,targetURL,dynamics365OrganizationUniqueName,dynamics365EntityLogicalName,dynamics365EntityLogicalCollectionName,environmentId,destinationOrigin,organizationId,performanceTrackers,resolveCallback,rejectCallback){if(!e||!e.data||!e.data.isResponse||!e.data.requestId||!e.data.method)return;if(e.data.requestId){if(window[Commands.FlowsConstants.FlowFpiResponseIdsProcessed][e.data.requestId])return;window[Commands.FlowsConstants.FlowFpiResponseIdsProcessed][e.data.requestId]=true}var iFrameContentWindow=iframeWindow.contentWindow;if(e.data.method==="MicrosoftFlowAppLoaded"){iFrameContentWindow.postMessage({method:"GetFlowWebsiteUrls",params:{environment:environmentId,dynamics365OrganizationUniqueName:dynamics365OrganizationUniqueName,dynamics365EntityLogicalCollectionName:dynamics365EntityLogicalCollectionName,dynamics365EntityLogicalName:dynamics365EntityLogicalName,dynamics365OrganizationId:organizationId}},destinationOrigin);performanceTrackers.startAttemptToSilentlyAuthenticateTime=performance.now();iFrameContentWindow.postMessage({method:"AttemptToSilentlyAuthenticate"},destinationOrigin)}else if(e.data.method==="UserLoginCompleted"){var userAuthTime=performance.now()-performanceTrackers.startAttemptToSilentlyAuthenticateTime;userAuthTime>0&&this.microsoftFlowsTelemetryReporter.logFlowAuthenticationEvent(this.tenantId,"Success",userAuthTime,false);iframeWindow.src=targetURL}else if(e.data.method==="AttemptToSilentlyAuthenticate")if(e.data.response&&e.data.response.success){performanceTrackers.startFlowDefinitionsLoadTime=performance.now();sessionStorage.setItem(Commands.FlowsConstants.Flow_SessionStorage_UserLoginRequired,"false");var authTime=performance.now()-performanceTrackers.startAttemptToSilentlyAuthenticateTime;authTime>0&&this.microsoftFlowsTelemetryReporter.logFlowAuthenticationEvent(this.tenantId,"Success",authTime,true);iFrameContentWindow.postMessage({method:"GetDefinitionsList",params:{environment:environmentId,dynamics365OrganizationUniqueName:dynamics365OrganizationUniqueName,dynamics365EntityLogicalCollectionName:dynamics365EntityLogicalCollectionName,dynamics365EntityLogicalName:dynamics365EntityLogicalName,dynamics365OrganizationId:organizationId}},destinationOrigin)}else{sessionStorage.setItem(Commands.FlowsConstants.Flow_SessionStorage_UserLoginRequired,"true");rejectCallback(null)}else if(e.data.method==="GetDefinitionsList")if(!e.data.isFailure){var flowDefinitions=[],endFlowDefinitionsLoadTime=performance.now(),returnedEnvironmentId=e.data.response.environmentId;if(returnedEnvironmentId){this.updateEnvironmentIdCache(returnedEnvironmentId);environmentId=returnedEnvironmentId}for(var flows=e.data.response.flows,flowCount=0,n=0;n<flows.length;++n){flowDefinitions[n]={name:flows[n].name,displayName:flows[n].displayName};flowCount=flowCount+1}sessionStorage.setItem(Commands.FlowsConstants.Flow_SessionStorage_DefinitionList+"_"+dynamics365EntityLogicalName,JSON.stringify(flowDefinitions));window.removeEventListener("message",this.activeMessageEventListener);var oLoadDefFromService=e.data.performanceInfo,timetoLoadDefFromService=0;if(oLoadDefFromService!=undefined)timetoLoadDefFromService=oLoadDefFromService.getDefinitionsListTimeMs;var timeTaken=Math.floor(endFlowDefinitionsLoadTime-performanceTrackers.startFlowDefinitionsLoadTime);this.microsoftFlowsTelemetryReporter.logFlowDefinitionsListEvent(this.tenantId,environmentId,flowCount,timeTaken,timetoLoadDefFromService,dynamics365EntityLogicalName);resolveCallback(flowDefinitions)}else{e.data.response&&e.data.response.status==403&&this.clearEnvironmentIdCache();rejectCallback(e.data.errorMessage)}else if(e.data.method==="GetFlowWebsiteUrls")if(e.data.response&&e.data.response.success){var returnedEnvironmentId=e.data.response.environmentId;if(returnedEnvironmentId){this.updateEnvironmentIdCache(returnedEnvironmentId);environmentId=returnedEnvironmentId}else console.warn("GetFlowWebsiteUrls did not get the environment Id in real time. Flow URLs are not going to be environment specific.");sessionStorage.setItem("flowCreateUrl_"+dynamics365EntityLogicalName,e.data.response.createFlowUrl);sessionStorage.setItem("flowManageUrl",e.data.response.manageFlowsUrl)}if(e.data.isFailure){var errMsg=e.data.errorMessage.replace(/'/g,"\\'"),methodName=e.data.method,errorSource=e.data.errorSource,response="";if(e.data.response)response=JSON.stringify(e.data.response);this.microsoftFlowsTelemetryReporter.logFlowErrorEvent(this.tenantId,environmentId,errorSource,response,methodName,errMsg)}};FlowsLibrary.orgUniqueName=function(){if(Xrm.Internal.isUci())return Xrm.Utility.getGlobalContext().getOrgUniqueName();else{var crmOrgUniqueName=window[Commands.FlowsConstants.Flow_GlobalVar_CrmOrgUniqueName];if(!crmOrgUniqueName&&window.parent)crmOrgUniqueName=window.parent[Commands.FlowsConstants.Flow_GlobalVar_CrmOrgUniqueName];return crmOrgUniqueName}};return FlowsLibrary}();Commands.FlowsLibrary=FlowsLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Flows=new Commands.FlowsLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Delete=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.DeleteLibrary:new Commands.DeleteLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var HierarchyLibraryLegacy=function(){function HierarchyLibraryLegacy(){}HierarchyLibraryLegacy.prototype.ViewHierarchy=function(entityTypeCode,form){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.viewHierarchy(entityTypeCode):backCompatHeader.Mscrm.CommandBarActions.viewHierarchy(entityTypeCode)};HierarchyLibraryLegacy.prototype.ViewHierarchyFromGrid=function(selectedRecords,entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.viewHierarchyFromGrid(selectedRecords,entityTypeCode):backCompatHeader.Mscrm.CommandBarActions.viewHierarchyFromGrid(selectedRecords,entityTypeCode)};return HierarchyLibraryLegacy}();Commands.HierarchyLibraryLegacy=HierarchyLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var HierarchyControlName="MscrmControls.HierarchyControl.HierarchyControl",CustomControlPageType="control",HierarchyLibrary=function(){function HierarchyLibrary(){}HierarchyLibrary.prototype.ViewHierarchy=function(entityTypeCode,form){var dataInput={};dataInput.etn=form.data.entity.getEntityName();dataInput.id=form.data.entity.getId().replace("{","").replace("}","");var controlInput={};controlInput.pageType=CustomControlPageType;controlInput.controlName=HierarchyControlName;controlInput.data=dataInput;Xrm.Navigation.navigateTo(controlInput)};HierarchyLibrary.prototype.ViewHierarchyFromGrid=function(selectedRecords,entityTypeCode){var dataInput={};dataInput.etn=selectedRecords[0].TypeName;dataInput.id=selectedRecords[0].Id;var controlInput={};controlInput.pageType=CustomControlPageType;controlInput.controlName=HierarchyControlName;controlInput.data=dataInput;Xrm.Navigation.navigateTo(controlInput)};return HierarchyLibrary}();Commands.HierarchyLibrary=HierarchyLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Hierarchy=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.HierarchyLibrary:new Commands.HierarchyLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var ImportLibrary=function(){function ImportLibrary(){this.importFromExcel=function(gridControl,entityTypeName){var params={};params["id_ImportFileType"]=3;params["id_EntityLogicalName"]=entityTypeName;Xrm.Navigation.openDialog("ImportWizard",{width:512,height:600,position:2},params);Xrm.Reporting.reportSuccess("Import.SMBImportLaunchRequest",[{name:"Dialogname",value:"ImportWizard"},{name:"Source",value:"EntityGrid"},{name:"EntityLogicalName",value:entityTypeName},{name:"ImportFileType",value:3}])};this.importFromCSV=function(gridControl,entityTypeName){var params={};params["id_ImportFileType"]=0;params["id_EntityLogicalName"]=entityTypeName;Xrm.Navigation.openDialog("ImportWizard",{width:512,height:600,position:2},params);Xrm.Reporting.reportSuccess("Import.SMBImportLaunchRequest",[{name:"Dialogname",value:"ImportWizard"},{name:"Source",value:"EntityGrid"},{name:"EntityLogicalName",value:entityTypeName},{name:"ImportFileType",value:0}])};this.importFromExchange=function(gridControl,entityTypeName){var params={};Xrm.Navigation.openDialog("ImportExchange",{width:400,height:600,position:2},params);Xrm.Reporting.reportSuccess("Import.SMBImportLaunchRequest",[{name:"Dialogname",value:"ImportExchange"},{name:"Source",value:"EntityGrid"},{name:"EntityLogicalName",value:entityTypeName},{name:"ImportFileType",value:2}])}}return ImportLibrary}();Commands.ImportLibrary=ImportLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Import=new Commands.ImportLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var BulkEditLibraryLegacy=function(){function BulkEditLibraryLegacy(){}BulkEditLibraryLegacy.prototype.bulkEditRecordsLegacy=function(gridControl,records,entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.bulkEdit(gridControl,records,entityTypeCode):backCompatHeader.Mscrm.GridRibbonActions.bulkEdit(gridControl,records,entityTypeCode)};BulkEditLibraryLegacy.prototype.bulkEditRecords=function(gridControl,records,entityName,defaultCloseState,callback){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),entityTypeCode=Xrm.Internal.getEntityCode(entityName);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.bulkEdit(gridControl,records,entityTypeCode):backCompatHeader.Mscrm.GridRibbonActions.bulkEdit(gridControl,records,entityTypeCode)};BulkEditLibraryLegacy.prototype.isBulkEditEnabledForEntityLegacy=function(entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isBulkEditEnabledForEntity(entityTypeCode):backCompatHeader.Mscrm.RibbonActions.isBulkEditEnabledForEntity(entityTypeCode)};BulkEditLibraryLegacy.prototype.isBulkEditEnabledForEntity=function(entityName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),entityTypeCode=Xrm.Internal.getEntityCode(entityName);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isBulkEditEnabledForEntity(entityTypeCode):backCompatHeader.Mscrm.RibbonActions.isBulkEditEnabledForEntity(entityTypeCode)};return BulkEditLibraryLegacy}();Commands.BulkEditLibraryLegacy=BulkEditLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var BulkEditLibrary=function(){function BulkEditLibrary(){var _this=this;this.bulkEditRecordsLegacy=function(gridControl,records,entityTypeCode){var entityName=Xrm.Internal.getEntityName(entityTypeCode);_this.bulkEditRecords(gridControl,records,entityName)};this.bulkEditRecords=function(gridControl,records,entityName){if(!gridControl||!records||records.length===0){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Action_NoItemSelected")});return}var entityTypeCode=Xrm.Internal.getEntityCode(entityName);if(records.length===1){var openOptions={entityName:records[0].TypeName,entityId:records[0].Id};Xrm.Navigation.openForm(openOptions);return}var actualEntityName=entityName,actionUri;if(entityName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityPointer){for(var record=records[0],i=1;i<records.length;i++)if(records[i].TypeName!==record.TypeName){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Grid_Apply_Rule_Heterogenous_Activity_Type_Records_Selected")});return}actualEntityName=record.TypeName}var forceRefresh=false,parameters=[forceRefresh,gridControl,"bulkedit",entityTypeCode,records];Commands.Common.constructAndOpenLegacyWebDialog(actualEntityName,gridControl,records,"dlg_bulkedit.aspx",1e3,700,false,_this._refreshGridAfterBulkEdit,parameters)};this._refreshGridAfterBulkEdit=function(result,forceRefresh,gridControl,requestType,entityName,records){(result||forceRefresh)&&gridControl.refresh()};this.isBulkEditEnabledForEntityLegacy=function(entityTypeCode){return _this.isBulkEditEnabledForEntity(Xrm.Internal.getEntityName(entityTypeCode))};this.isBulkEditEnabledForEntity=function(entityName){switch(entityName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityPointer:if(!XrmCore.InternalUtilities.ActivityUtilities.isActivityTypeCode(entityName)||entityName==XrmCore.InternalUtilities.EntityUtilities.EntityNames.RecurringAppointmentMaster)return false;return true;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.AccountAddress:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityMimeAttachment:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityParty:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityScheduling:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.AdvancedSimilarityRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Annotation:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.AnnualFiscalCalendar:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ApplicationFile:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.AppLicense:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.AppOfflineFilter:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Appointment:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.AppSalesPerson:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.AppWorkflowInstance:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.AsyncOperation:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Attribute:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.AttributeMap:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.AttributePicklistValue:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Audit:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.BulkDeleteFailure:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.BulkDeleteOperation:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.BulkDeleteWizardDialog:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.BulkOperation:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.BulkOperationLog:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.BusinessUnit:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.BusinessUnitMap:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.BusinessUnitNewsArticle:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Calendar:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CalendarRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ClientUpdate:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ColumnMapping:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CompetitorAddress:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Connection:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ConnectionRole:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ConstraintBasedGroup:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ContactAddress:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contract:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ContractDetail:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ContractTemplate:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CustomerAddress:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CustomerOpportunityRole:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CustomerRelationship:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Discount:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DiscountType:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DisplayString:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DisplayStringMap:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DocumentIndex:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DocumentTemplate:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DuplicateDetectionDialog:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DuplicateRecord:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DuplicateRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.DuplicateRuleCondition:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Email:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.EmailHash:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Entity:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.EntityMap:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.EntityRelationship:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.EntityRelationshipRole:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Equipment:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Fax:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.FieldPermission:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.FieldSecurityProfile:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.FilterTemplate:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.FixedMonthlyFiscalCalendar:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.GoalRollupQuery:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.HolidayCalendarRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ImportData:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ImportEntity:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ImportFile:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ImportJob:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ImportLog:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ImportMap:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ImportWizardDialog:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.IncidentResolution:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.IntegrationStatus:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.InternalAddress:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.InterProcessLock:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Invoice:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.InvoiceDetail:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.IsvConfig:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.KbArticle:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.KbArticleComment:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.KbArticleTemplate:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.KnowledgeSearchModel:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.LeadAddress:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Letter:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.License:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ListMember:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.LocalizedLabel:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.LookUpMapping:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.MailMergeTemplate:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Metric:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.MonthlyFiscalCalendar:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.MobileOfflineProfileItemAssociation:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.NewKbArticle:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.None:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Notification:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.NotWorkingWorkShift:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OccurrenceCalendarRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OccurringWorkShift:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OpportunityClose:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OpportunityProduct:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OptionSet:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OrderClose:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Organization:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OrganizationStatistic:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OrganizationUI:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.OwnerMapping:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.PhoneCall:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.PickListMapping:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.PluginAssembly:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.PluginType:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.PluginTypeStatistic:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Privilege:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.PrivilegeObjectTypeCodes:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ProcessSession:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ProductPriceLevel:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Publisher:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.QuarterlyFiscalCalendar:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Queue:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.QueueItem:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.QuoteClose:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.QuoteDetail:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RecurrenceCalendarRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RecurringAppointmentMaster:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RecurringWorkShift:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Relationship:9803;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RelationshipRole:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RelationshipRoleMap:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Report:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ReportPropertyDialog:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ResourceGroupExpansion:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ResourceSpec:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RibbonCommand:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RibbonContextGroup:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RibbonCustomization:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RibbonDiff:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RibbonRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RibbonTabToCommandMap:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Role:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RolePrivileges:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RoleTemplate:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RoleTemplatePrivileges:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RollupField:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SalesLiterature:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SalesLiteratureItem:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SalesOrderDetail:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SavedQuery:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SavedQueryVisualization:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ScriptErrorDetailsDialog:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ScriptErrorDialog:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SdkMessage:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SdkMessageFilter:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SdkMessagePair:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SdkMessageProcessingStep:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SdkMessageProcessingStepImage:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SdkMessageProcessingStepSecureConfig:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SdkMessageRequest:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SdkMessageRequestField:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SdkMessageResponse:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SdkMessageResponseField:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SemiAnnualFiscalCalendar:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Service:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ServiceAppointment:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ServiceEndpoint:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ServiceRestrictionCalendarRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SharePointDocumentLocation:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SharePointSite:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Site:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SiteMap:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Solution:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SolutionComponent:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SolutionExportWizard:9207;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SolutionImportWizard:9208;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Subject:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Subscription:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SubscriptionClients:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SubscriptionManuallyTrackedObject:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SubscriptionSyncInfo:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SystemForm:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SystemUser:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.SystemUserPrincipals:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Task:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Team:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Template:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Territory:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TimeOffCalendarRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TimeZoneDefinition:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TimeZoneLocalizedName:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TimeZoneRule:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TopicModel:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TransactionCurrency:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TransformationMapping:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.TransformationParameterMapping:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.UnresolvedAddress:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.UnresolvedEmailParty:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.UoM:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.UserFiscalCalendar:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.UserForm:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.UserQuery:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.UserQueryVisualization:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.UserSettings:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ViewAttribute:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.WebResource:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.WebWizard:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.WizardAccessPrivilege:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.WizardPage:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Workflow:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.WorkflowDependency:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.WorkflowLog:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.WorkflowWaitSubscription:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.MailboxStatistics:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.EntityDashboard:return false;default:return true}}}return BulkEditLibrary}();Commands.BulkEditLibrary=BulkEditLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.BulkEdit=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.BulkEditLibrary:new Commands.BulkEditLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var MergeLibraryLegacy=function(){function MergeLibraryLegacy(){}MergeLibraryLegacy.prototype.mergeRecordsLegacy=function(gridControl,records,entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.mergeRecords(gridControl,records,entityTypeCode):backCompatHeader.Mscrm.GridCommandActions.mergeRecords(gridControl,records,entityTypeCode)};MergeLibraryLegacy.prototype.mergeRecords=function(gridControl,records,entityName,defaultCloseState,callback){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),entityTypeCode=Xrm.Internal.getEntityCode(entityName);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.mergeRecords(gridControl,records,entityTypeCode):backCompatHeader.Mscrm.GridCommandActions.mergeRecords(gridControl,records,entityTypeCode)};return MergeLibraryLegacy}();Commands.MergeLibraryLegacy=MergeLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var MergeLibrary=function(){function MergeLibrary(){var _this=this;this.mergeRecordsLegacy=function(gridControl,records,entityTypeCode){var entityName=Xrm.Internal.getEntityName(entityTypeCode);_this.mergeRecords(gridControl,records,entityName)};this.mergeRecords=function(gridControl,records,entityName){var maxLimit=2;if(records&&records.length>maxLimit){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("LOCID_MERGE_TOOMANY_RECORDS")});return}var forceRefresh=false,parameters=[forceRefresh,gridControl,"merge",Xrm.Internal.getEntityCode(entityName),records];Commands.Common.constructAndOpenLegacyWebDialog(entityName,gridControl,records,"dlg_merge.aspx",800,570,true,_this.showMessageAfterMergeAssocAndRefreshGrid,parameters)};this.showMessageAfterMergeAssocAndRefreshGrid=function(result,forceRefresh,gridControl,requestType,entityName,records){(result||forceRefresh)&&gridControl.refresh()}}return MergeLibrary}();Commands.MergeLibrary=MergeLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Merge=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.MergeLibrary:new Commands.MergeLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var NavigateToGridLibrary=function(){function NavigateToGridLibrary(){}NavigateToGridLibrary.prototype.navigateToHomepageGrid=function(gridControl,entityTypeName){if(entityTypeName&&gridControl&&gridControl.getViewSelector()&&gridControl.getViewSelector().getCurrentView()){var currentViewId=gridControl.getViewSelector().getCurrentView().id,viewId=currentViewId&&currentViewId.replace("{","").replace("}","").toUpperCase();Xrm.Navigation.navigateTo({pageType:"entitylist",entityName:entityTypeName,viewId:viewId})}};return NavigateToGridLibrary}();Commands.NavigateToGridLibrary=NavigateToGridLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.NavigateToGrid=new Commands.NavigateToGridLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var NewRecordForBPFEntityLibraryLegacy=function(){function NewRecordForBPFEntityLibraryLegacy(){this.openNewRecord=function(entityLogicalName,gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.openNewBpfEntityRecord(entityLogicalName,gridControl):backCompatHeader.Mscrm.CommandBarActions.openNewBpfEntityRecord(entityLogicalName,gridControl)}}return NewRecordForBPFEntityLibraryLegacy}();Commands.NewRecordForBPFEntityLibraryLegacy=NewRecordForBPFEntityLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var NewRecordForBPFEntityLibrary=function(){function NewRecordForBPFEntityLibrary(){this.openNewRecord=function(entityLogicalName,gridControl){NewRecordForBPFEntityLibrary.getProcessInfo(entityLogicalName).then(function(response){if(response.entities&&response.entities.length>0){var process=response.entities[0],primaryEntityLogicalName=process["primaryentity"],processId=process["workflowid"],openOptions={entityName:primaryEntityLogicalName,processId:processId};Xrm.Navigation.openForm(openOptions)}},function(e){console.error(e)})}}NewRecordForBPFEntityLibrary.getProcessInfo=function(entityLogicalName){var fetchXml="<fetch version='1.0' mapping='logical'><entity name='workflow'><attribute name='primaryentity' /><attribute name='workflowid' /><filter type='and'><condition attribute='uniquename' operator='eq' value='"+entityLogicalName+"' /></filter></entity></fetch>";return Xrm.WebApi.online.retrieveMultipleRecords("workflow","?fetchXml="+fetchXml)};return NewRecordForBPFEntityLibrary}();Commands.NewRecordForBPFEntityLibrary=NewRecordForBPFEntityLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.NewRecordForBPFEntity=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.NewRecordForBPFEntityLibrary:new Commands.NewRecordForBPFEntityLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var OpenObjLibraryLegacy=function(){function OpenObjLibraryLegacy(){var _this=this;this.NewCustomActivity=function(entityTypeName,id,parameters,urlPrefix,mode,extraParams){_this.NewCustomActivityLegacy(Xrm.Internal.getEntityCode(entityTypeName),id,parameters,urlPrefix,mode,extraParams)};this.NewCustomActivityLegacy=function(entityTypeCode,id,parameters,urlPrefix,mode,extraParams){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);openObj?openObj(entityTypeCode,id,parameters,urlPrefix,mode,extraParams):backCompatHeader.openObj(entityTypeCode,id,parameters,urlPrefix,mode,extraParams)}}return OpenObjLibraryLegacy}();Commands.OpenObjLibraryLegacy=OpenObjLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var OpenObjLibrary=function(){function OpenObjLibrary(){var _this=this;this.NewCustomActivity=function(entityTypeName,id,parameters,urlPrefix,mode,extraParams){var openOptions={entityName:entityTypeName};Xrm.Navigation.openForm(openOptions)};this.NewCustomActivityLegacy=function(entityTypeCode,id,parameters,urlPrefix,mode,extraParams){var entityName=Xrm.Internal.getEntityName(entityTypeCode);_this.NewCustomActivity(entityName,id,parameters,urlPrefix,mode,extraParams)}}return OpenObjLibrary}();Commands.OpenObjLibrary=OpenObjLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.OpenObj=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.OpenObjLibrary:new Commands.OpenObjLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var OpenLibraryLegacy=function(){function OpenLibraryLegacy(){this.openNewRecord=function(entityLogicalName,gridControl){if(typeof entityLogicalName==="number")entityLogicalName=Xrm.Internal.getEntityName(entityLogicalName);var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.openNewRecord(entityLogicalName,gridControl):backCompatHeader.Mscrm.CommandBarActions.openNewRecord(entityLogicalName,gridControl)};this.addNewFromSubGridStandard=function(gridTypeName,parentEntityTypeName,parentEntityId,primaryControl,gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true),parentEntityTypeCode=Xrm.Internal.getEntityCode(parentEntityTypeName),gridTypeCode=Xrm.Internal.getEntityCode(gridTypeName);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.addNewFromSubGridStandard(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl):backCompatHeader.Mscrm.GridCommandActions.addNewFromSubGridStandard(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl)};this.addNewFromSubGridStandardLegacy=function(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.addNewFromSubGridStandard(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl):backCompatHeader.Mscrm.GridCommandActions.addNewFromSubGridStandard(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl)}}return OpenLibraryLegacy}();Commands.OpenLibraryLegacy=OpenLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var OpenLibrary=function(){function OpenLibrary(){var _this=this;this.openNewRecord=function(entityLogicalName,gridControl){if(typeof entityLogicalName==="number")entityLogicalName=Xrm.Internal.getEntityName(entityLogicalName);if(!entityLogicalName)return;var parameters={};switch(entityLogicalName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Report:var runReportLib=void 0;runReportLib=new XrmCore.Commands.RunReportLibrary;runReportLib.NewReport(entityLogicalName,gridControl);break;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.Connection:var SALES_TEAM_VIEW_ID="FE4BC089-8901-466C-A41B-1C1090F204D4",STAKEHOLDER_VIEW_ID="4E3600FA-B9C8-49F4-B69A-51EBA06D9BDF",STAKEHOLDER_ROLE_ID="518D7AAA-3B4C-4041-AD33-A6FD40DF6C81",SALES_PROFESSIONAL_ROLE_ID_1="20079806-EB84-4093-99AD-BB46435DB028",currentViewId=gridControl&&gridControl.getViewSelector().getCurrentView().id,viewId=currentViewId&&currentViewId.replace("{","").replace("}","").toUpperCase(),isStakeholderOrSalesTeamGrid=viewId&&(viewId==STAKEHOLDER_VIEW_ID||viewId==SALES_TEAM_VIEW_ID);if(isStakeholderOrSalesTeamGrid){var targetEntityName=viewId==STAKEHOLDER_VIEW_ID?XrmCore.InternalUtilities.EntityUtilities.EntityNames.Contact:XrmCore.InternalUtilities.EntityUtilities.EntityNames.SystemUser,roleId_1=viewId==STAKEHOLDER_VIEW_ID?STAKEHOLDER_ROLE_ID:SALES_PROFESSIONAL_ROLE_ID_1,lookup=Xrm.Utility.lookupObjects?Xrm.Utility.lookupObjects({allowMultiSelect:false,defaultEntityType:targetEntityName,entityTypes:[targetEntityName],lookupType:"Lookup.Simple"}):null;lookup&&lookup.then(function(lookupValues){return _this.createConnection(lookupValues,roleId_1,gridControl,roleId_1==SALES_PROFESSIONAL_ROLE_ID_1)});break}else if(gridControl){var fetchXml=gridControl.getFetchXml(),domFetch=fetchXml&&XrmCore.InternalUtilities.ExportUtilities.getXmlDOMFromString(fetchXml),linkEntities=domFetch&&domFetch.getElementsByTagName("link-entity");if(linkEntities)for(var linkEntity=void 0,linkEntity=0;linkEntity<linkEntities.length;linkEntity++)if(linkEntities[linkEntity].getAttribute("name")=="connectionrole"){var filters=linkEntities[linkEntity].getElementsByTagName("filter");if(filters&&filters[0])for(var conditions=filters[0].getElementsByTagName("condition"),condition=void 0,condition=0;condition<conditions.length;condition++)if(conditions[condition].getAttribute("attribute")=="category")parameters["roleCategoryId"]=conditions[condition].getAttribute("value")}}default:var openOptions={entityName:entityLogicalName};if(gridControl){var subGridControl=gridControl;if(subGridControl.getGridType&&(subGridControl.getGridType()===3||subGridControl.getGridType()===2)){openOptions.useQuickCreateForm=true;if(subGridControl.getRelationship&&subGridControl.getRelationship()){var parentControl=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page;if(parentControl&&parentControl.data&&parentControl.data.entity){var lookupValue=parentControl.data.entity.getEntityReference();openOptions.createFromEntity=lookupValue}}}}Xrm.Navigation.openForm(openOptions,parameters)}};this.addNewFromSubGridStandard=function(gridEntityName,parentEntityName,parentEntityId,primaryControl,gridControl){if(typeof gridEntityName=="number")gridEntityName=Xrm.Internal.getEntityName(gridEntityName);var entityRelationship=gridControl.getRelationship(),parentControl=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page,fromEntity=parentControl.data.entity.getEntityReference(),openOptions={entityName:gridEntityName,createFromEntity:fromEntity,useQuickCreateForm:true,relationship:entityRelationship};Xrm.Navigation.openForm(openOptions)};this.addNewFromSubGridStandardLegacy=function(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl){_this.addNewFromSubGridStandard(Xrm.Internal.getEntityName(gridTypeCode),Xrm.Internal.getEntityName(parentEntityTypeCode),parentEntityId,primaryControl,gridControl)};this.createConnection=function(lookupValues,targetRoleId,gridControl,assignRecordToDefaultSalesTemplate){if(assignRecordToDefaultSalesTemplate===void 0)assignRecordToDefaultSalesTemplate=false;if(!lookupValues||lookupValues.length===0)return;var connectionFromEntitySetName,connectionToEntitySetName,parentControl=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page;Xrm.Utility.getEntityMetadata(parentControl.data.entity.getEntityName()).then(function(connectionFromMetadata){connectionFromEntitySetName=connectionFromMetadata["EntitySetName"];var fromEntityId=parentControl.data.entity.getId().replace("{","").replace("}",""),toEntityType=lookupValues[0].entityType,toEntityId=lookupValues[0].id.replace("{","").replace("}","");Xrm.Utility.getEntityMetadata(toEntityType).then(function(connectionToMetadata){connectionToEntitySetName=connectionToMetadata["EntitySetName"];var DummyConnectionRoleIdIfRecord2RoleIdDoesNotExist="26591187-1160-4D25-8723-2D9C92617D3A",connection={};connection["record1id_"+parentControl.data.entity.getEntityName()+"@odata.bind"]="/"+connectionFromEntitySetName+"("+fromEntityId+")";connection["record2id_"+toEntityType+"@odata.bind"]="/"+connectionToEntitySetName+"("+toEntityId+")";connection["record2roleid@odata.bind"]="/connectionroles("+targetRoleId+")";connection["record1roleid@odata.bind"]="/connectionroles("+DummyConnectionRoleIdIfRecord2RoleIdDoesNotExist+")";Xrm.WebApi.createRecord(XrmCore.InternalUtilities.EntityUtilities.EntityNames.Connection,connection).then(function(success){if(assignRecordToDefaultSalesTemplate){var ACCESS_TEAM_TEMPLATE_ID="B3228218-B8F6-4A1B-A18D-552C6F980831";_this.addUserToRecordTeam(lookupValues[0].id,ACCESS_TEAM_TEMPLATE_ID)}gridControl&&gridControl.refresh()},function(error){gridControl&&gridControl.refresh();XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)})})})};this.addUserToRecordTeam=function(userId,templateId){var parentEntity=Xrm.Page.data.entity,addUserToTeamRequest=new XrmCore.SdkContracts.AddUserToRecordTeamRequest({id:userId,entityType:XrmCore.InternalUtilities.EntityUtilities.EntityNames.SystemUser},{id:parentEntity.getId(),entityType:parentEntity.getEntityName()},{id:templateId,entityType:XrmCore.InternalUtilities.EntityUtilities.EntityNames.TeamTemplate});Xrm.WebApi.online.execute(addUserToTeamRequest).then(null,function(error){XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)})}}return OpenLibrary}();Commands.OpenLibrary=OpenLibrary;var LookupValueImplementation=function(){function LookupValueImplementation(id,name,entityType){this.name=name;this.id=id;this.entityType=entityType}return LookupValueImplementation}()})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Open=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.OpenLibrary:new Commands.OpenLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var OpenActiveStageLibraryLegacy=function(){function OpenActiveStageLibraryLegacy(){}OpenActiveStageLibraryLegacy.prototype.openActiveStageFromGrid=function(records){var record=records[0],bpfEntityReference={LogicalName:record.TypeName,Id:record.Id,Name:record.Name},backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.openActiveStage(bpfEntityReference):backCompatHeader.Mscrm.GridRibbonActions.openActiveStage(bpfEntityReference)};OpenActiveStageLibraryLegacy.prototype.openActiveStageFromForm=function(id,entityName){var bpfEntityReference={LogicalName:entityName,Id:id,Name:""},backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.openActiveStage(bpfEntityReference):backCompatHeader.Mscrm.GridRibbonActions.openActiveStage(bpfEntityReference)};return OpenActiveStageLibraryLegacy}();Commands.OpenActiveStageLibraryLegacy=OpenActiveStageLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var OpenActiveStageLibrary=function(){function OpenActiveStageLibrary(){}OpenActiveStageLibrary.prototype.openActiveStageFromGrid=function(records){if(records.length==1){var record_1=records[0],bpfEntityReference={entityType:record_1.TypeName,id:record_1.Id,name:record_1.Name},request=new XrmCore.SdkContracts.RetrieveActiveStageRecordRequest(bpfEntityReference),deferred=Xrm.WebApi.online.execute(request).then(function(response){return response.json()}).then(function(odataResponse){var entityName=odataResponse["@odata.type"].replace("#Microsoft.Dynamics.CRM.","");Xrm.Utility.getEntityMetadata(entityName).then(function(entityMetadata){var openOptions={entityName:entityName,entityId:odataResponse[entityMetadata.PrimaryIdAttribute],processId:odataResponse["processid"],processInstanceId:record_1.Id};Xrm.Navigation.openForm(openOptions,null)})},function(error){console.error(error)});return}};OpenActiveStageLibrary.prototype.openActiveStageFromForm=function(id,entityName){var bpfEntityReference={entityType:entityName,id:id},request=new XrmCore.SdkContracts.RetrieveActiveStageRecordRequest(bpfEntityReference),deferred=Xrm.WebApi.online.execute(request).then(function(response){return response.json()}).then(function(odataResponse){var entityName=odataResponse["@odata.type"].replace("#Microsoft.Dynamics.CRM.","");Xrm.Utility.getEntityMetadata(entityName).then(function(entityMetadata){var openOptions={entityName:entityName,entityId:odataResponse[entityMetadata.PrimaryIdAttribute],processId:odataResponse["processid"],processInstanceId:id};Xrm.Navigation.openForm(openOptions,null)})},function(error){console.error(error)})};return OpenActiveStageLibrary}();Commands.OpenActiveStageLibrary=OpenActiveStageLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.OpenActiveStage=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.OpenActiveStageLibrary:new Commands.OpenActiveStageLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var Refresh=function(){function Refresh(){}Refresh.refreshCommand=function(control){if(control.refresh)control.refresh();else Xrm.Page.ui&&Xrm.Page.ui.refresh&&Xrm.Page.ui.refresh()};return Refresh}();Commands.Refresh=Refresh})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var DisassociateLibraryLegacy=function(){function DisassociateLibraryLegacy(){}DisassociateLibraryLegacy.prototype.gridDisassociate=function(typeName,gridControl,firstSelectedItemId){var typeCode=Xrm.Internal.getEntityCode(typeName),backCompatHeader=window.top.frames[0];Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.gridDisassociate(typeCode,gridControl,firstSelectedItemId):backCompatHeader.Mscrm.GridRibbonActions.gridDisassociate(typeCode,gridControl,firstSelectedItemId)};return DisassociateLibraryLegacy}();Commands.DisassociateLibraryLegacy=DisassociateLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var GridDisassociateBase=function(_super){__extends(GridDisassociateBase,_super);function GridDisassociateBase(){_super.apply(this,arguments)}GridDisassociateBase.prototype.disassociate=function(gridControl,selectedRecords){var _this=this,parentControl=gridControl&&gridControl.getParentForm?gridControl.getParentForm():Xrm.Page,parentId=parentControl.data.entity.getId().replace("{","").replace("}",""),parentEntity=parentControl.data.entity.getEntityName(),subGridControl=gridControl,relationship=subGridControl&&subGridControl.getRelationship&&subGridControl.getRelationship(),relationshipName=relationship&&relationship.name,childEntity=gridControl&&gridControl.getEntityName?gridControl.getEntityName():"",shouldSwapParentChild=relationship&&relationship.roleType===2&&relationship.relationshipType===1;if(selectedRecords&&0<selectedRecords.getLength())Xrm.WebApi.online&&Xrm.Utility.getEntityMetadata(parentEntity).then(function(metadata){var batch=[];selectedRecords.forEach(function(selectedRecord){var childId=selectedRecord.getId().replace("{","").replace("}","");if(shouldSwapParentChild)batch.push(_this.createDisassociateODataContract(childId,childEntity,parentId,relationship));else batch.push(_this.createDisassociateODataContract(parentId,parentEntity,childId,relationship))});batch&&batch.length>0&&_this.performExecuteMultiple(gridControl,batch)});else{var rows_1=gridControl&&gridControl.getGrid&&gridControl.getGrid()&&gridControl.getGrid().getSelectedRows&&gridControl.getGrid().getSelectedRows();if(rows_1&&0<rows_1.getLength())Xrm.WebApi.online&&Xrm.Utility.getEntityMetadata(parentEntity).then(function(metadata){var batch=[];rows_1.forEach(function(row){var childId=row&&row.data&&row.data.entity&&row.data.entity.getId?row.data.entity.getId().replace("{","").replace("}",""):null;if(shouldSwapParentChild)batch.push(_this.createDisassociateODataContract(childId,childEntity,parentId,relationship));else batch.push(_this.createDisassociateODataContract(parentId,parentEntity,childId,relationship))});batch&&batch.length>0&&_this.performExecuteMultiple(gridControl,batch)})}};GridDisassociateBase.prototype.createDisassociateODataContract=function(entityId,entityType,relatedEntityId,relationship){var request={getMetadata:function(){var ODataMetadata={boundParameter:null,parameterTypes:{},operationName:"Disassociate",operationType:2};return ODataMetadata},target:{id:entityId,entityType:entityType},relatedEntityId:relatedEntityId,relationship:relationship&&relationship.name};return request};GridDisassociateBase.prototype.performExecuteMultiple=function(gridControl,batch){Xrm.WebApi.online.executeMultiple(batch).then(function(success){XrmCore.InternalUtilities.DialogUtilities.onGridActionMultipleSuccess(gridControl,success)},function(error){gridControl.refresh();XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error)})};return GridDisassociateBase}(XrmCore.Common.EntitySpecificOverrideBase);Commands.GridDisassociateBase=GridDisassociateBase})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var GridDisassociate=function(_super){__extends(GridDisassociate,_super);function GridDisassociate(){_super.apply(this,arguments);this.overrideMethods={disassociate:{category:"gridDisassociateForKnowledgeArticleCategory"}}}GridDisassociate.prototype.gridDisassociateForKnowledgeArticleCategory=function(base,gridControl,selectedRecords){this[base](gridControl,selectedRecords)};return GridDisassociate}(Commands.GridDisassociateBase);Commands.GridDisassociate=GridDisassociate})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var DisassociateLibrary=function(){function DisassociateLibrary(){}DisassociateLibrary.prototype.gridDisassociate=function(typeName,gridControl,firstSelectedItemId){var gridDisassociate=new Commands.GridDisassociate(typeName);gridDisassociate.call("disassociate",gridControl)};return DisassociateLibrary}();Commands.DisassociateLibrary=DisassociateLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Disassociate=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.DisassociateLibrary:new Commands.DisassociateLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var SaveLibraryLegacy=function(){function SaveLibraryLegacy(){this.saveForm=function(form){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.saveForm(form):backCompatHeader.Mscrm.RibbonActions.saveForm(form)};this.saveAndCloseForm=function(form){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.saveAndCloseForm(form):backCompatHeader.Mscrm.RibbonActions.saveAndCloseForm(form)};this.saveAsCompleted=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.saveAsCompleted():backCompatHeader.Mscrm.CommandBarActions.saveAsCompleted()}}return SaveLibraryLegacy}();Commands.SaveLibraryLegacy=SaveLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var SaveLibrary=function(){function SaveLibrary(){var _this=this;this.saveForm=function(form){var saveOptions={useSchedulingEngine:false,saveMode:1},successCallback=function(successParameter){};form.data.save(saveOptions).then(successCallback,_this._failedCallback)};this.saveAndCloseForm=function(form){var saveOptions={useSchedulingEngine:false,saveMode:2},successCallback=function(successParameter){form.ui.close()};form.data.save(saveOptions).then(successCallback,_this._failedCallback)};this._failedCallback=function(errorResponse){};this.saveAsCompleted=function(){var entityId=Xrm.Page.data.entity.getId(),entityName=Xrm.Page.data.entity.getEntityName(),stateCode=1,statusCode=-1,closePage=true;XrmCore.Commands.Common.setState(entityId,entityName,stateCode,statusCode,closePage,null,null,58)}}return SaveLibrary}();Commands.SaveLibrary=SaveLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Save=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.SaveLibrary:new Commands.SaveLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var SetRegardingLibraryLegacy=function(){function SetRegardingLibraryLegacy(){}SetRegardingLibraryLegacy.prototype.setRegarding=function(gridControl,records,entityTypeName){var entityTypeCode=Xrm.Internal.getEntityCode(entityTypeName),backCompatHeader=window.top.frames[0];Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.setRegarding(gridControl,records,entityTypeCode):backCompatHeader.Mscrm.GridCommandActions.addExistingFromSubGridAssociated(gridControl,records,entityTypeCode)};SetRegardingLibraryLegacy.prototype.setRegardingOnLoad=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.setRegardingOnLoad():backCompatHeader.Mscrm.GridCommandActions.setRegardingOnLoad()};SetRegardingLibraryLegacy.prototype.setRegardingDialogRegardingChange=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.setRegardingDialogRegardingChange():backCompatHeader.Mscrm.GridCommandActions.setRegardingDialogRegardingChange()};SetRegardingLibraryLegacy.prototype.setRegardingDialogSetClick=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.setRegardingDialogSetClick():backCompatHeader.Mscrm.GridCommandActions.setRegardingDialogSetClick()};SetRegardingLibraryLegacy.prototype.setRegardingCloseDialog=function(){Commands.Common.closeDialogLegacy()};return SetRegardingLibraryLegacy}();Commands.SetRegardingLibraryLegacy=SetRegardingLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var SetRegardingLibrary=function(){function SetRegardingLibrary(){}SetRegardingLibrary.prototype.setRegarding=function(gridControl,records,entityTypeName){if(Xrm.Internal.isUci()&&entityTypeName==Xrm.Constants.EntityNames.ActivityPointer){var promise=Xrm.Utility.getEntitiesMetadata(Commands.Common.GetEntityNamesFromActivityRecords(records));records.length>0&&promise.then(function(values){!Commands.Common.CheckIfIsReadOnlyInMobileClient(values)&&SetRegardingLibrary.setRegardingCallback(gridControl,records,entityTypeName)})}else SetRegardingLibrary.setRegardingCallback(gridControl,records,entityTypeName)};SetRegardingLibrary.setRegardingCallback=function(gridControl,records,entityTypeName){var windowWidth=500,windowHeight=260,dialogParams={};dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityName]=entityTypeName;dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records]=records;var options={width:windowWidth,height:windowHeight};Xrm.Navigation.openDialog(XrmCore.InternalUtilities.DialogUtilities.DialogName.SetRegarding,options,dialogParams).then(Commands.Common.gridCommandDialogCloseCallback(gridControl))};SetRegardingLibrary.prototype.setRegardingOnLoad=function(eventContext){var formContext=eventContext.getFormContext(),setButton=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId);setButton.setDisabled(true);var headerDescriptionControl=formContext.getControl("label_DialogDescription"),selectedRecordsCount=0,records=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records).getValue();selectedRecordsCount=records.length;Xrm.Utility.getEntityMetadata(Xrm.Constants.EntityNames.ActivityPointer).then(function(entityInfo){var titleDescription="";if(selectedRecordsCount===1)titleDescription=XrmCore.InternalUtilities.GenericUtilities.stringFormat(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_SetRegarding_Description"),[selectedRecordsCount,entityInfo.DisplayName]);else titleDescription=XrmCore.InternalUtilities.GenericUtilities.stringFormat(XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Dialog_SetRegarding_Description"),[selectedRecordsCount,entityInfo.DisplayCollectionName]);headerDescriptionControl.setLabel(titleDescription)})};SetRegardingLibrary.prototype.setRegardingDialogRegardingChange=function(eventContext){var formContext=eventContext.getFormContext(),setButton=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId),setRegardingLookupControl=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.regardingControlName),regardingValue=setRegardingLookupControl.getAttribute().getValue();if(!regardingValue||regardingValue.length===0)setButton.setDisabled(true);else setButton.setDisabled(false)};SetRegardingLibrary.prototype.setRegardingDialogSetClick=function(eventContext){var formContext=eventContext.getFormContext();if(XrmCore.InternalUtilities.DialogUtilities.isOffline()){XrmCore.InternalUtilities.DialogUtilities.showOfflineError();return}var records=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.Records).getValue(),regardingLookupControl=formContext.getControl(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.regardingControlName),selectedRegardingEntities=regardingLookupControl.getAttribute().getValue(),regardingObjectId=selectedRegardingEntities[0].id,regardingObjectTypeName=selectedRegardingEntities[0].entityType;XrmCore.InternalUtilities.GenericUtilities.showGenericProgressIndicator();var uniqueRecordTypes=records.reduce(function(accumulator,record){accumulator.indexOf(record.TypeName)<0&&accumulator.push(record.TypeName);return accumulator},[]);XrmCore.InternalUtilities.GenericUtilities.createChainedEntityMetadataMapWithCallback(uniqueRecordTypes,0,{},function(entityInfo){if(records.length===1)SetRegardingLibrary.saveRegardingObject(eventContext,records[0].Id,records[0].TypeName,entityInfo[records[0].TypeName].EntitySetName,regardingObjectId,regardingObjectTypeName);else SetRegardingLibrary.saveRegardingMultiple(eventContext,records,entityInfo,regardingObjectId,regardingObjectTypeName)})};SetRegardingLibrary.prototype.setRegardingCloseDialog=function(eventContext){XrmCore.InternalUtilities.DialogUtilities.closeDialog(eventContext)};SetRegardingLibrary.saveRegardingObject=function(eventContext,id,entityName,entitySetName,regardingObjectId,regardingObjectEntityName){var formContext=eventContext.getFormContext(),payloadKey="regardingobjectid_"+regardingObjectEntityName+"_"+entityName+"@odata.bind",payload=(_a={},_a[payloadKey]="/"+entitySetName+"("+regardingObjectId.replace("{","").replace("}","")+")",_a);Xrm.WebApi.online.updateRecord(entityName,id,payload).then(function(){XrmCore.InternalUtilities.DialogUtilities.setLastButtonClicked(eventContext,XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId);Xrm.Utility.closeProgressIndicator();formContext.ui.close()},function(reason){XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(reason);formContext.ui.close()});var _a};SetRegardingLibrary.saveRegardingMultiple=function(eventContext,records,entityInfo,regardingObjectId,regardingObjectTypeName){var formContext=eventContext.getFormContext(),setRegardingBatch=records.map(function(record){var setRegardingRequest=new XrmCore.SdkContracts.SetRegardingRequest(record,regardingObjectTypeName,regardingObjectId,entityInfo[record.TypeName].EntitySetName);return setRegardingRequest});Xrm.WebApi.online.executeMultiple(setRegardingBatch).then(function(success){if(success.every(function(response){return response.ok})){XrmCore.InternalUtilities.DialogUtilities.setLastButtonClicked(eventContext,XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId);Xrm.Utility.closeProgressIndicator();formContext.ui.close()}else SetRegardingLibrary.openAlertDialogForSetRegardingMultipleError(eventContext)},function(error){Xrm.Utility.closeProgressIndicator();XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog(error);formContext.ui.close()})};SetRegardingLibrary.openAlertDialogForSetRegardingMultipleError=function(eventContext){var formContext=eventContext.getFormContext(),dialogText=XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Action_MultipleErrorsFound");Xrm.Navigation.openAlertDialog({text:dialogText});XrmCore.InternalUtilities.DialogUtilities.setLastButtonClicked(eventContext,XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId);Xrm.Utility.closeProgressIndicator();formContext.ui.close()};return SetRegardingLibrary}();Commands.SetRegardingLibrary=SetRegardingLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.SetRegarding=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.SetRegardingLibrary:new Commands.SetRegardingLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var ShareLibraryLegacy=function(){function ShareLibraryLegacy(){}ShareLibraryLegacy.prototype.shareSelectedRecordsLegacy=function(gridControl,selectedRecords,entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.shareSelectedRecords(gridControl,selectedRecords,entityTypeCode):backCompatHeader.Mscrm.GridRibbonActions.shareSelectedRecords(gridControl,selectedRecords,entityTypeCode)};ShareLibraryLegacy.prototype.shareSelectedRecords=function(gridControl,selectedRecords,entityName,defaultCloseState,callback){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),entityTypeCode=Xrm.Internal.getEntityCode(entityName);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.shareSelectedRecords(gridControl,selectedRecords,entityTypeCode):backCompatHeader.Mscrm.GridRibbonActions.shareSelectedRecords(gridControl,selectedRecords,entityTypeCode)};ShareLibraryLegacy.prototype.isShareValidLegacy=function(selectedEntityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isShareValid(selectedEntityTypeCode):backCompatHeader.Mscrm.RibbonActions.isShareValid(selectedEntityTypeCode)};ShareLibraryLegacy.prototype.isShareValid=function(selectedEntityTypeName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false),selectedEntityTypeCode=Xrm.Internal.getEntityCode(selectedEntityTypeName);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isShareValid(selectedEntityTypeCode):backCompatHeader.Mscrm.RibbonActions.isShareValid(selectedEntityTypeCode)};return ShareLibraryLegacy}();Commands.ShareLibraryLegacy=ShareLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var SHARE_COMPONENT_NAME="Share",ShareLibrary=function(){function ShareLibrary(){var _this=this;this.isShareValidLegacy=function(selectedEntityTypeCode){return _this.isShareValid(Xrm.Internal.getEntityName(selectedEntityTypeCode))};this.isShareValid=function(selectedEntityName){switch(selectedEntityName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityPointer:return false;default:return true}};this.shareSelectedRecordsLegacy=function(gridControl,selectedRecords,entityTypeCode){var entityName=Xrm.Internal.getEntityName(entityTypeCode);_this.shareSelectedRecords(gridControl,selectedRecords,entityName)};this.shareSelectedRecords=function(gridControl,selectedRecords,entityName){var forceRefresh=false,callback=null,parameters=[forceRefresh,gridControl,callback];Commands.Common.constructAndOpenLegacyWebDialog(entityName,gridControl,selectedRecords,"dlg_share.aspx",885,500,true,_this.refreshGrid,parameters)};this.refreshGrid=function(result,forceRefresh,gridControl,requestType,entityName,records){(result||forceRefresh)&&gridControl.refresh()}}return ShareLibrary}();Commands.ShareLibrary=ShareLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.Share=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.ShareLibrary:new Commands.ShareLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var AutoSaveLibraryLegacy=function(){function AutoSaveLibraryLegacy(){this.isAutoSaveEnabled=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isAutoSaveEnabled():backCompatHeader.Mscrm.RibbonActions.isAutoSaveEnabled()}}return AutoSaveLibraryLegacy}();Rules.AutoSaveLibraryLegacy=AutoSaveLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var AutoSaveLibrary=function(){function AutoSaveLibrary(){this.isAutoSaveEnabled=function(){return Xrm.Utility.getGlobalContext().organizationSettings.isAutoSaveEnabled}}return AutoSaveLibrary}();Rules.AutoSaveLibrary=AutoSaveLibrary})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.AutoSave=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Rules.AutoSaveLibrary:new Rules.AutoSaveLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var ChartsLibraryLegacy=function(){function ChartsLibraryLegacy(){this.disableButtonsWhenChartMaximized=function(gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.disableButtonsWhenChartMaximized(gridControl):backCompatHeader.Mscrm.GridCommandActions.disableButtonsWhenChartMaximized(gridControl)}}return ChartsLibraryLegacy}();Rules.ChartsLibraryLegacy=ChartsLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var ChartsLibrary=function(){function ChartsLibrary(){this.disableButtonsWhenChartMaximized=function(gridControl){return true}}return ChartsLibrary}();Rules.ChartsLibrary=ChartsLibrary})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.Charts=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Rules.ChartsLibrary:new Rules.ChartsLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var DashboardLibrary=function(){function DashboardLibrary(){this.isDashboardPage=function(){return Xrm.Utility.getGlobalContext().getQueryStringParameters().pageType==="dashboard"}}return DashboardLibrary}();Rules.DashboardLibrary=DashboardLibrary})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.Dashboard=new Rules.DashboardLibrary})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var Enabled=function(){function Enabled(){this.enableImportFromExchange=function(entityTypeName){if(entityTypeName=="contact")return true;else return false}}Enabled.alwaysEnabled=function(){return true};Enabled.neverEnabled=function(){return false};Enabled.enableImportForWeb=function(){if(Xrm.Internal.isUci&&Xrm.Internal.isUci()&&Xrm.Utility.getGlobalContext().client.getClient()==Xrm.Constants.ClientNames.web)return true;else return false};Enabled.enableActivityForWeb=function(){if(Xrm.Internal.isUci&&Xrm.Internal.isUci())if(Xrm.Utility.getGlobalContext().client.getClient()==Xrm.Constants.ClientNames.web)return true;else return false;else return true};Enabled.enableExportToExcelOnlineForModern=function(){if(Xrm.Internal.isUci&&Xrm.Internal.isUci())return !Xrm.Utility.getGlobalContext().isOnPremises();else return true};return Enabled}();Rules.Enabled=Enabled})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var ExportLibraryLegacy=function(){function ExportLibraryLegacy(){}ExportLibraryLegacy.prototype.EnableExportToExcel=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.enableExportToExcel():backCompatHeader.Mscrm.RibbonActions.enableExportToExcel()};ExportLibraryLegacy.prototype.EnabledForXlsxExport=function(gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);return Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.enabledForXlsxExport(gridControl):backCompatHeader.Mscrm.GridRibbonActions.enabledForXlsxExport(gridControl)};ExportLibraryLegacy.prototype.EnableOnlyInBrowsersForModern=function(){return true};return ExportLibraryLegacy}();Rules.ExportLibraryLegacy=ExportLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var ExportLibrary=function(){function ExportLibrary(){}ExportLibrary.prototype.EnableExportToExcel=function(){return true};ExportLibrary.prototype.EnabledForXlsxExport=function(gridControl){return true};ExportLibrary.prototype.EnableOnlyInBrowsersForModern=function(){if(Xrm.Internal.isUci&&Xrm.Internal.isUci())if(Xrm.Utility.getGlobalContext().client.getClient()==Xrm.Constants.ClientNames.web)return true;else return false;else return true};return ExportLibrary}();Rules.ExportLibrary=ExportLibrary})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.Export=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Rules.ExportLibrary:new Rules.ExportLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var HierarchyView=function(){function HierarchyView(){}HierarchyView.isValidForHierarchyView=function(){return true};HierarchyView.isValidForHierarchyPageInUC=function(){return true};return HierarchyView}();Rules.HierarchyView=HierarchyView})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var HierarchyLibraryLegacy=function(){function HierarchyLibraryLegacy(){this.IsRecordHierarchyEnabled=function(selectedControl,selectedControlSelectedItemReferences){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isRecordHierarchyEnabled(selectedControl,selectedControlSelectedItemReferences):backCompatHeader.Mscrm.RibbonActions.isRecordHierarchyEnabled(selectedControl,selectedControlSelectedItemReferences)}}HierarchyLibraryLegacy.prototype.IsFormHierarchyEnabled=function(form){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isFormHierarchyEnabled():backCompatHeader.Mscrm.RibbonActions.isFormHierarchyEnabled()};HierarchyLibraryLegacy.prototype.IsNotHierarchyView=function(selectedControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isNotHierarchyView():backCompatHeader.Mscrm.RibbonActions.isNotHierarchyView()};return HierarchyLibraryLegacy}();Rules.HierarchyLibraryLegacy=HierarchyLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var HierarchyLibrary=function(){function HierarchyLibrary(){}HierarchyLibrary.setHierarchyLibrary=function(success,entityId){HierarchyLibrary.currentEntityId=entityId;HierarchyLibrary.isHierarchial=success};HierarchyLibrary.prototype.IsFormHierarchyEnabled=function(form){return this.isHierarchyEnabled(form.data.entity.getEntityName(),form.data.entity.getId())};HierarchyLibrary.prototype.IsNotHierarchyView=function(selectedControl){if(selectedControl&&selectedControl._controlName)return selectedControl._controlName.indexOf("MscrmControls.HierarchyControl.HierarchyControl")<0;return false};HierarchyLibrary.prototype.IsRecordHierarchyEnabled=function(selectedControl,selectedItemReferences){return this.isHierarchyEnabled(selectedItemReferences[0].TypeName,selectedItemReferences[0].Id)};HierarchyLibrary.prototype.isHierarchyEnabled=function(entity,entityId){if(entityId===HierarchyLibrary.promiseEntityId&&HierarchyLibrary.metadataRequestPromise)return HierarchyLibrary.metadataRequestPromise;try{if(entityId==HierarchyLibrary.currentEntityId)return Promise.resolve(HierarchyLibrary.isHierarchial);else{HierarchyLibrary.promiseEntityId=entityId;return HierarchyLibrary.metadataRequestPromise=Xrm.Utility.getEntityMetadata(entity).then(function(metadata){var entitySetName=metadata.EntitySetName,hierarchicalRelationships=metadata.OneToManyRelationships.get(function(relationship){return relationship.IsHierarchical&&relationship.ReferencedEntity===entity});if(hierarchicalRelationships&&hierarchicalRelationships.length>0)return XrmCore.InternalUtilities.HierarchyUtilities.checkifRecordHierarchyEnabled(entity,entityId,entitySetName,hierarchicalRelationships[0]).then(function(success){HierarchyLibrary.setHierarchyLibrary(success,entityId);HierarchyLibrary.promiseEntityId=null;HierarchyLibrary.metadataRequestPromise=null;return HierarchyLibrary.isHierarchial});else return false})}}catch(ex){return Promise.resolve(false)}};HierarchyLibrary.isHierarchial=false;HierarchyLibrary.currentEntityId="";return HierarchyLibrary}();Rules.HierarchyLibrary=HierarchyLibrary})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.Hierarchy=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Rules.HierarchyLibrary:new Rules.HierarchyLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var OnlineLibraryLegacy=function(){function OnlineLibraryLegacy(){this.IsEntityAvailableForUserInMocaOffline=function(selectedEntityTypeName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);return Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.IsEntityAvailableForUserInMocaOffline(selectedEntityTypeName):backCompatHeader.Mscrm.CommandBarActions.IsEntityAvailableForUserInMocaOffline(selectedEntityTypeName)};this.IsCommandAvailableInMocaOffline=function(boolParam,selectedEntityTypeName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);return Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.IsCommandAvailableInMocaOffline(boolParam,selectedEntityTypeName):backCompatHeader.Mscrm.CommandBarActions.IsCommandAvailableInMocaOffline(boolParam,selectedEntityTypeName)}}return OnlineLibraryLegacy}();Rules.OnlineLibraryLegacy=OnlineLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var OnlineLibrary=function(){function OnlineLibrary(){this.IsCommandAvailableInMocaOffline=function(boolParam,selectedEntityTypeName){return true}}OnlineLibrary.prototype.IsEntityAvailableForUserInMocaOffline=function(selectedEntityTypeName){if(Xrm.Utility.getGlobalContext().client.getClientState()===Xrm.Constants.ClientStates.offline)return Xrm.Mobile.offline.isOfflineEnabled(selectedEntityTypeName);return true};OnlineLibrary.prototype.IsCustomActivityAvailableForUserInMocaOffline=function(commandProperties){if(Xrm.Utility.getGlobalContext().client.getClientState()===Xrm.Constants.ClientStates.offline){if(commandProperties!=null&&commandProperties["SourceControlId"]!=null){var buttonId=commandProperties["SourceControlId"];if(buttonId.toLowerCase().indexOf("mscrm.dynamicmenu.grid.newcustomactivity")>=0||buttonId.toLowerCase().indexOf("mscrm.dynamicmenu.form.addactivity")>=0||buttonId.toLowerCase().indexOf("mscrm.dynamicmenu.subgrid.newactivitymenu")>=0){var idParts=buttonId.split(".");return Xrm.Mobile.offline.isOfflineEnabled(idParts[idParts.length-1])}}return false}return true};OnlineLibrary.prototype.IsRelationshipEnabledInMocaOffline=function(gridControl){var subGridControl=gridControl;if(Xrm.Utility.getGlobalContext().client.getClientState()===Xrm.Constants.ClientStates.offline){var relationship=subGridControl&&subGridControl.getRelationship?subGridControl.getRelationship():null;if(relationship)return relationship.relationshipType===1?false:true}return true};return OnlineLibrary}();Rules.OnlineLibrary=OnlineLibrary})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.Online=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Rules.OnlineLibrary:new Rules.OnlineLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var RefreshFormLibraryLegacy=function(){function RefreshFormLibraryLegacy(){this.isRefreshForm=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isRefreshForm():backCompatHeader.Mscrm.RibbonActions.isRefreshForm()}}return RefreshFormLibraryLegacy}();Rules.RefreshFormLibraryLegacy=RefreshFormLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var RefreshFormLibrary=function(){function RefreshFormLibrary(){this.isRefreshForm=function(){return true}}return RefreshFormLibrary}();Rules.RefreshFormLibrary=RefreshFormLibrary})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.RefreshForm=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Rules.RefreshFormLibrary:new Rules.RefreshFormLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var RunReportLibraryLegacy=function(){function RunReportLibraryLegacy(){}RunReportLibraryLegacy.prototype.generateReportMenuXml=function(commandProperties,entityLogicalName,isForm,ribbonSelectionControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.generateReportMenuXml(commandProperties,entityLogicalName,isForm,ribbonSelectionControl):backCompatHeader.Mscrm.CommandBarActions.generateReportMenuXml(commandProperties,entityLogicalName,isForm,ribbonSelectionControl)};RunReportLibraryLegacy.prototype.runReport=function(commandProperties,gridControl,recordIds){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.runReport(commandProperties,gridControl,recordIds):backCompatHeader.Mscrm.GridRibbonActions.runReport(commandProperties,gridControl,recordIds)};RunReportLibraryLegacy.prototype.runReportFromFormRibbon=function(commandProperties,formControl,entityLogicalName){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.runReportFromFormRibbon(commandProperties,formControl):backCompatHeader.Mscrm.RibbonActions.runReportFromFormRibbon(commandProperties,formControl)};RunReportLibraryLegacy.prototype.viewReport=function(gridControl,records){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.ReportActions?Mscrm.ReportActions.viewReport(gridControl,records):backCompatHeader.Mscrm.ReportActions.viewReport(gridControl,records)};RunReportLibraryLegacy.prototype.editReportFilter=function(gridControl,records){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.ReportActions?Mscrm.ReportActions.editReportFilter(gridControl,records):backCompatHeader.Mscrm.ReportActions.editReportFilter(gridControl,records)};RunReportLibraryLegacy.prototype.editReport=function(gridControl,records,entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(true);Mscrm&&Mscrm.ReportActions?Mscrm.ReportActions.editReport(gridControl,records,entityTypeCode):backCompatHeader.Mscrm.ReportActions.editReport(gridControl,records,entityTypeCode)};return RunReportLibraryLegacy}();Commands.RunReportLibraryLegacy=RunReportLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){var RunReportLibrary=function(){function RunReportLibrary(){var _this=this;this.generateReportMenuXml=function(commandProperties,entityLogicalName,isForm,ribbonSelectionControl){var contextType=0,ribbonRelationshipType=-1,reportVisibilityCode=3;if(isForm){contextType=1;reportVisibilityCode=2}else if(ribbonSelectionControl.getGridType()===3){contextType=2;reportVisibilityCode=3;var relationship=ribbonSelectionControl.getRelationship();if(relationship!==null&&relationship.relationshipType===0)ribbonRelationshipType=0;else if(relationship!==null&&relationship.relationshipType===1)ribbonRelationshipType=1}var deferred=XrmCore.InternalUtilities.ReportsUtilites.retrieveReportsForEntity(entityLogicalName,reportVisibilityCode),menu=Promise.all([deferred]).then(function(_a){var reports=_a[0];Commands.logRetrieveReportsSuccess(entityLogicalName,reportVisibilityCode,ribbonRelationshipType);RunReportLibrary._reports=reports;return _this._buildMenu(commandProperties,reports,entityLogicalName,isForm,contextType,ribbonRelationshipType)},function(error){Commands.logRetrieveReportsFailure(error,entityLogicalName,null,reportVisibilityCode,ribbonRelationshipType)});commandProperties["PopulationXML"]=menu};this._buildMenu=function(commandProperties,reports,entityLogicalName,isForm,ribbonContextType,ribbonRelationshipType){var sourceControlId=commandProperties["SourceControlId"],menuId=sourceControlId+".Menu",menuSections=[],reportsCommandId=XrmCore.InternalUtilities.ReportsUtilites.determineReportsCommandId(entityLogicalName,isForm,ribbonContextType,ribbonRelationshipType),sectionIndex=0;if(reports&&reports.length>0){var reportsSections=XrmCore.InternalUtilities.ReportsUtilites.divideReportsIntoFilterableAndNon(reports);if(reportsSections["filterableReports"].length>0){var filterableReportsSection=XrmCore.InternalUtilities.ReportsUtilites.createMenuSection(menuId,reportsSections["filterableReports"],reportsCommandId,sectionIndex,true);menuSections.push(filterableReportsSection);sectionIndex=sectionIndex+1}if(reportsSections["nonFilterableReports"].length>0){var nonFilterableReportsSection=XrmCore.InternalUtilities.ReportsUtilites.createMenuSection(menuId,reportsSections["nonFilterableReports"],reportsCommandId,sectionIndex,false);menuSections.push(nonFilterableReportsSection)}}else{var noReportsSection=XrmCore.InternalUtilities.ReportsUtilites.createMenuSection(menuId,null,reportsCommandId,sectionIndex,false);menuSections.push(noReportsSection)}var menu=XrmCore.InternalUtilities.ReportsUtilites.buildMenu(menuId,menuSections);return menu};this.NewReport=function(entityTypeName,gridControl){var page="/crmreports/reportproperty.aspx",actionUri=Xrm.Utility.getGlobalContext().prependOrgName(page);Commands.logReportEvent(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DefaultGuidString,Xrm.Internal.getEntityCode(entityTypeName),null,"newreport");_this.openLegacyReportPropertyPage(actionUri,gridControl,"_blank")}}RunReportLibrary.prototype.runReportFromFormRibbon=function(commandProperties,formControl,entityCode){var reportId=XrmCore.InternalUtilities.ReportsUtilites.getReportIdFromSourceControlId(commandProperties["SourceControlId"]),reportEntity=RunReportLibrary._getReport(reportId);this.runFormsReport(reportEntity.Isfilterable,reportId,reportEntity.ReportTypeCode,reportEntity.Name,reportEntity.Filename,formControl.entityReference,entityCode)};RunReportLibrary.prototype.runFormsReport=function(filterable,reportId,reportType,reportName,reportFilename,entityReference,entityTypeCode){Commands.logReportEvent(reportId,entityTypeCode,reportType,"run_reportonentityform");if(filterable){var uri=XrmCore.InternalUtilities.ReportsUtilites.getCrmUri(XrmCore.InternalUtilities.ReportsUtilites.reportViewerBaseUri)+"?id="+reportId+"&action=run&context=records&recordstype="+entityTypeCode+"&records="+entityReference.id+"&helpID="+reportFilename;window.parent.open(uri,"_blank")}else this._openReportBasedOnType(reportId,"run",reportName,reportFilename,reportType,null)};RunReportLibrary.prototype.viewReport=function(gridControl,records){this._openReport(gridControl,records,"run")};RunReportLibrary.prototype.editReportFilter=function(gridControl,records){XrmCore.InternalUtilities.DialogUtilities.isAllowLegacyDialogsEmbedding()&&this._openReport(gridControl,records,"editfilter")};RunReportLibrary.prototype.openRecordItem=function(gridControl,records){XrmCore.InternalUtilities.DialogUtilities.isAllowLegacyDialogsEmbedding()&&this._openReport(gridControl,records,"filter")};RunReportLibrary.prototype._openReport=function(gridControl,records,reportWindowType){var _this=this,record;if(records.length===1){var reportRecord_1=records[0],gridEntity=gridControl.getGrid().getRows().get(reportRecord_1.Id).data.entity,reportEntity=gridEntity,reportName=reportEntity.attributes.get("name"),reportFileName=reportEntity.attributes.get("filename"),reportTypecode=reportEntity.attributes.get("reporttypecode");if(reportName&&reportTypecode&&reportFileName){var reportTypecodeValue=reportTypecode.getValue(),reportFileNameValue=reportFileName.getValue(),reportNameValue=reportName.getValue();Commands.logReportEvent(reportRecord_1.Id,Xrm.Internal.getEntityCode(reportRecord_1.TypeName),reportTypecodeValue,reportWindowType+"_onreportgrid");this._openReportBasedOnType(reportRecord_1.Id,reportWindowType,reportNameValue,reportFileNameValue,reportTypecodeValue,reportEntity)}else Xrm.WebApi.retrieveRecord("report",reportRecord_1.Id,"?$select=name,filename,reporttypecode,bodyurl,bodybinary,filesize,mimetype").then(function(reportEntityRecord){if(reportEntityRecord!=null){var reportNameValue=reportEntityRecord["name"]!=null?reportEntityRecord["name"].toString():null,reportFileNameValue=reportEntityRecord["filename"]!=null?reportEntityRecord["filename"].toString():null,reportTypecodeValue=reportEntityRecord["reporttypecode"]!=null?reportEntityRecord["reporttypecode"]:null;Commands.logReportEvent(reportRecord_1.Id,Xrm.Internal.getEntityCode(reportRecord_1.TypeName),reportTypecodeValue,reportWindowType+"_onreportgrid");_this._openReportBasedOnType(reportRecord_1.Id,reportWindowType,reportNameValue,reportFileNameValue,reportTypecodeValue,reportEntityRecord)}},function(error){Commands.logRetrieveReportsFailure(error,"report",reportRecord_1.Id,null,null)})}};RunReportLibrary.prototype._openReportBasedOnType=function(reportRecordId,reportWindowType,reportNameValue,reportFileNameValue,reportTypecodeValue,reportEntityRecord){var _this=this,reportURL=XrmCore.InternalUtilities.ReportsUtilites.getCrmUri("/crmreports/viewer/viewer.aspx?action="+reportWindowType+"&helpID="+reportFileNameValue+"&id=%7b"+reportRecordId+"%7d");switch(reportTypecodeValue){case 1:var globalContext=Xrm.Utility.getGlobalContext();globalContext.getCurrentAppProperties().then(function(appProperties){reportURL=reportURL.concat("&appid=",encodeURIComponent(appProperties["appId"]));window.parent.open(reportURL,"_blank");var recent={entityTypeName:"report",objectId:reportRecordId,pinStatus:false,recordType:"Entity",title:reportNameValue};Xrm.Internal.addRecentItem(recent)},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog);break;case 2:if(reportWindowType==="editfilter")Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Web.Reports.NonSRSReportFilterSchedule")});else if(reportEntityRecord)this._DownloadReport(reportEntityRecord);else Xrm.WebApi.retrieveRecord("report",reportRecordId,"?$select=filename,reporttypecode,bodyurl,bodybinary,filesize,mimetype").then(function(reportEntityRecord){reportEntityRecord!=null&&_this._DownloadReport(reportEntityRecord)},function(error){Commands.logRetrieveReportsFailure(error,"report",reportRecordId,null,null)});break;case 3:if(reportWindowType==="editfilter")Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Web.Reports.NonSRSReportFilterSchedule")});else window.parent.open(reportURL,"_blank");break;case 4:Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Web.Reports.UnsupportedReportType")});break;default:break}};RunReportLibrary.prototype._DownloadReport=function(reportEntityRecord){if(reportEntityRecord){var file={fileContent:reportEntityRecord["bodybinary"]!=null?reportEntityRecord["bodybinary"].toString():null,fileName:reportEntityRecord["filename"]!=null?reportEntityRecord["filename"].toString():null,fileSize:reportEntityRecord["filesize"]!=null?reportEntityRecord["filesize"]:null,mimeType:reportEntityRecord["mimetype"]!=null?reportEntityRecord["mimetype"].toString():null},openMode={openMode:2};Xrm.Navigation.openFile(file,openMode)}};RunReportLibrary.prototype.runReport=function(commandProperties,gridControl,recordIds,entityCode){if(recordIds==null)recordIds=[];var reportId=XrmCore.InternalUtilities.ReportsUtilites.getReportIdFromSourceControlId(commandProperties["SourceControlId"]),reportEntity=RunReportLibrary._getReport(reportId),parameters={GridControl:gridControl,ReportEntity:reportEntity,RecordIds:recordIds,EntityTypeCode:entityCode};if(reportEntity.Isfilterable){Commands.logReportEvent(reportId,entityCode,parameters.ReportEntity.ReportTypeCode,"RunReportCommandButtonOnEntityGridInitiated");var numRecordsSelected=recordIds.length,enableView=XrmCore.InternalUtilities.ReportsUtilites.isEffectiveFetchXmlFinal(gridControl),dialogUrl=XrmCore.InternalUtilities.ReportsUtilites.getRunReportDialogUrl(reportId,numRecordsSelected,enableView),options={position:1,width:450,height:400},dialogArguments={uciCallback:this.performActionAfterRunReport,callbackParameters:parameters};Commands.Common.appendAppIdAndOpenLegacyWebDialog(dialogUrl,options,dialogArguments,null)}else this.performActionAfterRunReport(2,parameters)};RunReportLibrary.prototype.performActionAfterRunReport=function(runMode,parameters){var uri=XrmCore.InternalUtilities.ReportsUtilites.getCrmUri(XrmCore.InternalUtilities.ReportsUtilites.reportViewerBaseUri),fetchXml=parameters.GridControl.getFetchXml(),form;if(parameters.ReportEntity.Isfilterable){if(runMode==null)runMode=-1;Commands.logRunReportOnEntityGrid(parameters,runMode);if(runMode==-1)return;switch(runMode){case 0:var sb=[],recordIds=parameters.RecordIds;if(recordIds)for(var i=0;i<recordIds.length;i++){i>0&&sb.push(";");sb.push(recordIds[i])}form=XrmCore.InternalUtilities.ReportsUtilites.CreateViewReportForm(uri,parameters.ReportEntity.ReportId,parameters.ReportEntity.Filename,"records","recordstype="+parameters.EntityTypeCode);XrmCore.InternalUtilities.ReportsUtilites.addFormParameter(form,"records",sb.join(""));Commands.logReportEvent(parameters.ReportEntity.ReportId,parameters.EntityTypeCode,null,"run_filterablereport_onentitygrid_forselectedrecords: "+sb.join(","));break;case 1:form=XrmCore.InternalUtilities.ReportsUtilites.CreateViewReportForm(uri,parameters.ReportEntity.ReportId,parameters.ReportEntity.Filename,"fetch");XrmCore.InternalUtilities.ReportsUtilites.addFormParameter(form,"fetchxml",fetchXml);Commands.logReportEvent(parameters.ReportEntity.ReportId,parameters.EntityTypeCode,null,"run_filterablereport_onentitygrid_forfetchxml: "+fetchXml);break;case 2:default:var reportURL_1=XrmCore.InternalUtilities.ReportsUtilites.getCrmUri("/crmreports/viewer/viewer.aspx?action=run&helpID="+parameters.ReportEntity.Filename+"&id=%7b"+parameters.ReportEntity.ReportId+"%7d");Commands.logReportEvent(parameters.ReportEntity.ReportId,parameters.EntityTypeCode,null,"run_filterablereport_onentitygrid_forallrecords_BeforeOpen");var globalContext=Xrm.Utility.getGlobalContext();globalContext.getCurrentAppProperties().then(function(appProperties){reportURL_1=reportURL_1.concat("&appid=",encodeURIComponent(appProperties["appId"]));window.parent.open(reportURL_1,"_blank");Commands.logReportEvent(parameters.ReportEntity.ReportId,parameters.EntityTypeCode,null,"run_filterablereport_onentitygrid_forallrecords_AfterOpen");var recent={entityTypeName:"report",objectId:parameters.ReportEntity.ReportId,pinStatus:false,recordType:"Entity",title:parameters.ReportEntity.Name};Xrm.Internal.addRecentItem(recent)},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog);break}}else{var reportViewType=parameters.ReportEntity.ReportTypeCode;Commands.logReportEvent(parameters.ReportEntity.ReportId,parameters.EntityTypeCode,reportViewType,"run_nonfilterablereport_onentitygrid");this._openReportBasedOnType(parameters.ReportEntity.ReportId,"run",parameters.ReportEntity.Name,parameters.ReportEntity.Filename,reportViewType,null)}if(form){var globalContext=Xrm.Utility.getGlobalContext();globalContext.getCurrentAppProperties().then(function(appProperties){var reportURL=form["action"];reportURL=reportURL.concat("&appid=",encodeURIComponent(appProperties["appId"]));form.setAttribute("action",reportURL);form.setAttribute("target","_blank");form.submit()},XrmCore.InternalUtilities.DialogUtilities.createActionFailedErrorDialog)}};RunReportLibrary._getReport=function(reportID){for(var i=0;i<RunReportLibrary._reports.length;i++)if(RunReportLibrary._reports[i].ReportId===reportID)return RunReportLibrary._reports[i]};RunReportLibrary.prototype.editReport=function(gridControl,records,entityTypeCode){var record;if(records.length===1){var reportRecord=records[0],page="/crmreports/reportproperty.aspx",actionUri=Xrm.Utility.getGlobalContext().prependOrgName(page),parameterToEncode=(new String).concat("{",reportRecord.Id.toString(),"}");actionUri=actionUri.concat("?id=",encodeURIComponent(parameterToEncode));Commands.logReportEvent(reportRecord.Id.toString(),entityTypeCode,null,"editreport");this.openLegacyReportPropertyPage(actionUri,gridControl,reportRecord.Id.toString())}};RunReportLibrary.prototype.openLegacyReportPropertyPage=function(actionUri,gridControl,name){var options={position:1,width:window.parent.innerHeight,height:window.parent.innerWidth},reportwindow=window.open(actionUri,name,"width="+options.width+", height="+options.height+", resizable=1, align-item=center, justify-content=center");window.onmessage=function(e){gridControl.refresh()}};RunReportLibrary._reports=[];return RunReportLibrary}();Commands.RunReportLibrary=RunReportLibrary})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){Commands.RunReport=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Commands.RunReportLibrary:new Commands.RunReportLibraryLegacy})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var InternalUtilities;(function(InternalUtilities){var ReportsUtilites=function(){function ReportsUtilites(){}ReportsUtilites.buildControlsForRunReports=function(menuId,reports,commandId){var buttons=[],controlsPrefix=menuId+".Filtered.Controls",image="Report";if(reports&&reports.length>0)for(var i=0;i<reports.length;i++){var button={ControlType:"Button",Id:controlsPrefix+".{"+reports[i].ReportId+"}",Command:commandId,Sequence:String(i*10+10),ToolTipDescription:reports[i].Name,Alt:reports[i].Name,LabelText:reports[i].Name,ModernImage:image};buttons.push(button)}var controls={Id:controlsPrefix,Items:buttons};return controls};ReportsUtilites.GridViewReportId="gridViewReport";ReportsUtilites.reportViewerBaseUri="/crmreports/viewer/viewer.aspx";ReportsUtilites.retrieveReportsForEntity=function(entityTypeName,reportVisibilityCode){var entityTypeCode=Xrm.Internal.getEntityCode(entityTypeName),fetchXml='<fetch mapping="logical">\n\t\t\t<entity name="report">\n\t\t\t<attribute name="name" /><attribute name="reporttypecode" /><attribute name="reportid" /><attribute name="filename" />\n\t\t\t<attribute name="bodyurl" />\n\t\t\t<order attribute="name" descending="false" />\n\t\t\t<filter type="and"><condition attribute="languagecode" operator="eq-userlanguage" /></filter>\n\t\t\t<link-entity alias="reportreportidreportentityreportid" name="reportentity" from="reportid" to="reportid">\n\t\t\t<attribute name="isfilterable" />\n\t\t\t<filter type="and"><condition attribute="objecttypecode" operator="eq" value="'+entityTypeCode+'"/></filter>\n\t\t\t</link-entity>\n\t\t\t<link-entity alias="reportreportidreportvisibilityreportid" name="reportvisibility" from="reportid" to="reportid">\n\t\t\t<filter type="and"><condition attribute="visibilitycode" operator="eq" value="'+reportVisibilityCode+'"/>\n\t\t\t</filter>\n\t\t\t</link-entity>\n\t\t\t</entity>\n\t\t\t</fetch>',deferred=Xrm.WebApi.online.retrieveMultipleRecords(InternalUtilities.EntityUtilities.EntityNames.Report,"?fetchXml="+fetchXml).then(function(response){for(var reports=[],templates=response.entities,i=0;i<templates.length;i++){var curT={ReportId:templates[i].reportid,Name:templates[i].name,Filename:templates[i].filename,Bodyurl:templates[i].bodyurl,ReportTypeCode:templates[i].reporttypecode,Isfilterable:templates[i]["reportreportidreportentityreportid.isfilterable"]};reports.push(curT)}return reports},function(e){console.error(e)});return deferred};ReportsUtilites.createMenuSection=function(menuId,reports,reportsCommandId,sectionIndex,filterableSection){var filterableReportsControl=ReportsUtilites.buildControlsForRunReports(menuId,reports,reportsCommandId);return InternalUtilities.ReportsUtilites.buildMenuSection(menuId,filterableSection,sectionIndex*10+10,filterableReportsControl)};ReportsUtilites.buildMenuSection=function(menuId,filterable,sequenceNum,controls){var runOnCurrentRecordLabel=Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_ParameterizedReportsForm"),sectionStr="",titleStr="";if(controls&&controls.Items&&controls.Items.length>0)if(filterable){titleStr=Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_ParameterizedReports");sectionStr="filterable"}else{titleStr=Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_GlobalReports");sectionStr="nonFilterable"}else{titleStr=Xrm.Utility.getResourceString("Main_system_library","Ribbon.ReportMenu.NoReportsAvailable");sectionStr="noReports"}var section={Id:menuId+"."+sectionStr,Sequence:String(sequenceNum),DisplayMode:6,Title:titleStr,Item:controls};return section};ReportsUtilites.buildMenu=function(menuId,menuSections){var menu={Id:menuId,MenuSection:menuSections};return menu};ReportsUtilites.determineReportsCommandId=function(entityLogicalName,isForm,ribbonContextType,ribbonRelationshipType){var relType="NoRelationship";if(ribbonRelationshipType===0)relType="OneToMany";else if(ribbonRelationshipType===1)relType="ManyToMany";var ribbonContext="SubGridAssociated";if(isForm)ribbonContext="Form";else if(ribbonContextType==0)ribbonContext="HomePageGrid";var docStr="ReportsMenu",opStr="RunReport",contextStr=isForm?"Form":"Grid",cmdStr=entityLogicalName+"|"+relType+"|"+ribbonContext+"|Mscrm."+docStr+"."+opStr+"."+contextStr;return cmdStr};ReportsUtilites.getReportIdFromSourceControlId=function(sourceControlId){return sourceControlId.substring(sourceControlId.length-37).slice(0,-1)};ReportsUtilites.getCrmUri=function(path){if(Xrm.Utility.getGlobalContext().isOnPremises&&Xrm.Utility.getGlobalContext().getOrgUniqueName)return Xrm.Utility.getGlobalContext().prependOrgName(path)};ReportsUtilites.CreateViewReportForm=function(uri,reportId,fileName,context,contextQuery){var form=document.getElementsByName(ReportsUtilites.GridViewReportId)[0];if(form)form=ReportsUtilites._clearFormParameters(form);else{form=document.createElement("form");form.setAttribute("name",ReportsUtilites.GridViewReportId);form.setAttribute("method","post");form.setAttribute("style","display: none");form=document.body.appendChild(form)}uri=uri+("?action=run&id="+reportId+"&helpID="+fileName);if(context!=null)uri=uri+("&context="+context);if(contextQuery!=null)uri=uri+("&"+contextQuery);form.setAttribute("action",uri);return form};ReportsUtilites.addFormParameter=function(form,paramName,paramValue){var inputElement=document.createElement("input");inputElement.value=paramValue;inputElement.name=paramName;form.appendChild(inputElement);return form};ReportsUtilites.isEffectiveFetchXmlFinal=function(gridControl){return true};ReportsUtilites.getRunReportDialogUrl=function(reportId,numRecordsSelected,enableView){var view=enableView?1:0;return ReportsUtilites.getCrmUri("/_grid/cmds/dlg_runreport.aspx?id="+reportId+"&numselected="+numRecordsSelected+"&enableview="+view)};ReportsUtilites.divideReportsIntoFilterableAndNon=function(reports){for(var filterableReports=[],nonFilterableReports=[],i=0;i<reports.length;i++)if(reports[i].Isfilterable)filterableReports.push(reports[i]);else nonFilterableReports.push(reports[i]);return {filterableReports:filterableReports,nonFilterableReports:nonFilterableReports}};ReportsUtilites._clearFormParameters=function(form){if(form&&form.children)for(var i=form.children.length-1;i>=0;i--)form.removeChild(form.children[i]);return form};return ReportsUtilites}();InternalUtilities.ReportsUtilites=ReportsUtilites})(InternalUtilities=XrmCore.InternalUtilities||(XrmCore.InternalUtilities={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Commands;(function(Commands){function _getEventParam(eventName,eventValue){var eventParam={name:eventName,value:eventValue};return eventParam}function _reportingAvailable(){if(Xrm!=null&&Xrm.Reporting!=null)return true;return false}function logRetrieveReportsSuccess(entityLogicalName,reportVisibilityCode,ribbonRelationshipType){if(_reportingAvailable()){var eventParams=[];eventParams.push(_getEventParam("entityLogicalName",entityLogicalName));eventParams.push(_getEventParam("reportVisibilityCode",reportVisibilityCode.toString()));eventParams.push(_getEventParam("ribbonRelationshipType",ribbonRelationshipType.toString()));Xrm.Reporting.reportSuccess("RetrieveReports",eventParams)}}Commands.logRetrieveReportsSuccess=logRetrieveReportsSuccess;function logRetrieveReportsFailure(error,entityLogicalName,reportId,reportVisibilityCode,ribbonRelationshipType){var errorMessage;if(error.message&&error.message!=null&&error.message!="")errorMessage=error.message;else if(error.innerror&&error.innerror.message&&error.innerror.message!=null&&error.innerror.message!="")errorMessage=error.innerror.message;else errorMessage="Retrieve Reports Failed with unknown error";if(_reportingAvailable()){var errorParam={name:"ErrorResponse",message:errorMessage},eventParams=[];entityLogicalName?eventParams.push(_getEventParam("entityLogicalName",entityLogicalName)):null;reportVisibilityCode?eventParams.push(_getEventParam("reportVisibilityCode",reportVisibilityCode.toString())):null;ribbonRelationshipType?eventParams.push(_getEventParam("ribbonRelationshipType",ribbonRelationshipType.toString())):null;reportId?eventParams.push(_getEventParam("reportId",reportId)):null;Xrm.Reporting.reportFailure("RetrieveReports",errorParam,"",eventParams)}}Commands.logRetrieveReportsFailure=logRetrieveReportsFailure;function logRunReportOnEntityGrid(parameters,runMode){parameters&&parameters.ReportEntity&&_logReportEvent(parameters.ReportEntity.ReportId,parameters.EntityTypeCode,null,runMode,"run_reportonentitygrid")}Commands.logRunReportOnEntityGrid=logRunReportOnEntityGrid;function logReportEvent(reportId,entityTypeCode,reportTypecodeValue,eventDetail){_logReportEvent(reportId,entityTypeCode,reportTypecodeValue,null,eventDetail)}Commands.logReportEvent=logReportEvent;function _logReportEvent(reportId,entityTypeCode,reportTypecodeValue,runMode,eventDetail){if(_reportingAvailable()){var eventParams=[];entityTypeCode?eventParams.push(_getEventParam("EntityTypeCode",entityTypeCode.toString())):null;reportTypecodeValue?eventParams.push(_getEventParam("ReportTypecodeValue",reportTypecodeValue.toString())):null;runMode?eventParams.push(_getEventParam("RunMode",runMode.toString())):null;eventDetail?eventParams.push(_getEventParam("EventDetail",eventDetail)):null;var applicationEvent={eventName:"ucissrsreports",eventParameters:eventParams};if(reportId){eventParams.push(_getEventParam("ReportId",reportId));Xrm.Reporting.reportEvent(applicationEvent)}else{var errorParam={name:"ErrorResponse",message:"ReportId is null"};Xrm.Reporting.reportFailure("RetrieveReports",errorParam,"",eventParams)}}}})(Commands=XrmCore.Commands||(XrmCore.Commands={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var SaveAsLibraryLegacy=function(){function SaveAsLibraryLegacy(){var _this=this;this.isBulkSaveAsCancelledValid=function(entityTypeName){return _this.isBulkSaveAsCancelledValidLegacy(Xrm.Internal.getEntityCode(entityTypeName))};this.isBulkSaveAsCompletedValid=function(entityTypeName){return _this.isBulkSaveAsCompletedValidLegacy(Xrm.Internal.getEntityCode(entityTypeName))};this.canMarkComplete=function(records){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.canMarkComplete(records):backCompatHeader.Mscrm.GridRibbonActions.canMarkComplete(records)};this.isBulkSaveAsCancelledValidLegacy=function(entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.isBulkSaveAsCancelledValid(entityTypeCode):backCompatHeader.Mscrm.GridRibbonActions.isBulkSaveAsCancelledValid(entityTypeCode)};this.isBulkSaveAsCompletedValidLegacy=function(entityTypeCode){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.isBulkSaveAsCompletedValid(entityTypeCode):backCompatHeader.Mscrm.GridRibbonActions.isBulkSaveAsCompletedValid(entityTypeCode)}}return SaveAsLibraryLegacy}();Rules.SaveAsLibraryLegacy=SaveAsLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var SaveAsLibrary=function(){function SaveAsLibrary(){var _this=this;this.isBulkSaveAsCancelledValid=function(entityTypeName){if(XrmCore.InternalUtilities.DialogUtilities.isMobileCompanionApp())return true;if(Xrm.Utility.isActivityType(entityTypeName)||entityTypeName===Xrm.Constants.EntityNames.ActivityPointer)return !(entityTypeName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.RecurringAppointmentMaster||entityTypeName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.Email);else return false};this.isBulkSaveAsCompletedValid=function(entityTypeName){if(XrmCore.InternalUtilities.DialogUtilities.isMobileCompanionApp())return true;if(Xrm.Utility.isActivityType(entityTypeName)||entityTypeName===Xrm.Constants.EntityNames.ActivityPointer)return !(entityTypeName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.RecurringAppointmentMaster||entityTypeName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignActivity||entityTypeName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignResponse||entityTypeName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.Email);else return false};this.canMarkComplete=function(records){for(var i=0;i<records.length;i++){var typeName=records[i].TypeName;if(typeName!==XrmCore.InternalUtilities.EntityUtilities.EntityNames.Email&&typeName!==XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignActivity&&typeName!==XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignResponse)return true}return false};this.isBulkSaveAsCancelledValidLegacy=function(entityTypeCode){var entityName=Xrm.Internal.getEntityName(entityTypeCode);return _this.isBulkSaveAsCancelledValid(entityName)};this.isBulkSaveAsCompletedValidLegacy=function(entityTypeCode){var entityName=Xrm.Internal.getEntityName(entityTypeCode);return _this.isBulkSaveAsCompletedValid(entityName)}}return SaveAsLibrary}();Rules.SaveAsLibrary=SaveAsLibrary})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.SaveAs=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Rules.SaveAsLibrary:new Rules.SaveAsLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var SetRegardingLibraryLegacy=function(){function SetRegardingLibraryLegacy(){}SetRegardingLibraryLegacy.prototype.isBulkSetRegardingValid=function(entityTypeName,records){var entityTypeCode=Xrm.Internal.getEntityCode(entityTypeName),backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.GridCommandActions?Mscrm.GridCommandActions.isBulkSetRegardingValid(entityTypeCode,records):backCompatHeader.Mscrm.GridCommandActions.isBulkSetRegardingValid(entityTypeCode,records)};SetRegardingLibraryLegacy.prototype.disableForSocialActivityView=function(gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.GridRibbonActions?Mscrm.GridRibbonActions.disableForSocialActivityView(gridControl):backCompatHeader.Mscrm.GridRibbonActions.disableForSocialActivityView(gridControl)};return SetRegardingLibraryLegacy}();Rules.SetRegardingLibraryLegacy=SetRegardingLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var SetRegardingLibrary=function(){function SetRegardingLibrary(){}SetRegardingLibrary.prototype.isBulkSetRegardingValid=function(entityName,records){if(Xrm.Utility.isActivityType(entityName)||entityName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityPointer)switch(entityName){case XrmCore.InternalUtilities.EntityUtilities.EntityNames.ActivityPointer:for(var key in records){var record=records[key];if(record.logicalName===XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignActivity)return false}return true;case XrmCore.InternalUtilities.EntityUtilities.EntityNames.RecurringAppointmentMaster:case XrmCore.InternalUtilities.EntityUtilities.EntityNames.CampaignActivity:return false;default:return true}return false};SetRegardingLibrary.prototype.disableForSocialActivityView=function(gridControl){if(gridControl&&gridControl.getViewSelector&&gridControl.getViewSelector()&&gridControl.getViewSelector().getCurrentView&&gridControl.getViewSelector().getCurrentView())return ["{E3CA8AD6-C682-4383-B54E-82641EF83206}","{DB576E56-6591-402D-848B-D6F9D626DAA3}","{AE2B791C-8210-49D3-BA16-3110AF6864A4}","{3354F296-99AF-45EF-8223-88ED59A7F478}","{C26EF3A5-0D49-42D3-ABD9-0D75E5F849E3}","{9E28442C-413E-4E5B-B3ED-1DCFFE9F43A9}","{CE7337DF-90B4-4940-8751-0C7BF8CD50EB}","{436918CB-693E-43F1-AE90-48AE3FA21C61}","{DF8137B5-B580-4806-8A26-385B83CFB5BF}"].indexOf(gridControl.getViewSelector().getCurrentView().id)!==-1;return false};return SetRegardingLibrary}();Rules.SetRegardingLibrary=SetRegardingLibrary})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.SetRegarding=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Rules.SetRegardingLibrary:new Rules.SetRegardingLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.SharePointFCBLegacy="FCB.SharePointS2S";var SharePointDocumentLibraryLegacy=function(){function SharePointDocumentLibraryLegacy(){}SharePointDocumentLibraryLegacy.prototype.areSelectedLocationsSame=function(gridControl,records){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.areSelectedLocationsSame(gridControl,records):backCompatHeader.Mscrm.GridCommandActions.areSelectedLocationsSame(gridControl,records)};SharePointDocumentLibraryLegacy.prototype.isDocumentNotFromSharedLocation=function(gridControl,records){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isDocumentNotFromSharedLocation(gridControl,records):backCompatHeader.Mscrm.GridCommandActions.isDocumentNotFromSharedLocation(gridControl,records)};SharePointDocumentLibraryLegacy.prototype.isSharePointSiteConfigured=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isSharePointSiteConfigured():backCompatHeader.Mscrm.GridCommandActions.isSharePointSiteConfigured()};SharePointDocumentLibraryLegacy.prototype.isRecordHasActiveSharePointDocLocation=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isRecordHasActiveSharePointDocLocation():backCompatHeader.Mscrm.GridCommandActions.disableButtonsWhenChartMaximized()};SharePointDocumentLibraryLegacy.prototype.isRecordHasActiveOrRenamedSharePointDocLocation=function(){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isRecordHasActiveOrRenamedSharePointDocLocation():backCompatHeader.Mscrm.GridCommandActions.isRecordHasActiveOrRenamedSharePointDocLocation()};SharePointDocumentLibraryLegacy.prototype.isDocumentRecommendationsEnabledForEntity=function(gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.CommandBarActions?Mscrm.CommandBarActions.isDocumentRecommendationsEnabledForEntity(gridControl):backCompatHeader.Mscrm.CommandBarActions.isDocumentRecommendationsEnabledForEntity(gridControl)};SharePointDocumentLibraryLegacy.prototype.isFolderNotSelected=function(gridControl,records){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.CommandBarActions?Mscrm.RibbonActions.isFolderNotSelected(gridControl,records):backCompatHeader.Mscrm.CommandBarActions.isFolderNotSelected(gridControl,records)};SharePointDocumentLibraryLegacy.prototype.isDocumentAssociatedGridViewSelected=function(gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.CommandBarActions?Mscrm.RibbonActions.isDocumentAssociatedGridViewSelected(gridControl):backCompatHeader.Mscrm.CommandBarActions.isDocumentAssociatedGridViewSelected(gridControl)};SharePointDocumentLibraryLegacy.prototype.isSharePointDocLocationNotSharedOrAllFiles=function(gridControl){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.RibbonActions?Mscrm.RibbonActions.isSharePointDocLocationNotSharedOrAllFiles():backCompatHeader.Mscrm.GridCommandActions.isSharePointDocLocationNotSharedOrAllFiles()};SharePointDocumentLibraryLegacy.prototype.hideCommand=function(){return false};SharePointDocumentLibraryLegacy.prototype.isSharePointEnabled=function(){return Xrm.Internal.isFeatureEnabled(Rules.SharePointFCBLegacy)};return SharePointDocumentLibraryLegacy}();Rules.SharePointDocumentLibraryLegacy=SharePointDocumentLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.LOCATION_ID="locationid";Rules.SHARED_LOCATION_GUID="17DE0DBB-153C-4C1A-B98A-223B3EA10125";Rules.SharePointFCB="SharePointS2S";var SharePointDocumentLibrary=function(){function SharePointDocumentLibrary(){}SharePointDocumentLibrary.prototype.areSelectedLocationsSame=function(gridControl,records){return true};SharePointDocumentLibrary.prototype.isDocumentNotFromSharedLocation=function(gridControl,records){var isDocNotFromSharedLoc=false,getLocationIdFromGridCtrl=GridControlUtil.GetParameterFromGridControl(gridControl,Rules.LOCATION_ID).toUpperCase();if(getLocationIdFromGridCtrl!=Rules.SHARED_LOCATION_GUID)return isDocNotFromSharedLoc=true;return isDocNotFromSharedLoc};SharePointDocumentLibrary.prototype.isSharePointSiteConfigured=function(){return true};SharePointDocumentLibrary.prototype.isRecordHasActiveSharePointDocLocation=function(){return true};SharePointDocumentLibrary.prototype.isRecordHasActiveOrRenamedSharePointDocLocation=function(){return true};SharePointDocumentLibrary.prototype.isDocumentRecommendationsEnabledForEntity=function(gridControl){return false};SharePointDocumentLibrary.prototype.isFolderNotSelected=function(gridControl,records){var returnValue=false;if(gridControl&&records){returnValue=true;var selectedRecords=gridControl.getGrid().getSelectedRows();selectedRecords&&selectedRecords.forEach(function(row){if(row&&row.data&&row.data.entity){var fileType=row.data.entity.attributes.get("filetype").getValue();if(fileType=="folder"||fileType=="onetoc2")returnValue=false}})}return returnValue};SharePointDocumentLibrary.prototype.isDocumentAssociatedGridViewSelected=function(gridControl){var isViewSelected=false,viewId="{0016f9f3-41cc-4276-9d11-04308d15858d}";if(gridControl){var viewSelector=gridControl.getViewSelector(),currentView=viewSelector.getCurrentView();isViewSelected=currentView!=null&&currentView.id!=null&&currentView.id.toString().toUpperCase()==viewId.toUpperCase()?true:false}return isViewSelected};SharePointDocumentLibrary.prototype.isSharePointDocLocationNotSharedOrAllFiles=function(gridControl){var isDocNotFromSharedLoc=false,getLocationIdFromGridCtrl=GridControlUtil.GetParameterFromGridControl(gridControl,Rules.LOCATION_ID).toUpperCase();if(getLocationIdFromGridCtrl!=Rules.SHARED_LOCATION_GUID)return isDocNotFromSharedLoc=true;return isDocNotFromSharedLoc};SharePointDocumentLibrary.prototype.hideCommand=function(){return false};SharePointDocumentLibrary.prototype.isSharePointEnabled=function(){return Xrm.Internal.isFeatureEnabled(Rules.SharePointFCB)};return SharePointDocumentLibrary}();Rules.SharePointDocumentLibrary=SharePointDocumentLibrary;var GridControlUtil=function(){function GridControlUtil(){}GridControlUtil.GetParameterFromGridControl=function(gridControl,id){var customFilterXml=gridControl.getFilterXml();return customFilterXml?GridControlUtil.GetParameterFromFetchXml(customFilterXml,id.toLowerCase()):""};GridControlUtil.GetParameterFromFetchXml=function(fetchXml,parameterName){var domParser=new DOMParser,fetchXmlDocument=domParser.parseFromString(fetchXml,"text/xml");if(fetchXmlDocument){var filterElements=fetchXmlDocument.getElementsByTagName("filter");if(filterElements&&filterElements.length>0)for(var index=0;index<filterElements.length;index++)for(var filterElement=filterElements[index],filterElementIndex=0;filterElementIndex<filterElement.childNodes.length;filterElementIndex++){var currentElement=filterElement.childNodes.item(filterElementIndex);if(currentElement.nodeName==="condition"){var attributeName=GridControlUtil.getNodeAttributeValueFromName(currentElement,"attribute");if(attributeName===parameterName)return GridControlUtil.getNodeAttributeValueFromName(currentElement,"value")}}}return ""};GridControlUtil.getNodeAttributeValueFromName=function(inputNode,attribuetName){if(!inputNode)return null;var nodeAttributeMap=inputNode.attributes.getNamedItem(attribuetName);return nodeAttributeMap?nodeAttributeMap.value:null};return GridControlUtil}();Rules.GridControlUtil=GridControlUtil})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.SharePointDocument=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Rules.SharePointDocumentLibrary:new Rules.SharePointDocumentLibraryLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var SystemUserRules=function(){function SystemUserRules(){}SystemUserRules.prototype.isCurrentUser=function(userId){var globalContext=Xrm.Utility.getGlobalContext(),currentUserId=globalContext?globalContext.userSettings.userId.toLowerCase().replace("{","").replace("}",""):null;if(userId!==null&&userId!==undefined&&currentUserId){userId=userId.toLowerCase().replace("{","").replace("}","");return userId===currentUserId}return false};return SystemUserRules}();Rules.SystemUserRules=SystemUserRules})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){var SystemUserRulesLegacy=function(){function SystemUserRulesLegacy(){}SystemUserRulesLegacy.prototype.isCurrentUser=function(userId){var backCompatHeader=XrmCore.InternalUtilities.LegacyUtilities.getIFrameForWebClient(false);return Mscrm&&Mscrm.SystemUserActions?Mscrm.SystemUserActions.isCurrentUser(userId):backCompatHeader.Mscrm.SystemUserActions.isCurrentUser(userId)};return SystemUserRulesLegacy}();Rules.SystemUserRulesLegacy=SystemUserRulesLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var Rules;(function(Rules){Rules.SystemUser=Xrm.Internal.isUci&&Xrm.Internal.isUci()?new Rules.SystemUserRules:new Rules.SystemUserRulesLegacy})(Rules=XrmCore.Rules||(XrmCore.Rules={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var AssignRequest=function(){function AssignRequest(){}AssignRequest.prototype.getMetadata=function(){var metadata={boundParameter:null,operationName:"Assign",operationType:0,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Assignee:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}}};return metadata};return AssignRequest}();SdkContracts.AssignRequest=AssignRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var DeleteRequest=function(){function DeleteRequest(entityReference){this.entityReference=entityReference}DeleteRequest.prototype.getMetadata=function(){var metadata={boundParameter:undefined,parameterTypes:{entityReference:{typeName:"mscrm.crmbaseentity",structuralProperty:5}},operationName:"Delete",operationType:2};return metadata};return DeleteRequest}();SdkContracts.DeleteRequest=DeleteRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var Object=function(){function Object(){}Object.prototype.getMetadata=function(){var metadata={boundParameter:null,parameterTypes:{},operationName:null,operationType:null};return metadata};return Object}();SdkContracts.Object=Object})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var InputArgumentCollection=function(){function InputArgumentCollection(args){this.Arguments=args}InputArgumentCollection.prototype.getMetadata=function(){var metadata={boundParameter:null,parameterTypes:{Arguments:{typeName:"Microsoft.Dynamics.CRM.InputArgument",structuralProperty:2}},operationName:null,operationType:null};return metadata};return InputArgumentCollection}();SdkContracts.InputArgumentCollection=InputArgumentCollection})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var InputArgument=function(){function InputArgument(count,isReadOnly,keys,values){this.Count=count;this.IsReadOnly=isReadOnly;this.Keys=keys;this.Values=values}InputArgument.prototype.getMetadata=function(){var metadata={boundParameter:null,parameterTypes:{Count:{typeName:"Edm.Int32",structuralProperty:1},IsReadOnly:{typeName:"Edm.Boolean",structuralProperty:1},Keys:{typeName:"Edm.String",structuralProperty:4},Values:{typeName:"mscrm.Object",structuralProperty:4}},operationName:null,operationType:null};return metadata};return InputArgument}();SdkContracts.InputArgument=InputArgument})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var ExportToExcelRequest=function(){function ExportToExcelRequest(view,fetchXml,layoutXml,queryApi,queryParameters){this.View=view;this.FetchXml=fetchXml;this.LayoutXml=layoutXml;this.QueryApi=queryApi;this.QueryParameters=queryParameters}ExportToExcelRequest.prototype.getMetadata=function(){var metadata={boundParameter:null,parameterTypes:{View:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FetchXml:{typeName:"Edm.String",structuralProperty:1},LayoutXml:{typeName:"Edm.String",structuralProperty:1},QueryApi:{typeName:"Edm.String",structuralProperty:1},QueryParameters:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}},operationName:"ExportToExcel",operationType:0};return metadata};return ExportToExcelRequest}();SdkContracts.ExportToExcelRequest=ExportToExcelRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var ExportWordDocumentRequest=function(){function ExportWordDocumentRequest(entityTypeCode,selectedTemplate,selectedRecords){this.EntityTypeCode=entityTypeCode;this.SelectedTemplate=selectedTemplate;this.SelectedRecords=selectedRecords}ExportWordDocumentRequest.prototype.getMetadata=function(){var metadata={boundParameter:null,parameterTypes:{EntityTypeCode:{typeName:"Edm.Int32",structuralProperty:1},SelectedTemplate:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},SelectedRecords:{typeName:"Edm.String",structuralProperty:1}},operationName:"ExportWordDocument",operationType:0};return metadata};return ExportWordDocumentRequest}();SdkContracts.ExportWordDocumentRequest=ExportWordDocumentRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var RenderTemplateRequest=function(){function RenderTemplateRequest(template,fetchXml,queryApi,queryParameters){this.Template=template;this.FetchXml=fetchXml;this.QueryApi=queryApi;this.QueryParameters=queryParameters}RenderTemplateRequest.prototype.getMetadata=function(){var metadata={boundParameter:null,parameterTypes:{Template:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FetchXml:{typeName:"Edm.String",structuralProperty:1},QueryApi:{typeName:"Edm.String",structuralProperty:1},QueryParameters:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}},operationName:"RenderTemplate",operationType:0};return metadata};return RenderTemplateRequest}();SdkContracts.RenderTemplateRequest=RenderTemplateRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var RenderTemplateFromViewRequest=function(){function RenderTemplateFromViewRequest(template,view){this.Template=template;this.View=view}RenderTemplateFromViewRequest.prototype.getMetadata=function(){var metadata={boundParameter:null,parameterTypes:{Template:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},View:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"RenderTemplateFromView",operationType:0};return metadata};return RenderTemplateFromViewRequest}();SdkContracts.RenderTemplateFromViewRequest=RenderTemplateFromViewRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var RetrieveActiveStageRecordRequest=function(){function RetrieveActiveStageRecordRequest(bpfEntityReference){this.BpfEntityReference=bpfEntityReference}RetrieveActiveStageRecordRequest.prototype.getMetadata=function(){var metadata={boundParameter:null,parameterTypes:{BpfEntityReference:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"RetrieveActiveStageRecord",operationType:1};return metadata};return RetrieveActiveStageRecordRequest}();SdkContracts.RetrieveActiveStageRecordRequest=RetrieveActiveStageRecordRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var SetRegardingRequest=function(){function SetRegardingRequest(record,regardingObjectTypeName,regardingObjectId,entitySetName){this.id=record.Id.replace("{","").replace("}","");this.etn=record.TypeName;var payloadKey="regardingobjectid_"+regardingObjectTypeName+"_"+record.TypeName+"@odata.bind";this.payload={};this.payload[payloadKey]="/"+entitySetName+"("+regardingObjectId.replace("{","").replace("}","")+")"}SetRegardingRequest.prototype.getMetadata=function(){var metadata={boundParameter:undefined,parameterTypes:{},operationName:"Update",operationType:2};return metadata};return SetRegardingRequest}();SdkContracts.SetRegardingRequest=SetRegardingRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var SetStateRequest=function(){function SetStateRequest(id,etn,statecode,statuscode){this.id=id.replace("{","").replace("}","");this.etn=etn;this.payload={statecode:statecode,statuscode:statuscode}}SetStateRequest.prototype.getMetadata=function(){var metadata={boundParameter:undefined,parameterTypes:{},operationName:"Update",operationType:2};return metadata};return SetStateRequest}();SdkContracts.SetStateRequest=SetStateRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var RemoveUserFromRecordTeamRequest=function(){function RemoveUserFromRecordTeamRequest(entity,record,teamTemplate){this.entity=entity;this.Record=record;this.TeamTemplate=teamTemplate}RemoveUserFromRecordTeamRequest.prototype.getMetadata=function(){var metadata={boundParameter:"entity",parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.systemuser",structuralProperty:5},Record:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},TeamTemplate:{typeName:"Microsoft.Dynamics.CRM.teamtemplate",structuralProperty:5}},operationName:"RemoveUserFromRecordTeam",operationType:0};return metadata};return RemoveUserFromRecordTeamRequest}();SdkContracts.RemoveUserFromRecordTeamRequest=RemoveUserFromRecordTeamRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var AddUserToRecordTeamRequest=function(){function AddUserToRecordTeamRequest(entity,record,teamTemplate){this.entity=entity;this.Record=record;this.TeamTemplate=teamTemplate}AddUserToRecordTeamRequest.prototype.getMetadata=function(){var metadata={boundParameter:"entity",parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.systemuser",structuralProperty:5},Record:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},TeamTemplate:{typeName:"Microsoft.Dynamics.CRM.teamtemplate",structuralProperty:5}},operationName:"AddUserToRecordTeam",operationType:0};return metadata};return AddUserToRecordTeamRequest}();SdkContracts.AddUserToRecordTeamRequest=AddUserToRecordTeamRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var InternalUtilities;(function(InternalUtilities){var ActivityUtilities=function(){function ActivityUtilities(){}ActivityUtilities.isActivityTypeCode=function(entityName){switch(entityName){case InternalUtilities.EntityUtilities.EntityNames.Task:case InternalUtilities.EntityUtilities.EntityNames.Letter:case InternalUtilities.EntityUtilities.EntityNames.PhoneCall:case InternalUtilities.EntityUtilities.EntityNames.ServiceAppointment:case InternalUtilities.EntityUtilities.EntityNames.UntrackedEmail:case InternalUtilities.EntityUtilities.EntityNames.Fax:case InternalUtilities.EntityUtilities.EntityNames.QuoteClose:case InternalUtilities.EntityUtilities.EntityNames.OrderClose:case InternalUtilities.EntityUtilities.EntityNames.IncidentResolution:case InternalUtilities.EntityUtilities.EntityNames.OpportunityClose:case InternalUtilities.EntityUtilities.EntityNames.SocialActivity:case InternalUtilities.EntityUtilities.EntityNames.CampaignActivity:case InternalUtilities.EntityUtilities.EntityNames.Appointment:case InternalUtilities.EntityUtilities.EntityNames.BulkOperation:case InternalUtilities.EntityUtilities.EntityNames.RecurringAppointmentMaster:case InternalUtilities.EntityUtilities.EntityNames.CampaignResponse:case InternalUtilities.EntityUtilities.EntityNames.Email:case InternalUtilities.EntityUtilities.EntityNames.ActivityPointer:return true;default:return false}};return ActivityUtilities}();InternalUtilities.ActivityUtilities=ActivityUtilities})(InternalUtilities=XrmCore.InternalUtilities||(XrmCore.InternalUtilities={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var InternalUtilities;(function(InternalUtilities){var DialogUtilities=function(){function DialogUtilities(){}DialogUtilities.closeDialog=function(eventContext){var formContext=eventContext.getFormContext();this.setLastButtonClicked(eventContext,DialogUtilities.DialogConstants.DialogCancelId);formContext.ui.close()};DialogUtilities.setLastButtonClicked=function(eventContext,buttonId){var formContext=eventContext.getFormContext(),lastButtonClicked=formContext.data.attributes.get("last_button_clicked");lastButtonClicked&&lastButtonClicked.setValue(buttonId)};DialogUtilities.isMobileCompanionApp=function(){return Xrm.Utility.getGlobalContext().client.getClient()===Xrm.Constants.ClientNames.mobile};DialogUtilities.isOutlook=function(){return Xrm.Utility.getGlobalContext().client.getClient()===Xrm.Constants.ClientNames.outlook};DialogUtilities.isMailApp=function(){var contexts=Xrm&&Xrm.ExternalContext?Xrm.ExternalContext.getAvailableExternalContexts():null;if(contexts&&contexts.get("MAIL_CONTEXT"))return true;return false};DialogUtilities.isOffline=function(){return DialogUtilities.isMobileCompanionApp()&&Xrm.Utility.getGlobalContext().client.getClientState()===Xrm.Constants.ClientStates.offline};DialogUtilities.showOfflineError=function(){var alert={text:InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Generic_Mobile_Client_Offline")};Xrm.Navigation.openAlertDialog(alert)};DialogUtilities.getSdkEntityReference=function(records){var referenceList=[];records.forEach(function(record){referenceList.push(record)});return referenceList};DialogUtilities.serializeSdkEntityReferences=function(records){return JSON.stringify(records)};DialogUtilities.deserializeSdkEntityReferences=function(stringifiedRecords){if(!stringifiedRecords)return [];return DialogUtilities.getSdkEntityReference(JSON.parse(stringifiedRecords))};DialogUtilities.createActionFailedErrorDialog=function(errorResponse){Xrm.Utility.closeProgressIndicator();var errorDialogOptions={message:errorResponse.message,errorCode:errorResponse.errorCode};Xrm.Navigation.openErrorDialog(errorDialogOptions)};DialogUtilities.onGridActionMultipleSuccess=function(gridControl,successResponses){if(successResponses.every(function(response){return response.ok}))gridControl&&gridControl.refresh();else InternalUtilities.DialogUtilities.openAlertDialogForMultipleErrors(gridControl)};DialogUtilities.isAllowLegacyDialogsEmbedding=function(){if(Xrm&&Xrm.Internal&&Xrm.Internal.getAllowLegacyDialogsEmbedding)return !DialogUtilities.isMobileCompanionApp()&&!DialogUtilities.isOutlook()&&!DialogUtilities.isMailApp()&&Xrm.Internal.getAllowLegacyDialogsEmbedding();return false};DialogUtilities.tryGetDialogStringsForEnabledMetadataDialogs=function(dialogName,confirmDialogStrings,entityName,recordsToDelete,actionUri,entityDisplayName,entitySetName,isDocumentManagementEnabled,isPrimary){if(isPrimary===void 0)isPrimary=false;if(recordsToDelete===null||recordsToDelete===undefined)recordsToDelete=1;var displayName=entityDisplayName;if(recordsToDelete>1)displayName=entitySetName;var DialogStrings={},DialogKeys=null;switch(dialogName){case DialogUtilities.DialogName.DeleteDialog:switch(entityName){case InternalUtilities.EntityUtilities.EntityNames.Contact:DialogKeys=["Web._grid.cmds.dlg_delete_contact.aspx_54","Delete_Customer_Dialog_Account_Instruction","Delete_Customer_Dialog_Delete_Instruction","Button_Label_Delete","Button_Label_Cancel","Dialog_DeleteContactConfirm_Title","Dialog_DeleteContactConfirm_Description"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Web._grid.cmds.dlg_delete_contact.aspx_54"].toString(),[displayName]);confirmDialogStrings.text+="\n";confirmDialogStrings.text+=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Delete_Customer_Dialog_Account_Instruction"].toString(),[displayName]);confirmDialogStrings.text+="\n";confirmDialogStrings.text+=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Delete_Customer_Dialog_Delete_Instruction"].toString(),[displayName]);confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Delete"].toString(),[]);confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Cancel"].toString(),[]);confirmDialogStrings.title=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_DeleteContactConfirm_Title"].toString(),[displayName]);confirmDialogStrings.subtitle=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_DeleteContactConfirm_Description"].toString(),[recordsToDelete,displayName]);break;case InternalUtilities.EntityUtilities.EntityNames.Account:DialogKeys=["Web._grid.cmds.dlg_delete_account.aspx_54","Button_Label_Delete","Button_Label_Cancel","Dialog_DeleteAccountConfirm_Title","Dialog_DeleteAccountConfirm_Description"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Web._grid.cmds.dlg_delete_account.aspx_54"].toString(),[displayName]);confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Delete"].toString(),[]);confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Cancel"].toString(),[]);confirmDialogStrings.title=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_DeleteAccountConfirm_Title"].toString(),[displayName]);confirmDialogStrings.subtitle=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_DeleteAccountConfirm_Description"].toString(),[recordsToDelete,displayName]);if(isDocumentManagementEnabled){DialogKeys=["Delete_Account_Dialog_RelatedDocumentsWarning","Delete_Customer_Dialog_Account_Instruction","Delete_Customer_Dialog_Delete_Instruction"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text+="\n";confirmDialogStrings.text+=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Delete_Account_Dialog_RelatedDocumentsWarning"].toString(),[]);confirmDialogStrings.text+="\n";confirmDialogStrings.text+=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Delete_Customer_Dialog_Account_Instruction"].toString(),[displayName]);confirmDialogStrings.text+="\n";confirmDialogStrings.text+=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Delete_Customer_Dialog_Delete_Instruction"].toString(),[displayName])}break;case InternalUtilities.EntityUtilities.EntityNames.KnowledgeArticle:DialogKeys=["Delete_KnowledgeArticle_Dialog_RelatedInformationWarning","Button_Label_Delete","Button_Label_Cancel","Dialog_DeleteKnowledgeArticleConfirm_Title","Dialog_DeleteKnowledgeArticleConfirm_Description"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=DialogStrings["Delete_KnowledgeArticle_Dialog_RelatedInformationWarning"].toString();confirmDialogStrings.confirmButtonLabel=DialogStrings["Button_Label_Delete"].toString();confirmDialogStrings.cancelButtonLabel=DialogStrings["Button_Label_Cancel"].toString();confirmDialogStrings.title=DialogStrings["Dialog_DeleteKnowledgeArticleConfirm_Title"].toString();confirmDialogStrings.subtitle=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_DeleteKnowledgeArticleConfirm_Description"].toString(),[recordsToDelete]);break;case InternalUtilities.EntityUtilities.EntityNames.OpportunityProduct:case InternalUtilities.EntityUtilities.EntityNames.InvoiceDetail:DialogKeys=["Dialog_Delete_DeleteAll","Button_Label_Delete","Button_Label_Cancel","Web._grid.cmds.dlg_delete.aspx_26"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_DeleteAll"].toString(),[]);confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Delete"].toString(),[]);confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Cancel"].toString(),[]);confirmDialogStrings.title=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Web._grid.cmds.dlg_delete.aspx_26"].toString(),[]);confirmDialogStrings.subtitle="";break;case InternalUtilities.EntityUtilities.EntityNames.Lead:case InternalUtilities.EntityUtilities.EntityNames.Competitor:case InternalUtilities.EntityUtilities.EntityNames.Opportunity:case InternalUtilities.EntityUtilities.EntityNames.DynamicProperty:case InternalUtilities.EntityUtilities.EntityNames.Email:case InternalUtilities.EntityUtilities.EntityNames.Incident:case InternalUtilities.EntityUtilities.EntityNames.SyncError:DialogKeys=["Dialog_Delete_Description","Button_Label_Delete","Button_Label_Cancel","Web._grid.cmds.dlg_delete.aspx_26"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_Description"].toString(),[displayName]);confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Delete"].toString(),[]);confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Cancel"].toString(),[]);confirmDialogStrings.title=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Web._grid.cmds.dlg_delete.aspx_26"].toString(),[]);confirmDialogStrings.subtitle="";break;case InternalUtilities.EntityUtilities.EntityNames.Queue:DialogKeys=["Dialog_DeleteQueue_Description","Button_Label_Delete","Button_Label_Cancel","Dialog_DeleteQueueEmpty_Title"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_DeleteQueue_Description"].toString(),[recordsToDelete,displayName]);confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Delete"].toString(),[]);confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Cancel"].toString(),[]);confirmDialogStrings.title=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_DeleteQueueEmpty_Title"].toString(),[displayName]);confirmDialogStrings.subtitle="";break;case InternalUtilities.EntityUtilities.EntityNames.TopicModel:DialogKeys=["Dialog_Delete_Topicmodel_Description","Button_Label_Delete","Button_Label_Cancel","Dialog_Delete_Topicmodel_Title"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_Topicmodel_Description"].toString(),[]);confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Delete"].toString(),[]);confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Cancel"].toString(),[]);confirmDialogStrings.title=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_Topicmodel_Title"].toString(),[]);confirmDialogStrings.subtitle="";break;case InternalUtilities.EntityUtilities.EntityNames.AzureServiceConnection:DialogKeys=["Dialog_Delete_AzureServiceConnection_Description","Button_Label_Delete","Button_Label_Cancel","Dialog_Delete_AzureServiceConnection_Title"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_AzureServiceConnection_Description"].toString(),[]);confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Delete"].toString(),[]);confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Cancel"].toString(),[]);confirmDialogStrings.title=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_AzureServiceConnection_Title"].toString(),[]);confirmDialogStrings.subtitle="";break;case InternalUtilities.EntityUtilities.EntityNames.Contract:case InternalUtilities.EntityUtilities.EntityNames.RecurringAppointmentMaster:case InternalUtilities.EntityUtilities.EntityNames.ServiceAppointment:case InternalUtilities.EntityUtilities.EntityNames.Role:case InternalUtilities.EntityUtilities.EntityNames.TeamTemplate:case InternalUtilities.EntityUtilities.EntityNames.CalendarRule:return false;case InternalUtilities.EntityUtilities.EntityNames.Product:DialogUtilities.GetDefaultStringsForDeleteDialog(confirmDialogStrings,displayName);break;case InternalUtilities.EntityUtilities.EntityNames.Connection:if(isPrimary)DialogUtilities.GetDefaultStringsForDeleteDialog(confirmDialogStrings,displayName);else{DialogKeys=["Dialog_Delete_Connection_Description","Dialog_Delete_Bulk_Connection_Description","Button_Label_Yes","Button_Label_No","Dialog_Delete_Connection_Title"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=Xrm.Utility.getResourceString("Main_system_library",key)||key});confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_Connection_Description"].toString(),[]);confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Yes"].toString(),[]);confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_No"].toString(),[]);confirmDialogStrings.title=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_Connection_Title"].toString(),[]);if(recordsToDelete>1)confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_Bulk_Connection_Description"].toString(),[]);confirmDialogStrings.subtitle=""}break;case InternalUtilities.EntityUtilities.EntityNames.Category:DialogKeys=["Dialog_Delete_Description_Category","Button_Label_Yes","Button_Label_No","Web._grid.cmds.dlg_delete.aspx_26"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_Description_Category"].toString(),[displayName]);confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Yes"].toString(),[]);confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_No"].toString(),[]);confirmDialogStrings.title=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Web._grid.cmds.dlg_delete.aspx_26"].toString(),[]);confirmDialogStrings.subtitle="";break;default:DialogUtilities.GetDefaultStringsForDeleteDialog(confirmDialogStrings,displayName);break}break;case InternalUtilities.DialogUtilities.DialogName.SaveAndRouteCase:confirmDialogStrings.text=InternalUtilities.GenericUtilities.getLocalResourceString("Dlg_RouteCase_AddRequiredConfirmForSingleCase_Body");confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Route");confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Cancel");confirmDialogStrings.title=InternalUtilities.GenericUtilities.getLocalResourceString("Dlg_RouteCase_AddRequiredConfirm_Title");break;case InternalUtilities.DialogUtilities.DialogName.RouteCase:DialogKeys=["Dlg_RouteCase_AddRequiredConfirmForSingleCase_Body","Button_Label_Route","Button_Label_Cancel","Dlg_RouteCase_AddRequiredConfirm_Title"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=DialogStrings["Dlg_RouteCase_AddRequiredConfirmForSingleCase_Body"].toString();confirmDialogStrings.confirmButtonLabel=DialogStrings["Button_Label_Route"].toString();confirmDialogStrings.cancelButtonLabel=DialogStrings["Button_Label_Cancel"].toString();confirmDialogStrings.title=DialogStrings["Dlg_RouteCase_AddRequiredConfirm_Title"].toString();break;case InternalUtilities.DialogUtilities.DialogName.ReactivateCase:DialogKeys=["Case_Reactivate_Dlg_Title","Web.CS.cases.dlg_reactivate.aspx_50","Button_Label_Reactivate","Button_Label_Cancel"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.title=DialogStrings["Case_Reactivate_Dlg_Title"].toString();confirmDialogStrings.text=DialogStrings["Web.CS.cases.dlg_reactivate.aspx_50"].toString();confirmDialogStrings.confirmButtonLabel=DialogStrings["Button_Label_Reactivate"].toString();confirmDialogStrings.cancelButtonLabel=DialogStrings["Button_Label_Cancel"].toString();break;case InternalUtilities.DialogUtilities.DialogName.ResolveCase:DialogKeys=["Web._cs.Cases.dlg_ConfirmResolve.aspx_1","Web._cs.Cases.dlg_ConfirmResolve.aspx_3","Button_Label_Confirm","Button_Label_Cancel"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.title=DialogStrings["Web._cs.Cases.dlg_ConfirmResolve.aspx_1"].toString();confirmDialogStrings.text=DialogStrings["Web._cs.Cases.dlg_ConfirmResolve.aspx_3"].toString();confirmDialogStrings.confirmButtonLabel=DialogStrings["Button_Label_Confirm"].toString();confirmDialogStrings.cancelButtonLabel=DialogStrings["Button_Label_Cancel"].toString();break;case InternalUtilities.DialogUtilities.DialogConstants.resolveCaseNoValidStatusReasonTransition:DialogKeys=["Web.Record.NoValidStatusReasonTransition.Window_Title01","Web.Record.NoValidStatusReasonTransition01","Button_Label_OK","Button_Label_Cancel"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.title=DialogStrings["Web.Record.NoValidStatusReasonTransition.Window_Title01"].toString();confirmDialogStrings.text=DialogStrings["Web.Record.NoValidStatusReasonTransition01"].toString();confirmDialogStrings.confirmButtonLabel=DialogStrings["Button_Label_OK"].toString();confirmDialogStrings.cancelButtonLabel=DialogStrings["Button_Label_Cancel"].toString();break;case InternalUtilities.DialogUtilities.DialogName.CancelCaseDialog:DialogKeys=["Web._cs.Cases.dlg_ConfirmResolve.aspx_4","Button_Label_Confirm","Button_Label_Cancel","Web._cs.Cases.dlg_ConfirmCancel.aspx_2"];DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=DialogStrings["Web._cs.Cases.dlg_ConfirmResolve.aspx_4"].toString();confirmDialogStrings.confirmButtonLabel=DialogStrings["Button_Label_Confirm"].toString();confirmDialogStrings.cancelButtonLabel=DialogStrings["Button_Label_Cancel"].toString();confirmDialogStrings.title=DialogStrings["Web._cs.Cases.dlg_ConfirmCancel.aspx_2"].toString();break;case InternalUtilities.DialogUtilities.DialogName.ApplyEmailTemplate:confirmDialogStrings.text=InternalUtilities.GenericUtilities.getLocalResourceString("Web._cs.ApplyEmailTemplate.dlg_ConfirmResolveText");confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_OK");confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Cancel");confirmDialogStrings.title=InternalUtilities.GenericUtilities.getLocalResourceString("Web._cs.ApplyEmailTemplate.dlg_ConfirmResolveTitle");break;case InternalUtilities.DialogUtilities.DialogName.UpdateAttachment:confirmDialogStrings.text=InternalUtilities.GenericUtilities.getLocalResourceString("AddTemplateWithoutAttachment");confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_OK");confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.getLocalResourceString("Button_Label_Cancel");confirmDialogStrings.title=InternalUtilities.GenericUtilities.getLocalResourceString("Web._cs.ApplyEmailTemplate.dlg_ConfirmResolveTitle");break;default:return false}return true};DialogUtilities.GetDefaultStringsForDeleteDialog=function(confirmDialogStrings,displayName){var DialogKeys=["Dialog_Delete_Description","Button_Label_Delete","Button_Label_Cancel","Web._grid.cmds.dlg_delete.aspx_26"],DialogStrings={};DialogKeys.forEach(function(key){DialogStrings[key]=InternalUtilities.GenericUtilities.getLocalResourceString(key)||key});confirmDialogStrings.text=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Dialog_Delete_Description"].toString(),[displayName]);confirmDialogStrings.confirmButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Delete"].toString(),[displayName]);confirmDialogStrings.cancelButtonLabel=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Button_Label_Cancel"].toString(),[displayName]);confirmDialogStrings.title=InternalUtilities.GenericUtilities.stringFormat(DialogStrings["Web._grid.cmds.dlg_delete.aspx_26"].toString(),[]);confirmDialogStrings.subtitle=""};DialogUtilities.openAlertDialogForMultipleErrors=function(gridControl){var alertDialogStrings={text:InternalUtilities.GenericUtilities.getLocalResourceString("Error_Message_Action_MultipleErrorsFound")};Xrm.Navigation.openAlertDialog(alertDialogStrings,null).then(function(success){gridControl&&gridControl.refresh()})};return DialogUtilities}();InternalUtilities.DialogUtilities=DialogUtilities;var DialogUtilities;(function(DialogUtilities){var DialogName=function(){function DialogName(){}DialogName.RouteCase="routecase";DialogName.SaveAndRouteCase="saveandroutecase";DialogName.DeleteDialog="delete";DialogName.AddToQueueDialog="AddToQueue";DialogName.ReactivateCase="ReactivateCase";DialogName.ResolveCase="ResolveCase";DialogName.QueueItemPickDialog="QueueItemPick";DialogName.RouteQueuedItemDialog="RouteQueuedItem";DialogName.Assign="Assign";DialogName.AssignQueue="AssignQueue";DialogName.CancelCaseDialog="CancelCase";DialogName.SetRegarding="SetRegarding";DialogName.ConvertActivityDialog="ConvertActivity";DialogName.ConvertToCaseDialog="ConvertToCase";DialogName.ConvertToKnowledgeArticleDialog="ConvertToKnowledgeArticle";DialogName.CloseOpportunity="CloseOpportunity";DialogName.CloseOrder="CloseOrder";DialogName.CloseInvoice="InvoiceClose";DialogName.CloseQuote="CloseQuote";DialogName.CreateOrder="CreateOrder";DialogName.SetStateDialog="SetStateDialog";DialogName.RecommendationModelDialog="RecommendationModelDialog";DialogName.SeriesActionDialog="SeriesActionDialog";DialogName.DupWarningDialog="DupWarning";DialogName.ApplyEmailTemplate="ApplyEmailTemplate";DialogName.SelectTemplateRecipient="SelectTemplateRecipient";DialogName.UpdateAttachment="UpdateAttachment";DialogName.Lookup="Lookup";DialogName.CreateSlaDialog="CreateSlaDialog";DialogName.AssociateCase="AssociateCase";DialogName.MergeCase="MergeCase";DialogName.RecommendedDocument="RecommendedDocument";DialogName.DocumentSuggestions="DocumentSuggestions";DialogName.OtherDocumentSuggestions="OtherDocumentSuggestions";DialogName.EntityImageUpload="EntityImageUpload";DialogName.DeviceSettings="DeviceSettings";DialogName.DeviceSettingsConsentDialog="DeviceSettingsConsentDialog";DialogName.MicrosoftFlowsDialog="MicrosoftFlowsDialog";return DialogName}();DialogUtilities.DialogName=DialogName;var DialogConstants=function(){function DialogConstants(){}DialogConstants.DialogOkId="ok_id";DialogConstants.DialogCancelId="cancel_id";DialogConstants.DialogMerge="Merge";DialogConstants.DialogSet="Set";DialogConstants.EntityId="entity_id";DialogConstants.EntityName="entity_name";DialogConstants.ActionCardId="actionCardId";DialogConstants.CardType="cardType";DialogConstants.LastButtonClicked="last_button_clicked";DialogConstants.ProgressValue=40;DialogConstants.ProgressMinValue=0;DialogConstants.ProgressMaxValue=100;DialogConstants.GridControl="gridControl";DialogConstants.Records="entity_records";DialogConstants.resolveCaseNoValidStatusReasonTransition="ResolveCaseNOvalidStatusReasonTransition";DialogConstants.EntityTypeCode="entityTypeCode";DialogConstants.DefaultStatus=-1;DialogConstants.BusinessQueuesLookupId="businessqueues_id";DialogConstants.incidentActiveState="Active";DialogConstants.statusReasonId="setcasestatus_id";DialogConstants.statusReasonLabelId="lbl_setcasestatus";DialogConstants.noValidStatusTransitionAlertTextResourceString="Web.Record.NoValidStatusReasonTransition03";DialogConstants.timeSpent="timeSpent";DialogConstants.isTimeAllotment="bIsTimeAllotment";DialogConstants.allotmentsRemaining="iAllotmentsRemaining";DialogConstants.resolutionType="resolutionType_id";DialogConstants.resolution="resolution_id";DialogConstants.totalTime="totaltime_id";DialogConstants.billableTime="billabletime_id";DialogConstants.remarks="remarks_id";DialogConstants.closeCaseConfirmAllotments="Case_Resolve_Dlg_Confirm_Allotments";DialogConstants.closeCaseString="Web.CS.cases.dlg_closecase.aspx_27";DialogConstants.closeCaseStringForNullSubject="Web.CS.cases.dlg_closecase.aspx_50";DialogConstants.closeCaseConfirmParent="Case_Resolve_Dlg_Confirm_Parent";DialogConstants.closeCaseConfirmContractDetailState="Case_Resolve_Dlg_Confirm_ContractDetailState";DialogConstants.resolvedState="Resolved";DialogConstants.RemoveQueueItemPickId="checkboxpick_id";DialogConstants.QueueItemPickHeaderText="lbl_headerdescription";DialogConstants.QueueItemRouteToId="routeto_id";DialogConstants.QueueItemUserLookupId="crmUserLookupControl_id";DialogConstants.QueueItemQueueLookupId="crmQueueLookupControl_id";DialogConstants.QueueItemRemoveId="chkBoxRemoveItem_id";DialogConstants.QueueItemAssignedToUserText="lbl_assignedtouser";DialogConstants.QueueItemAssignedToQueueText="lbl_addtoqueue";DialogConstants.QueueItemRouteHeaderText="lbl_headerdescription";DialogConstants.AssignQueueDialogLabel="label_DialogDescription";DialogConstants.AssignTomeOption="rdoMe_id";DialogConstants.SelectedRecordsCount="selected_records_count";DialogConstants.SystemUserViewId="systemuserview_id";DialogConstants.statusCodeId="statusCode_id";DialogConstants.CancelStatus="Canceled";DialogConstants.Id="Id";DialogConstants.regardingObjectColumnName="regardingobjectid";DialogConstants.regardingObjectTypeColumnName="regardingobjecttypecode";DialogConstants.regardingControlName="regarding_id";DialogConstants.activity="Activity";DialogConstants.activityLogicalName="activitypointer";DialogConstants.OpenNewId="cbOpenNew_id";DialogConstants.OpenNewRecord="openNewRecord";DialogConstants.SaveActivityId="cbSaveActivity_id";DialogConstants.SaveActivity="saveActivity";DialogConstants.LogResponseId="cbLogResponse_id";DialogConstants.Subject="subject";DialogConstants.LeadLookup="leadLookup";DialogConstants.CustomerLookup="customerLookup";DialogConstants.CurrencyLookup="currencyLookup";DialogConstants.CampaignLookup="campaignassociatedview_id";DialogConstants.SubjectLookup="subject_id";DialogConstants.LeadId="leadId";DialogConstants.OwnerId="owner_id";DialogConstants.OwnerType="owner_type";DialogConstants.OwnerName="owner_name";DialogConstants.OpportunityId="opportunityId";DialogConstants.CaseId="incidentId";DialogConstants.TransactionCurrencyId="transactioncurrencyid";DialogConstants.StateCode="statecode";DialogConstants.Caller="caller";DialogConstants.CallerParameters="callerparameters";DialogConstants.EstimatedValue="estimatedvalue";DialogConstants.ActualRevenueId="actualrevenue_id";DialogConstants.OpportunityStatusReasonId="statusreason_id";DialogConstants.CompetitorId="competitor_id";DialogConstants.CloseDateId="closedate_id";DialogConstants.DescriptionId="description_id";DialogConstants.Won="won";DialogConstants.WonString="Won";DialogConstants.LostString="Lost";DialogConstants.LabelSubtitle="lbl_closedescription";DialogConstants.DescriptionMaxLength=200;DialogConstants.HeaderTitleId="header_title_id";DialogConstants.TitleId="title_id";DialogConstants.MessageId="message_id";DialogConstants.StateId="state_id";DialogConstants.StatusId="status_id";DialogConstants.selectedState="selected_state";DialogConstants.allowedTransitions="allowed_transitions";DialogConstants.action="action_name";DialogConstants.activate="activate";DialogConstants.deactivate="deactivate";DialogConstants.defaultCloseState="default_close_state";DialogConstants.Completed=1;DialogConstants.Canceled=2;DialogConstants.Inactive=1;DialogConstants.Active=0;DialogConstants.DeleteOccurrence="deleteoccurrence_id";DialogConstants.DeleteSeriesKeepCompleted="deleteserieskeepcompleted_id";DialogConstants.DeleteSeriesAllInstances="deleteseriesallinstances_id";DialogConstants.DeleteDescriptionId="deletedescription_id";DialogConstants.SeriesId="seriesId";DialogConstants.AttachementSubGridControl="attachmentsGrid";DialogConstants.ControlNullError=" control cannot be null";DialogConstants.CursorInfoData="cursorInfo";DialogConstants.DefaultGuidString="00000000-0000-0000-0000-000000000000";DialogConstants.DefaultFormattedGuidString="{00000000-0000-0000-0000-000000000000}";DialogConstants.DefaultLookupName="default";DialogConstants.DescriptionAttribute="description";DialogConstants.EmailTemplateControlName="emailtemplates_id";DialogConstants.EmailSubject="emailsubject";DialogConstants.EmailDescription="emaildescription";DialogConstants.EmailEntityName="email";DialogConstants.EmailEntityId="id";DialogConstants.EmailEntityType="entityType";DialogConstants.EmailFormData="emailFormData";DialogConstants.EmailToField="to";DialogConstants.EmailCcField="cc";DialogConstants.EntityType="type";DialogConstants.EntityTypeInfo="entityTypeInfo";DialogConstants.FieldControlName="fieldname_id";DialogConstants.KeyPresent="KeyPresent";DialogConstants.LanguageId="language_id";DialogConstants.RecordControlName="record_id";DialogConstants.RegardingObject="regardingobjectid";DialogConstants.RecipientNames="name";DialogConstants.SelectControlName="select_id";DialogConstants.SubjectAttribute="subject";DialogConstants.TemplateEntityName="template";DialogConstants.TemplateId="templateId";DialogConstants.ParentAccountLookupId="parentAccountLookup_id";DialogConstants.ParentContactLookupId="parentContactLookup_id";DialogConstants.QualifyStatus="qualifyStatus";DialogConstants.ParentAccountId="parentAccountId";DialogConstants.ParentAccountName="parentAccountName";DialogConstants.ParentContactId="parentContactId";DialogConstants.ParentContactName="parentContactName";DialogConstants.qualifyLeadCommandName="QualifyLead";DialogConstants.convertActivityCommandName="ConvertActivity";DialogConstants.loseOpportunityCommandName="LoseOpportunity";DialogConstants.winOpportunityCommandName="WinOpportunity";DialogConstants.resolveCaseCommandName="CloseIncident";DialogConstants.setState="SetState";DialogConstants.closeActivityCommandName="CloseActivity";DialogConstants.commaSeperator=",";DialogConstants.defaultIndex=0;DialogConstants.firstIndex=1;DialogConstants.logicalName="LogicalName";DialogConstants.StatusCode="statuscode";DialogConstants.IncidentTitle="incident_title";DialogConstants.IncidentDescription="incident_description";DialogConstants.IncidentResolution="incident_resolution";DialogConstants.IncidentResolutionDescription="incidentresolution_description";DialogConstants.ConvertToKnowledgeArticleTitle="title_id";DialogConstants.ConvertToKnowledgeArticleContent="content_id";DialogConstants.ConvertToKnowledgeArticleId="knowledgeArticleId";DialogConstants.ConvertToKnowledgeArticleOwnerId="owner_id";DialogConstants.ConvertToKnowledgeArticleSubjectId="subject_id";DialogConstants.SubjectId="subjectId";DialogConstants.SubjectName="subjectName";DialogConstants.ConvertToKnowledgeArticleSubjectName="subjectName";DialogConstants.ConvertToKnowledgeArticleOwnerType="ownerType";DialogConstants.slaName="name_id";DialogConstants.SLASelectedEnity="applicableEntity_id";DialogConstants.PriceLevelId="pricelevelid";DialogConstants.SuggestionsSource="SuggestionsSource";DialogConstants.IsCustomLineItemEntity="isCustomLineItemEntity";DialogConstants.LineItemMetaData="lineItemMetaData";DialogConstants.PanoramaItemDialog="PanoramaItemDialog";DialogConstants.EntityLogicalNameParameter="entitylogicalname_id";DialogConstants.EntityPrimaryAttributeParameter="entityprimaryattribute_id";DialogConstants.EntityIdParameter="entity_id";DialogConstants.EntityImageUrlParameter="entityimageurl_id";DialogConstants.CameraEnabledParameter="cameraenabled_id";DialogConstants.EntityImageDataParameter="entityimagedata_id";DialogConstants.EntityImagePreviewId="entityimagepreview_id";DialogConstants.TakePhotoId="takephoto_id";DialogConstants.UploadImageId="uploadimage_id";DialogConstants.UseDefaultId="usedefault_id";DialogConstants.DeviceSettings="device_settings";DialogConstants.FlowId="flow_id";DialogConstants.EntityIdCollection="entity_ids";DialogConstants.FlowsEnvironmentId="environment_id";DialogConstants.OrgUniqueName="org_unique_name";DialogConstants.EntityLogicalCollectionName="entity_logical_collection_name";DialogConstants.EntityLogicalName="entity_logical_name";DialogConstants.Dynamics365AccessToken="dynamics365_access_token";DialogConstants.FlowsDestinationURL="flows_destination_url";DialogConstants.FlowsFPISiteURL="flows_fpi_site_url";DialogConstants.FlowsAuthenticationString="flows_authentication_string";DialogConstants.OfflineSync="offlineSync";DialogConstants.ShowAssignToMeOption="show_assign_to_me_option";return DialogConstants}();DialogUtilities.DialogConstants=DialogConstants})(DialogUtilities=InternalUtilities.DialogUtilities||(InternalUtilities.DialogUtilities={}))})(InternalUtilities=XrmCore.InternalUtilities||(XrmCore.InternalUtilities={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var InternalUtilities;(function(InternalUtilities){var EntityUtilities=function(){function EntityUtilities(){}EntityUtilities.isStateCodeReversed=function(entityName){switch(entityName){case InternalUtilities.EntityUtilities.EntityNames.Entitlement:case InternalUtilities.EntityUtilities.EntityNames.RoutingRule:case InternalUtilities.EntityUtilities.EntityNames.ConvertRule:return true;default:return false}};return EntityUtilities}();InternalUtilities.EntityUtilities=EntityUtilities;var EntityUtilities;(function(EntityUtilities){var ProductStructureType=function(){function ProductStructureType(){}ProductStructureType.Product=1;ProductStructureType.ProductFamily=2;ProductStructureType.ProductBundle=3;return ProductStructureType}();EntityUtilities.ProductStructureType=ProductStructureType;var EntityNames=function(){function EntityNames(){}EntityNames.None="none";EntityNames.Account="account";EntityNames.ActionCard="actioncard";EntityNames.SyncError="syncerror";EntityNames.AccountLeads="accountleads";EntityNames.ActivityMimeAttachment="activitymimeattachment";EntityNames.ActivityParty="activityparty";EntityNames.ActivityPointer="activitypointer";EntityNames.AdvancedSimilarityRule="advancedsimilarityrule";EntityNames.Annotation="annotation";EntityNames.AnnualFiscalCalendar="annualfiscalcalendar";EntityNames.ApplicationFile="applicationfile";EntityNames.Appointment="appointment";EntityNames.AsyncOperation="asyncoperation";EntityNames.Attachment="attachment";EntityNames.AttributeMap="attributemap";EntityNames.Audit="audit";EntityNames.AzureServiceConnection="azureserviceconnection";EntityNames.BaseAddEntityObjectTypeCode="baseaddentityobjecttypecode";EntityNames.BulkDeleteFailure="bulkdeletefailure";EntityNames.BulkDeleteOperation="bulkdeleteoperation";EntityNames.BulkOperation="bulkoperation";EntityNames.BulkOperationLog="bulkoperationlog";EntityNames.BusinessDataLocalizedLabel="businessdatalocalizedlabel";EntityNames.BusinessUnit="businessunit";EntityNames.BusinessUnitMap="businessunitmap";EntityNames.BusinessUnitNewsArticle="businessunitnewsarticle";EntityNames.Calendar="calendar";EntityNames.CalendarRule="calendarrule";EntityNames.Campaign="campaign";EntityNames.CampaignActivity="campaignactivity";EntityNames.CampaignActivityItem="campaignactivityitem";EntityNames.CampaignItem="campaignitem";EntityNames.CampaignResponse="campaignresponse";EntityNames.ChannelProperty="channelproperty";EntityNames.ChannelPropertyGroup="channelpropertygroup";EntityNames.ClientUpdate="clientupdate";EntityNames.ColumnMapping="columnmapping";EntityNames.Commitment="commitment";EntityNames.Competitor="competitor";EntityNames.CompetitorAddress="competitoraddress";EntityNames.CompetitorProduct="competitorproduct";EntityNames.CompetitorSalesLiterature="competitorsalesliterature";EntityNames.ComplexControl="complexcontrol";EntityNames.Connection="connection";EntityNames.ConnectionRole="connectionrole";EntityNames.ConnectionRoleAssociation="connectionroleassociation";EntityNames.ConnectionRoleObjectTypeCode="connectionroleobjecttypecode";EntityNames.ConvertRule="convertrule";EntityNames.ConvertRuleItem="convertruleitem";EntityNames.ConstraintBasedGroup="constraintbasedgroup";EntityNames.Contact="contact";EntityNames.ContactInvoices="contactinvoices";EntityNames.ContactLeads="contactleads";EntityNames.ContactOrders="contactorders";EntityNames.ContactQuotes="contactquotes";EntityNames.Contract="contract";EntityNames.ContractDetail="contractdetail";EntityNames.ContractTemplate="contracttemplate";EntityNames.CustomerAddress="customeraddress";EntityNames.CustomerOpportunityRole="customeropportunityrole";EntityNames.CustomerRelationship="customerrelationship";EntityNames.Dependency="dependency";EntityNames.DependencyNode="dependencynode";EntityNames.Discount="discount";EntityNames.DiscountType="discounttype";EntityNames.DisplayString="displaystring";EntityNames.DisplayStringMap="displaystringmap";EntityNames.DocumentIndex="documentindex";EntityNames.DocumentTemplate="documenttemplate";EntityNames.DuplicateRecord="duplicaterecord";EntityNames.DuplicateRule="duplicaterule";EntityNames.DuplicateRuleCondition="duplicaterulecondition";EntityNames.DynamicProperty="dynamicproperty";EntityNames.DelveActionHub="delveactionhub";EntityNames.DynamicPropertyOptionSetItem="dynamicpropertyoptionsetitem";EntityNames.Email="email";EntityNames.EmailHash="emailhash";EntityNames.EmailSearch="emailsearch";EntityNames.EmailServerProfile="emailserverprofile";EntityNames.EmailSignature="emailsignature";EntityNames.Entitlement="entitlement";EntityNames.EntityMap="entitymap";EntityNames.Equipment="equipment";EntityNames.EntitlementChannel="entitlementchannel";EntityNames.EntitlementTemplateChannel="entitlementtemplatechannel";EntityNames.Fax="fax";EntityNames.FieldPermission="fieldpermission";EntityNames.FieldSecurityProfile="fieldsecurityprofile";EntityNames.FilterTemplate="filtertemplate";EntityNames.FixedMonthlyFiscalCalendar="fixedmonthlyfiscalcalendar";EntityNames.Goal="goal";EntityNames.GoalRollupQuery="goalrollupquery";EntityNames.Import="import";EntityNames.ImportData="importdata";EntityNames.ImportEntityMapping="importentitymapping";EntityNames.ImportFile="importfile";EntityNames.ImportJob="importjob";EntityNames.ImportLog="importlog";EntityNames.ImportMap="importmap";EntityNames.Incident="incident";EntityNames.IncidentResolution="incidentresolution";EntityNames.IntegrationStatus="integrationstatus";EntityNames.InternalAddress="internaladdress";EntityNames.InterProcessLock="interprocesslock";EntityNames.InvalidDependency="invaliddependency";EntityNames.Invoice="invoice";EntityNames.InvoiceDetail="invoicedetail";EntityNames.IsvConfig="isvconfig";EntityNames.KbArticle="kbarticle";EntityNames.KbArticleComment="kbarticlecomment";EntityNames.KbArticleTemplate="kbarticletemplate";EntityNames.NewKbArticle="newkbarticle";EntityNames.KnowledgeArticle="knowledgearticle";EntityNames.KnowledgeArticlesCategories="knowledgearticlescategories";EntityNames.KnowledgeArticleIncident="knowledgearticleincident";EntityNames.KnowledgeArticleViews="knowledgearticleviews";EntityNames.KnowledgeSearchModel="knowledgesearchmodel";EntityNames.LanguageLocale="languagelocale";EntityNames.Lead="lead";EntityNames.LeadAddress="leadaddress";EntityNames.LeadCompetitors="leadcompetitors";EntityNames.LeadProduct="leadproduct";EntityNames.Letter="letter";EntityNames.License="license";EntityNames.List="list";EntityNames.ListMember="listmember";EntityNames.LookUpMapping="lookupmapping";EntityNames.Mailbox="mailbox";EntityNames.MailMergeTemplate="mailmergetemplate";EntityNames.Metric="metric";EntityNames.MobileOfflineProfile="mobileofflineprofile";EntityNames.MobileOfflineProfileItem="mobileofflineprofileitem";EntityNames.MonthlyFiscalCalendar="monthlyfiscalcalendar";EntityNames.Notification="notification";EntityNames.Notes="annotation";EntityNames.OfficeDocument="officedocument";EntityNames.Opportunity="opportunity";EntityNames.OpportunityClose="opportunityclose";EntityNames.OpportunityCompetitors="opportunitycompetitors";EntityNames.OpportunityProduct="opportunityproduct";EntityNames.OrderClose="orderclose";EntityNames.Organization="organization";EntityNames.OrganizationStatistic="organizationstatistic";EntityNames.OrganizationUI="organizationui";EntityNames.Owner="owner";EntityNames.OwnerMapping="ownermapping";EntityNames.PersonalDocumentTemplate="personaldocumenttemplate";EntityNames.PhoneCall="phonecall";EntityNames.PickListMapping="picklistmapping";EntityNames.PluginAssembly="pluginassembly";EntityNames.PluginType="plugintype";EntityNames.PluginTypeStatistic="plugintypestatistic";EntityNames.PluginTraceLog="plugintracelog";EntityNames.Post="post";EntityNames.PostComment="postcomment";EntityNames.PostFollow="postfollow";EntityNames.PostLike="postlike";EntityNames.PostRegarding="postregarding";EntityNames.PostRole="postrole";EntityNames.PriceLevel="pricelevel";EntityNames.PrincipalAttributeAccessMap="principalattributeaccessmap";EntityNames.PrincipalEntityMap="principalentitymap";EntityNames.PrincipalObjectAccess="principalobjectaccess";EntityNames.PrincipalObjectAccessReadSnapshot="principalobjectaccessreadsnapshot";EntityNames.PrincipalObjectAttributeAccess="principalobjectattributeaccess";EntityNames.Privilege="privilege";EntityNames.PrivilegeObjectTypeCodes="privilegeobjecttypecodes";EntityNames.ChannelAccessProfileEntityAccessLevel="channelaccessprofileentityaccesslevel";EntityNames.ProcessSession="processsession";EntityNames.Product="product";EntityNames.ProductAssociation="productassociation";EntityNames.ProductPriceLevel="productpricelevel";EntityNames.ProductSalesLiterature="productsalesliterature";EntityNames.ProductSubstitute="productsubstitute";EntityNames.Publisher="publisher";EntityNames.PublisherAddress="publisheraddress";EntityNames.QuarterlyFiscalCalendar="quarterlyfiscalcalendar";EntityNames.Queue="queue";EntityNames.QueueItem="queueitem";EntityNames.Quote="quote";EntityNames.QuoteClose="quoteclose";EntityNames.QuoteDetail="quotedetail";EntityNames.RecommendationModel="recommendationmodel";EntityNames.RecommendationModelVersion="recommendationmodelversion";EntityNames.RecordCountSnapshot="recordcountsnapshot";EntityNames.RecurrenceRule="recurrencerule";EntityNames.RecurringAppointmentMaster="recurringappointmentmaster";EntityNames.RelationshipRole="relationshiprole";EntityNames.RelationshipRoleMap="relationshiprolemap";EntityNames.ReplicationBacklog="replicationbacklog";EntityNames.Report="report";EntityNames.ReportCategory="reportcategory";EntityNames.ReportEntity="reportentity";EntityNames.ReportLink="reportlink";EntityNames.ReportVisibility="reportvisibility";EntityNames.Resource="resource";EntityNames.ResourceGroup="resourcegroup";EntityNames.ResourceGroupExpansion="resourcegroupexpansion";EntityNames.ResourceSpec="resourcespec";EntityNames.RibbonCommand="ribboncommand";EntityNames.RibbonContextGroup="ribboncontextgroup";EntityNames.RibbonCustomization="ribboncustomization";EntityNames.RibbonDiff="ribbondiff";EntityNames.RibbonRule="ribbonrule";EntityNames.RibbonTabToCommandMap="ribbontabtocommandmap";EntityNames.Role="role";EntityNames.RolePrivileges="roleprivileges";EntityNames.RoleTemplate="roletemplate";EntityNames.RoleTemplatePrivileges="roletemplateprivileges";EntityNames.RollupField="rollupfield";EntityNames.SalesLiterature="salesliterature";EntityNames.SalesLiteratureItem="salesliteratureitem";EntityNames.SalesOrder="salesorder";EntityNames.SalesOrderDetail="salesorderdetail";EntityNames.SalesProcessInstance="salesprocessinstance";EntityNames.SavedQuery="savedquery";EntityNames.SavedQueryVisualization="savedqueryvisualization";EntityNames.SdkMessage="sdkmessage";EntityNames.SdkMessageFilter="sdkmessagefilter";EntityNames.SdkMessagePair="sdkmessagepair";EntityNames.SdkMessageProcessingStep="sdkmessageprocessingstep";EntityNames.SdkMessageProcessingStepImage="sdkmessageprocessingstepimage";EntityNames.SdkMessageProcessingStepSecureConfig="sdkmessageprocessingstepsecureconfig";EntityNames.SdkMessageRequest="sdkmessagerequest";EntityNames.SdkMessageRequestField="sdkmessagerequestfield";EntityNames.SdkMessageResponse="sdkmessageresponse";EntityNames.SdkMessageResponseField="sdkmessageresponsefield";EntityNames.SemiAnnualFiscalCalendar="semiannualfiscalcalendar";EntityNames.Service="service";EntityNames.ServiceAppointment="serviceappointment";EntityNames.ServiceContractContacts="servicecontractcontacts";EntityNames.ServiceEndpoint="serviceendpoint";EntityNames.SharePointDocumentLocation="sharepointdocumentlocation";EntityNames.SharePointData="sharepointdata";EntityNames.SharePointDocument="sharepointdocument";EntityNames.SharePointSite="sharepointsite";EntityNames.Site="site";EntityNames.SiteMap="sitemap";EntityNames.Solution="solution";EntityNames.SocialActivity="socialactivity";EntityNames.SocialProfile="socialprofile";EntityNames.SolutionComponent="solutioncomponent";EntityNames.StatusMap="statusmap";EntityNames.StringMap="stringmap";EntityNames.Subject="subject";EntityNames.Subscription="subscription";EntityNames.SubscriptionClients="subscriptionclients";EntityNames.SubscriptionManuallyTrackedObject="subscriptionmanuallytrackedobject";EntityNames.SubscriptionSyncInfo="subscriptionsyncinfo";EntityNames.SubscriptionTrackingDeletedObject="subscriptiontrackingdeletedobject";EntityNames.SystemForm="systemform";EntityNames.SystemUser="systemuser";EntityNames.Position="position";EntityNames.SystemUserBusinessUnitEntityMap="systemuserbusinessunitentitymap";EntityNames.SystemUserLicenses="systemuserlicenses";EntityNames.SystemUserPrincipals="systemuserprincipals";EntityNames.SystemUserProfiles="systemuserprofiles";EntityNames.SystemUserRoles="systemuserroles";EntityNames.Task="task";EntityNames.Team="team";EntityNames.TeamMembership="teammembership";EntityNames.TeamProfiles="teamprofiles";EntityNames.TeamRoles="teamroles";EntityNames.TeamTemplate="teamtemplate";EntityNames.Template="template";EntityNames.Territory="territory";EntityNames.Theme="theme";EntityNames.TimeZoneDefinition="timezonedefinition";EntityNames.TimeZoneLocalizedName="timezonelocalizedname";EntityNames.TimeZoneRule="timezonerule";EntityNames.TopicModel="topicmodel";EntityNames.TransactionCurrency="transactioncurrency";EntityNames.TransformationMapping="transformationmapping";EntityNames.TransformationParameterMapping="transformationparametermapping";EntityNames.UnresolvedAddress="unresolvedaddress";EntityNames.UoM="uom";EntityNames.UoMSchedule="uomschedule";EntityNames.UserEntityInstanceData="userentityinstancedata";EntityNames.UserEntityUISettings="userentityuisettings";EntityNames.UserFiscalCalendar="userfiscalcalendar";EntityNames.UserForm="userform";EntityNames.UserQuery="userquery";EntityNames.UserQueryVisualization="userqueryvisualization";EntityNames.UserSettings="usersettings";EntityNames.WebResource="webresource";EntityNames.WebWizard="webwizard";EntityNames.WizardAccessPrivilege="wizardaccessprivilege";EntityNames.WizardPage="wizardpage";EntityNames.Workflow="workflow";EntityNames.WorkflowDependency="workflowdependency";EntityNames.WorkflowLog="workflowlog";EntityNames.WorkflowWaitSubscription="workflowwaitsubscription";EntityNames.RoutingRule="routingrule";EntityNames.RoutingRuleItem="routingruleitem";EntityNames.HierarchyRule="hierarchyrule";EntityNames.SLA="sla";EntityNames.SLAItem="slaitem";EntityNames.SLAKPIInstance="slakpiinstance";EntityNames.DataPerformance="dataperformance";EntityNames.ChannelAccessProfileRule="channelaccessprofilerule";EntityNames.ChannelAccessProfileRuleItem="channelaccessprofileruleitem";EntityNames.ExternalParty="externalparty";EntityNames.ExternalPartyItem="externalpartyitem";EntityNames.Category="category";EntityNames.AccountAddress="accountaddress";EntityNames.ActivityScheduling="activityscheduling";EntityNames.AppLicense="applicense";EntityNames.AppOfflineFilter="appofflinefilter";EntityNames.AppSalesPerson="appsalesperson";EntityNames.AppWorkflowInstance="appworkflowinstance";EntityNames.Attribute="attribute";EntityNames.AttributePicklistValue="attributepicklistvalue";EntityNames.BulkDeleteWizardDialog="bulkdeletewizarddialog";EntityNames.ContactAddress="contactaddress";EntityNames.DuplicateDetectionDialog="duplicatedetectiondialog";EntityNames.Entity="entity";EntityNames.EntityRelationship="entityrelationship";EntityNames.EntityRelationshipRole="entityrelationshiprole";EntityNames.HolidayCalendarRule="HolidayCalendarRule";EntityNames.ImportEntity="importentity";EntityNames.ImportWizardDialog="importwizarddialog";EntityNames.LocalizedLabel="localizedlabel";EntityNames.MobileOfflineProfileItemAssociation="mobileofflineprofileitemassociation";EntityNames.NotWorkingWorkShift="notworkingworkshift";EntityNames.OccurrenceCalendarRule="OccurrenceCalendarRule";EntityNames.OccurringWorkShift="occurringworkshift";EntityNames.OptionSet="optionset";EntityNames.RecurrenceCalendarRule="recurrencecalendarrule";EntityNames.RecurringWorkShift="recurringworkShift";EntityNames.Relationship="relationship";EntityNames.ScriptErrorDetailsDialog="scripterrordetailsdialog";EntityNames.ScriptErrorDialog="scripterrordialog";EntityNames.ServiceRestrictionCalendarRule="servicerestrictioncalendarrule";EntityNames.SolutionExportWizard="solutionexportwizard";EntityNames.SolutionImportWizard="solutionimportwizard";EntityNames.TimeOffCalendarRule="timeoffcalendarrule";EntityNames.UnresolvedEmailParty="unresolvedemailparty";EntityNames.ViewAttribute="viewattribute";EntityNames.MailboxStatistics="mailboxstatistics";EntityNames.EntityDashboard="entitydashboard";EntityNames.ReportPropertyDialog="reportpropertydialog";EntityNames.UntrackedEmail="untrackedemail";return EntityNames}();EntityUtilities.EntityNames=EntityNames})(EntityUtilities=InternalUtilities.EntityUtilities||(InternalUtilities.EntityUtilities={}))})(InternalUtilities=XrmCore.InternalUtilities||(XrmCore.InternalUtilities={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var InternalUtilities;(function(InternalUtilities){var GenericUtilities=function(){function GenericUtilities(){}GenericUtilities.getLocalResourceString=function(locLabel){return Xrm.Utility.getResourceString("Main_system_library",locLabel)};GenericUtilities.showGenericProgressIndicator=function(){Xrm.Utility.showProgressIndicator(GenericUtilities.getLocalResourceString("Msg_Progress_MOCA_Dialog"))};GenericUtilities.createChainedEntityMetadataMapWithCallback=function(uniqueEntityTypes,currentIndex,entityNameToMetadataMap,callback){if(currentIndex<uniqueEntityTypes.length)Xrm.Utility.getEntityMetadata(uniqueEntityTypes[currentIndex]).then(function(metadata){entityNameToMetadataMap[uniqueEntityTypes[currentIndex]]=metadata;GenericUtilities.createChainedEntityMetadataMapWithCallback(uniqueEntityTypes,currentIndex+1,entityNameToMetadataMap,callback)},function(error){GenericUtilities.createChainedEntityMetadataMapWithCallback(uniqueEntityTypes,currentIndex+1,entityNameToMetadataMap,callback)});else callback(entityNameToMetadataMap)};GenericUtilities.HandleErrorMessage=function(errorResponse){var errorDialogOptions={message:errorResponse.message,errorCode:errorResponse.errorCode};Xrm.Navigation.openErrorDialog(errorDialogOptions)};GenericUtilities.stringFormat=function(stringToFormat,args){if(!args||stringToFormat===undefined||stringToFormat===null)return stringToFormat||"";return stringToFormat.replace(/{(\d+)}/g,function(match,number){return args[number]!=null&&args[number]!=undefined?args[number]:match})};GenericUtilities.Format=function(format){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];for(var returnValue=format,i=1;i<arguments.length;i++){var actualValue=typeof arguments[i]=="undefined"||arguments[i]==null?"":arguments[i].toString();returnValue=returnValue.replace(new RegExp("\\{"+(i-1)+"\\}","g"),actualValue)}return returnValue};GenericUtilities.isNullOrEmpty=function(s){return s==null||s.length===0};GenericUtilities.isNullOrWhitespace=function(s){return s==null||s.trim().length===0};GenericUtilities.isNullUndefinedOrWhitespace=function(s){return s==null||s==undefined||s.trim().length===0};GenericUtilities.EqualsIgnoreCase=function(string1,string2){var isString1Null=string1==null,isString2Null=string2==null,isString1Undefined=string1==undefined,isString2Undefined=string2==undefined;if(isString1Null&&isString2Null||isString1Undefined&&isString2Undefined)return true;if(isString1Null!=isString2Null||isString1Undefined!=isString2Undefined)return false;return string1.toUpperCase()===string2.toUpperCase()};GenericUtilities.ReplaceLineBreaksWithBrTags=function(text){return text.replace(/(?:\r\n|&#13;&#10;|\r|&#13;|\n|&#10;)/g,"<br />")};GenericUtilities.ConvertEntityRefToLookUp=function(entityRef){return {entityType:entityRef.TypeName,id:entityRef.Id,name:entityRef.Name}};GenericUtilities.Empty="";return GenericUtilities}();InternalUtilities.GenericUtilities=GenericUtilities})(InternalUtilities=XrmCore.InternalUtilities||(XrmCore.InternalUtilities={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var SdkContracts;(function(SdkContracts){var RetrieveDocumentTemplatesRequest=function(){function RetrieveDocumentTemplatesRequest(entityTypeCode,documentType,entityset){this.EntityTypeCode=entityTypeCode;this.DocumentType=documentType;this.entityset=entityset}RetrieveDocumentTemplatesRequest.prototype.getMetadata=function(){var metadata={boundParameter:"entityset",parameterTypes:{entityset:{typeName:"mscrm.documenttemplate",structuralProperty:4},EntityTypeCode:{typeName:"Edm.Int32",structuralProperty:1},DocumentType:{typeName:"Edm.Int32",structuralProperty:1}},operationName:"RetrieveDocumentTemplates",operationType:1};return metadata};return RetrieveDocumentTemplatesRequest}();SdkContracts.RetrieveDocumentTemplatesRequest=RetrieveDocumentTemplatesRequest})(SdkContracts=XrmCore.SdkContracts||(XrmCore.SdkContracts={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var InternalUtilities;(function(InternalUtilities){var ExportUtilities=function(){function ExportUtilities(){}ExportUtilities.retrievePersonalDocumentTemplates=function(entityTypeName,documentType){var entityTypeCode=Xrm.Internal.getEntityCode(entityTypeName),fetchXml="<fetch mapping='logical'> <entity name='personaldocumenttemplate'> <attribute name='personaldocumenttemplateid' /> <attribute name='name' /> <order attribute='createdon' descending='true' /><filter type = 'and'> <condition attribute='associatedentitytypecode' operator='eq' value='"+entityTypeCode+"' /> <condition attribute='documenttype' operator='eq' value='"+documentType+"' /> <condition attribute='status' operator= 'eq' value= '0' /> </filter> </entity> </fetch>",deferred=Xrm.WebApi.online.retrieveMultipleRecords("personaldocumenttemplate","?fetchXml="+fetchXml).then(function(response){for(var personalTemplates=[],templates=response.entities,i=0;i<templates.length;i++){var curT={Id:templates[i].personaldocumenttemplateid,Name:templates[i].name};personalTemplates.push(curT)}return personalTemplates},function(e){console.error(e)});return deferred};ExportUtilities.retrieveSystemDocumentTemplates=function(entityTypeName,documentType){var entityTypeCode=Xrm.Internal.getEntityCode(entityTypeName),r=new XrmCore.SdkContracts.RetrieveDocumentTemplatesRequest(entityTypeCode,documentType,"documenttemplate"),deferred=Xrm.WebApi.online.execute(r).then(function(res){return res.json()}).then(function(odataResponse){for(var templates=odataResponse.value,systemTemplates=[],i=0;i<templates.length;i++){var curT={Id:templates[i].documenttemplateid,Name:templates[i].name};systemTemplates.push(curT)}return systemTemplates},function(e){console.error(e)});return deferred};ExportUtilities.retrieveCreateTemplates=function(){var createTemplate=[{Id:"UploadTemplate",Name:Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_UploadTemplate")},{Id:"DownloadTemplate",Name:Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_DownloadTemplate")}];return createTemplate};ExportUtilities.retrieveOnlineButton=function(){var createTemplate=[{Id:"OpenExcelOnline",Name:Xrm.Utility.getResourceString("Main_system_library","Menu_Label_OpenExcelOnline")},{Id:"Download",Name:Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Download")}];return createTemplate};ExportUtilities.determineRibbonMenuId=function(entityLogicalName,isForm,ribbonContextType,ribbonRelationshipType,documentType,isOnline){var relType="NoRelationship";if(ribbonRelationshipType===0)relType="OneToMany";else if(ribbonRelationshipType===1)relType="ManyToMany";var contextWithId="SubGrid",ribbonContext="SubGridAssociated";if(isForm){contextWithId="Form";ribbonContext="Form"}else if(ribbonContextType==0){contextWithId="HomepageGrid";ribbonContext="HomePageGrid"}var template="";if(isOnline)template=documentType===2?"WordOnlineTemplates":"DocumentOnlineTemplates";else template=documentType===2?"WordTemplates":"DocumentTemplates";var menuButtonId=entityLogicalName+"|"+relType+"|"+ribbonContext+"|Mscrm."+contextWithId+"."+entityLogicalName+"."+template+".Menu";return menuButtonId};ExportUtilities.determinCreateRibbonCommandId=function(entityLogicalName,isForm,ribbonContextType,documentType,isUpload){var relType="NoRelationship",ribbonContext="SubGridAssociated";if(isForm)ribbonContext="Form";else if(ribbonContextType==0)ribbonContext="HomePageGrid";var docStr=documentType===2?"Word":"Document",opStr="TemplatesMenu",cmdStr=entityLogicalName+"|"+relType+"|"+ribbonContext+"|Mscrm."+docStr+"Template."+opStr;if(documentType===2){var contextStr=isForm?"Form":"Grid";cmdStr=cmdStr+"."+contextStr}return cmdStr};ExportUtilities.determinRibbonCommandId=function(entityLogicalName,isForm,ribbonContextType,ribbonRelationshipType,documentType,isCreate){var relType="NoRelationship";if(ribbonRelationshipType===0)relType="OneToMany";else if(ribbonRelationshipType===1)relType="ManyToMany";var ribbonContext="SubGridAssociated";if(isForm)ribbonContext="Form";else if(ribbonContextType==0)ribbonContext="HomePageGrid";var docStr=documentType===2?"Word":"Document",opStr=isCreate?"Create"+docStr+"Template":"TemplatesMenu",cmdStr=entityLogicalName+"|"+relType+"|"+ribbonContext+"|Mscrm."+docStr+"Template."+opStr;if(documentType===2){var contextStr=isForm?"Form":"Grid";cmdStr=cmdStr+"."+contextStr}return cmdStr};ExportUtilities.buildControlsForCreate=function(menuId,commandId,templates,isUpload,documentType){for(var buttons=[],tempStr=isUpload?"Upload":"Download",docStr=documentType===1?"Excel":"Word",controlsPrefix=menuId+"."+docStr+"Templates.Controls",image="",i=0;i<templates.length;i++){if(image==="")image="SharePointUploadDocument";else image="Download";var button={ControlType:"Button",Id:controlsPrefix+"."+templates[i].Id,Command:commandId,Sequence:String(i*10+10),ToolTipDescription:templates[i].Name,Alt:templates[i].Name,LabelText:templates[i].Name,ModernImage:image};buttons.push(button)}var controls={Id:controlsPrefix,Items:buttons};return controls};ExportUtilities.buildControlsFromTemplates=function(menuId,onlineMenuId,commandId,templates,isSystemTemplate,documentType){var buttons=[],flyoutButtons=[],tempStr=isSystemTemplate?"":"Personal",docStr=documentType===1?"Excel":"Word",image=isSystemTemplate?"SystemDocumentTemplates":"MyDocumentTemplates",onlinecontrolsPrefix=menuId+"."+tempStr+docStr+"Templates.Controls",isOnPrem=Xrm.Utility.getGlobalContext().isOnPremises(),templateButtonForOnline=ExportUtilities.retrieveOnlineButton(),button={ControlType:"Button",Id:"ViewAllMyTemplatesId",Command:commandId,Sequence:String(i*10+10),ToolTipDescription:Xrm.Utility.getResourceString("Main_system_library","View_All_My_Templates"),Alt:Xrm.Utility.getResourceString("Main_system_library","View_All_My_Templates"),LabelText:Xrm.Utility.getResourceString("Main_system_library","View_All_My_Templates"),ModernImage:"ViewAllMyDocumentTemplates"};if(!isOnPrem&&documentType===1&&Xrm.Utility.getGlobalContext().client.getClient()===Xrm.Constants.ClientNames.web){!isSystemTemplate&&flyoutButtons.push(button);for(var i=0;i<templates.length;i++){onlineMenuId=""+onlineMenuId;var flyoutButtonsButtonsControl=InternalUtilities.ExportUtilities.buildOnlineControlsFromTemplates(onlineMenuId,commandId,templateButtonForOnline,templates[i],isSystemTemplate,true,documentType),menuSectionOnline=InternalUtilities.ExportUtilities.buildOnlineMenuSection(onlineMenuId,templates[i],isSystemTemplate,documentType,false,i*10+10,flyoutButtonsButtonsControl),menuSectionsOnline=[];menuSectionsOnline.push(menuSectionOnline);var menuOnline=InternalUtilities.ExportUtilities.buildMenu(onlineMenuId,menuSectionsOnline),flyoutButton={ControlType:"FlyoutAnchor",Id:onlinecontrolsPrefix+"."+templates[i].Id,Command:commandId,Sequence:String(i*10+10),ToolTipDescription:templates[i].Name,Alt:templates[i].Name,LabelText:templates[i].Name,ModernImage:image,Menu:menuOnline};flyoutButtons.push(flyoutButton)}var controls={Id:onlinecontrolsPrefix,Items:flyoutButtons};return controls}else{var controlsPrefix=menuId+"."+tempStr+docStr+"Templates.Controls";!isSystemTemplate&&buttons.push(button);for(var i=0;i<templates.length;i++){var button_1={ControlType:"Button",Id:controlsPrefix+"."+templates[i].Id,Command:commandId,Sequence:String(i*10+10),ToolTipDescription:templates[i].Name,Alt:templates[i].Name,LabelText:templates[i].Name,ModernImage:image};buttons.push(button_1)}var controls={Id:controlsPrefix,Items:buttons};return controls}};ExportUtilities.buildOnlineControlsFromTemplates=function(menuId,commandId,Onlinetemplates,template,isSystemTemplate,isOnline,documentType){for(var buttons=[],tempStr=isSystemTemplate?"":"Personal",docStr=documentType===1?"Excel":"Word",controlsPrefix=menuId+"."+tempStr+docStr+"Templates.Controls",i=0;i<Onlinetemplates.length;i++){var image=Onlinetemplates[i].Id==="OpenExcelOnline"?"ExportToExcel":"DocumentTemplates",button={ControlType:"Button",Id:controlsPrefix+"."+Onlinetemplates[i].Id+"."+template.Id,Command:commandId,Sequence:String(i*10+10),ToolTipDescription:Onlinetemplates[i].Name+" "+template.Name,Alt:Onlinetemplates[i].Name,LabelText:Onlinetemplates[i].Name+" "+template.Name,ModernImage:image};buttons.push(button)}var controls={Id:controlsPrefix+"."+template.Id,Items:buttons};return controls};ExportUtilities.buildMenuSection=function(menuId,isSystemTemplate,documentType,isCreate,sequenceNum,controls){var tempStr=isSystemTemplate?"":"Personal",docStr=documentType===2?"Word":"Excel",sectionStr=isCreate?"CreateTemplates":""+tempStr+docStr+"Templates",titleStr="";if(isCreate)if(documentType==1)titleStr=Xrm.Utility.getResourceString("Main_system_library","Menu_Label_CreateExcelTemplate");else titleStr=Xrm.Utility.getResourceString("Main_system_library","Menu_Label_CreateWordTemplate");else if(documentType==1)if(isSystemTemplate)titleStr=Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_ExcelTemplates");else titleStr=Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_PersonalExcelTemplates");else if(isSystemTemplate)titleStr=Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_WordTemplates");else titleStr=Xrm.Utility.getResourceString("Main_system_library","Menu_Label_Group_PersonalWordTemplates");var section={Id:menuId+"."+sectionStr,Sequence:String(sequenceNum),DisplayMode:6,Title:titleStr,Item:controls};return section};ExportUtilities.buildOnlineMenuSection=function(menuId,template,isSystemTemplate,documentType,isCreate,sequenceNum,controls){var tempStr=isSystemTemplate?"":"Personal",docStr=documentType===2?"Word":"Excel",sectionStr=""+tempStr+docStr+"Templates."+template.Id,titleStr="",section={Id:menuId+"."+sectionStr,Sequence:String(sequenceNum),DisplayMode:6,Title:titleStr,Item:controls};return section};ExportUtilities.buildMenu=function(menuId,menuSections){var menu={Id:menuId,MenuSection:menuSections};return menu};ExportUtilities.generateExportFileName=function(prefix,documentType){var ext=documentType===2?".docx":".xlsx";if(typeof Xrm.Utility.getGlobalContext()!="undefined"&&Xrm.Utility.getGlobalContext()!=null&&typeof Xrm.Utility.getGlobalContext().userSettings!="undefined"&&Xrm.Utility.getGlobalContext().userSettings!=null&&prefix&&prefix.length!=0){var now=new Date,datePattern=Xrm.Utility.getGlobalContext().userSettings.dateFormattingInfo.ShortDatePattern,timePattern=Xrm.Utility.getGlobalContext().userSettings.dateFormattingInfo.LongTimePattern,dateSeparator=Xrm.Utility.getGlobalContext().userSettings.dateFormattingInfo.DateSeparator,timeSeparator=Xrm.Utility.getGlobalContext().userSettings.dateFormattingInfo.TimeSeparator,fileName=prefix+" "+now.format(datePattern)+" "+now.format(timePattern);fileName=fileName.split(dateSeparator).join("-").split(timeSeparator).join("-");return ""+fileName+ext}if(prefix&&prefix.length!=0)return ""+prefix+ext;return "Export"+ext};ExportUtilities.getXmlDOMFromString=function(xmlStr){if(window.ActiveXObject&&window.GetObject){var dom=new ActiveXObject("Microsoft.XMLDOM");dom.loadXML(xmlStr);return dom}if(window.DOMParser)return (new DOMParser).parseFromString(xmlStr,"text/xml");throw new Error("No XML parser available")};ExportUtilities.getXmlAsString=function(xmlDom){return typeof XMLSerializer!=="undefined"?(new window.XMLSerializer).serializeToString(xmlDom):xmlDom.xml};return ExportUtilities}();InternalUtilities.ExportUtilities=ExportUtilities})(InternalUtilities=XrmCore.InternalUtilities||(XrmCore.InternalUtilities={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var InternalUtilities;(function(InternalUtilities){var oDataVersion="v9.0/",oDataPath="/api/data/"+oDataVersion,formApiPath="/systemforms",headers=[["Prefer",'odata.include-annotations="*"']],fetchXml='<fetch mapping="logical" count="1"><entity name="{0}"><attribute name="{3}" /><filter type="or"><condition attribute="{3}" operator= "eq" value= "{1}" /><filter type="and" ><condition attribute="{2}" operator= "eq" value= "{1}" /><condition attribute="{3}" operator= "not-null" /></filter></filter></entity></fetch>',HierarchyUtilities=function(){function HierarchyUtilities(){}HierarchyUtilities.getEntityRecordUrl=function(entity,name,recordId){var currentEntity={entityType:entity,name:name,id:recordId},currentUrl=Xrm.Internal.getCurrentPageUrl(currentEntity);return currentUrl.replace("pagetype=entityrecord","pagetype=control&controlName=MscrmControls.HierarchyControl.HierarchyControl")};HierarchyUtilities.sendXHR=function(url){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;xhr.open("GET",url,true);for(var i in headers)xhr.setRequestHeader(headers[i][0],headers[i][1]);xhr.onload=function(){var status=xhr.status;if(status==200)resolve(xhr.response);else reject(xhr.response)};xhr.onerror=function(){reject(xhr.response)};xhr.send()})};HierarchyUtilities.retrieveRelationshipForEntityMetadata=function(entitySetName,encodedFetchXml){var url=this.generateoDataUrlForDataFetch(entitySetName,encodedFetchXml);return this.sendXHR(url)};HierarchyUtilities.generateoDataUrlForDataFetch=function(entitySetName,encodedFetchXml){var hostUrl=Xrm.Utility.getGlobalContext().getClientUrl(),oDataUrl=hostUrl+oDataPath+entitySetName+"?fetchXml="+encodedFetchXml;return oDataUrl};HierarchyUtilities.checkifRecordHierarchyEnabled=function(entityLogicalName,Id,entitySetName,relationship){var result=false;try{return this.retrieveRelationshipForEntityMetadata(entitySetName,InternalUtilities.GenericUtilities.stringFormat(fetchXml,[entityLogicalName,Id,relationship.ReferencedAttribute,relationship.ReferencingAttribute])).then(function(relResponse){var parsedChildResponse=JSON.parse(relResponse);if(parsedChildResponse.value.length>0)result=true;return result})}catch(ex){return Promise.reject(result)}};return HierarchyUtilities}();InternalUtilities.HierarchyUtilities=HierarchyUtilities})(InternalUtilities=XrmCore.InternalUtilities||(XrmCore.InternalUtilities={}))})(XrmCore||(XrmCore={}));var XrmCore;(function(XrmCore){var InternalUtilities;(function(InternalUtilities){var LegacyUtilities=function(){function LegacyUtilities(){}LegacyUtilities.getIFrameForWebClient=function(isForm){var origin=document.origin;try{var currentWindow=window,parent_1=window.parent;while(currentWindow.document.origin===origin){try{if((isForm&&currentWindow.self._IsRefreshForm||!isForm&&!currentWindow.self._IsRefreshForm)&&currentWindow.Mscrm&&currentWindow.Mscrm.RibbonActions)return currentWindow}catch(e){}if(currentWindow===currentWindow.parent)break;currentWindow=currentWindow.parent}currentWindow=window;parent_1=window.parent;while(currentWindow!==parent_1&&parent_1.document.origin===origin){for(var ind=0;ind<parent_1.frames.length;ind++)try{var currentIframe=parent_1.frames[ind];if((isForm&&currentIframe.self._IsRefreshForm||!isForm&&!currentIframe.self._IsRefreshForm)&&currentIframe.Mscrm&&currentIframe.Mscrm.RibbonActions)return currentIframe}catch(e){}currentWindow=parent_1;parent_1=parent_1.parent}return window}catch(e){return window}};return LegacyUtilities}();InternalUtilities.LegacyUtilities=LegacyUtilities})(InternalUtilities=XrmCore.InternalUtilities||(XrmCore.InternalUtilities={}))})(XrmCore||(XrmCore={}));var Mscrm;(function(Mscrm){var ManageProcessActionDialogActions=function(){function ManageProcessActionDialogActions(){}ManageProcessActionDialogActions.onClickOk=function(eventContext){var formContext=eventContext.getFormContext();ManageProcessActionDialogActions.setLastButtonClicked(formContext,XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId);if(Xrm.Page.data.isValid())formContext.ui.close();else ManageProcessActionDialogActions.setLastButtonClicked(formContext,null)};ManageProcessActionDialogActions.onClickCancel=function(eventContext){var formContext=eventContext.getFormContext();ManageProcessActionDialogActions.setLastButtonClicked(formContext,XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogCancelId);formContext.ui.close()};ManageProcessActionDialogActions.setLastButtonClicked=function(formContext,buttonId){var lastButtonClicked=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked);lastButtonClicked&&lastButtonClicked.setValue(buttonId)};return ManageProcessActionDialogActions}();Mscrm.ManageProcessActionDialogActions=ManageProcessActionDialogActions})(Mscrm||(Mscrm={}));var Mscrm;(function(Mscrm){var WorkflowWebResource=function(){function WorkflowWebResource(){}WorkflowWebResource.ShowAbandon=function(){if(Xrm.Page.data.process){var businessProcessFlowInstanceStatus=Xrm.Page.data.process.getStatus();if(businessProcessFlowInstanceStatus)return businessProcessFlowInstanceStatus==WorkflowWebResource.ActiveBusinessProcessFlowInstanceStatus}return false};WorkflowWebResource.ShowFinish=function(){if(Xrm.Page.data.process){var businessProcessFlowInstanceStatus=Xrm.Page.data.process.getStatus(),isBusinessProcessStatusActive=businessProcessFlowInstanceStatus&&businessProcessFlowInstanceStatus==WorkflowWebResource.ActiveBusinessProcessFlowInstanceStatus;if(isBusinessProcessStatusActive==true){var activePath=Xrm.Page.data.process.getActivePath(),activeStage=Xrm.Page.data.process.getActiveStage();if(activePath&&activeStage){var lastStageInPath=activePath.get(activePath.getLength()-1);return activeStage.getId()===lastStageInPath.getId()}}}return false};WorkflowWebResource.ShowReactivate=function(){if(Xrm.Page.data.process){var businessProcessFlowInstanceStatus=Xrm.Page.data.process.getStatus();if(businessProcessFlowInstanceStatus)return businessProcessFlowInstanceStatus!=WorkflowWebResource.ActiveBusinessProcessFlowInstanceStatus}return false};WorkflowWebResource.CanSwitchProcess=function(){return true};WorkflowWebResource.CanEditProcess=function(){return WorkflowWebResource.IsBusinessProcessPresent()};WorkflowWebResource.IsBusinessProcessPresent=function(){if(Xrm.Page.ui.process)return true;else return false};WorkflowWebResource.SwitchProcess=function(){if(Xrm.Internal.isUci()){var dialogParams={};dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityIdParameter]=Xrm.Page.data.entity.getId();dialogParams[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.EntityName]=Xrm.Page.data.entity.getEntityName();dialogParams["process_instance_name"]=Xrm.Page.data.process.getInstanceName();var dialogOptions={height:Math.min(500,.9*window.outerHeight),width:Math.min(600,.9*window.outerWidth),position:1};Xrm.Navigation.openDialog("SwitchProcess",dialogOptions,dialogParams).then(function(successParameter){if(successParameter&&successParameter.parameters)if(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId===successParameter.parameters[XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked])if(successParameter.parameters["process_instance_id"])Xrm.Page.data.process.setActiveProcessInstance(successParameter.parameters["process_instance_id"],function(){WorkflowWebResource.SwitchProcessCallBack(successParameter)});else successParameter.parameters["process_id"]&&Xrm.Page.data.process.setActiveProcess(successParameter.parameters["process_id"],function(){WorkflowWebResource.SwitchProcessCallBack(successParameter)})},null)}else Xrm.Page.data.process.switchProcess()};WorkflowWebResource.SwitchProcessCallBack=function(dialogParams){};WorkflowWebResource.AbandonProcess=function(){Xrm.Page.data.process.abandonProcess()};WorkflowWebResource.ReactivateProcess=function(){Xrm.Page.data.process.reactivateProcess()};WorkflowWebResource.SetActiveStage=function(){var selectedStage=Xrm.Page.data.process.getSelectedStage();selectedStage&&Xrm.Page.data.process.setActiveStage(selectedStage.getId())};WorkflowWebResource.FinishProcess=function(){Xrm.Page.data.process.completeProcess()};WorkflowWebResource.ActiveBusinessProcessFlowInstanceStatus="active";return WorkflowWebResource}();Mscrm.WorkflowWebResource=WorkflowWebResource})(Mscrm||(Mscrm={}));var Mscrm;(function(Mscrm){var ManageSwitchProcessDialogActions=function(){function ManageSwitchProcessDialogActions(){}ManageSwitchProcessDialogActions.onClickCancel=function(eventContext){var formContext=eventContext.getFormContext();ManageSwitchProcessDialogActions.setLastButtonClicked(formContext,XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogCancelId);formContext.ui.close()};ManageSwitchProcessDialogActions.onClickOk=function(eventContext){var formContext=eventContext.getFormContext(),processInstanceIdAttribute=formContext.data.attributes.get("process_instance_id");if(processInstanceIdAttribute&&processInstanceIdAttribute.getValue()==="invalid"){Xrm.Navigation.openAlertDialog({text:XrmCore.InternalUtilities.GenericUtilities.getLocalResourceString("Grid_Action_Too_Many_Custom_Messages_Selected_Alert")});return}ManageSwitchProcessDialogActions.setLastButtonClicked(formContext,XrmCore.InternalUtilities.DialogUtilities.DialogConstants.DialogOkId);formContext.ui.close()};ManageSwitchProcessDialogActions.setLastButtonClicked=function(formContext,buttonId){var lastButtonClicked=formContext.data.attributes.get(XrmCore.InternalUtilities.DialogUtilities.DialogConstants.LastButtonClicked);lastButtonClicked&&lastButtonClicked.setValue(buttonId)};return ManageSwitchProcessDialogActions}();Mscrm.ManageSwitchProcessDialogActions=ManageSwitchProcessDialogActions})(Mscrm||(Mscrm={}))</script><script id="/{636878706300003032}/webresources/ribbon_main_system_library.js?ver=1888157098" type="text/javascript">Type.registerNamespace("Mscrm");Mscrm.BulkDelete_0=function(){var windowInf=GetWindowInformation(BulkDeleteWizardDialog),options=new Xrm.DialogOptions;options.width=windowInf.Width;options.height=windowInf.Height;var url=Mscrm.CrmUri.create("/WebWizard/WizardContainer.aspx?WizardId=A50E9478-8EC9-45ab-B927-FDFFF64A0729");Xrm.Internal.openDialog(url.toString(),options,null,null,null)};Mscrm.DuplicateDetection_0=function(){var windowInf=GetWindowInformation(DuplicateDetectionDialog),options=new Xrm.DialogOptions;options.width=windowInf.Width;options.height=windowInf.Height;var url=Mscrm.CrmUri.create("/WebWizard/WizardContainer.aspx?WizardId=3E4792DF-42CC-4b6b-B7E6-E197B4986EFF");Xrm.Internal.openDialog(url.toString(),options,null,null,null)};Mscrm.HelpAbout_0=function(){openStdDlg(Mscrm.CrmUri.create("/about/default.aspx"),"MSCRMAbout",570,548)};Mscrm.HelpCrmLive_0=function(){safeWindowOpen(Mscrm.CrmUri.create("http://go.microsoft.com/fwlink/?LinkId=35152&clcid=0x"+USER_LANGUAGE_CODE.toString(16)),"MSCRMLive","width=790, height=500, menubar=1, toolbar=1, status=1, scrollbars=1, resizable=1")};Mscrm.HelpUpdatesOutlook_0=function(){safeWindowOpen(Mscrm.CrmUri.create("http://go.microsoft.com/fwlink/?LinkId=76815"),"HelpUpdates","width=790, height=500, menubar=1, toolbar=1, status=1, scrollbars=1, resizable=1")};Mscrm.HelpUpdatesWeb_0=function(){safeWindowOpen(Mscrm.CrmUri.create("http://go.microsoft.com/fwlink/?LinkId=76816"),"HelpUpdates","width=790, height=500, menubar=1, toolbar=1, status=1, scrollbars=1, resizable=1")};Mscrm.ImportData_0=function(){if(Mscrm.IsIos_0()){alert(LOCID_UNSUPPORTED_RIBBONACTION);return}var windowInf=GetWindowInformation(ImportWizardDialog),options=new Xrm.DialogOptions;options.width=windowInf.Width;options.height=windowInf.Height;var url=Mscrm.CrmUri.create("/WebWizard/WizardContainer.aspx?WizardId=A0E9DC09-8730-4C97-A8B9-6F585C0C16F7");Xrm.Internal.openDialog(url.toString(),options,null,null,function(result){if(result){if(isOutlookHostedWindow()){getOutlookHostedWindow().refreshGrid();return}var gridControl=$find("crmGrid");if(!Mscrm.InternalUtilities.JSTypes.isNull(gridControl))gridControl.Refresh();else if(window.top.document.getElementById("crmContentPanel")){currentContentId=window.top.document.getElementById("crmContentPanel").getAttribute("currentContentId");var find=$get(currentContentId).contentWindow.$find;if(!Mscrm.InternalUtilities.JSTypes.isNull(find))gridControl=find("crmGrid");!Mscrm.InternalUtilities.JSTypes.isNull(gridControl)&&gridControl.Refresh()}}});try{var arguments={};arguments["context"]="grid";arguments["dialogName"]="ImportData";arguments["entityId"]="";arguments["gridType"]="";arguments["isMultiPageMDD"]=false;arguments["userRoleId"]=window.USER_ROLES.toString();Mscrm.MetricsReporting.instance().addMetric("dialogs",arguments)}catch(e){}};Mscrm.ExportDataTemplate_0=function(selectedEntityTypeName){if(Mscrm.IsIos_0()){alert(LOCID_UNSUPPORTED_RIBBONACTION);return}var createTemplateUri=Mscrm.CrmUri.create("/tools/importwizard/createtemplate.aspx?entityName="+selectedEntityTypeName);if(window.IS_OUTLOOK_CLIENT){var documentType=1,exportProgressUri=Mscrm.CrmUri.create("/_grid/print/export_progress.aspx?documentType="+documentType),progressDialogArgs={isTemplate:true,createTemplateUri:createTemplateUri};openStdDlg(exportProgressUri,progressDialogArgs,580,180)}else window.location.href=createTemplateUri.toString()};Mscrm.IsIos_0=function(){return navigator.userAgent!=""&&navigator.userAgent!=null&&(navigator.userAgent.toLowerCase().search("ipad")>-1||navigator.userAgent.toLowerCase().search("ipod")>-1||navigator.userAgent.toLowerCase().search("iphone")>-1)};Mscrm.IsIEBrowser_0=function(){return navigator.appName=="Microsoft Internet Explorer"}</script><script src="./inlineeditcommon.js(1).download"></script><script src="./globalquickcreatebehavior.js(1).download"></script><script id="/{636878706300003032}/webresources/activityfeeds.followcommand.dependencies.js?ver=1888157098" type="text/javascript">Type.registerNamespace("Mscrm");Mscrm.IBrowserStorage=function(){};Mscrm.IBrowserStorage.registerInterface("Mscrm.IBrowserStorage");Mscrm.CrmCrossBrowser=function(){};Mscrm.CrmCrossBrowser.get_hash=function(){return Mscrm.CrmCrossBrowser.getHash(window.self.location)};Mscrm.CrmCrossBrowser.getHash=function(location){if(!location)throw Error.argumentNull("location");var $v_0=location.href.split("#");return $v_0.length>1?$v_0[1]:""};Mscrm.CrmCrossBrowser.getLocalStorage=function($sn_window){if(!$sn_window)throw Error.argumentNull("window");return $sn_window.localStorage};Mscrm.CrmCrossBrowser.getSessionStorage=function($sn_window){if(!$sn_window)throw Error.argumentNull("window");return $sn_window.sessionStorage};Mscrm.CrmDisposeHelper=function(){this.$3_0=[]};Mscrm.CrmDisposeHelper.prototype={schedule:function(disposeAction){if(!this.$3_0)throw Error.invalidOperation("Object is already disposed");if(!disposeAction)throw Error.argumentNull("disposeAction");Array.add(this.$3_0,disposeAction)},dispose:function(){if(!this.$3_0)return;for(var $v_0=this.$3_0.length-1;$v_0>=0;$v_0--){var $v_1=this.$3_0[$v_0];$v_1()}this.$3_0=null}};Type.registerNamespace("Mscrm.Imported");Type.registerNamespace("jQueryApi");jQueryApi.IActiveDeferred$2=function(){};jQueryApi.IActiveDeferred$2.$$=function(TData,TError){var $$cn="IActiveDeferred$2$"+TData.getName().replace(/\./g,"_")+"$"+TError.getName().replace(/\./g,"_");if(!jQueryApi[$$cn]){var $$ccr=jQueryApi[$$cn]=function(){};$$ccr.registerInterface("jQueryApi."+$$cn)}return jQueryApi[$$cn]};jQueryApi.IActiveDeferred$2.registerInterface("jQueryApi.IActiveDeferred$2");jQueryApi.jQueryDeferredFactory=function(){};jQueryApi.jQueryDeferredFactory.Deferred=function(TData,TError,initializer){if(initializer===undefined||!initializer)return $P_CRM.Deferred();else return $P_CRM.Deferred(initializer)};jQueryApi.jQueryDeferredFactory.fromResult=function(TData,TError,value){var $v_0=jQueryApi.jQueryDeferredFactory.Deferred(TData,TError);$v_0.resolve(value);return $v_0.promise()};jQueryApi.JSTreeOptions=function(){this.$2_0=[]};jQueryApi.JSTreeOptions.prototype={$2_0:null,get_plugins:function(){return this.$2_0},set_plugins:function(value){this.$2_0=value;return value},getJSTreeConfig:function(){for(var $v_0='{ "plugins" : [ ',$v_2=0;$v_2<this.$2_0.length;$v_2++){var $v_3=this.$2_0[$v_2];if($v_2!==this.$2_0.length-1)$v_0+=$v_3.$1_0+",";else $v_0+=$v_3.$1_0+"],"}for(var $v_4=0;$v_4<this.$2_0.length;$v_4++){var $v_5=this.$2_0[$v_4];$v_0+=$v_5.$1_0+" : { ";var $$dict_6=$v_5.$0_0;for(var $$key_7 in $$dict_6){var $v_6={key:$$key_7,value:$$dict_6[$$key_7]};$v_0+=$v_6.key+" : "+$v_6.value+","}$v_0=$v_0.substring(0,$v_0.length-1);$v_0+="},"}$v_0=$v_0.substring(0,$v_0.length-1);$v_0+="}";var $v_1=$P_CRM.parseJSON($v_0);return $v_1}};jQueryApi.JSTreePlugin=function(){this.$0_0={}};jQueryApi.JSTreePlugin.prototype={$1_0:null,get_name:function(){return this.$1_0},set_name:function(value){this.$1_0=value;return value},get_configuration:function(){return this.$0_0},set_configuration:function(value){this.$0_0=value;return value}};jQueryApi.JSTreeCorePlugin=function(){jQueryApi.JSTreeCorePlugin.initializeBase(this);this.$1_0='"core"'};jQueryApi.JSTreeCorePlugin.prototype={get_animation:function(){return this.$0_0['"animation"'].toString()},set_animation:function(value){this.$0_0['"animation"']=value;return value},get_rightToLeft:function(){return this.$0_0['"rtl"'].toString()},set_rightToLeft:function(value){this.$0_0['"rtl"']=value;return value},get_loadOpen:function(){return this.$0_0['"load_open"'].toString()},set_loadOpen:function(value){this.$0_0['"load_open"']=value;return value},get_loadingString:function(){return this.$0_0['"strings"'].toString()},set_loadingString:function(value){this.$0_0['"strings"']='{ "loading" :"'+this.$4_1(value)+'"}';return value},$4_1:function($p0){var $v_0=new RegExp("\\\\","g"),$v_1=new RegExp('"',"g");return $p0.replace($v_0,"\\\\").replace($v_1,'\\"')}};jQueryApi.JSTreeUIPlugin=function(){jQueryApi.JSTreeUIPlugin.initializeBase(this);this.$1_0='"ui"'};jQueryApi.JSTreeUIPlugin.prototype={get_selectLimit:function(){return this.$0_0['"select_limit"'].toString()},set_selectLimit:function(value){this.$0_0['"select_limit"']=value;return value},get_selectMultipleModifier:function(){return this.$0_0['"select_multiple_modifier"'].toString()},set_selectMultipleModifier:function(value){this.$0_0['"select_multiple_modifier"']='"'+value+'"';return value},get_selectRangeModifier:function(){return this.$0_0['"select_range_modifier"'].toString()},set_selectRangeModifier:function(value){this.$0_0['"select_range_modifier"']='"'+value+'"';return value},get_selectedParentClose:function(){return this.$0_0['"selected_parent_close"'].toString()},set_selectedParentClose:function(value){if(value==="false")this.$0_0['"selected_parent_close"']=value;else this.$0_0['"selected_parent_close"']='"'+value+'"';return value},get_selectedParentOpen:function(){return this.$0_0['"selected_parent_open"'].toString()},set_selectedParentOpen:function(value){this.$0_0['"selected_parent_open"']=value;return value},get_selectPreviousOnDelete:function(){return this.$0_0['"select_prev_on_delete"'].toString()},set_selectPreviousOnDelete:function(value){this.$0_0['"select_prev_on_delete"']=value;return value},get_disableSelectingChildren:function(){return this.$0_0['"disable_selecting_children"'].toString()},set_disableSelectingChildren:function(value){this.$0_0['"disable_selecting_children"']=value;return value},get_initiallySelectedList:function(){return this.$0_0['"initially_select"'].toString()},set_initiallySelectedList:function(value){this.$0_0['"initially_select"']="["+value+"]";return value}};jQueryApi.JSTreeJsonDataPlugin=function(){jQueryApi.JSTreeJsonDataPlugin.initializeBase(this);this.$1_0='"json_data"';this.$0_0['"data"']="true"};jQueryApi.JSTreeJsonDataPlugin.prototype={get_progressiveRender:function(){return this.$0_0['"progressive_render"'].toString()},set_progressiveRender:function(value){this.$0_0['"progressive_render"']=value;return value},get_progressiveUnload:function(){return this.$0_0['"progressive_unload"'].toString()},set_progressiveUnload:function(value){this.$0_0['"progressive_unload"']=value;return value}};jQueryApi.JSTreeThemesPlugin=function(){jQueryApi.JSTreeThemesPlugin.initializeBase(this);this.$1_0='"themes"'};jQueryApi.JSTreeThemesPlugin.prototype={get_theme:function(){return this.$0_0['"theme"'].toString()},set_theme:function(value){this.$0_0['"theme"']='"'+value+'"';return value},get_icons:function(){return this.$0_0['"icons"'].toString()},set_icons:function(value){this.$0_0['"icons"']=value;return value},get_dots:function(){return this.$0_0['"dots"'].toString()},set_dots:function(value){this.$0_0['"dots"']=value;return value},get_url:function(){return this.$0_0['"url"'].toString()},set_url:function(value){this.$0_0['"url"']='"'+value+'"';return value}};jQueryApi.JSTreeHotKeysPlugin=function(){jQueryApi.JSTreeHotKeysPlugin.initializeBase(this);this.$1_0='"hotkeys"';this.$0_0['"return"']="true"};Type.registerNamespace("jQueryUIApi");jQueryUIApi.WidgetOptions=function(){};jQueryUIApi.WidgetOptions.prototype={disabled:false,hide:false,show:false,create:null,isRTL:false};jQueryUIApi.WidgetFactory=function(){};jQueryUIApi.WidgetFactory.register=function(TWidget){var $v_0=TWidget.getName().split("."),$v_1=$v_0[0],$v_2=$v_0[1],$v_3=$v_1+"-"+$v_2,$v_4=TWidget.prototype;$v_4.widgetName=$v_2;$v_4.widgetEventPrefix=$v_2;$v_4.widgetBaseClass=$v_3;$P_CRM.widget.bridge($v_2,TWidget)};jQueryUIApi.WidgetFactory.createInstance=function(TWidget,element,options){var $v_0=TWidget.getName().split("."),$v_1=$v_0[1],$v_2=$P_CRM(element)[$v_1](options);return $v_2.data($v_1)};Type.registerNamespace("Navigatorgeolocation");Mscrm.CrmCrossBrowser.registerClass("Mscrm.CrmCrossBrowser");Mscrm.CrmDisposeHelper.registerClass("Mscrm.CrmDisposeHelper",null,Sys.IDisposable);jQueryApi.jQueryDeferredFactory.registerClass("jQueryApi.jQueryDeferredFactory");jQueryApi.JSTreeOptions.registerClass("jQueryApi.JSTreeOptions");jQueryApi.JSTreePlugin.registerClass("jQueryApi.JSTreePlugin");jQueryApi.JSTreeCorePlugin.registerClass("jQueryApi.JSTreeCorePlugin",jQueryApi.JSTreePlugin);jQueryApi.JSTreeUIPlugin.registerClass("jQueryApi.JSTreeUIPlugin",jQueryApi.JSTreePlugin);jQueryApi.JSTreeJsonDataPlugin.registerClass("jQueryApi.JSTreeJsonDataPlugin",jQueryApi.JSTreePlugin);jQueryApi.JSTreeThemesPlugin.registerClass("jQueryApi.JSTreeThemesPlugin",jQueryApi.JSTreePlugin);jQueryApi.JSTreeHotKeysPlugin.registerClass("jQueryApi.JSTreeHotKeysPlugin",jQueryApi.JSTreePlugin);jQueryUIApi.WidgetOptions.registerClass("jQueryUIApi.WidgetOptions");jQueryUIApi.WidgetFactory.registerClass("jQueryUIApi.WidgetFactory");Type.registerNamespace("Sales.Common.Imported");Sales.Common.Imported.XPathResultType=function(){};Sales.Common.Imported.XPathResultType.prototype={ANY_TYPE:0,NUMBER_TYPE:1,STRING_TYPE:2,BOOLEAN_TYPE:3,UNORDERED_NODE_ITERATOR_TYPE:4,ORDERED_NODE_ITERATOR_TYPE:5,UNORDERED_NODE_SNAPSHOT_TYPE:6,ORDERED_NODE_SNAPSHOT_TYPE:7,ANY_UNORDERED_NODE_TYPE:8,FIRST_ORDERED_NODE_TYPE:9};Sales.Common.Imported.XPathResultType.registerEnum("Sales.Common.Imported.XPathResultType",false);Type.registerNamespace("Mscrm");Mscrm.IDeferredDataProcessingControl=function(){};Mscrm.IDeferredDataProcessingControl.registerInterface("Mscrm.IDeferredDataProcessingControl");Type.registerNamespace("Sales.Common.Framework");Sales.Common.Framework.IList$1=function(){};Sales.Common.Framework.IList$1.$$=function(T){var $$cn="IList$1$"+T.getName().replace(/\./g,"_");if(!Sales.Common.Framework[$$cn]){var $$ccr=Sales.Common.Framework[$$cn]=function(){};$$ccr.registerInterface("Sales.Common.Framework."+$$cn)}return Sales.Common.Framework[$$cn]};Sales.Common.Framework.IList$1.registerInterface("Sales.Common.Framework.IList$1");Sales.Common.Framework.List$1=function(items){this.$0_0=items||new Array(0)};Sales.Common.Framework.List$1.$$=function(T){var $$cn="List$1$"+T.getName().replace(/\./g,"_");if(!Sales.Common.Framework[$$cn]){var $$ccr=Sales.Common.Framework[$$cn]=function(){(this.$$gta=this.$$gta||{})["Sales.Common.Framework.List$1"]={T:T};for(var $v_0=[],$v_1=0;$v_1<arguments.length;++$v_1)$v_0[$v_1]=arguments[$v_1];Sales.Common.Framework.List$1.apply(this,$v_0)};$$ccr.registerClass("Sales.Common.Framework."+$$cn,null,Sales.Common.Framework.IList$1.$$(T));var $$dict_5=Sales.Common.Framework.List$1.prototype;for(var $$key_6 in $$dict_5){var $$entry_7={key:$$key_6,value:$$dict_5[$$key_6]};if("constructor"!==$$entry_7.key)$$ccr.prototype[$$entry_7.key]=$$entry_7.value}}return Sales.Common.Framework[$$cn]};Sales.Common.Framework.List$1.prototype={$0_0:null,get_items:function(){return this.$0_0},get_count:function(){return this.$0_0.length},get_item:function(index){return this.$0_0[index]},set_item:function(index,value){this.$0_0[index]=value;return value},add:function(item){Array.add(this.$0_0,item)},addRange:function(items){Array.addRange(this.$0_0,items)},clear:function(){Array.clear(this.$0_0)},contains:function(item){return Array.contains(this.$0_0,item)},indexOf:function(item,startIndex){startIndex=startIndex||0;return Array.indexOf(this.$0_0,item,startIndex)},insert:function(index,item){Array.insert(this.$0_0,index,item)},remove:function(item){Array.remove(this.$0_0,item)},removeAt:function(index){Array.removeAt(this.$0_0,index)},filter:function(callback){return new Sales.Common.Framework.List$1.$$(this.$$gta["Sales.Common.Framework.List$1"]["T"])(_Array.filter(this.$$gta["Sales.Common.Framework.List$1"]["T"],this.$0_0,callback))},toArray:function(){for(var $v_0=new Array(this.$0_0.length),$v_1=0;$v_1<this.$0_0.length;$v_1++)$v_0[$v_1]=this.$0_0[$v_1];return $v_0},first:function(){if(!this.$0_0.length)throw Error.invalidOperation("List contains no elements.");return this.$0_0[0]},last:function(){if(!this.$0_0.length)throw Error.invalidOperation("List contains no elements.");return this.$0_0[this.get_count()-1]}};Sales.Common.Framework.JsTypes=function(){};Sales.Common.Framework.JsTypes.isNull=function($p0){return typeof $p0==="undefined"||typeof $p0==="unknown"||$p0==null};function parseQueryString(windowLocation){if(Sales.Common.Framework.JsTypes.isNull(windowLocation)||Sales.Common.Framework.JsTypes.isNull(windowLocation.search)||!windowLocation.search.length)return {};var $v_0=windowLocation.search.substr(1);return parseQueryStringValue($v_0)}function parseHashString(windowLocation){if(Sales.Common.Framework.JsTypes.isNull(windowLocation))return {};var $v_0=Mscrm.CrmCrossBrowser.getHash(windowLocation);return parseQueryStringValue($v_0)}function parseQueryStringValue(queryStringValue){if(Sales.Common.Framework.JsTypes.isNull(queryStringValue)||!queryStringValue.length)return {};for(var $v_0={},$v_1=queryStringValue.split("&"),$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2].split("=");$v_0[$v_3[0].toLowerCase()]=CrmEncodeDecode.CrmUrlDecode($v_3[1])}return $v_0}function createEncodedQueryString(parameters){var $v_0="",$$dict_5=parameters;for(var $$key_6 in $$dict_5){var $v_1={key:$$key_6,value:$$dict_5[$$key_6]},$v_2=$v_1.key,$v_3=CrmEncodeDecode.CrmUrlEncode($v_1.value);$v_0+=String.format("{0}={1}&",$v_2,$v_3)}return $v_0.substr(0,$v_0.length-1)}function _Array(){}_Array.mapArray=function(T,array,callback){if(Sales.Common.Framework.JsTypes.isNull(array))return new Array(0);for(var $v_0=new Array(array.length),$v_1=0;$v_1<array.length;$v_1++)$v_0[$v_1]=callback(array[$v_1]);return $v_0};_Array.map=function(T,array,callback){return _Array.mapArray(T,array,callback)};_Array.each=function(T,array,callback){for(var $v_0=0;$v_0<array.length;$v_0++)callback($v_0,array[$v_0])};_Array.filterArray=function(array,callback){if(Sales.Common.Framework.JsTypes.isNull(array))return [];for(var $v_0=[],$v_1=0;$v_1<array.length;$v_1++)if(callback(array[$v_1]))$v_0[$v_0.length]=array[$v_1];return $v_0};_Array.filter=function(T,array,callback){return _Array.filterArray(array,callback)};_Array.insertRange=function(array,index,arrayToInsert){if(Sales.Common.Framework.JsTypes.isNull(array))throw Error.argumentNull("array");if(Sales.Common.Framework.JsTypes.isNull(arrayToInsert))return array;if(!index)array.unshift.apply(array,arrayToInsert);else for(var $v_0=0;$v_0<array.length;$v_0++)array.splice(index+$v_0,0,arrayToInsert[$v_0]);return array};_Array.removeDuplicatesFromArrayList=function(list){return _Array.removeDuplicates(Object,list)};_Array.removeDuplicates=function(T,objects){if(Sales.Common.Framework.JsTypes.isNull(objects))return new Array(0);for(var $v_0=[],$v_1=0;$v_1<objects.length;$v_1++)!Array.contains($v_0,objects[$v_1])&&Array.add($v_0,objects[$v_1]);return $v_0};_Array.removeRangeFromArray=function(array,index,count){if(Sales.Common.Framework.JsTypes.isNull(array))return array;return array.splice(index,count)};_Array.removeRange=function(T,objects,index,count){return _Array.removeRangeFromArray(objects,index,count)};function _DateTime(){}_DateTime.get_now=function(){return new Date};function _Dictionary(){}_Dictionary.count=function(dictionary){var $v_0=0,$$dict_3=dictionary;for(var $$key_4 in $$dict_3){var $v_1={key:$$key_4,value:$$dict_3[$$key_4]};$v_0++}return $v_0};_Dictionary.keys=function(dictionary){var $v_0=new Array(0),$$dict_3=dictionary;for(var $$key_4 in $$dict_3){var $v_1={key:$$key_4,value:$$dict_3[$$key_4]};$v_0[$v_0.length]=$v_1.key}return $v_0};_Dictionary.toArray=function(T,dictionary){var $v_0=new Array(_Dictionary.count(dictionary)),$v_1=0,$$dict_5=dictionary;for(var $$key_6 in $$dict_5){var $v_2={key:$$key_6,value:$$dict_5[$$key_6]};$v_0[$v_1]=$v_2.value;$v_1++}return $v_0};function _Event(){}_Event.fireEvent=function(T,_events,eventName,sender,args){if(!_events)return;var $v_0=_events.getHandler(eventName);$v_0&&$v_0(sender,args)};function _Nullable$1(value){this.$2_0=this.$$gta["_Nullable$1"]["T"]===Number||Type.isEnum(this.$$gta["_Nullable$1"]["T"])?0:this.$$gta["_Nullable$1"]["T"]===Boolean?false:null;this.$2_0=value}_Nullable$1.$$=function(T){var $$cn="_Nullable$1$"+T.getName().replace(/\./g,"_");if(!window[$$cn]){var $$ccr=window[$$cn]=function(){(this.$$gta=this.$$gta||{})["_Nullable$1"]={T:T};for(var $v_0=[],$v_1=0;$v_1<arguments.length;++$v_1)$v_0[$v_1]=arguments[$v_1];_Nullable$1.apply(this,$v_0)};$$ccr.registerClass($$cn);var $$dict_5=_Nullable$1.prototype;for(var $$key_6 in $$dict_5){var $$entry_7={key:$$key_6,value:$$dict_5[$$key_6]};if("constructor"!==$$entry_7.key)$$ccr.prototype[$$entry_7.key]=$$entry_7.value}}return window[$$cn]};_Nullable$1.prototype={get_hasValue:function(){return Sales.Common.Framework.JsTypes.isNull(this.$2_0)},get_value:function(){return this.$2_0}};function _RegularExpression(){}_RegularExpression.parse=function(s){if(s.startsWith("/")){var $v_0=s.lastIndexOf("/");if($v_0>1){var $v_1=s.substring(1,$v_0),$v_2=s.substr($v_0+1);return new RegExp($v_1,$v_2)}}return null};function _String(){}_String.isNullOrEmpty=function(value){return null===value||_String.isUndefined(value)||value===""};_String.isNullOrWhiteSpace=function(value){return _String.isNullOrEmpty(value)||value.trim()===""};_String.hashCode=function(value){for(var $v_0=0,$v_1=0;$v_1<value.length;++$v_1){var $v_2=value.charCodeAt($v_1);$v_0=($v_0<<5)-$v_0+$v_2;$v_0=$v_0&$v_0}return $v_0};_String.join=function(separator,values){return values.join(separator)};_String.isUndefined=function(value){return value===undefined};_String.format=function(format,arg0,arg1,arg2,arg3,arg4,arg5){if(_String.isUndefined(arg0)&&_String.isUndefined(arg1)&&_String.isUndefined(arg2)&&_String.isUndefined(arg3)&&_String.isUndefined(arg4)&&_String.isUndefined(arg5))return format;return String.format(format,arg0,arg1,arg2,arg3,arg4,arg5)};_String.replaceNewlineWithEnding=function(text,ending){if(_String.isNullOrEmpty(text))return "";for(var $v_0=new Sys.StringBuilder,$v_1=text.split(_String.$4),$v_2=0;$v_2<$v_1.length;$v_2++)if(!_String.isNullOrWhiteSpace($v_1[$v_2])){$v_0.append($v_1[$v_2]);$v_0.append(ending)}return $v_0.toString()};_String.normalizeNewLine=function(text,ending){if(_String.isNullOrEmpty(text))return "";var $v_0=_String.$7(_String.$5,text,ending);return _String.$7(_String.$6,$v_0,ending)};_String.$7=function($p0,$p1,$p2){for(var $v_0=new Sys.StringBuilder,$v_1=$p1.split($p0),$v_2=0;$v_2<$v_1.length;$v_2++){$v_0.append($v_1[$v_2]);$v_2!==$v_1.length-1&&$v_0.append($p2)}return $v_0.toString()};_String.replaceAll=function(text,patternText,replaceText){var $v_0=text;while($v_0.indexOf(patternText)>=0)$v_0=$v_0.replace(patternText,replaceText);return $v_0};_String.replaceFirst=function(text,patternText,replaceText){var $v_0=text,$v_1=text.indexOf(patternText);if($v_1>=0){$v_0=_String.remove($v_0,$v_1,patternText.length);$v_0=_String.insert($v_0,$v_1,replaceText)}return $v_0};_String.remove=function(text,index,count){if(_String.isNullOrEmpty(text))return "";if(Sales.Common.Framework.JsTypes.isNull(count)||index+count>text.length)return text.substr(0,index);return text.substr(0,index)+text.substr(index+count)};_String.indexOfAny=function(text,chars,startIndex,count){if(Sales.Common.Framework.JsTypes.isNull(text))return -1;if(Sales.Common.Framework.JsTypes.isNull(chars))return -1;var $v_0=text.length;if($v_0<=0)return -1;startIndex=Sales.Common.Framework.JsTypes.isNull(startIndex)?0:startIndex;count=Sales.Common.Framework.JsTypes.isNull(count)?0:count;var $v_1=startIndex+count-1;if($v_1>=$v_0)$v_1=$v_0-1;for(var $v_2=startIndex;$v_2<=$v_1;$v_2++)if(chars.indexOf(text.charAt($v_2))>=0)return $v_2;return -1};_String.insert=function(text,index,value){if(_String.isNullOrEmpty(value))return text;if(Sales.Common.Framework.JsTypes.isNull(index))return value+text;var $v_0=text.substr(0,index),$v_1=text.substr(index);return $v_0+value+$v_1};function _Type(){}_Type.hasField=function(instance,name){return !Sales.Common.Framework.JsTypes.isNull(instance[name])};_Type.getField=function(instance,name){return instance[name]};_Type.hasMethod=function(instance,name){return typeof instance[name]==="function"};_Type.hasProperty=function(instance,name){return !Sales.Common.Framework.JsTypes.isNull(instance["get_"+name])};Type.registerNamespace("Sales.Common.Framework.Loaders");Sales.Common.Framework.Loaders.ConcurrentContentLoaderData=function(){this.$$d_setError=Function.createDelegate(this,this.setError);this.$$d_setResult=Function.createDelegate(this,this.setResult);this.loadContentCallbacks=new Array(0);this.errorCallbacks=new Array(0)};Sales.Common.Framework.Loaders.ConcurrentContentLoaderData.prototype={loadContentInProgress:false,error:false,content:null,setResult:function($p0){if(!this.loadContentInProgress)throw Error.invalidOperation("Invalid request state");this.loadContentInProgress=false;this.content=$p0;var $$t_3=this;_Array.each(Function,this.loadContentCallbacks,function($p1_0,$p1_1){$p1_1($p0)});this.$3_0()},setError:function($p0,$p1,$p2){if(!this.loadContentInProgress)throw Error.invalidOperation("Invalid request state");this.loadContentInProgress=false;this.error=true;var $$t_7=this;_Array.each(Function,this.errorCallbacks,function($p1_0,$p1_1){return $p1_1($p0,$p1,$p2)});this.$3_0()},$3_0:function(){this.loadContentCallbacks=null;this.errorCallbacks=null},addCallbacks:function($p0,$p1){if(!Sales.Common.Framework.JsTypes.isNull($p0))this.loadContentCallbacks[this.loadContentCallbacks.length]=$p0;if(!Sales.Common.Framework.JsTypes.isNull($p1))this.errorCallbacks[this.errorCallbacks.length]=$p1}};Sales.Common.Framework.Loaders.ConcurrentContentLoader=function(){this.$1_1={};Sales.Common.Framework.Loaders.ConcurrentContentLoader.initializeBase(this)};Sales.Common.Framework.Loaders.ConcurrentContentLoader.prototype={loadContent:function(uri,dataType,successCallback,errorCallback){if(Sales.Common.Framework.JsTypes.isNull(uri))throw Error.argumentNull("uri");var $v_0=this.$1_1[uri];if(Sales.Common.Framework.JsTypes.isNull($v_0)||$v_0.error){$v_0=new Sales.Common.Framework.Loaders.ConcurrentContentLoaderData;$v_0.addCallbacks(successCallback,errorCallback);this.$8_1($v_0,uri,dataType);this.$1_1[uri]=$v_0}else if($v_0.loadContentInProgress)$v_0.addCallbacks(successCallback,errorCallback);else!Sales.Common.Framework.JsTypes.isNull(successCallback)&&successCallback($v_0.content)},$8_1:function($p0,$p1,$p2){$p0.loadContentInProgress=true;Sales.Common.Framework.Loaders.ContentLoader.prototype.loadContent.call(this,$p1,$p2,$p0.$$d_setResult,$p0.$$d_setError)},dispose:function(){this.$1_1=null}};Sales.Common.Framework.Loaders.ContentLoader=function(){};Sales.Common.Framework.Loaders.ContentLoader.prototype={loadContent:function(uri,dataType,successCallback,errorCallback){var $v_0=new jQueryAjaxOptions;$v_0.async=true;$v_0.type="GET";$v_0.url=uri;$v_0.dataType=dataType;var $$t_B=this;$v_0.success=function($p1_0,$p1_1,$p1_2){successCallback($p1_0)};if(errorCallback)$v_0.error=errorCallback;else{var $$t_C=this;$v_0.error=function($p1_0,$p1_1,$p1_2){if(!$p1_0.status)return;throw Error.create("Unable to load requested file: "+uri)}}$P_CRM.ajax($v_0)}};Sales.Common.Framework.JsTypes.registerClass("Sales.Common.Framework.JsTypes");_Array.registerClass("_Array");_DateTime.registerClass("_DateTime");_Dictionary.registerClass("_Dictionary");_Event.registerClass("_Event");_RegularExpression.registerClass("_RegularExpression");_String.registerClass("_String");_Type.registerClass("_Type");Sales.Common.Framework.Loaders.ConcurrentContentLoaderData.registerClass("Sales.Common.Framework.Loaders.ConcurrentContentLoaderData");Sales.Common.Framework.Loaders.ContentLoader.registerClass("Sales.Common.Framework.Loaders.ContentLoader");Sales.Common.Framework.Loaders.ConcurrentContentLoader.registerClass("Sales.Common.Framework.Loaders.ConcurrentContentLoader",Sales.Common.Framework.Loaders.ContentLoader,Sys.IDisposable);_DateTime.empty=null;_String.empty="";_String.$4=new RegExp("[\x0a\x0d]+");_String.$5=new RegExp("\x0d\x0a|\x0a\x0d");_String.$6=new RegExp("\x0a|\x0d");Type.registerNamespace("Mscrm");Mscrm.RemoteCommandJson=function(webService,webMethod){var $v_0=String.format("/AppWebServices/{0}.asmx",CrmEncodeDecode.CrmUrlEncode(webService));this.$a_0=Mscrm.CrmUri.createForOrganization($v_0,window.ORG_UNIQUE_NAME).toString()+"/"+CrmEncodeDecode.CrmUrlEncode(webMethod);this.$M_0={}};Mscrm.RemoteCommandJson.prototype={$a_0:null,$M_0:null,setParameter:function(name,value){this.$M_0[name]=value},execute:function(){$P_CRM.support.cors=true;var $v_0=new jQueryAjaxOptions;$v_0.cache=false;$v_0.type="POST";$v_0.contentType="application/json; charset=utf-8";$v_0.dataType="json";$v_0.url=this.$a_0;$v_0.data=JSON.stringify(this.$M_0);var $v_1=jQueryApi.jQueryDeferredFactory.Deferred(Object,String),$$t_7=this,$$t_8=this;$P_CRM.ajax($v_0).success(function($p1_0){var $v_2=$p1_0["d"];$v_1.resolve($v_2)}).error(function($p1_0,$p1_1,$p1_2){$v_1.reject($p1_2.toString())});return $v_1.promise()}};Type.registerNamespace("Mscrm.InternalUtilities");Mscrm.InternalUtilities.Sdk=function(){};Mscrm.InternalUtilities.Sdk.get_$3=function(){if(IsNull(Mscrm.InternalUtilities.Sdk.$X))Mscrm.InternalUtilities.Sdk.$X=new Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase(Xrm.Page.context.getClientUrl());return Mscrm.InternalUtilities.Sdk.$X};Mscrm.InternalUtilities.Sdk.book=function(successCallback,errorCallback,schedulingActivity){Mscrm.InternalUtilities.Sdk.get_$3().book(schedulingActivity).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.associate=function(successCallback,errorCallback,parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName){Mscrm.InternalUtilities.Sdk.get_$3().associate(parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.convertToCase=function(successCallback,errorCallback,targetEntityTitle,activityId,activityTypeCode,customerId,customerIdTypeCode,ownerId,ownerTypeCode,subjectId,subjectTypeCode){Mscrm.InternalUtilities.Sdk.get_$3().convertActivity("incident",targetEntityTitle,activityId,activityTypeCode,customerId,customerIdTypeCode,ownerId,ownerTypeCode,subjectId,subjectTypeCode,null,null,null,0,false).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.convertToOpportunity=function(successCallback,errorCallback,targetEntityTitle,activityId,activityTypeCode,leadId,currencyId,customerId,customerIdTypeCode,ownerId,ownerTypeCode,campaignId,campaignTypeCode,logResponse){Mscrm.InternalUtilities.Sdk.get_$3().convertActivity("opportunity",targetEntityTitle,activityId,activityTypeCode,customerId,customerIdTypeCode,ownerId,ownerTypeCode,null,0,leadId,currencyId,campaignId,campaignTypeCode,logResponse).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.disassociate=function(successCallback,errorCallback,parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName){Mscrm.InternalUtilities.Sdk.get_$3().disassociate(parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.executeQuickFind=function(successCallback,errorCallback,searchText,entityGroupName,entityNames,appModule){Mscrm.InternalUtilities.Sdk.get_$3().executeQuickFind(searchText,entityGroupName,entityNames,appModule).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.inviteUser=function(successCallback,errorCallback,userId){Mscrm.InternalUtilities.Sdk.get_$3().inviteUser(userId).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.loseOpportunity=function(successCallback,errorCallback,opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode,competitorId){Mscrm.InternalUtilities.Sdk.get_$3().loseOpportunity(opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode,competitorId).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.qualifyLead=function(successCallback,errorCallback,leadId,createAccount,createContact,createOpportunity,transactionCurrencyId,opportunityCustomer,sourceCampaignId,qualifyStatus,suppressDuplicateDetection){Mscrm.InternalUtilities.Sdk.get_$3().qualifyLead(leadId,createAccount,createContact,createOpportunity,transactionCurrencyId,opportunityCustomer,sourceCampaignId,qualifyStatus,suppressDuplicateDetection).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.reschedule=function(successCallback,errorCallback,schedulingActivity,activityId){Mscrm.InternalUtilities.Sdk.get_$3().reschedule(schedulingActivity,activityId).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.retrieve=function(successCallback,errorCallback,objectId,objectTypeCode,columns,returnNotifications){Mscrm.InternalUtilities.Sdk.get_$3().retrieve(objectId,objectTypeCode,columns,returnNotifications).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.retrieveAttribute=function(successCallback,errorCallback,retrieveAsIfPublished,entityLogicalName,attributeLogicalName){Mscrm.InternalUtilities.Sdk.get_$3().retrieveAttribute(retrieveAsIfPublished,entityLogicalName,attributeLogicalName).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.winOpportunity=function(successCallback,errorCallback,opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode){Mscrm.InternalUtilities.Sdk.get_$3().winOpportunity(opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.getValidStatusTransition=function(successCallback,errorCallback,incidentId,statusCode){Mscrm.InternalUtilities.Sdk.get_$3().getValidStatusTransition(incidentId,statusCode).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.closeIncident=function(successCallback,errorCallback,timeSpent,description,subject,incidentId,actualEnd,statusCode){Mscrm.InternalUtilities.Sdk.get_$3().closeIncident(timeSpent,description,subject,incidentId,actualEnd,statusCode).then(successCallback,errorCallback)};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy");Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase=function(serverUrl){this.webEndPointUrl=serverUrl+"/XRMServices/2011/Organization.svc/web";this.serverEndPointUrl=serverUrl};Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.prototype={webEndPointUrl:null,serverEndPointUrl:null,get_isAsync:function(){return Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.$g},set_isAsync:function(value){Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.$g=value;return value},get_webEndPointUrl:function(){return this.webEndPointUrl},get_serverEndPointUrl:function(){return this.serverEndPointUrl},$u_0:function($p0){var $v_0=Mscrm.CrmBrowser.get_currentBrowser();if(!$v_0.get_isMobileSafari())return;var $v_1={};$v_1["cache-control"]="no-cache";$p0.headers=$v_1},executeCrmRequest:function(T,requestName,parameters,requestNamespace){var $v_0=this.buildSoapEnvelope(requestName,parameters,requestNamespace),$v_1=jQueryApi.jQueryDeferredFactory.Deferred(T,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$$t_9=this,$$t_A=this;this.executeRequest($v_0,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){var $v_2=Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.createResponse($p1_0,requestName);$v_1.resolve($v_2)},function($p1_0){$v_1.reject($p1_0)});return $v_1.promise()},executeRequest:function(requestBody,soapAction){$P_CRM.support.cors=true;var $v_0=new jQueryAjaxOptions;$v_0.data=requestBody;$v_0.type="POST";$v_0.contentType="text/xml; charset=utf-8";$v_0.dataType="xml";$v_0.url=this.webEndPointUrl;$v_0.timeout=1e4;$v_0.async=this.get_isAsync();this.$u_0($v_0);if(($P_CRM.browser.msie||!Mscrm.CrmBrowser.get_currentBrowser().get_hasXPathEvaluator())&&Mscrm.CrmBrowser.get_currentBrowser().get_documentMode()>=10){var $v_3={};$v_3["responseType"]="msxml-document";$v_0.xhrFields=$v_3}var $$t_D=this;$v_0.beforeSend=function($p1_0){$p1_0.setRequestHeader("SOAPAction",soapAction);Mscrm.MetricsReporting.instance().addXMLHttpRequestHeaders($p1_0)};var $v_1=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$v_2=new Mscrm.MetricsStopwatch("CrmSoapServiceBase.ExecuteRequest");$v_2.properties={IsAsync:this.get_isAsync()};$v_2.start();var $$t_E=this,$$t_F=this;$P_CRM.ajax($v_0).success(function($p1_0,$p1_1,$p1_2){$$t_E.$p_0($v_2,$p1_2);$v_1.resolve(Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.create($p1_0))}).error(function($p1_0,$p1_1,$p1_2){$$t_F.$p_0($v_2,$p1_0);$p1_0.readyState&&!_String.isNullOrEmpty($p1_2)&&$v_1.reject(new Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse($p1_0,$p1_1,$p1_2))});return $v_1.promise()},$p_0:function($p0,$p1){if(!$p0)return;if($p1){var $v_0=$p1.getResponseHeader("REQ_ID");if(!isNullOrEmptyString($v_0)){if(!$p0.properties)$p0.properties={};$p0.properties["ReqId"]=$v_0}}$p0.stop()},retrieveEntityMetadata:function(entityName,retrieveAsIfPublished){var $v_0='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request i:type="a:RetrieveEntityRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"><a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><b:key>EntityFilters</b:key><b:value i:type="c:EntityFilters" xmlns:c="http://schemas.microsoft.com/xrm/2011/Metadata">Entity</b:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><b:key>MetadataId</b:key><b:value i:type="ser:guid" xmlns:ser="http://schemas.microsoft.com/2003/10/Serialization/">00000000-0000-0000-0000-000000000000</b:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><b:key>RetrieveAsIfPublished</b:key><b:value i:type="c:boolean" xmlns:c="http://www.w3.org/2001/XMLSchema">'+retrieveAsIfPublished+'</b:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><b:key>LogicalName</b:key><b:value i:type="c:string" xmlns:c="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityName)+'</b:value></a:KeyValuePairOfstringanyType></a:Parameters><a:RequestId i:nil="true" /><a:RequestName>RetrieveEntity</a:RequestName></request></Execute></s:Body></s:Envelope>',$v_1=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.ObjectModel.IEntityMetadata,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$$t_6=this,$$t_7=this;this.executeRequest($v_0,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){$v_1.resolve(Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata.$V((new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse($p1_0)).$R_1))},function($p1_0){$v_1.reject($p1_0)});return $v_1.promise()},retrieveFilteredForms:function(userId,entityName,formType){var $v_0='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request i:type="b:RetrieveFilteredFormsRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts"><a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><c:key>EntityLogicalName</c:key><c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityName)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>FormType</c:key><c:value i:type="a:OptionSetValue"><a:Value>'+formType+'</a:Value></c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>SystemUserId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(userId)+'</c:value></a:KeyValuePairOfstringanyType></a:Parameters><a:RequestId i:nil="true" /><a:RequestName>RetrieveFilteredForms</a:RequestName></request></Execute></s:Body></s:Envelope>',$v_1=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$$t_7=this,$$t_8=this;this.executeRequest($v_0,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){$v_1.resolve(new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse($p1_0))},function($p1_0){$v_1.reject($p1_0)});return $v_1.promise()},retrieveFilteredProcesses:function(entityName){var $v_0='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request i:type="b:RetrieveFilteredProcessesRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts"><a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><c:key>EntityLogicalName</c:key><c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityName)+'</c:value></a:KeyValuePairOfstringanyType></a:Parameters><a:RequestId i:nil="true" /><a:RequestName>RetrieveFilteredProcesses</a:RequestName></request></Execute></s:Body></s:Envelope>',$v_1=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$$t_5=this,$$t_6=this;this.executeRequest($v_0,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){$v_1.resolve(new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse($p1_0))},function($p1_0){$v_1.reject($p1_0)});return $v_1.promise()},navigateToNextEntity:function(currentEntityId,currentEntityLogicalName,nextEntityId,nextEntityLogicalName,processId,processInstanceId,newActiveStageId,traversedPath){var $v_0='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"><a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><c:key>CurrentEntityId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(currentEntityId)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>CurrentEntityLogicalName</c:key><c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(currentEntityLogicalName)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>NextEntityId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(nextEntityId)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>NextEntityLogicalName</c:key><c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(nextEntityLogicalName)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>NewActiveStageId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(newActiveStageId)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>NewTraversedPath</c:key><c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(traversedPath)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>ProcessId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(processId)+"</c:value></a:KeyValuePairOfstringanyType>"+(processInstanceId?'<a:KeyValuePairOfstringanyType><c:key>ProcessInstanceId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(processInstanceId)+"</c:value></a:KeyValuePairOfstringanyType>":"")+'</a:Parameters><a:RequestId i:nil="true" /><a:RequestName>NavigateToNextEntity</a:RequestName></request></Execute></s:Body></s:Envelope>',$v_1=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$$t_C=this,$$t_D=this;this.executeRequest($v_0,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){$v_1.resolve(new Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse($p1_0))},function($p1_0){$v_1.reject($p1_0)});return $v_1.promise()},buildSoapEnvelope:function(requestName,parameters,requestNamespace){var $v_0=true,$v_1=null;if(_String.isNullOrEmpty(requestNamespace)){$v_0=false;$v_1="a"}else $v_1="crm";var $v_2=new Sys.StringBuilder;$v_2.append('<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">');$v_2.append("<s:Body>");$v_2.append('<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:c="http://www.w3.org/2001/XMLSchema">');if($v_0){$v_2.append('<request i:type="');$v_2.append($v_1);$v_2.append(":");$v_2.append(CrmEncodeDecode.CrmXmlAttributeEncode(requestName));$v_2.append('Request" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"');$v_2.append(" xmlns:");$v_2.append($v_1);$v_2.append('="');$v_2.append(CrmEncodeDecode.CrmXmlAttributeEncode(requestNamespace));$v_2.append('"')}else $v_2.append('<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"');$v_2.append(">");$v_2.append('<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">');for(var $$arr_6=parameters,$$len_7=$$arr_6.length,$$idx_8=0;$$idx_8<$$len_7;++$$idx_8){var $v_3=$$arr_6[$$idx_8];$v_2.append("<a:KeyValuePairOfstringanyType>");$v_2.append($v_3.get_soapXml());$v_2.append("</a:KeyValuePairOfstringanyType>")}$v_2.append("</a:Parameters>");$v_2.append('<a:RequestId i:nil="true" />');$v_2.append("<a:RequestName>"+CrmEncodeDecode.CrmXmlEncode(requestName)+"</a:RequestName>");$v_2.append("</request>");$v_2.append("</Execute>");$v_2.append("</s:Body>");$v_2.append("</s:Envelope>");return $v_2.toString()},assign:function(targetEntityId,targetEntityName,assigneeEntityId,assigneeEntityName){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=targetEntityId;$v_0.logicalName=targetEntityName;var $v_1=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_1.id=assigneeEntityId;$v_1.logicalName=assigneeEntityName;var $v_2=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Target",$v_0),$v_3=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Assignee",$v_1),$v_4=[$v_2,$v_3];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"Assign",$v_4,"http://schemas.microsoft.com/crm/2011/Contracts")},associate:function(parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName){return this.$l_0("Associate",parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName)},disassociate:function(parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName){return this.$l_0("Disassociate",parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName)},$l_0:function($p0,$p1,$p2,$p3,$p4,$p5){for(var $v_0=Xrm.Internal.getEntityName($p2),$v_1=Xrm.Internal.getEntityName($p3),$v_2=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection,$v_3=0,$$arr_A=$p4,$$len_B=$$arr_A.length,$$idx_C=0;$$idx_C<$$len_B;++$$idx_C){var $v_9=$$arr_A[$$idx_C];$v_2.set_item($v_3++,Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference($v_9,$v_1))}var $v_4=-1;if($v_0===$v_1)$v_4=0;var $v_5=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Target",Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference($p1,$v_0)),$v_6=Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter.createInstance("Relationship",$p5,$v_4),$v_7=Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter.createInstance("RelatedEntities",$v_2),$v_8=[$v_5,$v_6,$v_7];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,$p0,$v_8,"http://schemas.microsoft.com/xrm/2011/Contracts")},closeIncident:function(timeSpent,description,subject,incidentId,actualEnd,statusCode){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity("incidentresolution");$v_0.set_id(Mscrm.Utilities.createGuid().replace("{","").replace("}",""));$v_0.setAttribute("timespent",timeSpent,1);$v_0.setAttribute("opportunityid",Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(incidentId,"incident"),4);$v_0.setAttribute("description",description,0);$v_0.setAttribute("subject",subject,0);$v_0.setAttribute("actualend",actualEnd,3);var $v_1=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("IncidentResolution",$v_0),$v_2=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("Status",statusCode),$v_3=[$v_1,$v_2];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"CloseIncident",$v_3,"http://schemas.microsoft.com/crm/2011/Contracts")},$I_0:function($p0){if(isNullOrEmptyString($p0.id)||isNullOrEmptyString($p0.id)||isNullOrEmptyString($p0.logicalName)||!Xrm.Internal.getEntityCode($p0.logicalName))return false;return true},convertActivity:function(targetEntityName,targetEntitySubject,activityId,activityTypeCode,customerId,customerTypeCode,ownerId,ownerTypeCode,subjectId,subjectTypeCode,leadId,currencyId,campaignId,campaignTypeCode,logResponse){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity(targetEntityName);if(!isNullOrEmptyString(targetEntitySubject)){var $v_6="title";if(targetEntityName==="opportunity")$v_6="name";$v_0.attributes[$v_6]=targetEntitySubject;$v_0.attributeTypes[$v_6]="c:string";$v_0.attributeTypeNamespaces[$v_6]="http://www.w3.org/2001/XMLSchema"}if(currencyId){var $v_7=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(currencyId,"transactioncurrency");if(this.$I_0($v_7)){$v_0.attributes["transactioncurrencyid"]=$v_7;$v_0.attributeTypes["transactioncurrencyid"]="a:EntityReference"}}if(campaignId&&Xrm.Internal.getEntityCode("campaign")===campaignTypeCode){var $v_8=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(campaignId,Xrm.Internal.getEntityName(campaignTypeCode));if(this.$I_0($v_8)){$v_0.attributes["campaignid"]=$v_8;$v_0.attributeTypes["campaignid"]="a:EntityReference"}}if(leadId){var $v_9=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(leadId,"lead");if(this.$I_0($v_9)){$v_0.attributes["originatingleadid"]=$v_9;$v_0.attributeTypes["originatingleadid"]="a:EntityReference"}}if(customerId){var $v_A=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(customerId,Xrm.Internal.getEntityName(customerTypeCode));if(this.$I_0($v_A)){$v_0.attributes["customerid"]=$v_A;$v_0.attributeTypes["customerid"]="a:EntityReference"}}if(ownerId){var $v_B=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(ownerId,Xrm.Internal.getEntityName(ownerTypeCode));if(this.$I_0($v_B)){$v_0.attributes["ownerid"]=$v_B;$v_0.attributeTypes["ownerid"]="a:EntityReference"}}if(subjectId){var $v_C=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(subjectId,Xrm.Internal.getEntityName(subjectTypeCode));if(this.$I_0($v_C)){$v_0.attributes["subjectid"]=$v_C;$v_0.attributeTypes["subjectid"]="a:EntityReference"}}var $v_1=Sales.Common.CrmSoapServiceProxy.GuidParameter.createInstance("ActivityId",activityId),$v_2=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("ActivityEntityName",Xrm.Internal.getEntityName(activityTypeCode)),$v_3=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("TargetEntityName",targetEntityName),$v_4=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("TargetEntity",$v_0),$v_5=[$v_1,$v_2,$v_3,$v_4];if(logResponse){var $v_D=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("CreateCampaignResponse",true);$v_5=$v_5.concat($v_D)}return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse,"ConvertActivity",$v_5,"http://schemas.microsoft.com/crm/2011/Contracts")},create:function(entity,suppressDuplicateDetection){if(IsNull(suppressDuplicateDetection))suppressDuplicateDetection=true;var $v_0=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("Target",entity),$v_1=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("SuppressDuplicateDetection",suppressDuplicateDetection),$v_2=[$v_0,$v_1];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse,"Create",$v_2)},deleteEntity:function(entityId,entityName){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=entityId;$v_0.logicalName=entityName;var $v_1=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Target",$v_0),$v_2=[$v_1];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"Delete",$v_2)},executeQuickFind:function(searchText,entityGroupName,entityNames,filter){var $v_0=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("searchText",searchText),$v_1=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("entityGroupName",entityGroupName),$v_2=Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.createInstance("ColumnSet",entityNames),$v_3=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Filter",filter),$v_4=[$v_0,$v_1,$v_2,$v_3];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"ExecuteQuickFind",$v_4,"http://schemas.microsoft.com/crm/2011/Contracts")},getValidStatusTransition:function(incidentId,statusCode){var $v_0=Sales.Common.CrmSoapServiceProxy.GuidParameter.createInstance("incidentid",incidentId),$v_1=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("tostatecode",statusCode),$v_2=[$v_0,$v_1];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"GetValidStatusTransition",$v_2,"http://schemas.microsoft.com/crm/2011/Contracts")},inviteUser:function(userId){var $v_0=Sales.Common.CrmSoapServiceProxy.GuidParameter.createInstance("UserId",userId),$v_1=[$v_0];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"InviteUser",$v_1,"http://schemas.microsoft.com/crm/2011/Contracts")},loseOpportunity:function(opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode,competitorId){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity("opportunityclose");$v_0.set_id(Mscrm.Utilities.createGuid().replace("{","").replace("}",""));$v_0.setAttribute("actualrevenue",actualRevenue,10);$v_0.setAttribute("activityid",$v_0.get_id(),2);$v_0.setAttribute("opportunityid",Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(opportunityId,"opportunity"),4);$v_0.setAttribute("description",description,0);$v_0.setAttribute("actualend",date,3);$v_0.setAttribute("subject",opportunityDisplayName,0);!isNullOrEmptyString(competitorId)&&$v_0.setAttribute("competitorid",Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(competitorId,"competitor"),4);var $v_1=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("OpportunityClose",$v_0),$v_2=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("Status",statusCode),$v_3=[$v_1,$v_2];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"LoseOpportunity",$v_3,"http://schemas.microsoft.com/crm/2011/Contracts")},qualifyLead:function(leadId,createAccount,createContact,createOpportunity,transactionCurrencyId,opportunityCustomer,sourceCampaignId,qualifyStatus,suppressDuplicateDetection){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=leadId;$v_0.logicalName="lead";var $v_1=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_1.id=transactionCurrencyId;$v_1.logicalName="transactioncurrency";var $v_2=null;if(!isNullOrEmptyString(sourceCampaignId)){$v_2=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_2.id=sourceCampaignId;$v_2.logicalName="campaign"}var $v_3=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("LeadId",$v_0),$v_4=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("CreateAccount",createAccount),$v_5=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("CreateContact",createContact),$v_6=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("CreateOpportunity",createOpportunity),$v_7=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("OpportunityCurrencyId",$v_1),$v_8=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("OpportunityCustomerId",opportunityCustomer),$v_9=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("SourceCampaignId",$v_2),$v_A=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("Status",qualifyStatus),$v_B=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("SuppressDuplicateDetection",suppressDuplicateDetection),$v_C=[$v_3,$v_4,$v_5,$v_6,$v_7,$v_8,$v_9,$v_A,$v_B];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse,"QualifyLead",$v_C,"http://schemas.microsoft.com/crm/2011/Contracts")},retrieve:function(objectId,objectTypeCode,columns,returnNotifications){var $v_0=Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.createInstance("ColumnSet",columns),$v_1=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("ReturnNotifications",returnNotifications),$v_2=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(objectId,Xrm.Internal.getEntityName(objectTypeCode)),$v_3=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Target",$v_2),$v_4=[$v_3,$v_1,$v_0];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse,"Retrieve",$v_4,"http://schemas.microsoft.com/xrm/2011/Contracts")},retrieveAttribute:function(retrieveAsIfPublished,entityLogicalName,attributeLogicalName){var $v_0=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("RetrieveAsIfPublished",retrieveAsIfPublished),$v_1=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("EntityLogicalName",entityLogicalName),$v_2=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("LogicalName",attributeLogicalName),$v_3=Sales.Common.CrmSoapServiceProxy.GuidParameter.createInstance("MetadataId","00000000-0000-0000-0000-000000000000"),$v_4=[$v_0,$v_1,$v_2,$v_3];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse,"RetrieveAttribute",$v_4,"http://schemas.microsoft.com/xrm/2011/Contracts")},retrieveMultiple:function(fetchXml,types){var $v_0=Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter.createInstance("Query",fetchXml),$v_1=[$v_0];if(IsNull(types))return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse,"RetrieveMultiple",$v_1);if(Object.getType(types)!==Array)types=[types];var $v_2=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$v_3=this.buildSoapEnvelope("RetrieveMultiple",$v_1),$$t_8=this,$$t_9=this;this.executeRequest($v_3,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){$v_2.resolve(new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse($p1_0,types))},function($p1_0){$v_2.reject($p1_0)});return $v_2.promise()},book:function(entity){var $v_0=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("Target",entity),$v_1=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("MaintainLegacyAppServerBehavior",true),$v_2=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("ReturnNotifications",true),$v_3=[$v_0,$v_1,$v_2];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse,"Book",$v_3)},reschedule:function(entity,activityId){entity.set_id(activityId);var $v_0=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("Target",entity),$v_1=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("MaintainLegacyAppServerBehavior",true),$v_2=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("ReturnNotifications",true),$v_3=[$v_0,$v_1,$v_2];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse,"Reschedule",$v_3)},setState:function(entityId,entityName,state,status){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=entityId.replace("{","").replace("}","");$v_0.logicalName=entityName;var $v_1=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("EntityMoniker",$v_0),$v_2=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("Status",status),$v_3=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("State",state),$v_4=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("MaintainLegacyAppServerBehavior",true),$v_5=[$v_1,$v_2,$v_3,$v_4];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"SetState",$v_5,"http://schemas.microsoft.com/crm/2011/Contracts")},update:function(entity){var $v_0=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("Target",entity),$v_1=[$v_0];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse,"Update",$v_1)},winOpportunity:function(opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity("opportunityclose");$v_0.set_id(Mscrm.Utilities.createGuid().replace("{","").replace("}",""));$v_0.setAttribute("actualrevenue",actualRevenue,10);$v_0.setAttribute("activityid",$v_0.get_id(),2);$v_0.setAttribute("opportunityid",Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(opportunityId,"opportunity"),4);$v_0.setAttribute("description",description,0);$v_0.setAttribute("actualend",date,3);$v_0.setAttribute("subject",opportunityDisplayName,0);var $v_1=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("OpportunityClose",$v_0),$v_2=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("Status",statusCode),$v_3=[$v_1,$v_2];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"WinOpportunity",$v_3,"http://schemas.microsoft.com/crm/2011/Contracts")}};Sales.Common.CrmSoapServiceProxy.AttributeType=function(){};Sales.Common.CrmSoapServiceProxy.MetadataHelper=function(){};Sales.Common.CrmSoapServiceProxy.MetadataHelper.parseAttributeType=function(attributeTypeName){switch(attributeTypeName){case "c:string":return 0;case "c:guid":return 2;case "a:EntityReference":return 4;case "c:dateTime":return 3;case "c:int":return 1;case "c:boolean":return 7;case "c:decimal":return 8;case "c:double":return 9;case "a:OptionSetValue":return 6;case "a:EntityCollection":return 5;case "a:Money":return 10;default:throw Error.create(String.format("attributeType '{0}' is not supported",attributeTypeName))}};Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition=function(entity,attributeName,attributeType){if(IsNull(entity))throw Error.create("entity is undefined");if(IsNull(attributeName))throw Error.create("attributeName is undefined");switch(attributeType){case 0:entity.attributeTypes[attributeName]="c:string";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 1:entity.attributeTypes[attributeName]="c:int";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 8:entity.attributeTypes[attributeName]="c:decimal";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 9:entity.attributeTypes[attributeName]="c:double";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 2:entity.attributeTypes[attributeName]="c:guid";entity.attributeTypeNamespaces[attributeName]="http://schemas.microsoft.com/2003/10/Serialization/";break;case 4:entity.attributeTypes[attributeName]="a:EntityReference";break;case 5:entity.attributeTypes[attributeName]="a:EntityCollection";break;case 3:entity.attributeTypes[attributeName]="c:dateTime";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 7:entity.attributeTypes[attributeName]="c:boolean";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 6:entity.attributeTypes[attributeName]="a:OptionSetValue";break;case 10:entity.attributeTypes[attributeName]="a:Money";break;default:throw Error.create(String.format("attributeType '{0}' is not supported",attributeType))}};Sales.Common.CrmSoapServiceProxy.BooleanParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.BooleanParameter.initializeBase(this,[$p0]);this.$4_1=$p1};Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance=function(name,value){return new Sales.Common.CrmSoapServiceProxy.BooleanParameter(name,value)};Sales.Common.CrmSoapServiceProxy.BooleanParameter.prototype={$4_1:false,get_valueXml:function(){return '<b:value i:type="c:boolean" xmlns:c="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$4_1.toString())+"</b:value>"}};Sales.Common.CrmSoapServiceProxy.ColumnSetParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.initializeBase(this,[$p0]);this.$Z_1=$p1};Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.createInstance=function(name,columns){return new Sales.Common.CrmSoapServiceProxy.ColumnSetParameter(name,columns)};Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.prototype={$Z_1:null,get_valueXml:function(){for(var $v_0='<b:value i:type="a:ColumnSet"><a:AllColumns>false</a:AllColumns><a:Columns xmlns:c="http://schemas.microsoft.com/2003/10/Serialization/Arrays">',$$arr_1=this.$Z_1,$$len_2=$$arr_1.length,$$idx_3=0;$$idx_3<$$len_2;++$$idx_3){var $v_1=$$arr_1[$$idx_3];$v_0+="<c:string>"+$v_1+"</c:string>"}$v_0+="</a:Columns>";$v_0+="</b:value>";return $v_0}};Sales.Common.CrmSoapServiceProxy.EntityParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.EntityParameter.initializeBase(this,[$p0]);this.$D_1=$p1};Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance=function(name,entity){return new Sales.Common.CrmSoapServiceProxy.EntityParameter(name,entity)};Sales.Common.CrmSoapServiceProxy.EntityParameter.prototype={$D_1:null,get_valueXml:function(){return '<b:value i:type="a:Entity">'+Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.attributesToXml(this.$D_1)+'<a:EntityState i:nil="true" /><a:FormattedValues />'+(_String.isNullOrEmpty(this.$D_1.get_id())?"":"<a:Id>"+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$D_1.get_id())+"</a:Id>")+"<a:LogicalName>"+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$D_1.logicalName)+"</a:LogicalName>"+Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.$q(this.$D_1.relatedEntities)+"</b:value>"}};Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.initializeBase(this,[$p0]);this.$E_1=$p1};Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance=function(name,entityMoniker){return new Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter(name,entityMoniker)};Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.prototype={$E_1:null,get_valueXml:function(){if(!this.$E_1)return '<b:value i:nil="true" />';var $v_0=new Sys.StringBuilder;$v_0.append("<b:value i:type='a:EntityReference'>");$v_0.append("<a:Id>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$E_1.id));$v_0.append("</a:Id>");$v_0.append("<a:LogicalName>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$E_1.logicalName));$v_0.append("</a:LogicalName>");if(!_String.isNullOrEmpty(this.$E_1.name)){$v_0.append("<a:Name>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$E_1.name));$v_0.append("</a:Name>")}else $v_0.append('<a:Name i:nil="true" />');$v_0.append("</b:value>");return $v_0.toString()}};Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter.initializeBase(this,[$p0]);this.$G_1=$p1};Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter.createInstance=function(name,entityCollection){return new Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter(name,entityCollection)};Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter.prototype={$G_1:null,get_valueXml:function(){if(!this.$G_1||!this.$G_1.get_length())return "";var $v_0=new Sys.StringBuilder;$v_0.append("<b:value i:type='a:EntityReferenceCollection'>");for(var $v_1=0;$v_1<this.$G_1.get_length();$v_1++){var $v_2=this.$G_1.get_item($v_1);$v_0.append("<a:EntityReference>");$v_0.append("<a:Id>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2.id));$v_0.append("</a:Id>");$v_0.append("<a:LogicalName>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2.logicalName));$v_0.append("</a:LogicalName>");if(!_String.isNullOrEmpty($v_2.name)){$v_0.append("<a:Name>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2.name));$v_0.append("</a:Name>")}else $v_0.append('<a:Name i:nil="true" />');$v_0.append("</a:EntityReference>")}$v_0.append("</b:value>");return $v_0.toString()}};Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter=function($p0,$p1,$p2){this.$O_1=-1;Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter.initializeBase(this,[$p0]);this.$d_1=$p1;this.$O_1=$p2};Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter.createInstance=function(name,value,primaryEntityRole){return new Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter(name,value,primaryEntityRole)};Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter.prototype={$d_1:null,get_valueXml:function(){var $v_0=new Sys.StringBuilder;$v_0.append("<b:value i:type='a:Relationship'>");if(this.$O_1!==-1){$v_0.append("<a:PrimaryEntityRole >");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$O_1.toString()));$v_0.append("</a:PrimaryEntityRole >")}else $v_0.append('<a:PrimaryEntityRole i:nil="true" />');$v_0.append("<a:SchemaName >");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$d_1));$v_0.append("</a:SchemaName >");$v_0.append("</b:value>");return $v_0.toString()}};Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter.initializeBase(this,[$p0]);this.$b_1=$p1};Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter.createInstance=function(name,fetchXml){return new Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter(name,fetchXml)};Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter.prototype={$b_1:null,get_valueXml:function(){return '<b:value i:type="a:FetchExpression"><a:Query>'+CrmEncodeDecode.CrmXmlEncode(this.$b_1)+"</a:Query></b:value>"}};Sales.Common.CrmSoapServiceProxy.GuidParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.GuidParameter.initializeBase(this,[$p0]);this.$4_1=$p1.replace("{","").replace("}","")};Sales.Common.CrmSoapServiceProxy.GuidParameter.createInstance=function(name,value){return new Sales.Common.CrmSoapServiceProxy.GuidParameter(name,value)};Sales.Common.CrmSoapServiceProxy.GuidParameter.prototype={$4_1:null,get_valueXml:function(){return '<b:value i:type="c:guid" xmlns:c="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$4_1.toString())+"</b:value>"}};Sales.Common.CrmSoapServiceProxy.SoapParameter=function(name){this.$c_0=name};Sales.Common.CrmSoapServiceProxy.SoapParameter.prototype={$c_0:null,get_soapXml:function(){return this.get_keySoapXml()+this.get_valueXml()},get_keySoapXml:function(){return String.format("<b:key>{0}</b:key>",CrmEncodeDecode.CrmXmlEncode(this.$c_0))}};Sales.Common.CrmSoapServiceProxy.StringParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.StringParameter.initializeBase(this,[$p0]);this.$4_1=$p1};Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance=function(name,value){return new Sales.Common.CrmSoapServiceProxy.StringParameter(name,value)};Sales.Common.CrmSoapServiceProxy.StringParameter.prototype={$4_1:null,get_valueXml:function(){return '<b:value i:type="c:string" xmlns:c="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$4_1.toString())+"</b:value>"}};Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.initializeBase(this,[$p0]);this.$4_1=$p1};Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance=function(name,value){return new Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter(name,value)};Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.prototype={$4_1:0,get_valueXml:function(){return "<b:value i:type='a:OptionSetValue'><a:Value>"+this.$4_1+"</a:Value></b:value>"}};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.Utils");Sales.Common.CrmSoapServiceProxy.Utils.Utils=function(){};Sales.Common.CrmSoapServiceProxy.Utils.Utils.isFunction=function(functionName){return eval(String.format("(typeof({0}) == 'function')",functionName))};Sales.Common.CrmSoapServiceProxy.Utils.Utils.parseGuid=function(stringGuid){if(_String.isNullOrEmpty(stringGuid))return null;var $v_0=Sales.Common.CrmSoapServiceProxy.Utils.Utils.tryParseGuid(stringGuid);if(IsNull($v_0))throw Error.create("invalid guid format");return $v_0};Sales.Common.CrmSoapServiceProxy.Utils.Utils.tryParseGuid=function(guid){return Mscrm.Utilities.tryParseGuid(guid)};Sales.Common.CrmSoapServiceProxy.Utils.Utils.getContextFromXrmPage=function(){return Xrm.Page.context};Sales.Common.CrmSoapServiceProxy.Utils.Utils.areGuidEqual=function(guid1,guid2){if(_String.isNullOrEmpty(guid1)||_String.isNullOrEmpty(guid2))return false;var $v_0=Sales.Common.CrmSoapServiceProxy.Utils.Utils.removeBeginEndBracket(guid1.toLowerCase()),$v_1=Sales.Common.CrmSoapServiceProxy.Utils.Utils.removeBeginEndBracket(guid2.toLowerCase());return $v_0===$v_1};Sales.Common.CrmSoapServiceProxy.Utils.Utils.removeBeginEndBracket=function(id){if(id.startsWith("{"))id=id.substr(1);if(id.endsWith("}"))id=id.substr(0,id.length-1);return id};Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils=function(){};Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.toCrmDateTimeString=function(dateTime){if(IsNull(dateTime)||dateTime===Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$Q)return "";return dateTime.format("s")};Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.fromCrmDateTimeString=function(dateTimeString){if(_String.isNullOrEmpty(dateTimeString))return Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$Q;var $v_0=dateTimeString.replace(Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$r," ").replace(Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$k,"/")+" UTC";return new Date($v_0)};Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.toCrmDateTimeStringWithTimeZone=function(dateTime){if(IsNull(dateTime)||dateTime===Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$Q)return "";return dateTime.format("yyyy-MM-ddTHH:mm:ss.fffzzz")};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils=function(){};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.multilineHtmlEncode=function(value,replaceNewLineForHtml){if(_String.isNullOrEmpty(value)||typeof value!=="string")return "";if(IsNull(replaceNewLineForHtml))replaceNewLineForHtml=false;for(var $v_0=value.replace("\r\n","\n").replace("\r","\n").split("\n"),$v_1=0;$v_1<$v_0.length;$v_1++)$v_0[$v_1]=Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlEncode($v_0[$v_1]);if(replaceNewLineForHtml)return $v_0.join("<br />");else return $v_0.join("\r\n")};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlAttributeEncode=function(value){if(_String.isNullOrEmpty(value))return "";return CrmEncodeDecode.CrmXmlAttributeEncode(value)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.javaScriptEncode=function(s){return CrmEncodeDecode.CrmJavaScriptEncode(s)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlAttributeEncode=function(s){return CrmEncodeDecode.CrmHtmlAttributeEncode(s)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlEncode=function(value){if(_String.isNullOrEmpty(value))return "";return CrmEncodeDecode.CrmHtmlEncode(value)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlDecode=function(value){if(_String.isNullOrEmpty(value))return "";return CrmEncodeDecode.CrmHtmlDecode(value)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode=function(value){if(_String.isNullOrEmpty(value))return "";return CrmEncodeDecode.CrmXmlEncode(value)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlEncode=function(value){return CrmEncodeDecode.CrmUrlEncode(value)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlDecode=function(value){return CrmEncodeDecode.CrmUrlDecode(value)};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.Faults");Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault=function(){};Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseFromXml=function(responseXml){var $v_0=new Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault;if(IsNull(responseXml)){$v_0.$U_0=true;return $v_0}responseXml.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services");responseXml.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts");responseXml.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic");responseXml.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance");responseXml.addNamespace("e","http://schemas.datacontract.org/2004/07/System.ServiceModel");$v_0.$W_0=responseXml;var $v_1="//a:OrganizationServiceFault",$v_2=responseXml.selectSingleNode($v_1);if(!IsNull($v_2)){$v_0=Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseServiceFault($v_0,$v_2);return $v_0}var $v_3="//e:ExceptionDetail",$v_4=responseXml.selectSingleNode($v_3);if(!IsNull($v_4)){$v_0=Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseExceptionDetail($v_0,$v_4);return $v_0}$v_0.$8_0=responseXml.get_outerXml();return $v_0};Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseServiceFault=function(organizationServiceFault,faultNode){var $v_0="//a:ErrorCode",$v_1="//a:InnerFault[not(@i:nil)]",$v_2="//a:Message",$v_3=faultNode.selectSingleNode($v_0);if(!IsNull($v_3))organizationServiceFault.$J_0=Number.parseInvariant($v_3.get_innerText());var $v_4=faultNode.selectSingleNode($v_1);if(!IsNull($v_4))organizationServiceFault.$T_0=Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.$o($v_4);var $v_5=faultNode.selectSingleNode($v_2);organizationServiceFault.$8_0=!IsNull($v_5)?$v_5.get_innerText():faultNode.get_outerXml();return organizationServiceFault};Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseExceptionDetail=function(organizationServiceFault,exceptionNode){var $v_0="e:InnerException/e:Message",$v_1=exceptionNode.selectSingleNode($v_0);organizationServiceFault.$8_0=!IsNull($v_1)?$v_1.get_innerText():exceptionNode.get_outerXml();return organizationServiceFault};Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.$o=function($p0){var $v_0=new Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault,$v_1="//ErrorCode",$v_2="//InnerFault[not(@i:nil)]",$v_3="//Message",$v_4=$p0.selectSingleNode($v_1);if(!IsNull($v_4))$v_0.$J_0=Number.parseInvariant($v_4.get_innerText());var $v_5=$p0.selectSingleNode($v_3);if(!IsNull($v_5))$v_0.$8_0=$v_5.get_innerText();var $v_6=$p0.selectNodes($v_2);if($v_6.get_count()>0){var $v_7=$v_6.get_item(0);if($v_7.hasChildNodes())$v_0.$T_0=Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.$o($v_7)}return $v_0};Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.prototype={$W_0:null,$J_0:0,$T_0:null,$8_0:null,$U_0:false,get_innerFault:function(){return this.$T_0},get_errorCode:function(){return this.$J_0},get_message:function(){return this.$8_0},get_responseXml:function(){return this.$W_0},get_responseOuterXml:function(){return this.$W_0.get_outerXml()},get_emptyResponse:function(){return this.$U_0},set_emptyResponse:function(value){this.$U_0=value;return value}};Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes=function(){};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.Messages");Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value");this.id=$v_0.get_innerText()}else{this.responseName="ConvertActivity";this.id=""}};Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse.prototype={id:null};Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse=function(request,textStatus,error){this.$j_0=request;this.$Y_0=textStatus;this.$A_0=error;this.$C_0=Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseFromXml(Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.create(request.responseXML))};Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse.prototype={$j_0:null,$Y_0:null,$A_0:null,$C_0:null,$N_0:null,get_localizedMessage:function(){var $v_0="errorTable[Error_Message_0x"+this.$C_0.$J_0.toString()+"]",$v_1=$v_0;if(!isNullOrEmptyString($v_1))this.$N_0=$v_1;else this.$N_0=this.$C_0.$8_0;return this.$N_0},get_request:function(){return this.$j_0},get_textStatus:function(){return this.$Y_0},get_error:function(){return this.$A_0},get_debugErrorMessage:function(){if(!IsNull(this.$C_0)&&!isNullOrEmptyString(this.$C_0.$8_0))return this.$C_0.$8_0;if(!IsNull(this.$A_0)){if(!IsNull(this.$A_0.message))return this.$A_0.message;if(String.isInstanceOfType(this.$A_0))return this.$A_0}return this.$Y_0},get_organizationServiceFault:function(){return this.$C_0}};Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value");this.id=$v_0.get_innerText()}else{this.responseName="Create";this.id=""}};Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse.prototype={id:null};Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse=function(soapResponse){this.responseName="OrganizationResponse";this.soapResponse=soapResponse;Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.$n(this.soapResponse)};Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.$n=function($p0){if(!IsNull($p0)){$p0.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts");$p0.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic");$p0.addNamespace("c","http://schemas.microsoft.com/crm/2011/Contracts");$p0.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services");$p0.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance");$p0.addNamespace("s","http://schemas.xmlsoap.org/soap/envelope")}};Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.createResponse=function(soapResponse,requestName){!IsNull(soapResponse)&&Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.$n(soapResponse);switch(requestName){case "Book":return new Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse(soapResponse);case "ConvertActivity":return new Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse(soapResponse);case "Create":return new Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse(soapResponse);case "ExecuteQuickFind":case "Retrieve":return new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse(soapResponse);case "RetrieveAttribute":return new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse(soapResponse);case "RetrieveMultiple":return new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse(soapResponse);case "QualifyLead":return new Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse(soapResponse);case "Update":return new Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse(soapResponse);case "Reschedule":return new Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse(soapResponse);case "GetValidStatusTransition":case "WinOpportunity":case "LoseOpportunity":case "Delete":case "SetState":case "CloseIncident":default:return new Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse(soapResponse)}};Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.prototype={responseName:null,soapResponse:null};Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse))this.$P_1=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection.loadFromXml(soapResponse);else this.$P_1=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection};Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse.prototype={$P_1:null,get_createdEntities:function(){return this.$P_1}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse.initializeBase(this,[soapResponse]);soapResponse.addNamespace("c","http://schemas.microsoft.com/xrm/2011/Metadata");this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();this.$e_1=soapResponse.selectSingleNode("//a:KeyValuePairOfstringanyType/b:value")};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse.prototype={$e_1:null,get_attributeMetadataXmlNode:function(){return this.$e_1}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse.initializeBase(this,[soapResponse]);soapResponse.addNamespace("c","http://schemas.microsoft.com/xrm/2011/Metadata");this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();this.$R_1=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value")};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse.prototype={$R_1:null,get_entityXml:function(){return this.$R_1}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value"),$v_1=$v_0.selectSingleNode("a:EntityReference/a:Id");this.id=$v_1.get_innerText()}else{this.responseName="Create";this.id=""}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse.prototype={id:null};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse=function(soapResponse,types){Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse.initializeBase(this,[soapResponse]);this.moreRecords=false;if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:EntityCollection']"),$v_1=$v_0.selectSingleNode("a:MoreRecords");if(!IsNull($v_1)&&!_String.isNullOrEmpty($v_1.get_innerText()))this.moreRecords=Boolean.parse($v_1.get_innerText());var $v_2=$v_0.selectSingleNode("a:TotalRecordCount");if(!IsNull($v_2)&&!_String.isNullOrEmpty($v_2.get_innerText()))this.totalRecordCount=parseInt($v_2.get_innerText());var $v_3=$v_0.selectSingleNode("a:PagingCookie");if(!IsNull($v_3)&&!_String.isNullOrEmpty($v_3.get_innerText()))this.pagingCookie=$v_3.get_innerText();var $v_4=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.loadFromXml($v_0,types);this.entities=$v_4.$1_0}else{this.responseName="RetrieveMultipleResponse";this.entities=new Array(0)}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse.prototype={moreRecords:false,totalRecordCount:0,entities:null,pagingCookie:null};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:Entity']");this.entity=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.loadFromXml($v_0);this.id=this.entity.get_id()}else{this.responseName="RetrieveResponse";this.entity=new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity("")}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse.prototype={entity:null,id:null};Sales.Common.CrmSoapServiceProxy.Messages.SchedulingNotification=function(message,severity){this.Text=message;switch(severity){case "Error":this.Severity=1;break;case "Warning":this.Severity=2;break;case "Information":this.Severity=3;break}};Sales.Common.CrmSoapServiceProxy.Messages.SchedulingNotification.prototype={Text:null,Severity:0};Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();this.notifications=[];var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value/c:ValidationSuccess");this.status=Boolean.parse($v_0.get_innerText());if(this.status){var $v_1=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value/c:ActivityId");if(!IsNull($v_1))this.activityId=$v_1.get_innerText()}else for(var $v_2=soapResponse.selectNodes("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value/c:BusinessNotification/c:Message"),$v_3=soapResponse.selectNodes("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value/c:BusinessNotification/c:Severity"),$v_4=0;$v_4<$v_2.get_count();$v_4++){var $v_5=$v_2.get_item($v_4),$v_6=new Sales.Common.CrmSoapServiceProxy.Messages.SchedulingNotification($v_5.get_innerText(),$v_3.get_item($v_4).get_innerText());Array.add(this.notifications,$v_6)}}else{this.responseName="Book";this.activityId=""}};Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse.prototype={activityId:null,status:false,notifications:null};Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse.initializeBase(this,[soapResponse])};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.ObjectModel");Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityState=function(){};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityState.prototype={active:0,inActive:1};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityState.registerEnum("Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityState",false);Sales.Common.CrmSoapServiceProxy.ObjectModel.IEntityMetadata=function(){};Sales.Common.CrmSoapServiceProxy.ObjectModel.IEntityMetadata.registerInterface("Sales.Common.CrmSoapServiceProxy.ObjectModel.IEntityMetadata");Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.initializeBase(this,["activitypointer"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.prototype={get_id:function(){return this.get_activityId()},set_id:function(value){this.set_activityId(value);return value},get_activityId:function(){return this.attributes["activityid"]},set_activityId:function(value){this.attributes["activityid"]=value;return value},get_activityTypeCode:function(){return this.attributes["activitytypecode"]},set_activityTypeCode:function(value){this.attributes["activitytypecode"]=value;return value},get_dueDate:function(){return this.attributes["scheduledend"]},set_dueDate:function(value){this.attributes["scheduledend"]=value;return value},get_formattedDueDate:function(){return this.formattedValues["scheduledend"]},get_priority:function(){return this.attributes["prioritycode"]},set_priority:function(value){this.attributes["prioritycode"]=value;return value},get_subject:function(){return this.attributes["subject"]},set_subject:function(value){this.attributes["subject"]=value;return value},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"activityid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"activitytypecode",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"scheduledend",3);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"prioritycode",6);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"subject",0)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.initializeBase(this,["contact"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.prototype={get_firstName:function(){return this.attributes["firstname"]},get_lastName:function(){return this.attributes["lastname"]},set_lastName:function(value){this.attributes["lastname"]=value;return value},get_emailAddress1:function(){return this.attributes["emailaddress1"]},set_emailAddress1:function(value){this.attributes["emailaddress1"]=value;return value},get_emailAddress2:function(){return this.attributes["emailaddress2"]},get_emailAddress3:function(){return this.attributes["emailaddress3"]},get_id:function(){return this.get_contactId()},set_id:function(value){this.set_contactId(value);return value},get_contactId:function(){return this.attributes["contactid"]},set_contactId:function(value){this.attributes["contactid"]=value;return value},get_jobTitle:function(){return this.attributes["jobtitle"]},set_jobTitle:function(value){this.attributes["contactid"]=value;return value},get_parentCustomerId:function(){return this.attributes["parentcustomerid"]},set_parentCustomerId:function(value){this.attributes["parentcustomerid"]=value;return value},get_personId:function(){return this.attributes["personid"]},set_personId:function(value){this.attributes["personid"]=value;return value},get_fullName:function(){return this.attributes["fullname"]},set_fullName:function(value){this.attributes["fullname"]=value;return value},get_emailAddress:function(){return this.attributes["emailsearch1.emailaddress"]},set_emailAddress:function(value){this.attributes["emailsearch1.emailaddress"]=value;return value},get_transactionCurrencyId:function(){return this.attributes["transactioncurrencyid"]},set_transactionCurrencyId:function(value){this.attributes["transactioncurrencyid"]=value;return value},get_salesToDate:function(){return this.attributes["salestodate"]},set_salesToDate:function(value){this.attributes["salestodate"]=value;return value},get_formattedSalesToDate:function(){return this.formattedValues["salestodate"]},get_currentSalesPipeline:function(){return this.attributes["currentsalespipeline"]},set_currentSalesPipeline:function(value){this.attributes["currentsalespipeline"]=value;return value},get_formattedCurrentSalesPipeline:function(){return this.formattedValues["currentsalespipeline"]},get_openOpportunityCount:function(){return this.attributes["openopportunitycount"]},set_openOpportunityCount:function(value){this.attributes["openopportunitycount"]=value;return value},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"contactid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"firstname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"lastname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"jobtitle",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"parentcustomerid",4);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"personid",4);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailaddress1",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailaddress2",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailaddress3",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"transactioncurrencyid",4);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"salestodate",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"currentsalespipeline",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"openopportunitycount",1);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"fullname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailsearch1.emailaddress",0)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.initializeBase(this,["emailsearch"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.prototype={get_id:function(){return this.get_emailSearchId()},set_id:function(value){this.set_emailSearchId(value);return value},get_emailSearchId:function(){return this.attributes["emailsearchid"]},set_emailSearchId:function(value){this.attributes["emailsearchid"]=value;return value},get_emailAddress:function(){return this.attributes["emailaddress"]},set_emailAddress:function(value){this.attributes["emailaddress"]=value;return value},get_parentObjectId:function(){return this.attributes["parentobjectid"]},set_parentObjectId:function(value){this.attributes["parentobjectid"]=value;return value},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailsearchid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailaddress",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"parentobjectid",4)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity=function(logicalName){this.$S_0="00000000-0000-0000-0000-000000000000";this.logicalName=logicalName;this.attributes={};this.attributeTypes={};this.attributeTypeNamespaces={};this.relatedEntities=new Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection;this.formattedValues={};this.initMetadata()};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.toTypedEntityCollection=function(T,entities){var $v_0=new Array(0);if(!entities)return $v_0;for(var $v_1=0;$v_1<entities.length;$v_1++)$v_0[$v_1]=entities[$v_1].toTypedEntity(T);return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.toXml=function(entity,skipRootNS){var $v_0=new Sys.StringBuilder;if(!IsNull(skipRootNS))$v_0.appendLine("<a:Entity>");else $v_0.appendLine('<entity xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">');$v_0.appendLine(Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.attributesToXml(entity,skipRootNS));$v_0.appendLine('<a:EntityState i:nil="true"/>');$v_0.appendLine('<a:FormattedValues xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic"/>');if(!_String.isNullOrEmpty(entity.get_id())){entity.set_id(entity.get_id().replace("{","").replace("}",""));$v_0.append("<a:Id>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entity.get_id()));$v_0.appendLine("</a:Id>")}$v_0.append("<a:LogicalName>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entity.logicalName));$v_0.appendLine("</a:LogicalName>");$v_0.appendLine(Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.$q(entity.relatedEntities));if(!IsNull(skipRootNS))$v_0.appendLine("</a:Entity>");else $v_0.appendLine("</entity>");return $v_0.toString()};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.attributesToXml=function(entity,skipRootNS){var $v_0=new Sys.StringBuilder;$v_0.append("<a:Attributes");if(!IsNull(skipRootNS))$v_0.appendLine(">");else $v_0.appendLine(' xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">');var $$dict_7=entity.attributes;for(var $$key_8 in $$dict_7){var $v_1={key:$$key_8,value:$$dict_7[$$key_8]},$v_2=$v_1.key,$v_3=entity.attributes[$v_2];if(IsNull($v_3))continue;$v_0.appendLine("<a:KeyValuePairOfstringanyType>");$v_0.append("<b:key>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2));$v_0.appendLine("</b:key>");if(!($v_2 in entity.attributeTypes))throw Error.create(String.format("Cannot serialize attribute '{0}.{1}' because its type was not found in the AttributeTypes dictionary.",entity.logicalName,$v_2));$v_0.append('<b:value i:type="');$v_0.append(entity.attributeTypes[$v_2].toString());$v_0.append('" ');if(!_String.isNullOrEmpty(entity.attributeTypeNamespaces[$v_2])){$v_0.append('xmlns:c="');$v_0.append(entity.attributeTypeNamespaces[$v_2].toString());$v_0.append('"')}$v_0.append(">");var $v_4=entity.attributeTypes[$v_2];switch($v_4){case "a:EntityReference":$v_0.append(Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.toXml($v_3));break;case "a:EntityCollection":$v_0.append(Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.toXml($v_3,true));break;case "c:dateTime":$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.toCrmDateTimeString($v_3));break;case "c:boolean":$v_0.append($v_3.toString());break;case "c:int":$v_0.append($v_3.toString());break;case "c:guid":$v_0.append($v_3.toString().replace("{","").replace("}",""));break;case "a:Money":$v_0.append("<a:Value>");$v_0.append($v_3.toString());$v_0.append("</a:Value>");break;case "a:OptionSetValue":$v_0.append("<a:Value>");$v_0.append($v_3.toString());$v_0.append("</a:Value>");break;default:$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_3));break}$v_0.appendLine("</b:value>");$v_0.appendLine("</a:KeyValuePairOfstringanyType>")}$v_0.appendLine("</a:Attributes>");return $v_0.toString()};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$s=function($p0,$p1){if(!IsNull($p1))for(var $v_1=0;$v_1<$p1.length;$v_1++){var $v_2=$p1[$v_1];if(Type.isClass($v_2)&&$v_2.getBaseType()&&$v_2.getBaseType().getName()===Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.getName()){var $v_3=$v_2.entityLogicalName;if(!_String.isNullOrEmpty($v_3)&&$v_3===$p0)return new $v_2}}if(!Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$K){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$K={};var $v_4=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.getName(),$v_5=$v_4.substr(0,$v_4.lastIndexOf(".")),$v_6=Type.parse($v_5),$$dict_A=$v_6;for(var $$key_B in $$dict_A){var $v_7={key:$$key_B,value:$$dict_A[$$key_B]};if(Type.isClass($v_7.value)&&$v_7.value.getBaseType()&&$v_7.value.getBaseType().getName()===Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.getName()){var $v_8=$v_7.value.entityLogicalName;if(!_String.isNullOrEmpty($v_8))Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$K[$v_8]=$v_7.value}}}var $v_0=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$K[$p0];if(!IsNull($v_0))return new $v_0;else return new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity($p0)};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.loadFromXml=function(xmlNode,types){var $v_0=xmlNode.selectSingleNode("a:LogicalName");if(!$v_0)return null;var $v_1=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$s(xmlNode.selectSingleNode("a:LogicalName").get_innerText(),types),$v_2=xmlNode.selectNodes("a:Attributes/a:KeyValuePairOfstringanyType");$v_1.set_id(xmlNode.selectSingleNode("a:Id").get_innerText());for(var $v_5=0;$v_5<$v_2.get_count();$v_5++){var $v_6=$v_2.get_item($v_5).selectSingleNode("b:value"),$v_7=$v_2.get_item($v_5).selectSingleNode("b:key"),$v_8=$v_6.getAttribute("i:type"),$v_9=$v_6.getAttribute("xmlns:c");if($v_8==="a:AliasedValue"){$v_6=$v_6.selectSingleNode("a:Value");$v_8=$v_6.getAttribute("i:type");$v_9=$v_6.getAttribute("xmlns:c")}$v_1.attributeTypes[$v_7.get_innerText()]=$v_8;$v_1.attributeTypeNamespaces[$v_7.get_innerText()]=$v_9;switch($v_8){case "a:EntityReference":$v_1.attributes[$v_7.get_innerText()]=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.$V($v_6);break;case "c:dateTime":$v_1.attributes[$v_7.get_innerText()]=Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.fromCrmDateTimeString($v_6.get_innerText());break;case "c:int":case "a:OptionSetValue":if(!_String.isNullOrEmpty($v_6.get_innerText()))$v_1.attributes[$v_7.get_innerText()]=parseInt($v_6.get_innerText());break;case "c:boolean":if(!_String.isNullOrEmpty($v_6.get_innerText()))$v_1.attributes[$v_7.get_innerText()]=Boolean.parse($v_6.get_innerText());break;default:$v_1.attributes[$v_7.get_innerText()]=$v_6.get_innerText();break}}var $v_3=xmlNode.selectNodes("a:FormattedValues/a:KeyValuePairOfstringstring");if(!IsNull($v_3))for(var $v_A=0;$v_A<$v_3.get_count();$v_A++){var $v_B=$v_3.get_item($v_A).selectSingleNode("b:key"),$v_C=$v_3.get_item($v_A).selectSingleNode("b:value");if(!IsNull($v_B)&&!IsNull($v_C)&&!IsNull($v_B.get_innerText()))$v_1.formattedValues[$v_B.get_innerText()]=$v_C.get_innerText()}var $v_4=xmlNode.selectSingleNode("a:RelatedEntities");if($v_4)$v_1.relatedEntities=Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.$V($v_4,types);return $v_1};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype={$S_0:null,logicalName:null,attributes:null,attributeTypes:null,attributeTypeNamespaces:null,relatedEntities:null,formattedValues:null,get_id:function(){return this.$S_0},set_id:function(value){this.$S_0=value;return value},toTypedEntity:function(T){var $v_0=new T;$v_0.set_id(this.get_id());$v_0.attributes=this.attributes;$v_0.attributeTypes=this.attributeTypes;$v_0.attributeTypeNamespaces=this.attributeTypeNamespaces;$v_0.relatedEntities=this.relatedEntities;return $v_0},initMetadata:function(){},setAttribute:function(key,value,type){Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,key,type);this.attributes[key]=value}};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection=function(){this.$1_0=new Array(0)};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.createInstance=function(collection){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection;$v_0.$1_0=collection;return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.loadFromXml=function(entityCollectionNode,types){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection,$v_1=entityCollectionNode.selectSingleNode("a:EntityName");if(!$v_1)return $v_0;for(var $v_2=$v_1.get_innerText(),$v_3=entityCollectionNode.selectNodes("a:Entities/a:Entity"),$v_4=0;$v_4<$v_3.get_count();$v_4++){var $v_5=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.loadFromXml($v_3.get_item($v_4),types);$v_0.$1_0[$v_0.$1_0.length]=$v_5}return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.toXml=function(entities,skipRootNS){for(var $v_0="<a:Entities>",$$arr_3=entities.$1_0,$$len_4=$$arr_3.length,$$idx_5=0;$$idx_5<$$len_4;++$$idx_5){var $v_1=$$arr_3[$$idx_5];$v_0+=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.toXml($v_1,skipRootNS)}$v_0+="</a:Entities>";return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.prototype={$1_0:null,get_entities:function(){return this.$1_0},get_item:function(index){return this.$1_0[index]},set_item:function(index,value){this.$1_0[index]=value;return value},get_length:function(){return this.$1_0.length}};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata=function(logicalName){this.$h_0=logicalName};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata.$V=function($p0){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata($p0.selectSingleNode("c:LogicalName").get_innerText());$v_0.$f_0=$p0.selectSingleNode("c:DisplayName/a:UserLocalizedLabel/a:Label").get_innerText();$v_0.$i_0=$p0.selectSingleNode("c:DisplayCollectionName/a:UserLocalizedLabel/a:Label").get_innerText();return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata.prototype={$h_0:null,$f_0:null,$i_0:null,get_logicalName:function(){return this.$h_0},get_displayName:function(){return this.$f_0},get_pluralName:function(){return this.$i_0}};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference=function(){};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference=function(id,logicalName,name){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=id.replace("{","").replace("}","");$v_0.logicalName=logicalName;$v_0.name=name;return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.$V=function($p0){if(!$p0)return null;var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=$p0.selectSingleNode("a:Id").get_innerText();$v_0.logicalName=$p0.selectSingleNode("a:LogicalName").get_innerText();$v_0.name=$p0.selectSingleNode("a:Name").get_innerText();return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.toXml=function(entityReference){if(!entityReference)return "";var $v_0="<a:Id>"+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityReference.id)+"</a:Id>";$v_0+="<a:LogicalName>"+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityReference.logicalName)+"</a:LogicalName>";if(!_String.isNullOrEmpty(entityReference.name))$v_0+="<a:Name>"+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityReference.name)+"</a:Name>";else $v_0+='<a:Name i:nil="true" />';return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.prototype={id:null,logicalName:null,name:null};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection=function(){this.$1_0=new Array(0)};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection.loadFromXml=function(entityReferenceCollectionNode){for(var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection,$v_1=entityReferenceCollectionNode.selectNodes("//a:EntityReference"),$v_2=0;$v_2<$v_1.get_count();$v_2++){var $v_3=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.$V($v_1.get_item($v_2));$v_0.set_item($v_0.get_length(),$v_3)}return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection.prototype={$1_0:null,get_item:function(index){return this.$1_0[index]},set_item:function(index,value){this.$1_0[index]=value;return value},get_length:function(){return this.$1_0.length}};Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.initializeBase(this,["incident"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.prototype={get_id:function(){return this.get_incidentId()},set_id:function(value){this.set_incidentId(value);return value},get_incidentId:function(){return this.attributes["incidentid"]},set_incidentId:function(value){this.attributes["incidentid"]=value;return value},get_title:function(){return this.attributes["title"]},set_title:function(value){this.attributes["title"]=value;return value},get_caseNumber:function(){return this.attributes["ticketnumber"]},set_caseNumber:function(value){this.attributes["ticketnumber"]=value;return value},get_createdOn:function(){return this.attributes["createdon"]},set_createdOn:function(value){this.attributes["createdon"]=value;return value},get_formattedCreatedOn:function(){return this.formattedValues["createdon"]},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"incidentid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"title",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"ticketnumber",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"createdon",3)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities=function(){};Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.parseMruXml=function(xml,dataElementPath){var $v_0=Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.create(XUI.Xml.LoadXml(xml)),$v_1=new Array(0),$v_2=$v_0.selectNodes(dataElementPath);if(!IsNull($v_2))for(var $v_3=0;$v_3<$v_2.get_count();$v_3++){var $v_4=$v_2.get_item($v_3),$v_5=parseInt(Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"Type"),10),$v_6=Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"ObjectId");if(IsNull($v_6)||IsNull(Sales.Common.CrmSoapServiceProxy.Utils.Utils.tryParseGuid($v_6)))continue;var $v_7=new Xrm.Objects.RecentlyViewedItem;$v_7.displayName=Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"DisplayName");$v_7.title=Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"Title");$v_7.action=Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"Action");$v_7.iconPath=Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"IconPath");$v_7.entityTypeCode=Number.parseInvariant(Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"EntityTypeCode"));$v_7.lastAccessed=new Date(Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"LastAccessed"));$v_7.objectId=$v_6;$v_7.type=$v_5;$v_1[$v_1.length]=$v_7}$v_1.reverse();$v_1.sort(Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.lastAccessedComparer);return $v_1};Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.serializeMruXml=function(items){if(IsNull(items)||items.length<1)return null;for(var $v_0={},$v_1,$v_2=0;$v_2<items.length;$v_2++){var $v_3=items[$v_2].entityTypeCode,$v_4=items[$v_2].lastAccessed;if($v_4===_DateTime.empty){$v_4=_DateTime.get_now();$v_4.setHours($v_4.getHours()+$v_4.getTimezoneOffset()/60)}var $v_5=String.format("\r\n\t\t\t\t\t<RecentlyViewedItem>\r\n\t\t\t\t\t\t<Type>{1}</Type>\r\n\t\t\t\t\t\t<ObjectId>{2}</ObjectId>\r\n\t\t\t\t\t\t<EntityTypeCode>{0}</EntityTypeCode>\r\n\t\t\t\t\t\t<Title>{3}</Title>\r\n\t\t\t\t\t\t<LastAccessed>{4}</LastAccessed>\r\n\t\t\t\t\t\t<Action>{5}</Action>\r\n\t\t\t\t\t\t<PinStatus>{6}</PinStatus>\r\n\t\t\t\t\t</RecentlyViewedItem>",items[$v_2].entityTypeCode,0,Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(items[$v_2].objectId),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(items[$v_2].title),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_4.format("MM/dd/yyyy HH:mm:ss")),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(items[$v_2].action),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(items[$v_2].pinStatus.toString()==="1"?"true":"false"));if($v_3.toString() in $v_0){$v_1=$v_0[$v_3.toString()];$v_0[$v_3.toString()]=$v_1+$v_5}else $v_0[$v_3.toString()]=$v_5}$v_1="";var $$dict_8=$v_0;for(var $$key_9 in $$dict_8){var $v_6={key:$$key_9,value:$$dict_8[$$key_9]};$v_1+=String.format("<RecentlyViewedEntityData etc='{0}'>{1}</RecentlyViewedEntityData>",Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlAttributeEncode($v_6.key),$v_6.value)}return "<RecentlyViewedData>"+$v_1+"</RecentlyViewedData>"};Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.lastAccessedComparer=function(recordA,recordB){var $v_0=recordA,$v_1=recordB;return $v_1.lastAccessed-$v_0.lastAccessed};Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B=function($p0,$p1){var $v_0=$p0.selectSingleNode($p1);if(!IsNull($v_0))return $v_0.get_innerText();else return null};Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.initializeBase(this,["opportunity"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.prototype={get_id:function(){return this.get_opportunityId()},set_id:function(value){this.set_opportunityId(value);return value},get_opportunityId:function(){return this.attributes["opportunityid"]},set_opportunityId:function(value){this.attributes["opportunityid"]=value;return value},get_topic:function(){return this.attributes["name"]},set_topic:function(value){this.attributes["name"]=value;return value},get_estimatedValue:function(){return this.attributes["estimatedvalue"]},set_estimatedValue:function(value){this.attributes["estimatedvalue"]=value;return value},get_formattedEstimatedvalue:function(){return this.formattedValues["estimatedvalue"]},get_estimatedCloseDate:function(){return this.attributes["estimatedclosedate"]},set_estimatedCloseDate:function(value){this.attributes["estimatedclosedate"]=value;return value},get_formattedEstimatedCloseDate:function(){return this.formattedValues["estimatedclosedate"]},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"opportunityid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"name",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"estimatedvalue",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"estimatedclosedate",3)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection=function(){this.$L_0={}};Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.$V=function($p0,$p1){for(var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection,$v_1=$p0.selectNodes("*"),$v_2=0;$v_2<$v_1.get_count();$v_2++){if($v_1.get_item($v_2).get_tagName().indexOf("KeyValuePairOfRelationshipEntityCollection")<0)return $v_0;var $v_3=!IsNull($v_1.get_item($v_2).selectSingleNode("b:key/a:SchemaName"))?$v_1.get_item($v_2).selectSingleNode("b:key/a:SchemaName").get_innerText():null;if(!_String.isNullOrEmpty($v_3)){var $v_4=$v_1.get_item($v_2).selectSingleNode("b:value");if(!IsNull($v_4)){var $v_5=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.loadFromXml($v_4,$p1);$v_0.$L_0[$v_3]=$v_5}}}return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.$q=function($p0){var $v_0='<a:RelatedEntities xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">';$v_0+="</a:RelatedEntities>";return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.prototype={$L_0:null,get_item:function(key){return this.$L_0[key]},set_item:function(key,value){this.$L_0[key]=value;return value}};Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.initializeBase(this,["systemform"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.prototype={get_id:function(){return this.get_systemFormId()},set_id:function(value){this.set_systemFormId(value);return value},get_systemFormId:function(){return this.attributes["id"]},set_systemFormId:function(value){this.attributes["id"]=value;return value},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"id",2)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.initializeBase(this,["systemuser"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.prototype={get_firstName:function(){return this.attributes["firstname"]},get_lastName:function(){return this.attributes["lastname"]},get_fullName:function(){return this.attributes["fullname"]},get_internalEmailAddress:function(){return this.attributes["internalemailaddress"]},get_personalEmailAddress:function(){return this.attributes["personalemailaddress"]},get_id:function(){return this.get_systemUserId()},set_id:function(value){this.set_systemUserId(value);return value},get_systemUserId:function(){return this.attributes["systemuserid"]},set_systemUserId:function(value){this.attributes["systemuserid"]=value;return value},get_title:function(){return this.attributes["title"]},set_title:function(value){this.attributes["title"]=value;return value},get_yammerEmailAddress:function(){return this.attributes["yammeremailaddress"]},set_yammerEmailAddress:function(value){this.attributes["yammeremailaddress"]=value;return value},get_yammerUserId:function(){return this.attributes["yammeruserid"]},set_yammerUserId:function(value){this.attributes["yammeruserid"]=value;return value},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"systemuserid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"firstname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"lastname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"fullname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"internalemailaddress",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"personalemailaddress",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"title",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"yammeremailaddress",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"yammeruserid",0)}};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.Parser");Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode=function(){};Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode.registerInterface("Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode");Sales.Common.CrmSoapServiceProxy.Parser.IXmlNodeList=function(){};Sales.Common.CrmSoapServiceProxy.Parser.IXmlNodeList.registerInterface("Sales.Common.CrmSoapServiceProxy.Parser.IXmlNodeList");Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper=function($p0,$p1,$p2){this.$6_0=[];if(!IsNull($p1.length))for(var $v_0=$p1,$v_1=0;$v_1<$v_0.length;$v_1++)Array.add(this.$6_0,new Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper($p0,$v_0[$v_1],$p2));else for(var $v_2=$p1,$v_3=0;$v_3<$v_2.snapshotLength;$v_3++)Array.add(this.$6_0,new Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper($p0,$v_2.snapshotItem($v_3),$p2))};Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper.prototype={$6_0:null,get_count:function(){return this.$6_0.length},get_item:function($p0){return this.$6_0[$p0]}};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory=function(){};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.create=function(node){if(IsNull(node))return null;if(!Mscrm.CrmBrowser.get_currentBrowser().get_hasXPathEvaluator())return new Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper(node);else return new Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper(node)};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.parseXmlDocument=function(xml){var $v_0=null;if(Mscrm.Utilities.isIE9())for(var $v_1=["Microsoft.XMLDOM","Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"],$v_2=0;$v_2<$v_1.length;$v_2++){$v_0=new ActiveXObject($v_1[$v_2]);if(!IsNull($v_0)){$v_0.async=false;$v_0.resolveExternals=false;$v_0.loadXML(xml);$v_0.setProperty("SelectionLanguage","XPath");$v_0.setProperty("SelectionNamespaces","xmlns:d='http://schemas.microsoft.com/xrm/2011/Contracts/Services' xmlns:a='http://schemas.microsoft.com/xrm/2011/Contracts' xmlns:b='http://schemas.datacontract.org/2004/07/System.Collections.Generic' xmlns:i='http://www.w3.org/2001/XMLSchema-instance'");if(!_String.isNullOrEmpty($v_0.text))break}}if(IsNull($v_0))$v_0=Sys.Net.XMLDOM(xml);if(!IsNull($v_0)){var $v_3=Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.create($v_0),$v_4=$v_3.selectSingleNode("/parsererror");if(!IsNull($v_4)&&$v_4.get_tagName()==="parsererror")$v_0=null}return $v_0};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper=function($p0){var $v_0=$p0;this.$6_0=[];for(var $v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];Array.add(this.$6_0,new Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper($v_2,true))}};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper.prototype={$6_0:null,get_count:function(){return this.$6_0.length},get_item:function($p0){return this.$6_0[$p0]}};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper=function($p0,$p1){this.$9_0=$p0;this.$H_0=!IsNull($p1)&&$p1;this.$5_0=this.$H_0?null:{}};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper.prototype={$9_0:null,$5_0:null,$H_0:false,get_xmlElement:function(){return this.$9_0},get_element:function(){return this.$9_0},addNamespace:function($p0,$p1){if(!this.$H_0)this.$5_0[$p0]=$p1},selectSingleNode:function($p0){this.$m_0();var $v_0=this.$9_0.selectSingleNode($p0);return !$v_0?null:new Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper($v_0,true)},selectNodes:function($p0){this.$m_0();return new Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper(this.$9_0.selectNodes($p0))},get_innerText:function(){return this.$9_0.text},get_outerXml:function(){return this.$9_0.xml},getAttribute:function($p0){return this.get_xmlElement().getAttribute($p0)},getElementsByTagName:function($p0){return new Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper(this.get_element().getElementsByTagName($p0))},hasChildNodes:function(){return this.$9_0.hasChildNodes()},get_tagName:function(){return this.get_element().tagName},$m_0:function(){if(!this.$H_0){var $v_0=new Sys.StringBuilder,$v_1="",$$dict_3=this.$5_0;for(var $$key_4 in $$dict_3){var $v_2={key:$$key_4,value:$$dict_3[$$key_4]};$v_0.append(String.format("{0}xmlns:{1}='{2}'",$v_1,Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2.key),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2.value)));$v_1=" "}this.get_xmlElement().setProperty("SelectionLanguage","XPath");this.get_xmlElement().setProperty("SelectionNamespaces",$v_0.toString());this.$H_0=true}}};Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper=function($p0,$p1,$p2){this.$$d_$t_0=Function.createDelegate(this,this.$t_0);this.$F_0=$p0;this.$7_0=IsNull($p1)?$p0:$p1;this.$5_0=IsNull($p2)?{}:$p2};Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper.prototype={$5_0:null,$F_0:null,$7_0:null,addNamespace:function($p0,$p1){this.$5_0[$p0]=$p1},selectSingleNode:function($p0){var $v_0=this.$F_0.evaluate($p0,this.$7_0,this.$$d_$t_0,9,null);return IsNull($v_0.singleNodeValue)?null:new Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper(this.$F_0,$v_0.singleNodeValue,this.$5_0)},selectNodes:function($p0){return new Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper(this.$F_0,this.$F_0.evaluate($p0,this.$7_0,this.$$d_$t_0,7,null),this.$5_0)},get_innerText:function(){return this.$7_0.textContent},get_outerXml:function(){return (new XMLSerializer).serializeToString(this.$7_0)},getAttribute:function($p0){return this.$7_0.getAttribute($p0)},getElementsByTagName:function($p0){return new Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper(this.$F_0,this.$7_0.getElementsByTagName($p0),this.$5_0)},hasChildNodes:function(){return this.$7_0.hasChildNodes()},get_tagName:function(){return this.$7_0.tagName},$t_0:function($p0){if($p0 in this.$5_0)return this.$5_0[$p0];else return null}};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.Stubs");Sales.Common.CrmSoapServiceProxy.Stubs.XPathResultType=function(){};Sales.Common.CrmSoapServiceProxy.Stubs.XPathResultType.prototype={ANY_TYPE:0,NUMBER_TYPE:1,STRING_TYPE:2,BOOLEAN_TYPE:3,UNORDERED_NODE_ITERATOR_TYPE:4,ORDERED_NODE_ITERATOR_TYPE:5,UNORDERED_NODE_SNAPSHOT_TYPE:6,ORDERED_NODE_SNAPSHOT_TYPE:7,ANY_UNORDERED_NODE_TYPE:8,FIRST_ORDERED_NODE_TYPE:9};Sales.Common.CrmSoapServiceProxy.Stubs.XPathResultType.registerEnum("Sales.Common.CrmSoapServiceProxy.Stubs.XPathResultType",false);Mscrm.RemoteCommandJson.registerClass("Mscrm.RemoteCommandJson");Mscrm.InternalUtilities.Sdk.registerClass("Mscrm.InternalUtilities.Sdk");Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.registerClass("Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase");Sales.Common.CrmSoapServiceProxy.AttributeType.registerClass("Sales.Common.CrmSoapServiceProxy.AttributeType");Sales.Common.CrmSoapServiceProxy.MetadataHelper.registerClass("Sales.Common.CrmSoapServiceProxy.MetadataHelper");Sales.Common.CrmSoapServiceProxy.SoapParameter.registerClass("Sales.Common.CrmSoapServiceProxy.SoapParameter");Sales.Common.CrmSoapServiceProxy.BooleanParameter.registerClass("Sales.Common.CrmSoapServiceProxy.BooleanParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.registerClass("Sales.Common.CrmSoapServiceProxy.ColumnSetParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.EntityParameter.registerClass("Sales.Common.CrmSoapServiceProxy.EntityParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.registerClass("Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter.registerClass("Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter.registerClass("Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter.registerClass("Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.GuidParameter.registerClass("Sales.Common.CrmSoapServiceProxy.GuidParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.StringParameter.registerClass("Sales.Common.CrmSoapServiceProxy.StringParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.registerClass("Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.Utils.Utils.registerClass("Sales.Common.CrmSoapServiceProxy.Utils.Utils");Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.registerClass("Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils");Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.registerClass("Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils");Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.registerClass("Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault");Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.registerClass("Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes");Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse");Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse");Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.SchedulingNotification.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.SchedulingNotification");Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity");Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection");Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata",null,Sales.Common.CrmSoapServiceProxy.ObjectModel.IEntityMetadata);Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference");Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection");Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities");Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection");Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper.registerClass("Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper",null,Sales.Common.CrmSoapServiceProxy.Parser.IXmlNodeList);Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.registerClass("Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory");Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper.registerClass("Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper",null,Sales.Common.CrmSoapServiceProxy.Parser.IXmlNodeList);Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper.registerClass("Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper",null,Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode);Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper.registerClass("Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper",null,Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode);Mscrm.InternalUtilities.Sdk.$X=null;Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.$g=true;Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.soapExecuteAction="http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute";Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.timeout=1e4;Sales.Common.CrmSoapServiceProxy.AttributeType.string=0;Sales.Common.CrmSoapServiceProxy.AttributeType.integer=1;Sales.Common.CrmSoapServiceProxy.AttributeType.guid=2;Sales.Common.CrmSoapServiceProxy.AttributeType.dateTime=3;Sales.Common.CrmSoapServiceProxy.AttributeType.entityReference=4;Sales.Common.CrmSoapServiceProxy.AttributeType.entityCollection=5;Sales.Common.CrmSoapServiceProxy.AttributeType.optionSet=6;Sales.Common.CrmSoapServiceProxy.AttributeType.bool=7;Sales.Common.CrmSoapServiceProxy.AttributeType.decimal=8;Sales.Common.CrmSoapServiceProxy.AttributeType.doubleNumber=9;Sales.Common.CrmSoapServiceProxy.AttributeType.money=10;Sales.Common.CrmSoapServiceProxy.MetadataHelper.stringAttributeType="c:string";Sales.Common.CrmSoapServiceProxy.MetadataHelper.guidAttributeType="c:guid";Sales.Common.CrmSoapServiceProxy.MetadataHelper.entityReferenceAttributeType="a:EntityReference";Sales.Common.CrmSoapServiceProxy.MetadataHelper.dateTimeAttributeType="c:dateTime";Sales.Common.CrmSoapServiceProxy.MetadataHelper.intAttributeType="c:int";Sales.Common.CrmSoapServiceProxy.MetadataHelper.booleanAttributeType="c:boolean";Sales.Common.CrmSoapServiceProxy.MetadataHelper.decimalAttributeType="c:decimal";Sales.Common.CrmSoapServiceProxy.MetadataHelper.doubleAttributeType="c:double";Sales.Common.CrmSoapServiceProxy.MetadataHelper.aliasedValueAttributeType="a:AliasedValue";Sales.Common.CrmSoapServiceProxy.MetadataHelper.optionSetAttributeType="a:OptionSetValue";Sales.Common.CrmSoapServiceProxy.MetadataHelper.entityCollectionType="a:EntityCollection";Sales.Common.CrmSoapServiceProxy.MetadataHelper.moneyAttributeType="a:Money";Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$Q=new Date(0);Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$r=new RegExp("[Z,T]","ig");Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$k=new RegExp("[-]","ig");Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.objectDoesNotExist=-2147220969;Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.privilegeDenied=-2147220960;Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.unManagedIdsAccessDenied=-2147187962;Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.mustContainAtLeastACharInMention=-2147158364;Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.duplicateRecord=-2147220937;Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.isvAborted=-2147220891;Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.activityIdAttributeName="activityid";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.activityTypeCodeAttributeName="activitytypecode";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.dueDateAttributeName="scheduledend";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.priorityAttributeName="prioritycode";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.subjectAttributeName="subject";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.entityLogicalName="activitypointer";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.entityTypeCode=4200;Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.lastNameAttributeName="lastname";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.contactIdAttributeName="contactid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.emailAddress1AttributeName="emailaddress1";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.emailAddress2AttributeName="emailaddress2";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.emailAddress3AttributeName="emailaddress3";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.fullNameAttributeName="fullname";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.jobTitleAttributeName="jobtitle";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.parentCustomerIdAttributeName="parentcustomerid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.personIdAttributeName="personid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.transactionCurrencyIdAttributeName="transactioncurrencyid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.salesToDateAttributeName="salestodate";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.currentSalePipelineAttributeName="currentsalespipeline";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.openOpportunityCountAttributeName="openopportunitycount";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.emailSearchEmailAttributeName="emailsearch1.emailaddress";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.entityLogicalName="contact";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.entityTypeCode=2;Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.emailSearchIdAttributeName="emailsearchid";Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.emailAddressAttributeName="emailaddress";Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.parentObjectIdAttributeName="parentobjectid";Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.parentObjectTypeCodeAttributeName="parentobjecttypecode";Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.entityLogicalName="emailsearch";Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.entityTypeCode=4299;Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.entityLogicalName="entity";Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$K=null;Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.incidentIdAttributeName="incidentid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.titleAttributeName="title";Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.caseNumberAttributeName="ticketnumber";Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.createdOnAttributeName="createdon";Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.entityLogicalName="incident";Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.entityTypeCode=112;Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.opportunityIdAttributeName="opportunityid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.topicAttributeName="name";Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.estimatedValueAttributeName="estimatedvalue";Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.estimatedCloseDateAttributeName="estimatedclosedate";Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.entityLogicalName="opportunity";Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.entityTypeCode=3;Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.systemFormIdAttributeName="id";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.entityLogicalName="systemform";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.entityTypeCode=1030;Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.firstNameAttributeName="firstname";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.lastNameAttributeName="lastname";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.fullNameAttributeName="fullname";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.systemUserIdAttributeName="systemuserid";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.internalEmailAddressAttributeName="internalemailaddress";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.personalEmailAddressAttributeName="personalemailaddress";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.titleAttributeName="title";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.yammerEmailAddressAttributeName="yammeremailaddress";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.yammerUserIdAttributeName="yammeruserid";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.entityLogicalName="systemuser";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.entityTypeCode=8;Type.registerNamespace("ActivityFeeds.Services");ActivityFeeds.Services.IActivityFeedService=function(){};ActivityFeeds.Services.IActivityFeedService.registerInterface("ActivityFeeds.Services.IActivityFeedService");ActivityFeeds.Services.IFollowService=function(){};ActivityFeeds.Services.IFollowService.registerInterface("ActivityFeeds.Services.IFollowService");ActivityFeeds.Services.IYammerEmbed=function(){};ActivityFeeds.Services.IYammerEmbed.registerInterface("ActivityFeeds.Services.IYammerEmbed");ActivityFeeds.Services.ActivityFeedService=function(){};ActivityFeeds.Services.ActivityFeedService.$A=function(){var $v_0=new Array(0),$v_1=$P_CRM(".yammerEmbed");if(!IsNull($v_1)){var $v_2=$v_1.children("iframe");$v_2.each(function($p1_0,$p1_1){var $v_3=$p1_1;!IsNull($v_3.contentWindow)&&$v_0.push($v_3.contentWindow)})}return $v_0};ActivityFeeds.Services.ActivityFeedService.create=function($sn_window){var $v_0=$sn_window._activityFeedsStateDictionary,$v_1=new ActivityFeeds.Services.ActivityFeedService;if(IsNull($v_0))return $v_1;$v_1.$3_0=ActivityFeeds.Services.ActivityFeedService.$6($v_0["IsConfigured"]);$v_1.$2_0=ActivityFeeds.Services.ActivityFeedService.$6($v_0["IsFollowed"]);$v_1.$4_0=ActivityFeeds.Services.ActivityFeedService.$6($v_0["IsFollowedInYammer"]);return $v_1};ActivityFeeds.Services.ActivityFeedService.$6=function($p0){if(IsNull($p0))return false;var $v_0=$p0.toString();return $v_0==="True"||$v_0==="true"};ActivityFeeds.Services.ActivityFeedService.prototype={$2_0:false,$3_0:false,$4_0:false,get_isFollowed:function(){return this.$2_0},set_isFollowed:function(value){this.$2_0=value;return value},get_hasPostConfig:function(){return this.$3_0},set_hasPostConfig:function(value){this.$3_0=value;return value},get_isFollowedInYammer:function(){return this.$4_0},set_isFollowedInYammer:function(value){this.$4_0=value;return value},isFollowButtonEnabled:function(entityId,logicalName,followButton){if(followButton)return this.$3_0&&!this.$2_0;else return this.$2_0},refreshFormFollowEnabled:function(entityId,newIsFollowed){this.$2_0=this.$4_0=newIsFollowed;for(var $v_0=ActivityFeeds.Services.ActivityFeedService.$A(),$v_1=0;$v_1<$v_0.length;$v_1++)$v_0[$v_1].updatePageOnFollowUnfollow();Xrm.Page.ui.refreshRibbon()}};ActivityFeeds.Services.FollowService=function(){this.$0_0={}};ActivityFeeds.Services.FollowService.$8=function($p0){if(!ActivityFeeds.Services.FollowService.$1)if(Xrm.Page.context.client.getClient()!=="Outlook"){var $v_0=sessionStorage.getItem("EnabledGridStates");if(!_String.isNullOrEmpty($v_0))ActivityFeeds.Services.FollowService.$1=JSON.parse($v_0);else ActivityFeeds.Services.FollowService.$1={}}else ActivityFeeds.Services.FollowService.$1={};return ActivityFeeds.Services.FollowService.$1[$p0]};ActivityFeeds.Services.FollowService.$B=function($p0,$p1){ActivityFeeds.Services.FollowService.$1[$p0]=$p1;if(Xrm.Page.context.client.getClient()!=="Outlook")try{sessionStorage.setItem("EnabledGridStates",JSON.stringify(ActivityFeeds.Services.FollowService.$1))}catch($v_0){}};ActivityFeeds.Services.FollowService.normalizeEntityId=function(entityId){if(!entityId)return "";if(entityId.startsWith("{"))entityId=entityId.substr(1);if(entityId.endsWith("}"))entityId=entityId.substr(0,entityId.length-1);return entityId.toLowerCase()};ActivityFeeds.Services.FollowService.getGridEnabledFollow=function(logicalName,followEnabledStateCallback){var $v_0=ActivityFeeds.Services.FollowService.$8(logicalName);if($v_0!==undefined){followEnabledStateCallback($v_0);return}var $v_1=Xrm.Page.context.getClientUrl(),$v_2=encodeURI(String.format("{0}/xrmservices/2011/OrganizationData.svc/msdyn_PostConfigSet?$select=msdyn_EntityName,statecode&$filter=msdyn_EntityName eq '{1}'",$v_1,logicalName)),$v_3=new XMLHttpRequest;$v_3.open("GET",$v_2,true);$v_3.setRequestHeader("Accept","application/json");$v_3.onreadystatechange=function(){if($v_3.readyState!==4)return;var $v_4=new ActivityFeeds.Services.FollowEnabledState,$v_5=$v_3.responseText;$v_5=$v_5.split("\n").join("");$v_5=$v_5.split("\r").join("");if($v_5.indexOf(String.format('msdyn_EntityName": "{0}"',logicalName))>=0){var $v_6=$v_5.match(ActivityFeeds.Services.FollowService.$7);if($v_6&&$v_6.length===2)$v_4.enableFollow=$v_4.enableUnFollow=$v_6[1]==="0"}ActivityFeeds.Services.FollowService.$B(logicalName,$v_4);followEnabledStateCallback($v_4);$v_3.onreadystatechange=null};$v_3.send(null)};ActivityFeeds.Services.FollowService.$9=function($p0,$p1,$p2){ActivityFeeds.Services.FollowService.getGridEnabledFollow($p0,function($p1_0){if(!$p1_0.enableFollow){$p2($p1_0);return}var $v_0=Xrm.Page.context.getClientUrl(),$v_1=encodeURI(String.format("{0}",$p1)),$v_2=encodeURI(String.format("{0}",Xrm.Page.context.getUserId())),$v_3=String.format("{0}/xrmservices/2011/OrganizationData.svc/PostFollowSet?$select=OwnerId,PostFollowId,RegardingObjectId&$filter=RegardingObjectId/Id eq guid'{1}' and OwnerId/Id eq guid'{2}'",$v_0,$v_1,$v_2),$v_4=new XMLHttpRequest;$v_4.open("GET",$v_3,true);$v_4.setRequestHeader("Accept","application/json");$v_4.onreadystatechange=function(){if($v_4.readyState!==4)return;var $v_5=new ActivityFeeds.Services.FollowEnabledState;$v_5.enableUnFollow=$v_4.responseText.indexOf("PostFollowId")>0;$v_5.enableFollow=!$v_5.enableUnFollow;$p2($v_5);$v_4.onreadystatechange=null};$v_4.send(null)})};ActivityFeeds.Services.FollowService.prototype={isFollowButtonEnabled:function(entityId,logicalName,followButton){var $v_0=null,$v_1=null;$v_1=new Promise(function(_resolve,reject){$v_0=_resolve});entityId=ActivityFeeds.Services.FollowService.normalizeEntityId(entityId);if(this.$0_0[entityId]===undefined){this.$0_0[entityId]=new ActivityFeeds.Services.FollowEnabledState;this.$0_0[entityId].promise=$v_1;var $$t_7=this;ActivityFeeds.Services.FollowService.$9(logicalName,entityId,function($p1_0){$$t_7.$0_0[entityId]=$p1_0;$$t_7.$0_0[entityId].promise=null;$v_0(followButton?$$t_7.$0_0[entityId].enableFollow:$$t_7.$0_0[entityId].enableUnFollow)})}else{if(this.$0_0[entityId].promise){var $v_2=this;return this.$0_0[entityId].promise.then(function(){return followButton?$v_2.$0_0[entityId].enableFollow:$v_2.$0_0[entityId].enableUnFollow})}$v_0(followButton?this.$0_0[entityId].enableFollow:this.$0_0[entityId].enableUnFollow)}return $v_1},refreshFormFollowEnabled:function(entityId,newIsFollowed){entityId=ActivityFeeds.Services.FollowService.normalizeEntityId(entityId);this.$0_0[entityId]=new ActivityFeeds.Services.FollowEnabledState;this.$0_0[entityId].enableFollow=!newIsFollowed;this.$0_0[entityId].enableUnFollow=newIsFollowed}};ActivityFeeds.Services.FollowServiceFactory=function(){};ActivityFeeds.Services.FollowServiceFactory.getFollowService=function(){if(Xrm.Page.context.client.getClient()==="Mobile"||Xrm.Internal.isUci()){if(null===ActivityFeeds.Services.FollowServiceFactory.$5)ActivityFeeds.Services.FollowServiceFactory.$5=new ActivityFeeds.Services.FollowService;return ActivityFeeds.Services.FollowServiceFactory.$5}else return Xrm.Internal.getServiceDirectory().find(ActivityFeeds.Services.IFollowService)};ActivityFeeds.Services.FollowEnabledState=function(){};ActivityFeeds.Services.FollowEnabledState.prototype={enableFollow:false,enableUnFollow:false,inProgress:false,promise:null};function getLocalizedFileName(fileNameWithPath,userLcid,orgLcid){if(IsNull(fileNameWithPath))throw Error.argumentNull("fileNameWithPath");var $v_0=fileNameWithPath.match(new RegExp("[^/]*$"));if(!$v_0||!$v_0.length)throw Error.create("invalid fileNameWithPath format");$v_0=$v_0[0].match(new RegExp("^[^?]*"));if(!$v_0||!$v_0.length)throw Error.create("invalid fileNameWithPath format");var $v_1=$v_0[0],$v_2=$v_1.replace(".1033","");$v_0=$v_2.match(new RegExp("[^.]*$"));if(!$v_0||!$v_0.length)throw Error.create("invalid fileNameWithPath format");var $v_3=$v_0[0].toLowerCase();if($v_3!=="js"&&$v_3!=="htm"&&$v_3!=="html"&&$v_3!=="css")throw Error.create("invalid extension / file type is not supported");var $v_4=getFallbackLcid(userLcid,orgLcid);if(!($v_3==="js"&&$v_4===1033))$v_2=_String.insert($v_2,$v_2.lastIndexOf("."),String.format(".{0}",$v_4));return fileNameWithPath.replace($v_1,$v_2)}function loadLocalizedContent(url,globalContext,successCallback){var $v_0=new Sales.Common.Framework.Loaders.ContentLoader;$v_0.loadContent(getLocalizedFileName(url,globalContext.getUserLcid(),globalContext.getOrgLcid()),"html",successCallback)}function getInstalledLocales(){var $v_0=window._installedLocales;if(IsNull($v_0))return [1033];return $v_0}function getFallbackLcid(userLcid,orgLcid){var $v_0=getInstalledLocales();if(Array.contains($v_0,userLcid))return userLcid;if(Array.contains($v_0,orgLcid))return orgLcid;return 1033}ActivityFeeds.Services.ActivityFeedService.registerClass("ActivityFeeds.Services.ActivityFeedService",null,ActivityFeeds.Services.IActivityFeedService,ActivityFeeds.Services.IFollowService);ActivityFeeds.Services.FollowService.registerClass("ActivityFeeds.Services.FollowService",null,ActivityFeeds.Services.IFollowService);ActivityFeeds.Services.FollowServiceFactory.registerClass("ActivityFeeds.Services.FollowServiceFactory");ActivityFeeds.Services.FollowEnabledState.registerClass("ActivityFeeds.Services.FollowEnabledState");ActivityFeeds.Services.FollowService.$1=null;ActivityFeeds.Services.FollowService.$7=new RegExp("statecode.*?Value.*(\\d+)","i");ActivityFeeds.Services.FollowServiceFactory.$5=null</script><script id="/{636878706300003032}/webresources/msdyn_/installedlocales.js?ver=1888157098" type="text/javascript">//TODO: this file should be generated as part of build process

// AFTER EVERY UPDATE:
// bump up version number in script tag with latest value of window.top.VERSION_STAMP for: msdyn_/PersonalWall.htm , msdyn_/RecordWall.htm , msdyn_/FollowDialog.1033.htm

window._installedLocales = [1033, 1025, 1026, 1027, 1028, 1029, 1030, 1031, 1032, 1035, 1036, 1037, 1038, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1048, 1049, 1050, 1051, 1053, 1054, 1055, 1057, 1058, 1060, 1061, 1062, 1063, 1066, 1069, 1081, 1086, 1087, 1110, 2052, 2070, 2074, 3076, 3082, 3098];
</script><script id="/{636878706300003032}/webresources/msdyn_/follow.command.js?ver=1888157098" type="text/javascript">Type.registerNamespace('Sales.Common.Framework');

function __Type() {
}
__Type.hasField = function __Type$hasField(instance, name) {
    return !IsNull(instance[name]);
}
__Type.hasMethod = function __Type$hasMethod(instance, name) {
    return typeof(instance[name]) === 'function';
}
__Type.hasProperty = function __Type$hasProperty(instance, name) {
    return !IsNull(instance['get_' + name]());
}


Type.registerNamespace('Follow');

Follow.FollowEnableYammerCheck = function Follow_FollowEnableYammerCheck() {
}
Follow.FollowEnableYammerCheck.shouldEnableFollow = function Follow_FollowEnableYammerCheck$shouldEnableFollow(primaryEntityCode, selectedEntityCode) {
    try {
        if (Xrm.Internal.isUci() && Xrm.Utility.getGlobalContext().client.getClientState() === 'Offline') {
            return false;
        }
        if (Xrm.Page.context.client.getClient() !== 'Mobile') {
            if (!window.YAMMER_IS_INSTALLED || !window.YAMMER_IS_CONFIGURED_FOR_ORG) {
                return true;
            }
            if (Mscrm.CrmBrowser.get_currentBrowser().get_isMobileSafari()) {
                return false;
            }
        }
        else {
            if (!Follow.FollowEnableYammerCheck.$N() || !Follow.FollowEnableYammerCheck.$M(Xrm.Page.context.getOrgUniqueName())) {
                return true;
            }
        }
        if (selectedEntityCode !== 8 && !primaryEntityCode) {
            return true;
        }
        if (!selectedEntityCode && primaryEntityCode !== 8) {
            return true;
        }
        if (Xrm.Page.context.client.getClient() !== 'Mobile') {
            if (!window.YAMMER_IS_CONFIGURED_FOR_USER) {
                return false;
            }
        }
        else {
            return Follow.FollowEnableYammerCheck.$B(Xrm.Page.context.getUserId());
        }
        if (primaryEntityCode === 8) {
            if (Xrm.Page.context.client.getClient() !== 'Mobile') {
                return window.YAMMER_IS_CONFIGURED_FOR_TARGET_USER;
            }
            else {
                return Follow.FollowEnableYammerCheck.$B(Xrm.Page.data.entity.getId());
            }
        }
        return true;
    }
    catch ($v_0) {
        console.log('Exception occurred in ShouldEnableFollow: {0}', $v_0.toString());
        return false;
    }
}
Follow.FollowEnableYammerCheck.$B = function Follow_FollowEnableYammerCheck$$B($p0) {
    return Follow.FollowEnableYammerCheck.$8($p0, 3);
}
Follow.FollowEnableYammerCheck.$M = function Follow_FollowEnableYammerCheck$$M($p0) {
    return Follow.FollowEnableYammerCheck.$8($p0, 1);
}
Follow.FollowEnableYammerCheck.$N = function Follow_FollowEnableYammerCheck$$N() {
    return Follow.FollowEnableYammerCheck.$8('ActivityFeedsCore', 2);
}
Follow.FollowEnableYammerCheck.$8 = function Follow_FollowEnableYammerCheck$$8($p0, $p1) {
    var $v_0 = ActivityFeeds.Services.FollowServiceFactory.getFollowService();
    var $v_1 = '';
    var $v_2 = '';
    switch ($p1) {
        case 1:
            $v_1 = 'YammerNetworkPermalink';
            $v_2 = '{0}/XRMServices/2011/OrganizationData.svc/OrganizationSet?$select=YammerNetworkPermalink&$filter=(YammerNetworkPermalink ne null and Name eq \'{1}\')';
            break;
        case 2:
            $v_1 = 'SolutionId';
            $v_2 = '{0}/XRMServices/2011/OrganizationData.svc/SolutionSet?$select=SolutionId&$filter=(UniqueName eq \'{1}\')';
            break;
        case 3:
            $v_1 = 'YammerEmailAddress';
            $v_2 = '{0}/XRMServices/2011/OrganizationData.svc/SystemUserSet(guid\'{1}\')?$select=YammerEmailAddress&$filter=(YammerEmailAddress ne null)';
            break;
        default:
            return false;
    }
    if (!(($p0) in Follow.FollowEnableYammerCheck.$4)) {
        Follow.FollowEnableYammerCheck.$4[$p0] = new ActivityFeeds.Services.FollowEnabledState();
        (Follow.FollowEnableYammerCheck.$4[$p0]).inProgress = true;
        Follow.FollowEnableYammerCheck.$L($p0, $v_2, function($p1_0) {
            var $v_3 = new ActivityFeeds.Services.FollowEnabledState();
            $v_3.enableUnFollow = $p1_0.indexOf($v_1) > 0;
            $v_3.enableFollow = $v_3.enableUnFollow;
            Follow.FollowEnableYammerCheck.$4[$p0] = $v_3;
        });
    }
    else {
        if ((Follow.FollowEnableYammerCheck.$4[$p0]).inProgress) {
            return false;
        }
        return (Follow.FollowEnableYammerCheck.$4[$p0]).enableFollow;
    }
    return false;
}
Follow.FollowEnableYammerCheck.$L = function Follow_FollowEnableYammerCheck$$L($p0, $p1, $p2) {
    var $v_0 = Xrm.Page.context.getClientUrl();
    var $v_1 = String.format($p1, $v_0, encodeURI(String.format('{0}', $p0)));
    var $v_2 = new XMLHttpRequest();
    $v_2.open('GET', $v_1, true);
    $v_2.setRequestHeader('Accept', 'application/json');
    $v_2.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
    $v_2.onreadystatechange = function() {
        if ($v_2.readyState !== 4) {
            return;
        }
        $p2($v_2.responseText);
        $v_2.onreadystatechange = null;
    };
    $v_2.send(null);
}


Follow.FollowCommands = function Follow_FollowCommands(dialogArguments, gridControl) {
    this.$$d_$I_0 = Function.createDelegate(this, this.$I_0);
    this.$2_0 = dialogArguments;
    this.$3_0 = gridControl;
    this.$6_0 = Xrm.Page.context;
}
Follow.FollowCommands.dummy = function Follow_FollowCommands$dummy() {
    return true;
}
Follow.FollowCommands.followFromGrid = function Follow_FollowCommands$followFromGrid(gridControl, selectedRecords, entityTypeCode) {
    Follow.FollowCommands.$1 = null;
    var $v_0 = {};
    $v_0['selectedRecords'] = selectedRecords;
    $v_0['entityTypeCode'] = entityTypeCode;
    $v_0['action'] = 'follow';
    Follow.FollowCommands.$1 = new Follow.FollowCommands($v_0, gridControl);
    Follow.FollowCommands.$1.execute();
    Follow.FollowCommands.$1 = null;
}
Follow.FollowCommands.unfollowFromGrid = function Follow_FollowCommands$unfollowFromGrid(gridControl, selectedRecords, entityTypeCode) {
    Follow.FollowCommands.$1 = null;
    var $v_0 = {};
    $v_0['selectedRecords'] = selectedRecords;
    $v_0['entityTypeCode'] = entityTypeCode;
    $v_0['action'] = 'unfollow';
    Follow.FollowCommands.$1 = new Follow.FollowCommands($v_0, gridControl);
    Follow.FollowCommands.$1.execute();
    Follow.FollowCommands.$1 = null;
}
Follow.FollowCommands.followFromForm = function Follow_FollowCommands$followFromForm(selectedRecordId, entityLogicalName, entityTypeCode) {
    Follow.FollowCommands.$1 = null;
    var $v_0 = {};
    $v_0['selectedRecords'] = Follow.FollowCommands.$E(selectedRecordId, entityLogicalName);
    $v_0['entityTypeCode'] = entityTypeCode;
    $v_0['action'] = 'follow';
    $v_0['formAction'] = true;
    $v_0['window'] = window.self;
    Follow.FollowCommands.$1 = new Follow.FollowCommands($v_0, null);
    Follow.FollowCommands.$1.execute();
    Follow.FollowCommands.$1 = null;
}
Follow.FollowCommands.unfollowFromForm = function Follow_FollowCommands$unfollowFromForm(selectedRecordId, entityLogicalName, entityTypeCode) {
    Follow.FollowCommands.$1 = null;
    var $v_0 = {};
    $v_0['selectedRecords'] = Follow.FollowCommands.$E(selectedRecordId, entityLogicalName);
    $v_0['entityTypeCode'] = entityTypeCode;
    $v_0['action'] = 'unfollow';
    $v_0['formAction'] = true;
    $v_0['window'] = window.self;
    Follow.FollowCommands.$1 = new Follow.FollowCommands($v_0, null);
    Follow.FollowCommands.$1.execute();
    Follow.FollowCommands.$1 = null;
}
Follow.FollowCommands.$E = function Follow_FollowCommands$$E($p0, $p1) {
    var $v_0 = new Array(1);
    $v_0[0] = {};
    $v_0[0].Id = $p0;
    $v_0[0].TypeName = $p1;
    return $v_0;
}
Follow.FollowCommands.$D = function Follow_FollowCommands$$D($p0) {
    if (!Follow.FollowCommands.isNullOrUndefined($p0) && Xrm.Page.context.client.getClient() === 'Mobile') {
        ($p0).refresh();
    }
}
Follow.FollowCommands.$9 = function Follow_FollowCommands$$9($p0) {
    var $v_0 = Xrm.Page.context.getClientUrl();
    var $v_1 = new RegExp('\"code\":\\s\"(-?\\d+)\"', 'im');
    var $v_2 = $p0.match($v_1);
    if ($v_2 && $v_2.length >= 2) {
        var $v_3 = parseInt($v_2[1]);
        if ($v_3 === -2147220937 || $v_3 === -2147220969) {
            return;
        }
        if (Xrm.Internal.isUci()) {
            var $v_4 = {};
            $v_4.errorCode = $v_3;
            $v_4.message = '';
            $v_4.details = '';
            Xrm.Navigation.openErrorDialog($v_4);
        }
        else {
            Xrm.Internal.openErrorDialog($v_3, '', '');
        }
    }
}
Follow.FollowCommands.isNullOrUndefined = function Follow_FollowCommands$isNullOrUndefined(obj) {
    return !obj || typeof(obj) === 'undefined';
}
Follow.FollowCommands.$K = function Follow_FollowCommands$$K() {
    var $v_0 = window._installedLocales;
    if (!$v_0 || $v_0 === 'undefined') {
        return [ 1033 ];
    }
    return $v_0;
}
Follow.FollowCommands.getFallbackLcid = function Follow_FollowCommands$getFallbackLcid(userLcid, orgLcid) {
    var $v_0 = Follow.FollowCommands.$K();
    for (var $v_1 = 0; $v_1 < $v_0.length; $v_1++) {
        if ($v_0[$v_1] === userLcid) {
            return userLcid;
        }
    }
    for (var $v_2 = 0; $v_2 < $v_0.length; $v_2++) {
        if ($v_0[$v_2] === orgLcid) {
            return orgLcid;
        }
    }
    return 1033;
}
Follow.FollowCommands.$C = function Follow_FollowCommands$$C($p0, $p1, $p2) {
    var $v_0 = ActivityFeeds.Services.FollowServiceFactory.getFollowService();
    if (IsNull($v_0)) {
        Xrm.Internal.trace.warning('ActivityFeeds.FollowEnabled', 'Can\'t refresh follow/unfollow in ribbon - IActivityFeedService is unavailable');
        return;
    }
    $v_0.refreshFormFollowEnabled($p0, $p2);
}
Follow.FollowCommands.prototype = {
    $2_0: null,
    $3_0: null,
    $6_0: null,
    
    $A_0: function Follow_FollowCommands$$A_0($p0, $p1) {
        var $v_0 = $p0.Id;
        var $v_1 = $p0.TypeName;
        if (Follow.FollowCommands.isNullOrUndefined($v_1)) {
            $v_1 = Xrm.Internal.getEntityName($p0.TypeCode);
        }
        switch ($p1) {
            case 'follow':
                this.$H_0($v_0, $v_1);
                break;
            case 'unfollow':
                this.$J_0($v_0, $v_1);
                break;
        }
    },
    
    execute: function Follow_FollowCommands$execute() {
        if (!this.$2_0 || !this.$2_0['action']) {
            return;
        }
        var $v_0 = this.$2_0['selectedRecords'];
        var $v_1 = !Follow.FollowCommands.isNullOrUndefined(this.$2_0['formAction']) && this.$2_0['formAction'];
        var $v_2 = this.$2_0['action'];
        if ($v_0.length === 1 && $v_1) {
            this.$A_0($v_0[0], $v_2);
        }
        else if ($v_0.length === 1 && !$v_1 && Xrm.Internal.isUci()) {
            var $v_3 = {};
            if ($v_2 === 'follow') {
                $v_3.title = ActivityFeeds.Resources.ActivityFeedsUI.confirmFollowTitleBold;
                $v_3.text = ActivityFeeds.Resources.ActivityFeedsUI.confirmFollowMessageSingular;
            }
            else if ($v_2 === 'unfollow') {
                $v_3.title = ActivityFeeds.Resources.ActivityFeedsUI.confirmUnfollowTitleBold;
                $v_3.text = ActivityFeeds.Resources.ActivityFeedsUI.confirmUnfollowMessageSingular;
            }
            var $$t_A = this;
            Xrm.Navigation.openConfirmDialog($v_3, null).then(function($p1_0) {
                if ($p1_0.confirmed) {
                    $v_2 = $$t_A.$2_0['action'];
                    $v_0 = $$t_A.$2_0['selectedRecords'];
                    $$t_A.$A_0($v_0[0], $v_2);
                }
            }, null);
        }
        else {
            var $v_4 = Follow.FollowCommands.getFallbackLcid(this.$6_0.getUserLcid(), this.$6_0.getOrgLcid());
            var $v_5 = String.format('FollowDialog.{0}.htm', $v_4);
            var $v_6 = String.format('{0}/WebResources/msdyn_/{1}', this.$6_0.getClientUrl(), $v_5);
            var $v_7 = new Xrm.DialogOptions();
            $v_7.width = 450;
            $v_7.height = 300;
            var $v_8 = this.$$d_$I_0;
            Xrm.Internal.openDialog($v_6, $v_7, this.$2_0, null, $v_8);
        }
    },
    
    $I_0: function Follow_FollowCommands$$I_0($p0) {
        if ($p0 && $p0 === -1) {
            return;
        }
        if (this.$3_0) {
            this.$3_0.refresh();
        }
    },
    
    $H_0: function Follow_FollowCommands$$H_0($p0, $p1) {
        var $v_0 = Xrm.Page.context.getClientUrl();
        var $v_1 = String.format('\'Id\': \'{0}\', \'LogicalName\': \'{1}\'', $p0, $p1);
        var $v_2 = '{\'RegardingObjectId\': {' + $v_1 + '}}';
        var $v_3 = String.format('{0}/xrmservices/2011/OrganizationData.svc/PostFollowSet', $v_0);
        var $v_4 = new XMLHttpRequest();
        $v_4.open('POST', $v_3, true);
        $v_4.setRequestHeader('Accept', 'application/json');
        $v_4.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
        var $$t_8 = this;
        $v_4.onreadystatechange = function() {
            if ($v_4.readyState !== 4) {
                return;
            }
            var $v_5 = $v_4.responseText;
            if ($v_5.indexOf('\"error\"') > 0) {
                Follow.FollowCommands.$9($v_5);
            }
            else {
                Follow.FollowCommands.$C($p0, $p1, true);
                Follow.FollowCommands.$D($$t_8.$3_0);
                $$t_8.refreshRibbonForUCI('follow');
            }
        };
        $v_4.send($v_2);
    },
    
    $J_0: function Follow_FollowCommands$$J_0($p0, $p1) {
        var $v_0 = Xrm.Page.context.getClientUrl();
        var $v_1 = String.format('{0}/xrmservices/2011/OrganizationData.svc/PostFollowSet?$select=PostFollowId&$filter=RegardingObjectId/Id eq guid\'{1}\' and OwnerId/Id eq guid\'{2}\'', $v_0, $p0, Xrm.Page.context.getUserId());
        var $v_2 = new XMLHttpRequest();
        $v_2.open('GET', $v_1, true);
        $v_2.setRequestHeader('Accept', 'application/json');
        $v_2.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
        var $$t_8 = this;
        $v_2.onreadystatechange = function() {
            if ($v_2.readyState !== 4) {
                return;
            }
            var $v_3 = new RegExp('\"PostFollowId\":\\s\"(-?.*)\"', 'im');
            var $v_4 = $v_2.responseText.match($v_3);
            if ($v_4 && $v_4.length >= 2) {
                var $v_5 = $v_4[1];
                $$t_8.$R_0($v_5, $p0, $p1);
            }
        };
        $v_2.send(null);
    },
    
    $R_0: function Follow_FollowCommands$$R_0($p0, $p1, $p2) {
        var $v_0 = Xrm.Page.context.getClientUrl();
        var $v_1 = String.format('{0}/xrmservices/2011/OrganizationData.svc/PostFollowSet(guid\'{1}\')', $v_0, $p0);
        var $v_2 = new XMLHttpRequest();
        $v_2.open('POST', $v_1, true);
        $v_2.setRequestHeader('Accept', 'application/json');
        $v_2.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
        $v_2.setRequestHeader('X-HTTP-Method', 'DELETE');
        var $$t_7 = this;
        $v_2.onreadystatechange = function() {
            if ($v_2.readyState !== 4) {
                return;
            }
            var $v_3 = $v_2.responseText;
            if ($v_3.indexOf('\"error\"') > 0) {
                Follow.FollowCommands.$9($v_3);
            }
            else {
                Follow.FollowCommands.$C($p1, $p2, false);
                Follow.FollowCommands.$D($$t_7.$3_0);
                $$t_7.refreshRibbonForUCI('unfollow');
            }
        };
        $v_2.send(null);
    },
    
    refreshRibbonForUCI: function Follow_FollowCommands$refreshRibbonForUCI(actionType) {
        if (Xrm.Internal.isUci()) {
            if (IsNull(this.$3_0)) {
                Xrm.Page.ui.refreshRibbon();
            }
        }
    }
}


Follow.FollowEnabled = function Follow_FollowEnabled() {
}
Follow.FollowEnabled.preCreateRows = function Follow_FollowEnabled$preCreateRows(gridControl) {
    if (Follow.FollowEnabled.$7) {
        Follow.FollowEnabled.retrieveAllActivityFeedEnabledEntities(gridControl);
        Follow.FollowEnabled.$7 = false;
    }
    return true;
}
Follow.FollowEnabled.dummy = function Follow_FollowEnabled$dummy() {
    return true;
}
Follow.FollowEnabled.$Q = function Follow_FollowEnabled$$Q() {
    var $v_0 = !Follow.FollowEnabled.$5 && !IsNull(ActivityFeeds.Resources);
    return $v_0;
}
Follow.FollowEnabled.loadResources = function Follow_FollowEnabled$loadResources() {
    if (!Follow.FollowEnabled.$Q()) {
        var $v_0 = Sales.Common.CrmSoapServiceProxy.Utils.Utils.getContextFromXrmPage();
        var $v_1 = $v_0.getClientUrl();
        loadLocalizedContent($v_1 + '/WebResources/msdyn_/ActivityFeeds.Resources.js', $v_0, function($p1_0) {
            eval($p1_0);
            Follow.FollowEnabled.$5 = false;
        });
    }
    return true;
}
Follow.FollowEnabled.$O = function Follow_FollowEnabled$$O() {
    if (IsNull(ActivityFeeds.Resources) && !Follow.FollowEnabled.$5) {
        Follow.FollowEnabled.$5 = true;
        var $v_0 = Sales.Common.CrmSoapServiceProxy.Utils.Utils.getContextFromXrmPage();
        var $v_1 = $v_0.getClientUrl();
        var $v_2 = Follow.FollowCommands.getFallbackLcid($v_0.getUserLcid(), $v_0.getOrgLcid());
        var $v_3 = $v_1 + '/WebResources/msdyn_/ActivityFeeds.Resources.js';
        var $v_4 = getLocalizedFileName($v_3, $v_0.getUserLcid(), $v_0.getOrgLcid());
        var $v_5 = new XMLHttpRequest();
        $v_5.open('GET', $v_4, true);
        $v_5.setRequestHeader('Accept', 'application/json');
        $v_5.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
        $v_5.onreadystatechange = function() {
            if ($v_5.readyState !== 4) {
                return;
            }
            var $v_6 = $v_5.responseText;
            eval($v_6);
            Follow.FollowEnabled.$5 = false;
        };
        $v_5.send(null);
    }
}
Follow.FollowEnabled.isMultiRecordFollowAllowed = function Follow_FollowEnabled$isMultiRecordFollowAllowed(gridControl, records) {
    try {
        var $v_0 = false;
        if (Xrm.Internal.isUci()) {
            if (Xrm.Utility.getGlobalContext().client.getClientState() === 'Offline') {
                return false;
            }
            if (records.length === 1) {
                Follow.FollowEnabled.$O();
                $v_0 = true;
            }
        }
        else {
            $v_0 = true;
        }
        return $v_0;
    }
    catch ($v_1) {
        console.log('Exception occurred in IsMultiRecordFollowAllowed: {0}', $v_1.toString());
        return false;
    }
}
Follow.FollowEnabled.activateDeactivateOverride = function Follow_FollowEnabled$activateDeactivateOverride(gridControl, records, otc, activate) {
    if (activate) {
        Mscrm.GridRibbonActions.activate(gridControl, records, otc, function() {
            if (records.length === 1) {
                alert(ActivityFeeds.Resources.ActivityFeedsUI.postConfigurationPublishChangesNotificationGrid);
            }
            else {
                alert(ActivityFeeds.Resources.ActivityFeedsUI.postConfigurationPublishChangesNotificationGridPlural);
            }
        });
    }
    else {
        Mscrm.GridRibbonActions.deactivate(gridControl, records, otc, -1, function() {
            if (records.length === 1) {
                alert(ActivityFeeds.Resources.ActivityFeedsUI.postConfigurationPublishChangesNotificationGrid);
            }
            else {
                alert(ActivityFeeds.Resources.ActivityFeedsUI.postConfigurationPublishChangesNotificationGridPlural);
            }
        });
    }
}
Follow.FollowEnabled.retrieveAllActivityFeedEnabledEntities = function Follow_FollowEnabled$retrieveAllActivityFeedEnabledEntities(gridControl) {
    var $v_0 = Xrm.Page.context.getClientUrl();
    var $v_1 = String.format('{0}/xrmservices/2011/OrganizationData.svc/msdyn_PostRuleConfigSet?$select=msdyn_name&$filter=msdyn_name eq \'{1}\'', $v_0, CrmEncodeDecode.CrmUrlEncode('5EF5871D-FE40-4EB9-9952-39B0AC611895'));
    var $v_2 = new XMLHttpRequest();
    $v_2.open('GET', $v_1, true);
    $v_2.setRequestHeader('Accept', 'application/json');
    $v_2.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
    $v_2.onreadystatechange = function() {
        if ($v_2.readyState !== 4) {
            return;
        }
        var $v_3 = $v_2.responseText;
        if ($v_3.indexOf('\"error\"') === -1) {
            if (__Type.hasMethod(gridControl, 'refresh')) {
                gridControl.refresh();
            }
        }
        $v_2.onreadystatechange = null;
    };
    $v_2.send(null);
    if (__Type.hasMethod(gridControl, 'ShowLoadingMessage')) {
        gridControl.ShowLoadingMessage();
    }
}
Follow.FollowEnabled.isEntityWallEnabled = function Follow_FollowEnabled$isEntityWallEnabled(selectedControl, logicalName, followButton) {
    try {
        if (Xrm.Internal.isUci() && Xrm.Utility.getGlobalContext().client.getClientState() === 'Offline') {
            return false;
        }
        if (IsNull(selectedControl)) {
            return false;
        }
        var $v_0 = null;
        var $v_1 = null;
        $v_1 = new Promise(function(_resolve, reject) { $v_0 = _resolve; });
        if (Follow.FollowEnabled.$0[logicalName] === undefined) {
            Follow.FollowEnabled.$0[logicalName] = new ActivityFeeds.Services.FollowEnabledState();
            (Follow.FollowEnabled.$0[logicalName]).promise = $v_1;
            (Follow.FollowEnabled.$0[logicalName]).inProgress = true;
            ActivityFeeds.Services.FollowService.getGridEnabledFollow(logicalName, function($p1_0) {
                Follow.FollowEnabled.$0[logicalName] = $p1_0;
                (Follow.FollowEnabled.$0[logicalName]).promise = null;
                (Follow.FollowEnabled.$0[logicalName]).inProgress = false;
                try {
                    if (Xrm.Internal.isUci()) {
                        $v_0((followButton) ? (Follow.FollowEnabled.$0[logicalName]).enableFollow : (Follow.FollowEnabled.$0[logicalName]).enableUnFollow);
                    }
                    else {
                        window.refreshRibbon();
                    }
                }
                catch ($v_2) {
                    if (Xrm.Internal.isUci()) {
                        $v_0(false);
                    }
                    console.log('Exception occurred in RefreshRibbon {0}', $v_2.toString());
                }
            });
        }
        else {
            if (Xrm.Internal.isUci()) {
                if ((Follow.FollowEnabled.$0[logicalName]).promise) {
                    return (Follow.FollowEnabled.$0[logicalName]).promise.then(function() { return (followButton) ? (Follow.FollowEnabled.$0[logicalName]).enableFollow : (Follow.FollowEnabled.$0[logicalName]).enableUnFollow; });
                }
                $v_0((followButton) ? (Follow.FollowEnabled.$0[logicalName]).enableFollow : (Follow.FollowEnabled.$0[logicalName]).enableUnFollow);
            }
            else {
                if ((Follow.FollowEnabled.$0[logicalName]).inProgress) {
                    return false;
                }
                return (followButton) ? (Follow.FollowEnabled.$0[logicalName]).enableFollow : (Follow.FollowEnabled.$0[logicalName]).enableUnFollow;
            }
        }
        if (Xrm.Internal.isUci()) {
            return $v_1;
        }
        else {
            return false;
        }
    }
    catch ($v_3) {
        console.log('Exception occurred in IsEntityWallEnabled: {0}', $v_3.toString());
        return false;
    }
}
Follow.FollowEnabled.isFollowButtonEnabled = function Follow_FollowEnabled$isFollowButtonEnabled(entityId, logicalName, followButton) {
    try {
        if (Xrm.Internal.isUci() && Xrm.Utility.getGlobalContext().client.getClientState() === 'Offline') {
            return false;
        }
        var $v_0 = ActivityFeeds.Services.FollowServiceFactory.getFollowService();
        return $v_0.isFollowButtonEnabled(entityId, logicalName, followButton);
    }
    catch ($v_1) {
        console.log('Exception occurred in IsFollowButtonEnabled: {0}', $v_1.toString());
        return false;
    }
}


Follow.YammerHelper = function Follow_YammerHelper() {
}
Follow.YammerHelper.get_isYammerConfiguredForOrganization = function Follow_YammerHelper$get_isYammerConfiguredForOrganization() {
    return window.YAMMER_IS_CONFIGURED_FOR_ORG;
}


__Type.registerClass('__Type');
Follow.FollowEnableYammerCheck.registerClass('Follow.FollowEnableYammerCheck');
Follow.FollowCommands.registerClass('Follow.FollowCommands');
Follow.FollowEnabled.registerClass('Follow.FollowEnabled');
Follow.YammerHelper.registerClass('Follow.YammerHelper');
Follow.FollowEnableYammerCheck.$4 = {};
Follow.FollowCommands.$1 = null;
Follow.FollowEnabled.$0 = {};
Follow.FollowEnabled.$5 = false;
Follow.FollowEnabled.$7 = true;
//@ sourceMappingURL=file:///d:/dbs/sh/dccm2/0227_160625/cmd/14/Target/retail/amd64/.srcmap
</script><script id="/{636878706300003032}/webresources/msdyn_/scripts/platformscriptloader.js?ver=1888157098" type="text/javascript">if (Xrm.Page.context.client.getClient() != Xrm.Constants.ClientNames.Mobile && !Xrm.Internal.isUci()) {
Mscrm.CrmHeader.get_scriptLoader().addIncludeExternalSync(null, '/_static/_common/scripts/jquery-2.1.1.min.js?ver=' + CrmEncodeDecode.CrmUrlEncode(window.top.VERSION_STAMP));
Mscrm.CrmHeader.get_scriptLoader().addIncludeExternalSync(null, '/_static/_common/scripts/jquery.tmpl.min.js?ver=' + CrmEncodeDecode.CrmUrlEncode(window.top.VERSION_STAMP));
Mscrm.CrmHeader.get_scriptLoader().addIncludeExternalSync(null, '/_static/_common/scripts/SalesCommonImported.js?ver=' + CrmEncodeDecode.CrmUrlEncode(window.top.VERSION_STAMP));
Mscrm.CrmHeader.get_scriptLoader().addIncludeExternalSync(null, '/_static/_common/scripts/SalesCommonFramework.js?ver=' + CrmEncodeDecode.CrmUrlEncode(window.top.VERSION_STAMP));
Mscrm.CrmHeader.get_scriptLoader().addIncludeExternalSync(null, '/_static/_common/scripts/CrmInternalUtility.js?ver=' + CrmEncodeDecode.CrmUrlEncode(window.top.VERSION_STAMP));
Mscrm.CrmHeader.get_scriptLoader().addIncludeExternalSync(null, '/_static/_common/scripts/SalesCrmSoapProxyService.js?ver=' + CrmEncodeDecode.CrmUrlEncode(window.top.VERSION_STAMP));
Mscrm.CrmHeader.get_scriptLoader().addIncludeExternalSync(null, '/_static/_common/scripts/Wall.Interfaces.js?ver=' + CrmEncodeDecode.CrmUrlEncode(window.top.VERSION_STAMP));
Mscrm.CrmHeader.get_scriptLoader().addIncludeExternalSync(null, '/_static/_common/scripts/Wall.Control.js?ver=' + CrmEncodeDecode.CrmUrlEncode(window.top.VERSION_STAMP));
}</script><script id="/_static/_common/scripts/jquery.tmpl.min.js?ver=1888157098" type="text/javascript">
(function(a)
{
    var r = a.fn.domManip,
        d = "_tmplitem",
        q = /^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,
        b = {},
        f = {},
        e,
        p = {key:0,data:{}},
        i = 0,
        c = 0,
        l = [];
    function g(g,d,h,e)
    {
        var c = {data:e || (e === 0 || e === false) ? e : d ? d.data : {},_wrap:d ? d._wrap : null,tmpl:null,parent:d || null,nodes:[],calls:u,nest:w,wrap:x,html:v,update:t};
        g && a.extend(c,g,{nodes:[],parent:d});
        if(h)
        {
            c.tmpl = h;
            c._ctnt = c._ctnt || c.tmpl(a,c);
            c.key = ++i;
            (l.length ? f : b)[i] = c
        }
        return c
    }
    a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(f,d)
    {
        a.fn[f] = function(n)
        {
            var g = [],
                i = a(n),
                k,
                h,
                m,
                l,
                j = this.length === 1 && this[0].parentNode;
            e = b || {};
            if(j && j.nodeType === 11 && j.childNodes.length === 1 && i.length === 1)
            {
                i[d](this[0]);
                g = this
            }
            else
            {
                for(h = 0, m = i.length; h < m; h++)
                {
                    c = h;
                    k = (h > 0 ? this.clone(true) : this).get();
                    a(i[h])[d](k);
                    g = g.concat(k)
                }
                c = 0;
                g = this.pushStack(g,f,i.selector)
            }
            l = e;
            e = null;
            a.tmpl.complete(l);
            return g
        }
    });
    a.fn.extend({tmpl:function(d,c,b)
    {
        return a.tmpl(this[0],d,c,b)
    },tmplItem:function()
    {
        return a.tmplItem(this[0])
    },template:function(b)
    {
        return a.template(b,this[0])
    },domManip:function(d,m,k)
    {
        if(d[0] && a.isArray(d[0]))
        {
            var g = a.makeArray(arguments),
                h = d[0],
                j = h.length,
                i = 0,
                f;
            while(i < j && !(f = a.data(h[i++],"tmplItem")));
            if(f && c)
                g[2] = function(b)
                {
                    a.tmpl.afterManip(this,b,k)
                };
            r.apply(this,g)
        }
        else
            r.apply(this,arguments);
        c = 0;
        !e && a.tmpl.complete(b);
        return this
    }});
    a.extend({tmpl:function(d,h,e,c)
    {
        var i,
            k = !c;
        if(k)
        {
            c = p;
            d = a.template[d] || a.template(null,d);
            f = {}
        }
        else
            if(!d)
            {
                d = c.tmpl;
                b[c.key] = c;
                c.nodes = [];
                c.wrapped && n(c,c.wrapped);
                return a(j(c,null,c.tmpl(a,c)))
            }
        if(!d)
            return [];
        if(typeof h === "function")
            h = h.call(c || {});
        e && e.wrapped && n(e,e.wrapped);
        i = a.isArray(h) ? a.map(h,function(a)
        {
            return a ? g(e,c,d,a) : null
        }) : [g(e,c,d,h)];
        return k ? a(j(c,null,i)) : i
    },tmplItem:function(b)
    {
        var c;
        if(b instanceof a)
            b = b[0];
        while(b && b.nodeType === 1 && !(c = a.data(b,"tmplItem")) && (b = b.parentNode));
        return c || p
    },template:function(c,b)
    {
        if(b)
        {
            if(typeof b === "string")
                b = o(b);
            else
                if(b instanceof a)
                    b = b[0] || {};
            if(b.nodeType)
                b = a.data(b,"tmpl") || a.data(b,"tmpl",o(b.innerHTML));
            return typeof c === "string" ? (a.template[c] = b) : b
        }
        return c ? typeof c !== "string" ? a.template(null,c) : a.template[c] || a.template(null,q.test(c) ? c : a(c)) : null
    },encode:function(a)
    {
        return ("" + a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")
    }});
    a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function()
    {
        b = {}
    },afterManip:function(f,b,d)
    {
        var e = b.nodeType === 11 ? a.makeArray(b.childNodes) : b.nodeType === 1 ? [b] : [];
        d.call(f,b);
        m(e);
        c++
    }});
    function j(e,g,f)
    {
        var b,
            c = f ? a.map(f,function(a)
            {
                return typeof a === "string" ? e.key ? a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 " + d + '="' + e.key + '" $2') : a : j(a,e,a._ctnt)
            }) : e;
        if(g)
            return c;
        c = c.join("");
        c.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(f,c,e,d)
        {
            b = a(e).get();
            m(b);
            if(c)
                b = k(c).concat(b);
            if(d)
                b = b.concat(k(d))
        });
        return b ? b : k(c)
    }
    function k(c)
    {
        var b = document.createElement("div");
        b.innerHTML = c;
        return a.makeArray(b.childNodes)
    }
    function o(b)
    {
        return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('" + a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(m,l,k,g,b,c,d)
        {
            var j = a.tmpl.tag[k],
                i,
                e,
                f;
            if(!j)
                throw"Unknown template tag: " + k;
            i = j._default || [];
            if(c && !/\w$/.test(b))
            {
                b += c;
                c = ""
            }
            if(b)
            {
                b = h(b);
                d = d ? "," + h(d) + ")" : c ? ")" : "";
                e = c ? b.indexOf(".") > -1 ? b + h(c) : "(" + b + ").call($item" + d : b;
                f = c ? e : "(typeof(" + b + ")==='function'?(" + b + ").call($item):(" + b + "))"
            }
            else
                f = e = i.$1 || "null";
            g = h(g);
            return "');" + j[l ? "close" : "open"].split("$notnull_1").join(b ? "typeof(" + b + ")!=='undefined' && (" + b + ")!=null" : "true").split("$1a").join(f).split("$1").join(e).split("$2").join(g || i.$2 || "") + "__.push('"
        }) + "');}return __;")
    }
    function n(c,b)
    {
        c._wrap = j(c,true,a.isArray(b) ? b : [q.test(b) ? b : a(b).html()]).join("")
    }
    function h(a)
    {
        return a ? a.replace(/\\'/g,"'").replace(/\\\\/g,"\\") : null
    }
    function s(b)
    {
        var a = document.createElement("div");
        a.appendChild(b.cloneNode(true));
        return a.innerHTML
    }
    function m(o)
    {
        var n = "_" + c,
            k,
            j,
            l = {},
            e,
            p,
            h;
        for(e = 0, p = o.length; e < p; e++)
        {
            if((k = o[e]).nodeType !== 1)
                continue;
            j = k.getElementsByTagName("*");
            for(h = j.length - 1; h >= 0; h--)
                m(j[h]);
            m(k)
        }
        function m(j)
        {
            var p,
                h = j,
                k,
                e,
                m;
            if(m = j.getAttribute(d))
            {
                while(h.parentNode && (h = h.parentNode).nodeType === 1 && !(p = h.getAttribute(d)));
                if(p !== m)
                {
                    h = h.parentNode ? h.nodeType === 11 ? 0 : h.getAttribute(d) || 0 : 0;
                    if(!(e = b[m]))
                    {
                        e = f[m];
                        e = g(e,b[h] || f[h]);
                        e.key = ++i;
                        b[i] = e
                    }
                    c && o(m)
                }
                j.removeAttribute(d)
            }
            else
                if(c && (e = a.data(j,"tmplItem")))
                {
                    o(e.key);
                    b[e.key] = e;
                    h = a.data(j.parentNode,"tmplItem");
                    h = h ? h.key : 0
                }
            if(e)
            {
                k = e;
                while(k && k.key != h)
                {
                    k.nodes.push(j);
                    k = k.parent
                }
                delete e._ctnt;
                delete e._wrap;
                a.data(j,"tmplItem",e)
            }
            function o(a)
            {
                a = a + n;
                e = l[a] = l[a] || g(e,b[e.parent.key + n] || e.parent)
            }
        }
    }
    function u(a,d,c,b)
    {
        if(!a)
            return l.pop();
        l.push({_:a,tmpl:d,item:this,data:c,options:b})
    }
    function w(d,c,b)
    {
        return a.tmpl(a.template(d),c,b,this)
    }
    function x(b,d)
    {
        var c = b.options || {};
        c.wrapped = d;
        return a.tmpl(a.template(b.tmpl),b.data,c,b.item)
    }
    function v(d,c)
    {
        var b = this._wrap;
        return a.map(a(a.isArray(b) ? b.join("") : b).filter(d || "*"),function(a)
        {
            return c ? a.innerText || a.textContent : a.outerHTML || s(a)
        })
    }
    function t()
    {
        var b = this.nodes;
        a.tmpl(null,null,null,this).insertBefore(b[0]);
        a(b).remove()
    }
})(jQuery)
</script><script id="/_static/_common/scripts/salescommonimported.js?ver=1888157098" type="text/javascript">Type.registerNamespace("Sales.Common.Imported");Sales.Common.Imported.XPathResultType=function(){};Sales.Common.Imported.XPathResultType.prototype={ANY_TYPE:0,NUMBER_TYPE:1,STRING_TYPE:2,BOOLEAN_TYPE:3,UNORDERED_NODE_ITERATOR_TYPE:4,ORDERED_NODE_ITERATOR_TYPE:5,UNORDERED_NODE_SNAPSHOT_TYPE:6,ORDERED_NODE_SNAPSHOT_TYPE:7,ANY_UNORDERED_NODE_TYPE:8,FIRST_ORDERED_NODE_TYPE:9};Sales.Common.Imported.XPathResultType.registerEnum("Sales.Common.Imported.XPathResultType",false)</script><script id="/_static/_common/scripts/salescommonframework.js?ver=1888157098" type="text/javascript">Type.registerNamespace('Mscrm');

Mscrm.IDeferredDataProcessingControl = function() {}
Mscrm.IDeferredDataProcessingControl.registerInterface('Mscrm.IDeferredDataProcessingControl');


Type.registerNamespace('Sales.Common.Framework');

Sales.Common.Framework.IList$1 = function() {}
Sales.Common.Framework.IList$1.$$ = function(T) {
    var $$cn = 'IList$1' + '$' + T.getName().replace(/\./g, '_');
    if (!Sales.Common.Framework[$$cn]) {
        var $$ccr = Sales.Common.Framework[$$cn] = function() {
        };
        $$ccr.registerInterface('Sales.Common.Framework.' + $$cn);
    }
    return Sales.Common.Framework[$$cn];
}
Sales.Common.Framework.IList$1.registerInterface('Sales.Common.Framework.IList$1');


Sales.Common.Framework.List$1 = function(items) {
    this.$0_0 = items || new Array(0);
}
Sales.Common.Framework.List$1.$$ = function(T) {
    var $$cn = 'List$1' + '$' + T.getName().replace(/\./g, '_');
    if (!Sales.Common.Framework[$$cn]) {
        var $$ccr = Sales.Common.Framework[$$cn] = function() {
            (this.$$gta = this.$$gta || {})['Sales.Common.Framework.List$1'] = {'T': T};
            var $v_0 = [];
            for (var $v_1 = 0; $v_1 < arguments.length; ++$v_1) {
                $v_0[$v_1] = arguments[$v_1];
            }
            Sales.Common.Framework.List$1.apply(this, $v_0);
        };
        $$ccr.registerClass('Sales.Common.Framework.' + $$cn, null, Sales.Common.Framework.IList$1.$$(T));
        var $$dict_5 = Sales.Common.Framework.List$1.prototype;
        for (var $$key_6 in $$dict_5) {
            var $$entry_7 = { key: $$key_6, value: $$dict_5[$$key_6] };
            if ('constructor' !== $$entry_7.key) {
                $$ccr.prototype[$$entry_7.key] = $$entry_7.value;
            }
        }
    }
    return Sales.Common.Framework[$$cn];
}
Sales.Common.Framework.List$1.prototype = {
    $0_0: null,
    
    get_items: function() {
        return this.$0_0;
    },
    
    get_count: function() {
        return this.$0_0.length;
    },
    
    get_item: function(index) {
        return this.$0_0[index];
    },
    
    set_item: function(index, value) {
        this.$0_0[index] = value;
        return value;
    },
    
    add: function(item) {
        Array.add(this.$0_0, item);
    },
    
    addRange: function(items) {
        Array.addRange(this.$0_0, items);
    },
    
    clear: function() {
        Array.clear(this.$0_0);
    },
    
    contains: function(item) {
        return Array.contains(this.$0_0, item);
    },
    
    indexOf: function(item, startIndex) {
        startIndex = startIndex || 0;
        return Array.indexOf(this.$0_0, item, startIndex);
    },
    
    insert: function(index, item) {
        Array.insert(this.$0_0, index, item);
    },
    
    remove: function(item) {
        Array.remove(this.$0_0, item);
    },
    
    removeAt: function(index) {
        Array.removeAt(this.$0_0, index);
    },
    
    filter: function(callback) {
        return new (Sales.Common.Framework.List$1.$$(this.$$gta['Sales.Common.Framework.List$1']['T']))(_Array.filter(this.$$gta['Sales.Common.Framework.List$1']['T'], this.$0_0, callback));
    },
    
    toArray: function() {
        var $v_0 = new Array(this.$0_0.length);
        for (var $v_1 = 0; $v_1 < this.$0_0.length; $v_1++) {
            $v_0[$v_1] = this.$0_0[$v_1];
        }
        return $v_0;
    },
    
    first: function() {
        if (!this.$0_0.length) {
            throw Error.invalidOperation('List contains no elements.');
        }
        return this.$0_0[0];
    },
    
    last: function() {
        if (!this.$0_0.length) {
            throw Error.invalidOperation('List contains no elements.');
        }
        return this.$0_0[this.get_count() - 1];
    }
}


Sales.Common.Framework.JsTypes = function() {
}
Sales.Common.Framework.JsTypes.isNull = function($p0) {
    return typeof($p0) === 'undefined' || typeof($p0) === 'unknown' || $p0 == null;
}


function parseQueryString(windowLocation) {
    if (Sales.Common.Framework.JsTypes.isNull(windowLocation) || Sales.Common.Framework.JsTypes.isNull(windowLocation.search) || !windowLocation.search.length) {
        return {};
    }
    var $v_0 = windowLocation.search.substr(1);
    return parseQueryStringValue($v_0);
}
function parseHashString(windowLocation) {
    if (Sales.Common.Framework.JsTypes.isNull(windowLocation)) {
        return {};
    }
    var $v_0 = Mscrm.CrmCrossBrowser.getHash(windowLocation);
    return parseQueryStringValue($v_0);
}
function parseQueryStringValue(queryStringValue) {
    if (Sales.Common.Framework.JsTypes.isNull(queryStringValue) || !queryStringValue.length) {
        return {};
    }
    var $v_0 = {};
    var $v_1 = queryStringValue.split('&');
    for (var $v_2 = 0; $v_2 < $v_1.length; $v_2++) {
        var $v_3 = $v_1[$v_2].split('=');
        $v_0[$v_3[0].toLowerCase()] = CrmEncodeDecode.CrmUrlDecode($v_3[1]);
    }
    return $v_0;
}
function createEncodedQueryString(parameters) {
    var $v_0 = '';
    var $$dict_5 = parameters;
    for (var $$key_6 in $$dict_5) {
        var $v_1 = { key: $$key_6, value: $$dict_5[$$key_6] };
        var $v_2 = $v_1.key;
        var $v_3 = CrmEncodeDecode.CrmUrlEncode($v_1.value);
        $v_0 += String.format('{0}={1}&', $v_2, $v_3);
    }
    return $v_0.substr(0, $v_0.length - 1);
}


function _Array() {
}
_Array.mapArray = function(T, array, callback) {
    if (Sales.Common.Framework.JsTypes.isNull(array)) {
        return new Array(0);
    }
    var $v_0 = new Array(array.length);
    for (var $v_1 = 0; $v_1 < array.length; $v_1++) {
        $v_0[$v_1] = callback(array[$v_1]);
    }
    return $v_0;
}
_Array.map = function(T, array, callback) {
    return _Array.mapArray(T, array, callback);
}
_Array.each = function(T, array, callback) {
    for (var $v_0 = 0; $v_0 < array.length; $v_0++) {
        callback($v_0, array[$v_0]);
    }
}
_Array.filterArray = function(array, callback) {
    if (Sales.Common.Framework.JsTypes.isNull(array)) {
        return [];
    }
    var $v_0 = [];
    for (var $v_1 = 0; $v_1 < array.length; $v_1++) {
        if (callback(array[$v_1])) {
            $v_0[$v_0.length] = array[$v_1];
        }
    }
    return $v_0;
}
_Array.filter = function(T, array, callback) {
    return _Array.filterArray(array, callback);
}
_Array.insertRange = function(array, index, arrayToInsert) {
    if (Sales.Common.Framework.JsTypes.isNull(array)) {
        throw Error.argumentNull('array');
    }
    if (Sales.Common.Framework.JsTypes.isNull(arrayToInsert)) {
        return array;
    }
    if (!index) {
        array.unshift.apply(array, arrayToInsert);
    }
    else {
        for (var $v_0 = 0; $v_0 < array.length; $v_0++) {
            array.splice(index + $v_0, 0, arrayToInsert[$v_0]);
        }
    }
    return array;
}
_Array.removeDuplicatesFromArrayList = function(list) {
    return _Array.removeDuplicates(Object, list);
}
_Array.removeDuplicates = function(T, objects) {
    if (Sales.Common.Framework.JsTypes.isNull(objects)) {
        return new Array(0);
    }
    var $v_0 = [];
    for (var $v_1 = 0; $v_1 < objects.length; $v_1++) {
        if (!Array.contains($v_0, objects[$v_1])) {
            Array.add($v_0, objects[$v_1]);
        }
    }
    return $v_0;
}
_Array.removeRangeFromArray = function(array, index, count) {
    if (Sales.Common.Framework.JsTypes.isNull(array)) {
        return array;
    }
    return array.splice(index, count);
}
_Array.removeRange = function(T, objects, index, count) {
    return _Array.removeRangeFromArray(objects, index, count);
}


function _DateTime() {
}
_DateTime.get_now = function() {
    return new Date();
}


function _Dictionary() {
}
_Dictionary.count = function(dictionary) {
    var $v_0 = 0;
    var $$dict_3 = dictionary;
    for (var $$key_4 in $$dict_3) {
        var $v_1 = { key: $$key_4, value: $$dict_3[$$key_4] };
        $v_0++;
    }
    return $v_0;
}
_Dictionary.keys = function(dictionary) {
    var $v_0 = new Array(0);
    var $$dict_3 = dictionary;
    for (var $$key_4 in $$dict_3) {
        var $v_1 = { key: $$key_4, value: $$dict_3[$$key_4] };
        $v_0[$v_0.length] = $v_1.key;
    }
    return $v_0;
}
_Dictionary.toArray = function(T, dictionary) {
    var $v_0 = new Array(_Dictionary.count(dictionary));
    var $v_1 = 0;
    var $$dict_5 = dictionary;
    for (var $$key_6 in $$dict_5) {
        var $v_2 = { key: $$key_6, value: $$dict_5[$$key_6] };
        $v_0[$v_1] = $v_2.value;
        $v_1++;
    }
    return $v_0;
}


function _Event() {
}
_Event.fireEvent = function(T, _events, eventName, sender, args) {
    if (!_events) {
        return;
    }
    var $v_0 = _events.getHandler(eventName);
    if ($v_0) {
        $v_0(sender, args);
    }
}


function _Nullable$1(value) {
    this.$2_0 = ((this.$$gta['_Nullable$1']['T'] === Number || Type.isEnum(this.$$gta['_Nullable$1']['T'])) ? 0 : (this.$$gta['_Nullable$1']['T'] === Boolean) ? false : null);
    this.$2_0 = value;
}
_Nullable$1.$$ = function(T) {
    var $$cn = '_Nullable$1' + '$' + T.getName().replace(/\./g, '_');
    if (!window[$$cn]) {
        var $$ccr = window[$$cn] = function() {
            (this.$$gta = this.$$gta || {})['_Nullable$1'] = {'T': T};
            var $v_0 = [];
            for (var $v_1 = 0; $v_1 < arguments.length; ++$v_1) {
                $v_0[$v_1] = arguments[$v_1];
            }
            _Nullable$1.apply(this, $v_0);
        };
        $$ccr.registerClass($$cn);
        var $$dict_5 = _Nullable$1.prototype;
        for (var $$key_6 in $$dict_5) {
            var $$entry_7 = { key: $$key_6, value: $$dict_5[$$key_6] };
            if ('constructor' !== $$entry_7.key) {
                $$ccr.prototype[$$entry_7.key] = $$entry_7.value;
            }
        }
    }
    return window[$$cn];
}
_Nullable$1.prototype = {
    
    get_hasValue: function() {
        return Sales.Common.Framework.JsTypes.isNull(this.$2_0);
    },
    
    get_value: function() {
        return this.$2_0;
    }
}


function _RegularExpression() {
}
_RegularExpression.parse = function(s) {
    if (s.startsWith('/')) {
        var $v_0 = s.lastIndexOf('/');
        if ($v_0 > 1) {
            var $v_1 = s.substring(1, $v_0);
            var $v_2 = s.substr($v_0 + 1);
            return new RegExp($v_1, $v_2);
        }
    }
    return null;
}


function _String() {
}
_String.isNullOrEmpty = function(value) {
    return (null === value) || _String.isUndefined(value) || value === '';
}
_String.isNullOrWhiteSpace = function(value) {
    return _String.isNullOrEmpty(value) || value.trim() === '';
}
_String.hashCode = function(value) {
    var $v_0 = 0;
    for (var $v_1 = 0; $v_1 < value.length; ++$v_1) {
        var $v_2 = value.charCodeAt($v_1);
        $v_0 = (($v_0 << 5) - $v_0) + $v_2;
        $v_0 = $v_0 & $v_0;
    }
    return $v_0;
}
_String.join = function(separator, values) {
    return values.join(separator);
}
_String.isUndefined = function(value) {
    return value === undefined;
}
_String.format = function(format, arg0, arg1, arg2, arg3, arg4, arg5) {
    if (_String.isUndefined(arg0) && _String.isUndefined(arg1) && _String.isUndefined(arg2) && _String.isUndefined(arg3) && _String.isUndefined(arg4) && _String.isUndefined(arg5)) {
        return format;
    }
    return String.format(format, arg0, arg1, arg2, arg3, arg4, arg5);
}
_String.replaceNewlineWithEnding = function(text, ending) {
    if (_String.isNullOrEmpty(text)) {
        return '';
    }
    var $v_0 = new Sys.StringBuilder();
    var $v_1 = text.split(_String.$4);
    for (var $v_2 = 0; $v_2 < $v_1.length; $v_2++) {
        if (!_String.isNullOrWhiteSpace($v_1[$v_2])) {
            $v_0.append($v_1[$v_2]);
            $v_0.append(ending);
        }
    }
    return $v_0.toString();
}
_String.normalizeNewLine = function(text, ending) {
    if (_String.isNullOrEmpty(text)) {
        return '';
    }
    var $v_0 = _String.$7(_String.$5, text, ending);
    return _String.$7(_String.$6, $v_0, ending);
}
_String.$7 = function($p0, $p1, $p2) {
    var $v_0 = new Sys.StringBuilder();
    var $v_1 = $p1.split($p0);
    for (var $v_2 = 0; $v_2 < $v_1.length; $v_2++) {
        $v_0.append($v_1[$v_2]);
        if ($v_2 !== $v_1.length - 1) {
            $v_0.append($p2);
        }
    }
    return $v_0.toString();
}
_String.replaceAll = function(text, patternText, replaceText) {
    var $v_0 = text;
    while ($v_0.indexOf(patternText) >= 0) {
        $v_0 = $v_0.replace(patternText, replaceText);
    }
    return $v_0;
}
_String.replaceFirst = function(text, patternText, replaceText) {
    var $v_0 = text;
    var $v_1 = text.indexOf(patternText);
    if ($v_1 >= 0) {
        $v_0 = _String.remove($v_0, $v_1, patternText.length);
        $v_0 = _String.insert($v_0, $v_1, replaceText);
    }
    return $v_0;
}
_String.remove = function(text, index, count) {
    if (_String.isNullOrEmpty(text)) {
        return '';
    }
    if (Sales.Common.Framework.JsTypes.isNull(count) || index + count > text.length) {
        return text.substr(0, index);
    }
    return text.substr(0, index) + text.substr(index + count);
}
_String.indexOfAny = function(text, chars, startIndex, count) {
    if (Sales.Common.Framework.JsTypes.isNull(text)) {
        return -1;
    }
    if (Sales.Common.Framework.JsTypes.isNull(chars)) {
        return -1;
    }
    var $v_0 = text.length;
    if ($v_0 <= 0) {
        return -1;
    }
    startIndex = (Sales.Common.Framework.JsTypes.isNull(startIndex)) ? 0 : startIndex;
    count = (Sales.Common.Framework.JsTypes.isNull(count)) ? 0 : count;
    var $v_1 = startIndex + count - 1;
    if ($v_1 >= $v_0) {
        $v_1 = $v_0 - 1;
    }
    for (var $v_2 = startIndex; $v_2 <= $v_1; $v_2++) {
        if (chars.indexOf(text.charAt($v_2)) >= 0) {
            return $v_2;
        }
    }
    return -1;
}
_String.insert = function(text, index, value) {
    if (_String.isNullOrEmpty(value)) {
        return text;
    }
    if (Sales.Common.Framework.JsTypes.isNull(index)) {
        return value + text;
    }
    var $v_0 = text.substr(0, index);
    var $v_1 = text.substr(index);
    return $v_0 + value + $v_1;
}


function _Type() {
}
_Type.hasField = function(instance, name) {
    return !Sales.Common.Framework.JsTypes.isNull(instance[name]);
}
_Type.getField = function(instance, name) {
    return instance[name];
}
_Type.hasMethod = function(instance, name) {
    return typeof(instance[name]) === 'function';
}
_Type.hasProperty = function(instance, name) {
    return !Sales.Common.Framework.JsTypes.isNull(instance['get_' + name]);
}


Type.registerNamespace('Sales.Common.Framework.Loaders');

Sales.Common.Framework.Loaders.ConcurrentContentLoaderData = function() {
    this.$$d_setError = Function.createDelegate(this, this.setError);
    this.$$d_setResult = Function.createDelegate(this, this.setResult);
    this.loadContentCallbacks = new Array(0);
    this.errorCallbacks = new Array(0);
}
Sales.Common.Framework.Loaders.ConcurrentContentLoaderData.prototype = {
    loadContentInProgress: false,
    error: false,
    content: null,
    
    setResult: function($p0) {
        if (!this.loadContentInProgress) {
            throw Error.invalidOperation('Invalid request state');
        }
        this.loadContentInProgress = false;
        this.content = $p0;
        var $$t_3 = this;
        _Array.each(Function, this.loadContentCallbacks, function($p1_0, $p1_1) {
            $p1_1($p0);
        });
        this.$3_0();
    },
    
    setError: function($p0, $p1, $p2) {
        if (!this.loadContentInProgress) {
            throw Error.invalidOperation('Invalid request state');
        }
        this.loadContentInProgress = false;
        this.error = true;
        var $$t_7 = this;
        _Array.each(Function, this.errorCallbacks, function($p1_0, $p1_1) {
            return $p1_1($p0, $p1, $p2);
        });
        this.$3_0();
    },
    
    $3_0: function() {
        this.loadContentCallbacks = null;
        this.errorCallbacks = null;
    },
    
    addCallbacks: function($p0, $p1) {
        if (!Sales.Common.Framework.JsTypes.isNull($p0)) {
            this.loadContentCallbacks[this.loadContentCallbacks.length] = $p0;
        }
        if (!Sales.Common.Framework.JsTypes.isNull($p1)) {
            this.errorCallbacks[this.errorCallbacks.length] = $p1;
        }
    }
}


Sales.Common.Framework.Loaders.ConcurrentContentLoader = function() {
    this.$1_1 = {};
    Sales.Common.Framework.Loaders.ConcurrentContentLoader.initializeBase(this);
}
Sales.Common.Framework.Loaders.ConcurrentContentLoader.prototype = {
    
    loadContent: function(uri, dataType, successCallback, errorCallback) {
        if (Sales.Common.Framework.JsTypes.isNull(uri)) {
            throw Error.argumentNull('uri');
        }
        var $v_0 = this.$1_1[uri];
        if (Sales.Common.Framework.JsTypes.isNull($v_0) || $v_0.error) {
            $v_0 = new Sales.Common.Framework.Loaders.ConcurrentContentLoaderData();
            $v_0.addCallbacks(successCallback, errorCallback);
            this.$8_1($v_0, uri, dataType);
            this.$1_1[uri] = $v_0;
        }
        else if ($v_0.loadContentInProgress) {
            $v_0.addCallbacks(successCallback, errorCallback);
        }
        else {
            if (!Sales.Common.Framework.JsTypes.isNull(successCallback)) {
                successCallback($v_0.content);
            }
        }
    },
    
    $8_1: function($p0, $p1, $p2) {
        $p0.loadContentInProgress = true;
        Sales.Common.Framework.Loaders.ContentLoader.prototype.loadContent.call(this, $p1, $p2, $p0.$$d_setResult, $p0.$$d_setError);
    },
    
    dispose: function() {
        this.$1_1 = null;
    }
}


Sales.Common.Framework.Loaders.ContentLoader = function() {
}
Sales.Common.Framework.Loaders.ContentLoader.prototype = {
    
    loadContent: function(uri, dataType, successCallback, errorCallback) {
        var $v_0 = new jQueryAjaxOptions();
        $v_0.async = true;
        $v_0.type = 'GET';
        $v_0.url = uri;
        $v_0.dataType = dataType;
        var $$t_B = this;
        $v_0.success = function($p1_0, $p1_1, $p1_2) {
            successCallback($p1_0);
        };
        if (errorCallback) {
            $v_0.error = errorCallback;
        }
        else {
            var $$t_C = this;
            $v_0.error = function($p1_0, $p1_1, $p1_2) {
                if (!$p1_0.status) {
                    return;
                }
                throw Error.create('Unable to load requested file: ' + uri);
            };
        }
        $P_CRM.ajax($v_0);
    }
}


Sales.Common.Framework.JsTypes.registerClass('Sales.Common.Framework.JsTypes');
_Array.registerClass('_Array');
_DateTime.registerClass('_DateTime');
_Dictionary.registerClass('_Dictionary');
_Event.registerClass('_Event');
_RegularExpression.registerClass('_RegularExpression');
_String.registerClass('_String');
_Type.registerClass('_Type');
Sales.Common.Framework.Loaders.ConcurrentContentLoaderData.registerClass('Sales.Common.Framework.Loaders.ConcurrentContentLoaderData');
Sales.Common.Framework.Loaders.ContentLoader.registerClass('Sales.Common.Framework.Loaders.ContentLoader');
Sales.Common.Framework.Loaders.ConcurrentContentLoader.registerClass('Sales.Common.Framework.Loaders.ConcurrentContentLoader', Sales.Common.Framework.Loaders.ContentLoader, Sys.IDisposable);
_DateTime.empty = null;
_String.empty = '';
_String.$4 = new RegExp('[\n\r]+');
_String.$5 = new RegExp('\r\n|\n\r');
_String.$6 = new RegExp('\n|\r');
</script><script id="/_static/_common/scripts/salescrmsoapproxyservice.js?ver=1888157098" type="text/javascript">Type.registerNamespace("Mscrm");Mscrm.RemoteCommandJson=function(webService,webMethod){var $v_0=String.format("/AppWebServices/{0}.asmx",CrmEncodeDecode.CrmUrlEncode(webService));this.$a_0=Mscrm.CrmUri.createForOrganization($v_0,window.ORG_UNIQUE_NAME).toString()+"/"+CrmEncodeDecode.CrmUrlEncode(webMethod);this.$M_0={}};Mscrm.RemoteCommandJson.prototype={$a_0:null,$M_0:null,setParameter:function(name,value){this.$M_0[name]=value},execute:function(){$P_CRM.support.cors=true;var $v_0=new jQueryAjaxOptions;$v_0.cache=false;$v_0.type="POST";$v_0.contentType="application/json; charset=utf-8";$v_0.dataType="json";$v_0.url=this.$a_0;$v_0.data=JSON.stringify(this.$M_0);var $v_1=jQueryApi.jQueryDeferredFactory.Deferred(Object,String),$$t_7=this,$$t_8=this;$P_CRM.ajax($v_0).success(function($p1_0){var $v_2=$p1_0["d"];$v_1.resolve($v_2)}).error(function($p1_0,$p1_1,$p1_2){$v_1.reject($p1_2.toString())});return $v_1.promise()}};Type.registerNamespace("Mscrm.InternalUtilities");Mscrm.InternalUtilities.Sdk=function(){};Mscrm.InternalUtilities.Sdk.get_$3=function(){if(IsNull(Mscrm.InternalUtilities.Sdk.$X))Mscrm.InternalUtilities.Sdk.$X=new Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase(Xrm.Page.context.getClientUrl());return Mscrm.InternalUtilities.Sdk.$X};Mscrm.InternalUtilities.Sdk.book=function(successCallback,errorCallback,schedulingActivity){Mscrm.InternalUtilities.Sdk.get_$3().book(schedulingActivity).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.associate=function(successCallback,errorCallback,parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName){Mscrm.InternalUtilities.Sdk.get_$3().associate(parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.convertToCase=function(successCallback,errorCallback,targetEntityTitle,activityId,activityTypeCode,customerId,customerIdTypeCode,ownerId,ownerTypeCode,subjectId,subjectTypeCode){Mscrm.InternalUtilities.Sdk.get_$3().convertActivity("incident",targetEntityTitle,activityId,activityTypeCode,customerId,customerIdTypeCode,ownerId,ownerTypeCode,subjectId,subjectTypeCode,null,null,null,0,false).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.convertToOpportunity=function(successCallback,errorCallback,targetEntityTitle,activityId,activityTypeCode,leadId,currencyId,customerId,customerIdTypeCode,ownerId,ownerTypeCode,campaignId,campaignTypeCode,logResponse){Mscrm.InternalUtilities.Sdk.get_$3().convertActivity("opportunity",targetEntityTitle,activityId,activityTypeCode,customerId,customerIdTypeCode,ownerId,ownerTypeCode,null,0,leadId,currencyId,campaignId,campaignTypeCode,logResponse).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.disassociate=function(successCallback,errorCallback,parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName){Mscrm.InternalUtilities.Sdk.get_$3().disassociate(parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.executeQuickFind=function(successCallback,errorCallback,searchText,entityGroupName,entityNames,appModule){Mscrm.InternalUtilities.Sdk.get_$3().executeQuickFind(searchText,entityGroupName,entityNames,appModule).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.inviteUser=function(successCallback,errorCallback,userId){Mscrm.InternalUtilities.Sdk.get_$3().inviteUser(userId).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.loseOpportunity=function(successCallback,errorCallback,opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode,competitorId){Mscrm.InternalUtilities.Sdk.get_$3().loseOpportunity(opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode,competitorId).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.qualifyLead=function(successCallback,errorCallback,leadId,createAccount,createContact,createOpportunity,transactionCurrencyId,opportunityCustomer,sourceCampaignId,qualifyStatus,suppressDuplicateDetection){Mscrm.InternalUtilities.Sdk.get_$3().qualifyLead(leadId,createAccount,createContact,createOpportunity,transactionCurrencyId,opportunityCustomer,sourceCampaignId,qualifyStatus,suppressDuplicateDetection).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.reschedule=function(successCallback,errorCallback,schedulingActivity,activityId){Mscrm.InternalUtilities.Sdk.get_$3().reschedule(schedulingActivity,activityId).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.retrieve=function(successCallback,errorCallback,objectId,objectTypeCode,columns,returnNotifications){Mscrm.InternalUtilities.Sdk.get_$3().retrieve(objectId,objectTypeCode,columns,returnNotifications).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.retrieveAttribute=function(successCallback,errorCallback,retrieveAsIfPublished,entityLogicalName,attributeLogicalName){Mscrm.InternalUtilities.Sdk.get_$3().retrieveAttribute(retrieveAsIfPublished,entityLogicalName,attributeLogicalName).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.winOpportunity=function(successCallback,errorCallback,opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode){Mscrm.InternalUtilities.Sdk.get_$3().winOpportunity(opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.getValidStatusTransition=function(successCallback,errorCallback,incidentId,statusCode){Mscrm.InternalUtilities.Sdk.get_$3().getValidStatusTransition(incidentId,statusCode).then(successCallback,errorCallback)};Mscrm.InternalUtilities.Sdk.closeIncident=function(successCallback,errorCallback,timeSpent,description,subject,incidentId,actualEnd,statusCode){Mscrm.InternalUtilities.Sdk.get_$3().closeIncident(timeSpent,description,subject,incidentId,actualEnd,statusCode).then(successCallback,errorCallback)};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy");Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase=function(serverUrl){this.webEndPointUrl=serverUrl+"/XRMServices/2011/Organization.svc/web";this.serverEndPointUrl=serverUrl};Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.prototype={webEndPointUrl:null,serverEndPointUrl:null,get_isAsync:function(){return Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.$g},set_isAsync:function(value){Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.$g=value;return value},get_webEndPointUrl:function(){return this.webEndPointUrl},get_serverEndPointUrl:function(){return this.serverEndPointUrl},$u_0:function($p0){var $v_0=Mscrm.CrmBrowser.get_currentBrowser();if(!$v_0.get_isMobileSafari())return;var $v_1={};$v_1["cache-control"]="no-cache";$p0.headers=$v_1},executeCrmRequest:function(T,requestName,parameters,requestNamespace){var $v_0=this.buildSoapEnvelope(requestName,parameters,requestNamespace),$v_1=jQueryApi.jQueryDeferredFactory.Deferred(T,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$$t_9=this,$$t_A=this;this.executeRequest($v_0,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){var $v_2=Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.createResponse($p1_0,requestName);$v_1.resolve($v_2)},function($p1_0){$v_1.reject($p1_0)});return $v_1.promise()},executeRequest:function(requestBody,soapAction){$P_CRM.support.cors=true;var $v_0=new jQueryAjaxOptions;$v_0.data=requestBody;$v_0.type="POST";$v_0.contentType="text/xml; charset=utf-8";$v_0.dataType="xml";$v_0.url=this.webEndPointUrl;$v_0.timeout=1e4;$v_0.async=this.get_isAsync();this.$u_0($v_0);if(($P_CRM.browser.msie||!Mscrm.CrmBrowser.get_currentBrowser().get_hasXPathEvaluator())&&Mscrm.CrmBrowser.get_currentBrowser().get_documentMode()>=10){var $v_3={};$v_3["responseType"]="msxml-document";$v_0.xhrFields=$v_3}var $$t_D=this;$v_0.beforeSend=function($p1_0){$p1_0.setRequestHeader("SOAPAction",soapAction);Mscrm.MetricsReporting.instance().addXMLHttpRequestHeaders($p1_0)};var $v_1=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$v_2=new Mscrm.MetricsStopwatch("CrmSoapServiceBase.ExecuteRequest");$v_2.properties={IsAsync:this.get_isAsync()};$v_2.start();var $$t_E=this,$$t_F=this;$P_CRM.ajax($v_0).success(function($p1_0,$p1_1,$p1_2){$$t_E.$p_0($v_2,$p1_2);$v_1.resolve(Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.create($p1_0))}).error(function($p1_0,$p1_1,$p1_2){$$t_F.$p_0($v_2,$p1_0);$p1_0.readyState&&!_String.isNullOrEmpty($p1_2)&&$v_1.reject(new Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse($p1_0,$p1_1,$p1_2))});return $v_1.promise()},$p_0:function($p0,$p1){if(!$p0)return;if($p1){var $v_0=$p1.getResponseHeader("REQ_ID");if(!isNullOrEmptyString($v_0)){if(!$p0.properties)$p0.properties={};$p0.properties["ReqId"]=$v_0}}$p0.stop()},retrieveEntityMetadata:function(entityName,retrieveAsIfPublished){var $v_0='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request i:type="a:RetrieveEntityRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"><a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><b:key>EntityFilters</b:key><b:value i:type="c:EntityFilters" xmlns:c="http://schemas.microsoft.com/xrm/2011/Metadata">Entity</b:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><b:key>MetadataId</b:key><b:value i:type="ser:guid" xmlns:ser="http://schemas.microsoft.com/2003/10/Serialization/">00000000-0000-0000-0000-000000000000</b:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><b:key>RetrieveAsIfPublished</b:key><b:value i:type="c:boolean" xmlns:c="http://www.w3.org/2001/XMLSchema">'+retrieveAsIfPublished+'</b:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><b:key>LogicalName</b:key><b:value i:type="c:string" xmlns:c="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityName)+'</b:value></a:KeyValuePairOfstringanyType></a:Parameters><a:RequestId i:nil="true" /><a:RequestName>RetrieveEntity</a:RequestName></request></Execute></s:Body></s:Envelope>',$v_1=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.ObjectModel.IEntityMetadata,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$$t_6=this,$$t_7=this;this.executeRequest($v_0,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){$v_1.resolve(Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata.$V((new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse($p1_0)).$R_1))},function($p1_0){$v_1.reject($p1_0)});return $v_1.promise()},retrieveFilteredForms:function(userId,entityName,formType){var $v_0='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request i:type="b:RetrieveFilteredFormsRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts"><a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><c:key>EntityLogicalName</c:key><c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityName)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>FormType</c:key><c:value i:type="a:OptionSetValue"><a:Value>'+formType+'</a:Value></c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>SystemUserId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(userId)+'</c:value></a:KeyValuePairOfstringanyType></a:Parameters><a:RequestId i:nil="true" /><a:RequestName>RetrieveFilteredForms</a:RequestName></request></Execute></s:Body></s:Envelope>',$v_1=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$$t_7=this,$$t_8=this;this.executeRequest($v_0,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){$v_1.resolve(new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse($p1_0))},function($p1_0){$v_1.reject($p1_0)});return $v_1.promise()},retrieveFilteredProcesses:function(entityName){var $v_0='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request i:type="b:RetrieveFilteredProcessesRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts"><a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><c:key>EntityLogicalName</c:key><c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityName)+'</c:value></a:KeyValuePairOfstringanyType></a:Parameters><a:RequestId i:nil="true" /><a:RequestName>RetrieveFilteredProcesses</a:RequestName></request></Execute></s:Body></s:Envelope>',$v_1=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$$t_5=this,$$t_6=this;this.executeRequest($v_0,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){$v_1.resolve(new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse($p1_0))},function($p1_0){$v_1.reject($p1_0)});return $v_1.promise()},navigateToNextEntity:function(currentEntityId,currentEntityLogicalName,nextEntityId,nextEntityLogicalName,processId,processInstanceId,newActiveStageId,traversedPath){var $v_0='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"><a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><c:key>CurrentEntityId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(currentEntityId)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>CurrentEntityLogicalName</c:key><c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(currentEntityLogicalName)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>NextEntityId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(nextEntityId)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>NextEntityLogicalName</c:key><c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(nextEntityLogicalName)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>NewActiveStageId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(newActiveStageId)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>NewTraversedPath</c:key><c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(traversedPath)+'</c:value></a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>ProcessId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(processId)+"</c:value></a:KeyValuePairOfstringanyType>"+(processInstanceId?'<a:KeyValuePairOfstringanyType><c:key>ProcessInstanceId</c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(processInstanceId)+"</c:value></a:KeyValuePairOfstringanyType>":"")+'</a:Parameters><a:RequestId i:nil="true" /><a:RequestName>NavigateToNextEntity</a:RequestName></request></Execute></s:Body></s:Envelope>',$v_1=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$$t_C=this,$$t_D=this;this.executeRequest($v_0,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){$v_1.resolve(new Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse($p1_0))},function($p1_0){$v_1.reject($p1_0)});return $v_1.promise()},buildSoapEnvelope:function(requestName,parameters,requestNamespace){var $v_0=true,$v_1=null;if(_String.isNullOrEmpty(requestNamespace)){$v_0=false;$v_1="a"}else $v_1="crm";var $v_2=new Sys.StringBuilder;$v_2.append('<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">');$v_2.append("<s:Body>");$v_2.append('<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:c="http://www.w3.org/2001/XMLSchema">');if($v_0){$v_2.append('<request i:type="');$v_2.append($v_1);$v_2.append(":");$v_2.append(CrmEncodeDecode.CrmXmlAttributeEncode(requestName));$v_2.append('Request" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"');$v_2.append(" xmlns:");$v_2.append($v_1);$v_2.append('="');$v_2.append(CrmEncodeDecode.CrmXmlAttributeEncode(requestNamespace));$v_2.append('"')}else $v_2.append('<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"');$v_2.append(">");$v_2.append('<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">');for(var $$arr_6=parameters,$$len_7=$$arr_6.length,$$idx_8=0;$$idx_8<$$len_7;++$$idx_8){var $v_3=$$arr_6[$$idx_8];$v_2.append("<a:KeyValuePairOfstringanyType>");$v_2.append($v_3.get_soapXml());$v_2.append("</a:KeyValuePairOfstringanyType>")}$v_2.append("</a:Parameters>");$v_2.append('<a:RequestId i:nil="true" />');$v_2.append("<a:RequestName>"+CrmEncodeDecode.CrmXmlEncode(requestName)+"</a:RequestName>");$v_2.append("</request>");$v_2.append("</Execute>");$v_2.append("</s:Body>");$v_2.append("</s:Envelope>");return $v_2.toString()},assign:function(targetEntityId,targetEntityName,assigneeEntityId,assigneeEntityName){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=targetEntityId;$v_0.logicalName=targetEntityName;var $v_1=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_1.id=assigneeEntityId;$v_1.logicalName=assigneeEntityName;var $v_2=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Target",$v_0),$v_3=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Assignee",$v_1),$v_4=[$v_2,$v_3];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"Assign",$v_4,"http://schemas.microsoft.com/crm/2011/Contracts")},associate:function(parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName){return this.$l_0("Associate",parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName)},disassociate:function(parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName){return this.$l_0("Disassociate",parentEntityId,parentObjectTypeCode,targetObjectTypeCode,targetEntityIds,relationshipName)},$l_0:function($p0,$p1,$p2,$p3,$p4,$p5){for(var $v_0=Xrm.Internal.getEntityName($p2),$v_1=Xrm.Internal.getEntityName($p3),$v_2=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection,$v_3=0,$$arr_A=$p4,$$len_B=$$arr_A.length,$$idx_C=0;$$idx_C<$$len_B;++$$idx_C){var $v_9=$$arr_A[$$idx_C];$v_2.set_item($v_3++,Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference($v_9,$v_1))}var $v_4=-1;if($v_0===$v_1)$v_4=0;var $v_5=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Target",Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference($p1,$v_0)),$v_6=Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter.createInstance("Relationship",$p5,$v_4),$v_7=Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter.createInstance("RelatedEntities",$v_2),$v_8=[$v_5,$v_6,$v_7];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,$p0,$v_8,"http://schemas.microsoft.com/xrm/2011/Contracts")},closeIncident:function(timeSpent,description,subject,incidentId,actualEnd,statusCode){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity("incidentresolution");$v_0.set_id(Mscrm.Utilities.createGuid().replace("{","").replace("}",""));$v_0.setAttribute("timespent",timeSpent,1);$v_0.setAttribute("opportunityid",Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(incidentId,"incident"),4);$v_0.setAttribute("description",description,0);$v_0.setAttribute("subject",subject,0);$v_0.setAttribute("actualend",actualEnd,3);var $v_1=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("IncidentResolution",$v_0),$v_2=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("Status",statusCode),$v_3=[$v_1,$v_2];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"CloseIncident",$v_3,"http://schemas.microsoft.com/crm/2011/Contracts")},$I_0:function($p0){if(isNullOrEmptyString($p0.id)||isNullOrEmptyString($p0.id)||isNullOrEmptyString($p0.logicalName)||!Xrm.Internal.getEntityCode($p0.logicalName))return false;return true},convertActivity:function(targetEntityName,targetEntitySubject,activityId,activityTypeCode,customerId,customerTypeCode,ownerId,ownerTypeCode,subjectId,subjectTypeCode,leadId,currencyId,campaignId,campaignTypeCode,logResponse){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity(targetEntityName);if(!isNullOrEmptyString(targetEntitySubject)){var $v_6="title";if(targetEntityName==="opportunity")$v_6="name";$v_0.attributes[$v_6]=targetEntitySubject;$v_0.attributeTypes[$v_6]="c:string";$v_0.attributeTypeNamespaces[$v_6]="http://www.w3.org/2001/XMLSchema"}if(currencyId){var $v_7=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(currencyId,"transactioncurrency");if(this.$I_0($v_7)){$v_0.attributes["transactioncurrencyid"]=$v_7;$v_0.attributeTypes["transactioncurrencyid"]="a:EntityReference"}}if(campaignId&&Xrm.Internal.getEntityCode("campaign")===campaignTypeCode){var $v_8=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(campaignId,Xrm.Internal.getEntityName(campaignTypeCode));if(this.$I_0($v_8)){$v_0.attributes["campaignid"]=$v_8;$v_0.attributeTypes["campaignid"]="a:EntityReference"}}if(leadId){var $v_9=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(leadId,"lead");if(this.$I_0($v_9)){$v_0.attributes["originatingleadid"]=$v_9;$v_0.attributeTypes["originatingleadid"]="a:EntityReference"}}if(customerId){var $v_A=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(customerId,Xrm.Internal.getEntityName(customerTypeCode));if(this.$I_0($v_A)){$v_0.attributes["customerid"]=$v_A;$v_0.attributeTypes["customerid"]="a:EntityReference"}}if(ownerId){var $v_B=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(ownerId,Xrm.Internal.getEntityName(ownerTypeCode));if(this.$I_0($v_B)){$v_0.attributes["ownerid"]=$v_B;$v_0.attributeTypes["ownerid"]="a:EntityReference"}}if(subjectId){var $v_C=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(subjectId,Xrm.Internal.getEntityName(subjectTypeCode));if(this.$I_0($v_C)){$v_0.attributes["subjectid"]=$v_C;$v_0.attributeTypes["subjectid"]="a:EntityReference"}}var $v_1=Sales.Common.CrmSoapServiceProxy.GuidParameter.createInstance("ActivityId",activityId),$v_2=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("ActivityEntityName",Xrm.Internal.getEntityName(activityTypeCode)),$v_3=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("TargetEntityName",targetEntityName),$v_4=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("TargetEntity",$v_0),$v_5=[$v_1,$v_2,$v_3,$v_4];if(logResponse){var $v_D=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("CreateCampaignResponse",true);$v_5=$v_5.concat($v_D)}return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse,"ConvertActivity",$v_5,"http://schemas.microsoft.com/crm/2011/Contracts")},create:function(entity,suppressDuplicateDetection){if(IsNull(suppressDuplicateDetection))suppressDuplicateDetection=true;var $v_0=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("Target",entity),$v_1=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("SuppressDuplicateDetection",suppressDuplicateDetection),$v_2=[$v_0,$v_1];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse,"Create",$v_2)},deleteEntity:function(entityId,entityName){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=entityId;$v_0.logicalName=entityName;var $v_1=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Target",$v_0),$v_2=[$v_1];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"Delete",$v_2)},executeQuickFind:function(searchText,entityGroupName,entityNames,filter){var $v_0=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("searchText",searchText),$v_1=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("entityGroupName",entityGroupName),$v_2=Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.createInstance("ColumnSet",entityNames),$v_3=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Filter",filter),$v_4=[$v_0,$v_1,$v_2,$v_3];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"ExecuteQuickFind",$v_4,"http://schemas.microsoft.com/crm/2011/Contracts")},getValidStatusTransition:function(incidentId,statusCode){var $v_0=Sales.Common.CrmSoapServiceProxy.GuidParameter.createInstance("incidentid",incidentId),$v_1=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("tostatecode",statusCode),$v_2=[$v_0,$v_1];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"GetValidStatusTransition",$v_2,"http://schemas.microsoft.com/crm/2011/Contracts")},inviteUser:function(userId){var $v_0=Sales.Common.CrmSoapServiceProxy.GuidParameter.createInstance("UserId",userId),$v_1=[$v_0];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"InviteUser",$v_1,"http://schemas.microsoft.com/crm/2011/Contracts")},loseOpportunity:function(opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode,competitorId){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity("opportunityclose");$v_0.set_id(Mscrm.Utilities.createGuid().replace("{","").replace("}",""));$v_0.setAttribute("actualrevenue",actualRevenue,10);$v_0.setAttribute("activityid",$v_0.get_id(),2);$v_0.setAttribute("opportunityid",Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(opportunityId,"opportunity"),4);$v_0.setAttribute("description",description,0);$v_0.setAttribute("actualend",date,3);$v_0.setAttribute("subject",opportunityDisplayName,0);!isNullOrEmptyString(competitorId)&&$v_0.setAttribute("competitorid",Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(competitorId,"competitor"),4);var $v_1=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("OpportunityClose",$v_0),$v_2=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("Status",statusCode),$v_3=[$v_1,$v_2];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"LoseOpportunity",$v_3,"http://schemas.microsoft.com/crm/2011/Contracts")},qualifyLead:function(leadId,createAccount,createContact,createOpportunity,transactionCurrencyId,opportunityCustomer,sourceCampaignId,qualifyStatus,suppressDuplicateDetection){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=leadId;$v_0.logicalName="lead";var $v_1=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_1.id=transactionCurrencyId;$v_1.logicalName="transactioncurrency";var $v_2=null;if(!isNullOrEmptyString(sourceCampaignId)){$v_2=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_2.id=sourceCampaignId;$v_2.logicalName="campaign"}var $v_3=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("LeadId",$v_0),$v_4=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("CreateAccount",createAccount),$v_5=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("CreateContact",createContact),$v_6=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("CreateOpportunity",createOpportunity),$v_7=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("OpportunityCurrencyId",$v_1),$v_8=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("OpportunityCustomerId",opportunityCustomer),$v_9=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("SourceCampaignId",$v_2),$v_A=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("Status",qualifyStatus),$v_B=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("SuppressDuplicateDetection",suppressDuplicateDetection),$v_C=[$v_3,$v_4,$v_5,$v_6,$v_7,$v_8,$v_9,$v_A,$v_B];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse,"QualifyLead",$v_C,"http://schemas.microsoft.com/crm/2011/Contracts")},retrieve:function(objectId,objectTypeCode,columns,returnNotifications){var $v_0=Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.createInstance("ColumnSet",columns),$v_1=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("ReturnNotifications",returnNotifications),$v_2=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(objectId,Xrm.Internal.getEntityName(objectTypeCode)),$v_3=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("Target",$v_2),$v_4=[$v_3,$v_1,$v_0];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse,"Retrieve",$v_4,"http://schemas.microsoft.com/xrm/2011/Contracts")},retrieveAttribute:function(retrieveAsIfPublished,entityLogicalName,attributeLogicalName){var $v_0=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("RetrieveAsIfPublished",retrieveAsIfPublished),$v_1=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("EntityLogicalName",entityLogicalName),$v_2=Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance("LogicalName",attributeLogicalName),$v_3=Sales.Common.CrmSoapServiceProxy.GuidParameter.createInstance("MetadataId","00000000-0000-0000-0000-000000000000"),$v_4=[$v_0,$v_1,$v_2,$v_3];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse,"RetrieveAttribute",$v_4,"http://schemas.microsoft.com/xrm/2011/Contracts")},retrieveMultiple:function(fetchXml,types){var $v_0=Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter.createInstance("Query",fetchXml),$v_1=[$v_0];if(IsNull(types))return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse,"RetrieveMultiple",$v_1);if(Object.getType(types)!==Array)types=[types];var $v_2=jQueryApi.jQueryDeferredFactory.Deferred(Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse,Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse),$v_3=this.buildSoapEnvelope("RetrieveMultiple",$v_1),$$t_8=this,$$t_9=this;this.executeRequest($v_3,"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute").then(function($p1_0){$v_2.resolve(new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse($p1_0,types))},function($p1_0){$v_2.reject($p1_0)});return $v_2.promise()},book:function(entity){var $v_0=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("Target",entity),$v_1=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("MaintainLegacyAppServerBehavior",true),$v_2=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("ReturnNotifications",true),$v_3=[$v_0,$v_1,$v_2];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse,"Book",$v_3)},reschedule:function(entity,activityId){entity.set_id(activityId);var $v_0=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("Target",entity),$v_1=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("MaintainLegacyAppServerBehavior",true),$v_2=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("ReturnNotifications",true),$v_3=[$v_0,$v_1,$v_2];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse,"Reschedule",$v_3)},setState:function(entityId,entityName,state,status){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=entityId.replace("{","").replace("}","");$v_0.logicalName=entityName;var $v_1=Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance("EntityMoniker",$v_0),$v_2=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("Status",status),$v_3=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("State",state),$v_4=Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance("MaintainLegacyAppServerBehavior",true),$v_5=[$v_1,$v_2,$v_3,$v_4];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"SetState",$v_5,"http://schemas.microsoft.com/crm/2011/Contracts")},update:function(entity){var $v_0=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("Target",entity),$v_1=[$v_0];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse,"Update",$v_1)},winOpportunity:function(opportunityId,opportunityDisplayName,actualRevenue,description,date,statusCode){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity("opportunityclose");$v_0.set_id(Mscrm.Utilities.createGuid().replace("{","").replace("}",""));$v_0.setAttribute("actualrevenue",actualRevenue,10);$v_0.setAttribute("activityid",$v_0.get_id(),2);$v_0.setAttribute("opportunityid",Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference(opportunityId,"opportunity"),4);$v_0.setAttribute("description",description,0);$v_0.setAttribute("actualend",date,3);$v_0.setAttribute("subject",opportunityDisplayName,0);var $v_1=Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance("OpportunityClose",$v_0),$v_2=Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance("Status",statusCode),$v_3=[$v_1,$v_2];return this.executeCrmRequest(Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse,"WinOpportunity",$v_3,"http://schemas.microsoft.com/crm/2011/Contracts")}};Sales.Common.CrmSoapServiceProxy.AttributeType=function(){};Sales.Common.CrmSoapServiceProxy.MetadataHelper=function(){};Sales.Common.CrmSoapServiceProxy.MetadataHelper.parseAttributeType=function(attributeTypeName){switch(attributeTypeName){case "c:string":return 0;case "c:guid":return 2;case "a:EntityReference":return 4;case "c:dateTime":return 3;case "c:int":return 1;case "c:boolean":return 7;case "c:decimal":return 8;case "c:double":return 9;case "a:OptionSetValue":return 6;case "a:EntityCollection":return 5;case "a:Money":return 10;default:throw Error.create(String.format("attributeType '{0}' is not supported",attributeTypeName))}};Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition=function(entity,attributeName,attributeType){if(IsNull(entity))throw Error.create("entity is undefined");if(IsNull(attributeName))throw Error.create("attributeName is undefined");switch(attributeType){case 0:entity.attributeTypes[attributeName]="c:string";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 1:entity.attributeTypes[attributeName]="c:int";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 8:entity.attributeTypes[attributeName]="c:decimal";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 9:entity.attributeTypes[attributeName]="c:double";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 2:entity.attributeTypes[attributeName]="c:guid";entity.attributeTypeNamespaces[attributeName]="http://schemas.microsoft.com/2003/10/Serialization/";break;case 4:entity.attributeTypes[attributeName]="a:EntityReference";break;case 5:entity.attributeTypes[attributeName]="a:EntityCollection";break;case 3:entity.attributeTypes[attributeName]="c:dateTime";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 7:entity.attributeTypes[attributeName]="c:boolean";entity.attributeTypeNamespaces[attributeName]="http://www.w3.org/2001/XMLSchema";break;case 6:entity.attributeTypes[attributeName]="a:OptionSetValue";break;case 10:entity.attributeTypes[attributeName]="a:Money";break;default:throw Error.create(String.format("attributeType '{0}' is not supported",attributeType))}};Sales.Common.CrmSoapServiceProxy.BooleanParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.BooleanParameter.initializeBase(this,[$p0]);this.$4_1=$p1};Sales.Common.CrmSoapServiceProxy.BooleanParameter.createInstance=function(name,value){return new Sales.Common.CrmSoapServiceProxy.BooleanParameter(name,value)};Sales.Common.CrmSoapServiceProxy.BooleanParameter.prototype={$4_1:false,get_valueXml:function(){return '<b:value i:type="c:boolean" xmlns:c="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$4_1.toString())+"</b:value>"}};Sales.Common.CrmSoapServiceProxy.ColumnSetParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.initializeBase(this,[$p0]);this.$Z_1=$p1};Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.createInstance=function(name,columns){return new Sales.Common.CrmSoapServiceProxy.ColumnSetParameter(name,columns)};Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.prototype={$Z_1:null,get_valueXml:function(){for(var $v_0='<b:value i:type="a:ColumnSet"><a:AllColumns>false</a:AllColumns><a:Columns xmlns:c="http://schemas.microsoft.com/2003/10/Serialization/Arrays">',$$arr_1=this.$Z_1,$$len_2=$$arr_1.length,$$idx_3=0;$$idx_3<$$len_2;++$$idx_3){var $v_1=$$arr_1[$$idx_3];$v_0+="<c:string>"+$v_1+"</c:string>"}$v_0+="</a:Columns>";$v_0+="</b:value>";return $v_0}};Sales.Common.CrmSoapServiceProxy.EntityParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.EntityParameter.initializeBase(this,[$p0]);this.$D_1=$p1};Sales.Common.CrmSoapServiceProxy.EntityParameter.createInstance=function(name,entity){return new Sales.Common.CrmSoapServiceProxy.EntityParameter(name,entity)};Sales.Common.CrmSoapServiceProxy.EntityParameter.prototype={$D_1:null,get_valueXml:function(){return '<b:value i:type="a:Entity">'+Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.attributesToXml(this.$D_1)+'<a:EntityState i:nil="true" /><a:FormattedValues />'+(_String.isNullOrEmpty(this.$D_1.get_id())?"":"<a:Id>"+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$D_1.get_id())+"</a:Id>")+"<a:LogicalName>"+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$D_1.logicalName)+"</a:LogicalName>"+Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.$q(this.$D_1.relatedEntities)+"</b:value>"}};Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.initializeBase(this,[$p0]);this.$E_1=$p1};Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.createInstance=function(name,entityMoniker){return new Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter(name,entityMoniker)};Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.prototype={$E_1:null,get_valueXml:function(){if(!this.$E_1)return '<b:value i:nil="true" />';var $v_0=new Sys.StringBuilder;$v_0.append("<b:value i:type='a:EntityReference'>");$v_0.append("<a:Id>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$E_1.id));$v_0.append("</a:Id>");$v_0.append("<a:LogicalName>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$E_1.logicalName));$v_0.append("</a:LogicalName>");if(!_String.isNullOrEmpty(this.$E_1.name)){$v_0.append("<a:Name>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$E_1.name));$v_0.append("</a:Name>")}else $v_0.append('<a:Name i:nil="true" />');$v_0.append("</b:value>");return $v_0.toString()}};Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter.initializeBase(this,[$p0]);this.$G_1=$p1};Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter.createInstance=function(name,entityCollection){return new Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter(name,entityCollection)};Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter.prototype={$G_1:null,get_valueXml:function(){if(!this.$G_1||!this.$G_1.get_length())return "";var $v_0=new Sys.StringBuilder;$v_0.append("<b:value i:type='a:EntityReferenceCollection'>");for(var $v_1=0;$v_1<this.$G_1.get_length();$v_1++){var $v_2=this.$G_1.get_item($v_1);$v_0.append("<a:EntityReference>");$v_0.append("<a:Id>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2.id));$v_0.append("</a:Id>");$v_0.append("<a:LogicalName>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2.logicalName));$v_0.append("</a:LogicalName>");if(!_String.isNullOrEmpty($v_2.name)){$v_0.append("<a:Name>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2.name));$v_0.append("</a:Name>")}else $v_0.append('<a:Name i:nil="true" />');$v_0.append("</a:EntityReference>")}$v_0.append("</b:value>");return $v_0.toString()}};Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter=function($p0,$p1,$p2){this.$O_1=-1;Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter.initializeBase(this,[$p0]);this.$d_1=$p1;this.$O_1=$p2};Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter.createInstance=function(name,value,primaryEntityRole){return new Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter(name,value,primaryEntityRole)};Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter.prototype={$d_1:null,get_valueXml:function(){var $v_0=new Sys.StringBuilder;$v_0.append("<b:value i:type='a:Relationship'>");if(this.$O_1!==-1){$v_0.append("<a:PrimaryEntityRole >");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$O_1.toString()));$v_0.append("</a:PrimaryEntityRole >")}else $v_0.append('<a:PrimaryEntityRole i:nil="true" />');$v_0.append("<a:SchemaName >");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$d_1));$v_0.append("</a:SchemaName >");$v_0.append("</b:value>");return $v_0.toString()}};Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter.initializeBase(this,[$p0]);this.$b_1=$p1};Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter.createInstance=function(name,fetchXml){return new Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter(name,fetchXml)};Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter.prototype={$b_1:null,get_valueXml:function(){return '<b:value i:type="a:FetchExpression"><a:Query>'+CrmEncodeDecode.CrmXmlEncode(this.$b_1)+"</a:Query></b:value>"}};Sales.Common.CrmSoapServiceProxy.GuidParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.GuidParameter.initializeBase(this,[$p0]);this.$4_1=$p1.replace("{","").replace("}","")};Sales.Common.CrmSoapServiceProxy.GuidParameter.createInstance=function(name,value){return new Sales.Common.CrmSoapServiceProxy.GuidParameter(name,value)};Sales.Common.CrmSoapServiceProxy.GuidParameter.prototype={$4_1:null,get_valueXml:function(){return '<b:value i:type="c:guid" xmlns:c="http://schemas.microsoft.com/2003/10/Serialization/">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$4_1.toString())+"</b:value>"}};Sales.Common.CrmSoapServiceProxy.SoapParameter=function(name){this.$c_0=name};Sales.Common.CrmSoapServiceProxy.SoapParameter.prototype={$c_0:null,get_soapXml:function(){return this.get_keySoapXml()+this.get_valueXml()},get_keySoapXml:function(){return String.format("<b:key>{0}</b:key>",CrmEncodeDecode.CrmXmlEncode(this.$c_0))}};Sales.Common.CrmSoapServiceProxy.StringParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.StringParameter.initializeBase(this,[$p0]);this.$4_1=$p1};Sales.Common.CrmSoapServiceProxy.StringParameter.createInstance=function(name,value){return new Sales.Common.CrmSoapServiceProxy.StringParameter(name,value)};Sales.Common.CrmSoapServiceProxy.StringParameter.prototype={$4_1:null,get_valueXml:function(){return '<b:value i:type="c:string" xmlns:c="http://www.w3.org/2001/XMLSchema">'+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(this.$4_1.toString())+"</b:value>"}};Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter=function($p0,$p1){Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.initializeBase(this,[$p0]);this.$4_1=$p1};Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.createInstance=function(name,value){return new Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter(name,value)};Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.prototype={$4_1:0,get_valueXml:function(){return "<b:value i:type='a:OptionSetValue'><a:Value>"+this.$4_1+"</a:Value></b:value>"}};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.Utils");Sales.Common.CrmSoapServiceProxy.Utils.Utils=function(){};Sales.Common.CrmSoapServiceProxy.Utils.Utils.isFunction=function(functionName){return eval(String.format("(typeof({0}) == 'function')",functionName))};Sales.Common.CrmSoapServiceProxy.Utils.Utils.parseGuid=function(stringGuid){if(_String.isNullOrEmpty(stringGuid))return null;var $v_0=Sales.Common.CrmSoapServiceProxy.Utils.Utils.tryParseGuid(stringGuid);if(IsNull($v_0))throw Error.create("invalid guid format");return $v_0};Sales.Common.CrmSoapServiceProxy.Utils.Utils.tryParseGuid=function(guid){return Mscrm.Utilities.tryParseGuid(guid)};Sales.Common.CrmSoapServiceProxy.Utils.Utils.getContextFromXrmPage=function(){return Xrm.Page.context};Sales.Common.CrmSoapServiceProxy.Utils.Utils.areGuidEqual=function(guid1,guid2){if(_String.isNullOrEmpty(guid1)||_String.isNullOrEmpty(guid2))return false;var $v_0=Sales.Common.CrmSoapServiceProxy.Utils.Utils.removeBeginEndBracket(guid1.toLowerCase()),$v_1=Sales.Common.CrmSoapServiceProxy.Utils.Utils.removeBeginEndBracket(guid2.toLowerCase());return $v_0===$v_1};Sales.Common.CrmSoapServiceProxy.Utils.Utils.removeBeginEndBracket=function(id){if(id.startsWith("{"))id=id.substr(1);if(id.endsWith("}"))id=id.substr(0,id.length-1);return id};Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils=function(){};Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.toCrmDateTimeString=function(dateTime){if(IsNull(dateTime)||dateTime===Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$Q)return "";return dateTime.format("s")};Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.fromCrmDateTimeString=function(dateTimeString){if(_String.isNullOrEmpty(dateTimeString))return Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$Q;var $v_0=dateTimeString.replace(Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$r," ").replace(Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$k,"/")+" UTC";return new Date($v_0)};Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.toCrmDateTimeStringWithTimeZone=function(dateTime){if(IsNull(dateTime)||dateTime===Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$Q)return "";return dateTime.format("yyyy-MM-ddTHH:mm:ss.fffzzz")};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils=function(){};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.multilineHtmlEncode=function(value,replaceNewLineForHtml){if(_String.isNullOrEmpty(value)||typeof value!=="string")return "";if(IsNull(replaceNewLineForHtml))replaceNewLineForHtml=false;for(var $v_0=value.replace("\r\n","\n").replace("\r","\n").split("\n"),$v_1=0;$v_1<$v_0.length;$v_1++)$v_0[$v_1]=Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlEncode($v_0[$v_1]);if(replaceNewLineForHtml)return $v_0.join("<br />");else return $v_0.join("\r\n")};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlAttributeEncode=function(value){if(_String.isNullOrEmpty(value))return "";return CrmEncodeDecode.CrmXmlAttributeEncode(value)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.javaScriptEncode=function(s){return CrmEncodeDecode.CrmJavaScriptEncode(s)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlAttributeEncode=function(s){return CrmEncodeDecode.CrmHtmlAttributeEncode(s)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlEncode=function(value){if(_String.isNullOrEmpty(value))return "";return CrmEncodeDecode.CrmHtmlEncode(value)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlDecode=function(value){if(_String.isNullOrEmpty(value))return "";return CrmEncodeDecode.CrmHtmlDecode(value)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode=function(value){if(_String.isNullOrEmpty(value))return "";return CrmEncodeDecode.CrmXmlEncode(value)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlEncode=function(value){return CrmEncodeDecode.CrmUrlEncode(value)};Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlDecode=function(value){return CrmEncodeDecode.CrmUrlDecode(value)};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.Faults");Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault=function(){};Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseFromXml=function(responseXml){var $v_0=new Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault;if(IsNull(responseXml)){$v_0.$U_0=true;return $v_0}responseXml.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services");responseXml.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts");responseXml.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic");responseXml.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance");responseXml.addNamespace("e","http://schemas.datacontract.org/2004/07/System.ServiceModel");$v_0.$W_0=responseXml;var $v_1="//a:OrganizationServiceFault",$v_2=responseXml.selectSingleNode($v_1);if(!IsNull($v_2)){$v_0=Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseServiceFault($v_0,$v_2);return $v_0}var $v_3="//e:ExceptionDetail",$v_4=responseXml.selectSingleNode($v_3);if(!IsNull($v_4)){$v_0=Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseExceptionDetail($v_0,$v_4);return $v_0}$v_0.$8_0=responseXml.get_outerXml();return $v_0};Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseServiceFault=function(organizationServiceFault,faultNode){var $v_0="//a:ErrorCode",$v_1="//a:InnerFault[not(@i:nil)]",$v_2="//a:Message",$v_3=faultNode.selectSingleNode($v_0);if(!IsNull($v_3))organizationServiceFault.$J_0=Number.parseInvariant($v_3.get_innerText());var $v_4=faultNode.selectSingleNode($v_1);if(!IsNull($v_4))organizationServiceFault.$T_0=Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.$o($v_4);var $v_5=faultNode.selectSingleNode($v_2);organizationServiceFault.$8_0=!IsNull($v_5)?$v_5.get_innerText():faultNode.get_outerXml();return organizationServiceFault};Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseExceptionDetail=function(organizationServiceFault,exceptionNode){var $v_0="e:InnerException/e:Message",$v_1=exceptionNode.selectSingleNode($v_0);organizationServiceFault.$8_0=!IsNull($v_1)?$v_1.get_innerText():exceptionNode.get_outerXml();return organizationServiceFault};Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.$o=function($p0){var $v_0=new Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault,$v_1="//ErrorCode",$v_2="//InnerFault[not(@i:nil)]",$v_3="//Message",$v_4=$p0.selectSingleNode($v_1);if(!IsNull($v_4))$v_0.$J_0=Number.parseInvariant($v_4.get_innerText());var $v_5=$p0.selectSingleNode($v_3);if(!IsNull($v_5))$v_0.$8_0=$v_5.get_innerText();var $v_6=$p0.selectNodes($v_2);if($v_6.get_count()>0){var $v_7=$v_6.get_item(0);if($v_7.hasChildNodes())$v_0.$T_0=Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.$o($v_7)}return $v_0};Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.prototype={$W_0:null,$J_0:0,$T_0:null,$8_0:null,$U_0:false,get_innerFault:function(){return this.$T_0},get_errorCode:function(){return this.$J_0},get_message:function(){return this.$8_0},get_responseXml:function(){return this.$W_0},get_responseOuterXml:function(){return this.$W_0.get_outerXml()},get_emptyResponse:function(){return this.$U_0},set_emptyResponse:function(value){this.$U_0=value;return value}};Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes=function(){};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.Messages");Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value");this.id=$v_0.get_innerText()}else{this.responseName="ConvertActivity";this.id=""}};Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse.prototype={id:null};Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse=function(request,textStatus,error){this.$j_0=request;this.$Y_0=textStatus;this.$A_0=error;this.$C_0=Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.parseFromXml(Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.create(request.responseXML))};Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse.prototype={$j_0:null,$Y_0:null,$A_0:null,$C_0:null,$N_0:null,get_localizedMessage:function(){var $v_0="errorTable[Error_Message_0x"+this.$C_0.$J_0.toString()+"]",$v_1=$v_0;if(!isNullOrEmptyString($v_1))this.$N_0=$v_1;else this.$N_0=this.$C_0.$8_0;return this.$N_0},get_request:function(){return this.$j_0},get_textStatus:function(){return this.$Y_0},get_error:function(){return this.$A_0},get_debugErrorMessage:function(){if(!IsNull(this.$C_0)&&!isNullOrEmptyString(this.$C_0.$8_0))return this.$C_0.$8_0;if(!IsNull(this.$A_0)){if(!IsNull(this.$A_0.message))return this.$A_0.message;if(String.isInstanceOfType(this.$A_0))return this.$A_0}return this.$Y_0},get_organizationServiceFault:function(){return this.$C_0}};Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value");this.id=$v_0.get_innerText()}else{this.responseName="Create";this.id=""}};Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse.prototype={id:null};Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse=function(soapResponse){this.responseName="OrganizationResponse";this.soapResponse=soapResponse;Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.$n(this.soapResponse)};Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.$n=function($p0){if(!IsNull($p0)){$p0.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts");$p0.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic");$p0.addNamespace("c","http://schemas.microsoft.com/crm/2011/Contracts");$p0.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services");$p0.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance");$p0.addNamespace("s","http://schemas.xmlsoap.org/soap/envelope")}};Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.createResponse=function(soapResponse,requestName){!IsNull(soapResponse)&&Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.$n(soapResponse);switch(requestName){case "Book":return new Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse(soapResponse);case "ConvertActivity":return new Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse(soapResponse);case "Create":return new Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse(soapResponse);case "ExecuteQuickFind":case "Retrieve":return new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse(soapResponse);case "RetrieveAttribute":return new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse(soapResponse);case "RetrieveMultiple":return new Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse(soapResponse);case "QualifyLead":return new Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse(soapResponse);case "Update":return new Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse(soapResponse);case "Reschedule":return new Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse(soapResponse);case "GetValidStatusTransition":case "WinOpportunity":case "LoseOpportunity":case "Delete":case "SetState":case "CloseIncident":default:return new Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse(soapResponse)}};Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.prototype={responseName:null,soapResponse:null};Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse))this.$P_1=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection.loadFromXml(soapResponse);else this.$P_1=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection};Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse.prototype={$P_1:null,get_createdEntities:function(){return this.$P_1}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse.initializeBase(this,[soapResponse]);soapResponse.addNamespace("c","http://schemas.microsoft.com/xrm/2011/Metadata");this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();this.$e_1=soapResponse.selectSingleNode("//a:KeyValuePairOfstringanyType/b:value")};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse.prototype={$e_1:null,get_attributeMetadataXmlNode:function(){return this.$e_1}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse.initializeBase(this,[soapResponse]);soapResponse.addNamespace("c","http://schemas.microsoft.com/xrm/2011/Metadata");this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();this.$R_1=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value")};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse.prototype={$R_1:null,get_entityXml:function(){return this.$R_1}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value"),$v_1=$v_0.selectSingleNode("a:EntityReference/a:Id");this.id=$v_1.get_innerText()}else{this.responseName="Create";this.id=""}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse.prototype={id:null};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse=function(soapResponse,types){Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse.initializeBase(this,[soapResponse]);this.moreRecords=false;if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:EntityCollection']"),$v_1=$v_0.selectSingleNode("a:MoreRecords");if(!IsNull($v_1)&&!_String.isNullOrEmpty($v_1.get_innerText()))this.moreRecords=Boolean.parse($v_1.get_innerText());var $v_2=$v_0.selectSingleNode("a:TotalRecordCount");if(!IsNull($v_2)&&!_String.isNullOrEmpty($v_2.get_innerText()))this.totalRecordCount=parseInt($v_2.get_innerText());var $v_3=$v_0.selectSingleNode("a:PagingCookie");if(!IsNull($v_3)&&!_String.isNullOrEmpty($v_3.get_innerText()))this.pagingCookie=$v_3.get_innerText();var $v_4=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.loadFromXml($v_0,types);this.entities=$v_4.$1_0}else{this.responseName="RetrieveMultipleResponse";this.entities=new Array(0)}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse.prototype={moreRecords:false,totalRecordCount:0,entities:null,pagingCookie:null};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:Entity']");this.entity=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.loadFromXml($v_0);this.id=this.entity.get_id()}else{this.responseName="RetrieveResponse";this.entity=new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity("")}};Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse.prototype={entity:null,id:null};Sales.Common.CrmSoapServiceProxy.Messages.SchedulingNotification=function(message,severity){this.Text=message;switch(severity){case "Error":this.Severity=1;break;case "Warning":this.Severity=2;break;case "Information":this.Severity=3;break}};Sales.Common.CrmSoapServiceProxy.Messages.SchedulingNotification.prototype={Text:null,Severity:0};Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse.initializeBase(this,[soapResponse]);if(!IsNull(soapResponse)){this.responseName=soapResponse.selectSingleNode("//d:ExecuteResult/a:ResponseName").get_innerText();this.notifications=[];var $v_0=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value/c:ValidationSuccess");this.status=Boolean.parse($v_0.get_innerText());if(this.status){var $v_1=soapResponse.selectSingleNode("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value/c:ActivityId");if(!IsNull($v_1))this.activityId=$v_1.get_innerText()}else for(var $v_2=soapResponse.selectNodes("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value/c:BusinessNotification/c:Message"),$v_3=soapResponse.selectNodes("//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value/c:BusinessNotification/c:Severity"),$v_4=0;$v_4<$v_2.get_count();$v_4++){var $v_5=$v_2.get_item($v_4),$v_6=new Sales.Common.CrmSoapServiceProxy.Messages.SchedulingNotification($v_5.get_innerText(),$v_3.get_item($v_4).get_innerText());Array.add(this.notifications,$v_6)}}else{this.responseName="Book";this.activityId=""}};Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse.prototype={activityId:null,status:false,notifications:null};Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse=function(soapResponse){Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse.initializeBase(this,[soapResponse])};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.ObjectModel");Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityState=function(){};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityState.prototype={active:0,inActive:1};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityState.registerEnum("Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityState",false);Sales.Common.CrmSoapServiceProxy.ObjectModel.IEntityMetadata=function(){};Sales.Common.CrmSoapServiceProxy.ObjectModel.IEntityMetadata.registerInterface("Sales.Common.CrmSoapServiceProxy.ObjectModel.IEntityMetadata");Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.initializeBase(this,["activitypointer"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.prototype={get_id:function(){return this.get_activityId()},set_id:function(value){this.set_activityId(value);return value},get_activityId:function(){return this.attributes["activityid"]},set_activityId:function(value){this.attributes["activityid"]=value;return value},get_activityTypeCode:function(){return this.attributes["activitytypecode"]},set_activityTypeCode:function(value){this.attributes["activitytypecode"]=value;return value},get_dueDate:function(){return this.attributes["scheduledend"]},set_dueDate:function(value){this.attributes["scheduledend"]=value;return value},get_formattedDueDate:function(){return this.formattedValues["scheduledend"]},get_priority:function(){return this.attributes["prioritycode"]},set_priority:function(value){this.attributes["prioritycode"]=value;return value},get_subject:function(){return this.attributes["subject"]},set_subject:function(value){this.attributes["subject"]=value;return value},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"activityid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"activitytypecode",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"scheduledend",3);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"prioritycode",6);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"subject",0)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.initializeBase(this,["contact"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.prototype={get_firstName:function(){return this.attributes["firstname"]},get_lastName:function(){return this.attributes["lastname"]},set_lastName:function(value){this.attributes["lastname"]=value;return value},get_emailAddress1:function(){return this.attributes["emailaddress1"]},set_emailAddress1:function(value){this.attributes["emailaddress1"]=value;return value},get_emailAddress2:function(){return this.attributes["emailaddress2"]},get_emailAddress3:function(){return this.attributes["emailaddress3"]},get_id:function(){return this.get_contactId()},set_id:function(value){this.set_contactId(value);return value},get_contactId:function(){return this.attributes["contactid"]},set_contactId:function(value){this.attributes["contactid"]=value;return value},get_jobTitle:function(){return this.attributes["jobtitle"]},set_jobTitle:function(value){this.attributes["contactid"]=value;return value},get_parentCustomerId:function(){return this.attributes["parentcustomerid"]},set_parentCustomerId:function(value){this.attributes["parentcustomerid"]=value;return value},get_personId:function(){return this.attributes["personid"]},set_personId:function(value){this.attributes["personid"]=value;return value},get_fullName:function(){return this.attributes["fullname"]},set_fullName:function(value){this.attributes["fullname"]=value;return value},get_emailAddress:function(){return this.attributes["emailsearch1.emailaddress"]},set_emailAddress:function(value){this.attributes["emailsearch1.emailaddress"]=value;return value},get_transactionCurrencyId:function(){return this.attributes["transactioncurrencyid"]},set_transactionCurrencyId:function(value){this.attributes["transactioncurrencyid"]=value;return value},get_salesToDate:function(){return this.attributes["salestodate"]},set_salesToDate:function(value){this.attributes["salestodate"]=value;return value},get_formattedSalesToDate:function(){return this.formattedValues["salestodate"]},get_currentSalesPipeline:function(){return this.attributes["currentsalespipeline"]},set_currentSalesPipeline:function(value){this.attributes["currentsalespipeline"]=value;return value},get_formattedCurrentSalesPipeline:function(){return this.formattedValues["currentsalespipeline"]},get_openOpportunityCount:function(){return this.attributes["openopportunitycount"]},set_openOpportunityCount:function(value){this.attributes["openopportunitycount"]=value;return value},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"contactid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"firstname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"lastname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"jobtitle",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"parentcustomerid",4);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"personid",4);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailaddress1",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailaddress2",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailaddress3",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"transactioncurrencyid",4);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"salestodate",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"currentsalespipeline",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"openopportunitycount",1);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"fullname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailsearch1.emailaddress",0)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.initializeBase(this,["emailsearch"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.prototype={get_id:function(){return this.get_emailSearchId()},set_id:function(value){this.set_emailSearchId(value);return value},get_emailSearchId:function(){return this.attributes["emailsearchid"]},set_emailSearchId:function(value){this.attributes["emailsearchid"]=value;return value},get_emailAddress:function(){return this.attributes["emailaddress"]},set_emailAddress:function(value){this.attributes["emailaddress"]=value;return value},get_parentObjectId:function(){return this.attributes["parentobjectid"]},set_parentObjectId:function(value){this.attributes["parentobjectid"]=value;return value},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailsearchid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"emailaddress",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"parentobjectid",4)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity=function(logicalName){this.$S_0="00000000-0000-0000-0000-000000000000";this.logicalName=logicalName;this.attributes={};this.attributeTypes={};this.attributeTypeNamespaces={};this.relatedEntities=new Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection;this.formattedValues={};this.initMetadata()};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.toTypedEntityCollection=function(T,entities){var $v_0=new Array(0);if(!entities)return $v_0;for(var $v_1=0;$v_1<entities.length;$v_1++)$v_0[$v_1]=entities[$v_1].toTypedEntity(T);return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.toXml=function(entity,skipRootNS){var $v_0=new Sys.StringBuilder;if(!IsNull(skipRootNS))$v_0.appendLine("<a:Entity>");else $v_0.appendLine('<entity xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">');$v_0.appendLine(Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.attributesToXml(entity,skipRootNS));$v_0.appendLine('<a:EntityState i:nil="true"/>');$v_0.appendLine('<a:FormattedValues xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic"/>');if(!_String.isNullOrEmpty(entity.get_id())){entity.set_id(entity.get_id().replace("{","").replace("}",""));$v_0.append("<a:Id>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entity.get_id()));$v_0.appendLine("</a:Id>")}$v_0.append("<a:LogicalName>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entity.logicalName));$v_0.appendLine("</a:LogicalName>");$v_0.appendLine(Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.$q(entity.relatedEntities));if(!IsNull(skipRootNS))$v_0.appendLine("</a:Entity>");else $v_0.appendLine("</entity>");return $v_0.toString()};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.attributesToXml=function(entity,skipRootNS){var $v_0=new Sys.StringBuilder;$v_0.append("<a:Attributes");if(!IsNull(skipRootNS))$v_0.appendLine(">");else $v_0.appendLine(' xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">');var $$dict_7=entity.attributes;for(var $$key_8 in $$dict_7){var $v_1={key:$$key_8,value:$$dict_7[$$key_8]},$v_2=$v_1.key,$v_3=entity.attributes[$v_2];if(IsNull($v_3))continue;$v_0.appendLine("<a:KeyValuePairOfstringanyType>");$v_0.append("<b:key>");$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2));$v_0.appendLine("</b:key>");if(!($v_2 in entity.attributeTypes))throw Error.create(String.format("Cannot serialize attribute '{0}.{1}' because its type was not found in the AttributeTypes dictionary.",entity.logicalName,$v_2));$v_0.append('<b:value i:type="');$v_0.append(entity.attributeTypes[$v_2].toString());$v_0.append('" ');if(!_String.isNullOrEmpty(entity.attributeTypeNamespaces[$v_2])){$v_0.append('xmlns:c="');$v_0.append(entity.attributeTypeNamespaces[$v_2].toString());$v_0.append('"')}$v_0.append(">");var $v_4=entity.attributeTypes[$v_2];switch($v_4){case "a:EntityReference":$v_0.append(Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.toXml($v_3));break;case "a:EntityCollection":$v_0.append(Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.toXml($v_3,true));break;case "c:dateTime":$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.toCrmDateTimeString($v_3));break;case "c:boolean":$v_0.append($v_3.toString());break;case "c:int":$v_0.append($v_3.toString());break;case "c:guid":$v_0.append($v_3.toString().replace("{","").replace("}",""));break;case "a:Money":$v_0.append("<a:Value>");$v_0.append($v_3.toString());$v_0.append("</a:Value>");break;case "a:OptionSetValue":$v_0.append("<a:Value>");$v_0.append($v_3.toString());$v_0.append("</a:Value>");break;default:$v_0.append(Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_3));break}$v_0.appendLine("</b:value>");$v_0.appendLine("</a:KeyValuePairOfstringanyType>")}$v_0.appendLine("</a:Attributes>");return $v_0.toString()};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$s=function($p0,$p1){if(!IsNull($p1))for(var $v_1=0;$v_1<$p1.length;$v_1++){var $v_2=$p1[$v_1];if(Type.isClass($v_2)&&$v_2.getBaseType()&&$v_2.getBaseType().getName()===Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.getName()){var $v_3=$v_2.entityLogicalName;if(!_String.isNullOrEmpty($v_3)&&$v_3===$p0)return new $v_2}}if(!Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$K){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$K={};var $v_4=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.getName(),$v_5=$v_4.substr(0,$v_4.lastIndexOf(".")),$v_6=Type.parse($v_5),$$dict_A=$v_6;for(var $$key_B in $$dict_A){var $v_7={key:$$key_B,value:$$dict_A[$$key_B]};if(Type.isClass($v_7.value)&&$v_7.value.getBaseType()&&$v_7.value.getBaseType().getName()===Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.getName()){var $v_8=$v_7.value.entityLogicalName;if(!_String.isNullOrEmpty($v_8))Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$K[$v_8]=$v_7.value}}}var $v_0=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$K[$p0];if(!IsNull($v_0))return new $v_0;else return new Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity($p0)};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.loadFromXml=function(xmlNode,types){var $v_0=xmlNode.selectSingleNode("a:LogicalName");if(!$v_0)return null;var $v_1=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$s(xmlNode.selectSingleNode("a:LogicalName").get_innerText(),types),$v_2=xmlNode.selectNodes("a:Attributes/a:KeyValuePairOfstringanyType");$v_1.set_id(xmlNode.selectSingleNode("a:Id").get_innerText());for(var $v_5=0;$v_5<$v_2.get_count();$v_5++){var $v_6=$v_2.get_item($v_5).selectSingleNode("b:value"),$v_7=$v_2.get_item($v_5).selectSingleNode("b:key"),$v_8=$v_6.getAttribute("i:type"),$v_9=$v_6.getAttribute("xmlns:c");if($v_8==="a:AliasedValue"){$v_6=$v_6.selectSingleNode("a:Value");$v_8=$v_6.getAttribute("i:type");$v_9=$v_6.getAttribute("xmlns:c")}$v_1.attributeTypes[$v_7.get_innerText()]=$v_8;$v_1.attributeTypeNamespaces[$v_7.get_innerText()]=$v_9;switch($v_8){case "a:EntityReference":$v_1.attributes[$v_7.get_innerText()]=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.$V($v_6);break;case "c:dateTime":$v_1.attributes[$v_7.get_innerText()]=Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.fromCrmDateTimeString($v_6.get_innerText());break;case "c:int":case "a:OptionSetValue":if(!_String.isNullOrEmpty($v_6.get_innerText()))$v_1.attributes[$v_7.get_innerText()]=parseInt($v_6.get_innerText());break;case "c:boolean":if(!_String.isNullOrEmpty($v_6.get_innerText()))$v_1.attributes[$v_7.get_innerText()]=Boolean.parse($v_6.get_innerText());break;default:$v_1.attributes[$v_7.get_innerText()]=$v_6.get_innerText();break}}var $v_3=xmlNode.selectNodes("a:FormattedValues/a:KeyValuePairOfstringstring");if(!IsNull($v_3))for(var $v_A=0;$v_A<$v_3.get_count();$v_A++){var $v_B=$v_3.get_item($v_A).selectSingleNode("b:key"),$v_C=$v_3.get_item($v_A).selectSingleNode("b:value");if(!IsNull($v_B)&&!IsNull($v_C)&&!IsNull($v_B.get_innerText()))$v_1.formattedValues[$v_B.get_innerText()]=$v_C.get_innerText()}var $v_4=xmlNode.selectSingleNode("a:RelatedEntities");if($v_4)$v_1.relatedEntities=Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.$V($v_4,types);return $v_1};Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype={$S_0:null,logicalName:null,attributes:null,attributeTypes:null,attributeTypeNamespaces:null,relatedEntities:null,formattedValues:null,get_id:function(){return this.$S_0},set_id:function(value){this.$S_0=value;return value},toTypedEntity:function(T){var $v_0=new T;$v_0.set_id(this.get_id());$v_0.attributes=this.attributes;$v_0.attributeTypes=this.attributeTypes;$v_0.attributeTypeNamespaces=this.attributeTypeNamespaces;$v_0.relatedEntities=this.relatedEntities;return $v_0},initMetadata:function(){},setAttribute:function(key,value,type){Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,key,type);this.attributes[key]=value}};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection=function(){this.$1_0=new Array(0)};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.createInstance=function(collection){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection;$v_0.$1_0=collection;return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.loadFromXml=function(entityCollectionNode,types){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection,$v_1=entityCollectionNode.selectSingleNode("a:EntityName");if(!$v_1)return $v_0;for(var $v_2=$v_1.get_innerText(),$v_3=entityCollectionNode.selectNodes("a:Entities/a:Entity"),$v_4=0;$v_4<$v_3.get_count();$v_4++){var $v_5=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.loadFromXml($v_3.get_item($v_4),types);$v_0.$1_0[$v_0.$1_0.length]=$v_5}return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.toXml=function(entities,skipRootNS){for(var $v_0="<a:Entities>",$$arr_3=entities.$1_0,$$len_4=$$arr_3.length,$$idx_5=0;$$idx_5<$$len_4;++$$idx_5){var $v_1=$$arr_3[$$idx_5];$v_0+=Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.toXml($v_1,skipRootNS)}$v_0+="</a:Entities>";return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.prototype={$1_0:null,get_entities:function(){return this.$1_0},get_item:function(index){return this.$1_0[index]},set_item:function(index,value){this.$1_0[index]=value;return value},get_length:function(){return this.$1_0.length}};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata=function(logicalName){this.$h_0=logicalName};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata.$V=function($p0){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata($p0.selectSingleNode("c:LogicalName").get_innerText());$v_0.$f_0=$p0.selectSingleNode("c:DisplayName/a:UserLocalizedLabel/a:Label").get_innerText();$v_0.$i_0=$p0.selectSingleNode("c:DisplayCollectionName/a:UserLocalizedLabel/a:Label").get_innerText();return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata.prototype={$h_0:null,$f_0:null,$i_0:null,get_logicalName:function(){return this.$h_0},get_displayName:function(){return this.$f_0},get_pluralName:function(){return this.$i_0}};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference=function(){};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.createEntityReference=function(id,logicalName,name){var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=id.replace("{","").replace("}","");$v_0.logicalName=logicalName;$v_0.name=name;return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.$V=function($p0){if(!$p0)return null;var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=$p0.selectSingleNode("a:Id").get_innerText();$v_0.logicalName=$p0.selectSingleNode("a:LogicalName").get_innerText();$v_0.name=$p0.selectSingleNode("a:Name").get_innerText();return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.toXml=function(entityReference){if(!entityReference)return "";var $v_0="<a:Id>"+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityReference.id)+"</a:Id>";$v_0+="<a:LogicalName>"+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityReference.logicalName)+"</a:LogicalName>";if(!_String.isNullOrEmpty(entityReference.name))$v_0+="<a:Name>"+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(entityReference.name)+"</a:Name>";else $v_0+='<a:Name i:nil="true" />';return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.prototype={id:null,logicalName:null,name:null};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection=function(){this.$1_0=new Array(0)};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection.loadFromXml=function(entityReferenceCollectionNode){for(var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection,$v_1=entityReferenceCollectionNode.selectNodes("//a:EntityReference"),$v_2=0;$v_2<$v_1.get_count();$v_2++){var $v_3=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.$V($v_1.get_item($v_2));$v_0.set_item($v_0.get_length(),$v_3)}return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection.prototype={$1_0:null,get_item:function(index){return this.$1_0[index]},set_item:function(index,value){this.$1_0[index]=value;return value},get_length:function(){return this.$1_0.length}};Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.initializeBase(this,["incident"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.prototype={get_id:function(){return this.get_incidentId()},set_id:function(value){this.set_incidentId(value);return value},get_incidentId:function(){return this.attributes["incidentid"]},set_incidentId:function(value){this.attributes["incidentid"]=value;return value},get_title:function(){return this.attributes["title"]},set_title:function(value){this.attributes["title"]=value;return value},get_caseNumber:function(){return this.attributes["ticketnumber"]},set_caseNumber:function(value){this.attributes["ticketnumber"]=value;return value},get_createdOn:function(){return this.attributes["createdon"]},set_createdOn:function(value){this.attributes["createdon"]=value;return value},get_formattedCreatedOn:function(){return this.formattedValues["createdon"]},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"incidentid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"title",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"ticketnumber",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"createdon",3)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities=function(){};Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.parseMruXml=function(xml,dataElementPath){var $v_0=Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.create(XUI.Xml.LoadXml(xml)),$v_1=new Array(0),$v_2=$v_0.selectNodes(dataElementPath);if(!IsNull($v_2))for(var $v_3=0;$v_3<$v_2.get_count();$v_3++){var $v_4=$v_2.get_item($v_3),$v_5=parseInt(Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"Type"),10),$v_6=Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"ObjectId");if(IsNull($v_6)||IsNull(Sales.Common.CrmSoapServiceProxy.Utils.Utils.tryParseGuid($v_6)))continue;var $v_7=new Xrm.Objects.RecentlyViewedItem;$v_7.displayName=Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"DisplayName");$v_7.title=Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"Title");$v_7.action=Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"Action");$v_7.iconPath=Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"IconPath");$v_7.entityTypeCode=Number.parseInvariant(Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"EntityTypeCode"));$v_7.lastAccessed=new Date(Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B($v_4,"LastAccessed"));$v_7.objectId=$v_6;$v_7.type=$v_5;$v_1[$v_1.length]=$v_7}$v_1.reverse();$v_1.sort(Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.lastAccessedComparer);return $v_1};Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.serializeMruXml=function(items){if(IsNull(items)||items.length<1)return null;for(var $v_0={},$v_1,$v_2=0;$v_2<items.length;$v_2++){var $v_3=items[$v_2].entityTypeCode,$v_4=items[$v_2].lastAccessed;if($v_4===_DateTime.empty){$v_4=_DateTime.get_now();$v_4.setHours($v_4.getHours()+$v_4.getTimezoneOffset()/60)}var $v_5=String.format("\r\n\t\t\t\t\t<RecentlyViewedItem>\r\n\t\t\t\t\t\t<Type>{1}</Type>\r\n\t\t\t\t\t\t<ObjectId>{2}</ObjectId>\r\n\t\t\t\t\t\t<EntityTypeCode>{0}</EntityTypeCode>\r\n\t\t\t\t\t\t<Title>{3}</Title>\r\n\t\t\t\t\t\t<LastAccessed>{4}</LastAccessed>\r\n\t\t\t\t\t\t<Action>{5}</Action>\r\n\t\t\t\t\t\t<PinStatus>{6}</PinStatus>\r\n\t\t\t\t\t</RecentlyViewedItem>",items[$v_2].entityTypeCode,0,Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(items[$v_2].objectId),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(items[$v_2].title),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_4.format("MM/dd/yyyy HH:mm:ss")),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(items[$v_2].action),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode(items[$v_2].pinStatus.toString()==="1"?"true":"false"));if($v_3.toString() in $v_0){$v_1=$v_0[$v_3.toString()];$v_0[$v_3.toString()]=$v_1+$v_5}else $v_0[$v_3.toString()]=$v_5}$v_1="";var $$dict_8=$v_0;for(var $$key_9 in $$dict_8){var $v_6={key:$$key_9,value:$$dict_8[$$key_9]};$v_1+=String.format("<RecentlyViewedEntityData etc='{0}'>{1}</RecentlyViewedEntityData>",Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlAttributeEncode($v_6.key),$v_6.value)}return "<RecentlyViewedData>"+$v_1+"</RecentlyViewedData>"};Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.lastAccessedComparer=function(recordA,recordB){var $v_0=recordA,$v_1=recordB;return $v_1.lastAccessed-$v_0.lastAccessed};Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.$B=function($p0,$p1){var $v_0=$p0.selectSingleNode($p1);if(!IsNull($v_0))return $v_0.get_innerText();else return null};Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.initializeBase(this,["opportunity"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.prototype={get_id:function(){return this.get_opportunityId()},set_id:function(value){this.set_opportunityId(value);return value},get_opportunityId:function(){return this.attributes["opportunityid"]},set_opportunityId:function(value){this.attributes["opportunityid"]=value;return value},get_topic:function(){return this.attributes["name"]},set_topic:function(value){this.attributes["name"]=value;return value},get_estimatedValue:function(){return this.attributes["estimatedvalue"]},set_estimatedValue:function(value){this.attributes["estimatedvalue"]=value;return value},get_formattedEstimatedvalue:function(){return this.formattedValues["estimatedvalue"]},get_estimatedCloseDate:function(){return this.attributes["estimatedclosedate"]},set_estimatedCloseDate:function(value){this.attributes["estimatedclosedate"]=value;return value},get_formattedEstimatedCloseDate:function(){return this.formattedValues["estimatedclosedate"]},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"opportunityid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"name",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"estimatedvalue",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"estimatedclosedate",3)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection=function(){this.$L_0={}};Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.$V=function($p0,$p1){for(var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection,$v_1=$p0.selectNodes("*"),$v_2=0;$v_2<$v_1.get_count();$v_2++){if($v_1.get_item($v_2).get_tagName().indexOf("KeyValuePairOfRelationshipEntityCollection")<0)return $v_0;var $v_3=!IsNull($v_1.get_item($v_2).selectSingleNode("b:key/a:SchemaName"))?$v_1.get_item($v_2).selectSingleNode("b:key/a:SchemaName").get_innerText():null;if(!_String.isNullOrEmpty($v_3)){var $v_4=$v_1.get_item($v_2).selectSingleNode("b:value");if(!IsNull($v_4)){var $v_5=Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.loadFromXml($v_4,$p1);$v_0.$L_0[$v_3]=$v_5}}}return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.$q=function($p0){var $v_0='<a:RelatedEntities xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">';$v_0+="</a:RelatedEntities>";return $v_0};Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.prototype={$L_0:null,get_item:function(key){return this.$L_0[key]},set_item:function(key,value){this.$L_0[key]=value;return value}};Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.initializeBase(this,["systemform"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.prototype={get_id:function(){return this.get_systemFormId()},set_id:function(value){this.set_systemFormId(value);return value},get_systemFormId:function(){return this.attributes["id"]},set_systemFormId:function(value){this.attributes["id"]=value;return value},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"id",2)}};Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser=function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.initializeBase(this,["systemuser"])};Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.prototype={get_firstName:function(){return this.attributes["firstname"]},get_lastName:function(){return this.attributes["lastname"]},get_fullName:function(){return this.attributes["fullname"]},get_internalEmailAddress:function(){return this.attributes["internalemailaddress"]},get_personalEmailAddress:function(){return this.attributes["personalemailaddress"]},get_id:function(){return this.get_systemUserId()},set_id:function(value){this.set_systemUserId(value);return value},get_systemUserId:function(){return this.attributes["systemuserid"]},set_systemUserId:function(value){this.attributes["systemuserid"]=value;return value},get_title:function(){return this.attributes["title"]},set_title:function(value){this.attributes["title"]=value;return value},get_yammerEmailAddress:function(){return this.attributes["yammeremailaddress"]},set_yammerEmailAddress:function(value){this.attributes["yammeremailaddress"]=value;return value},get_yammerUserId:function(){return this.attributes["yammeruserid"]},set_yammerUserId:function(value){this.attributes["yammeruserid"]=value;return value},initMetadata:function(){Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.prototype.initMetadata.call(this);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"systemuserid",2);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"firstname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"lastname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"fullname",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"internalemailaddress",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"personalemailaddress",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"title",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"yammeremailaddress",0);Sales.Common.CrmSoapServiceProxy.MetadataHelper.addEntityMetadataDefinition(this,"yammeruserid",0)}};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.Parser");Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode=function(){};Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode.registerInterface("Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode");Sales.Common.CrmSoapServiceProxy.Parser.IXmlNodeList=function(){};Sales.Common.CrmSoapServiceProxy.Parser.IXmlNodeList.registerInterface("Sales.Common.CrmSoapServiceProxy.Parser.IXmlNodeList");Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper=function($p0,$p1,$p2){this.$6_0=[];if(!IsNull($p1.length))for(var $v_0=$p1,$v_1=0;$v_1<$v_0.length;$v_1++)Array.add(this.$6_0,new Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper($p0,$v_0[$v_1],$p2));else for(var $v_2=$p1,$v_3=0;$v_3<$v_2.snapshotLength;$v_3++)Array.add(this.$6_0,new Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper($p0,$v_2.snapshotItem($v_3),$p2))};Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper.prototype={$6_0:null,get_count:function(){return this.$6_0.length},get_item:function($p0){return this.$6_0[$p0]}};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory=function(){};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.create=function(node){if(IsNull(node))return null;if(!Mscrm.CrmBrowser.get_currentBrowser().get_hasXPathEvaluator())return new Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper(node);else return new Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper(node)};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.parseXmlDocument=function(xml){var $v_0=null;if(Mscrm.Utilities.isIE9())for(var $v_1=["Microsoft.XMLDOM","Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"],$v_2=0;$v_2<$v_1.length;$v_2++){$v_0=new ActiveXObject($v_1[$v_2]);if(!IsNull($v_0)){$v_0.async=false;$v_0.resolveExternals=false;$v_0.loadXML(xml);$v_0.setProperty("SelectionLanguage","XPath");$v_0.setProperty("SelectionNamespaces","xmlns:d='http://schemas.microsoft.com/xrm/2011/Contracts/Services' xmlns:a='http://schemas.microsoft.com/xrm/2011/Contracts' xmlns:b='http://schemas.datacontract.org/2004/07/System.Collections.Generic' xmlns:i='http://www.w3.org/2001/XMLSchema-instance'");if(!_String.isNullOrEmpty($v_0.text))break}}if(IsNull($v_0))$v_0=Sys.Net.XMLDOM(xml);if(!IsNull($v_0)){var $v_3=Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.create($v_0),$v_4=$v_3.selectSingleNode("/parsererror");if(!IsNull($v_4)&&$v_4.get_tagName()==="parsererror")$v_0=null}return $v_0};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper=function($p0){var $v_0=$p0;this.$6_0=[];for(var $v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];Array.add(this.$6_0,new Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper($v_2,true))}};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper.prototype={$6_0:null,get_count:function(){return this.$6_0.length},get_item:function($p0){return this.$6_0[$p0]}};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper=function($p0,$p1){this.$9_0=$p0;this.$H_0=!IsNull($p1)&&$p1;this.$5_0=this.$H_0?null:{}};Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper.prototype={$9_0:null,$5_0:null,$H_0:false,get_xmlElement:function(){return this.$9_0},get_element:function(){return this.$9_0},addNamespace:function($p0,$p1){if(!this.$H_0)this.$5_0[$p0]=$p1},selectSingleNode:function($p0){this.$m_0();var $v_0=this.$9_0.selectSingleNode($p0);return !$v_0?null:new Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper($v_0,true)},selectNodes:function($p0){this.$m_0();return new Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper(this.$9_0.selectNodes($p0))},get_innerText:function(){return this.$9_0.text},get_outerXml:function(){return this.$9_0.xml},getAttribute:function($p0){return this.get_xmlElement().getAttribute($p0)},getElementsByTagName:function($p0){return new Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper(this.get_element().getElementsByTagName($p0))},hasChildNodes:function(){return this.$9_0.hasChildNodes()},get_tagName:function(){return this.get_element().tagName},$m_0:function(){if(!this.$H_0){var $v_0=new Sys.StringBuilder,$v_1="",$$dict_3=this.$5_0;for(var $$key_4 in $$dict_3){var $v_2={key:$$key_4,value:$$dict_3[$$key_4]};$v_0.append(String.format("{0}xmlns:{1}='{2}'",$v_1,Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2.key),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.xmlEncode($v_2.value)));$v_1=" "}this.get_xmlElement().setProperty("SelectionLanguage","XPath");this.get_xmlElement().setProperty("SelectionNamespaces",$v_0.toString());this.$H_0=true}}};Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper=function($p0,$p1,$p2){this.$$d_$t_0=Function.createDelegate(this,this.$t_0);this.$F_0=$p0;this.$7_0=IsNull($p1)?$p0:$p1;this.$5_0=IsNull($p2)?{}:$p2};Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper.prototype={$5_0:null,$F_0:null,$7_0:null,addNamespace:function($p0,$p1){this.$5_0[$p0]=$p1},selectSingleNode:function($p0){var $v_0=this.$F_0.evaluate($p0,this.$7_0,this.$$d_$t_0,9,null);return IsNull($v_0.singleNodeValue)?null:new Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper(this.$F_0,$v_0.singleNodeValue,this.$5_0)},selectNodes:function($p0){return new Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper(this.$F_0,this.$F_0.evaluate($p0,this.$7_0,this.$$d_$t_0,7,null),this.$5_0)},get_innerText:function(){return this.$7_0.textContent},get_outerXml:function(){return (new XMLSerializer).serializeToString(this.$7_0)},getAttribute:function($p0){return this.$7_0.getAttribute($p0)},getElementsByTagName:function($p0){return new Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper(this.$F_0,this.$7_0.getElementsByTagName($p0),this.$5_0)},hasChildNodes:function(){return this.$7_0.hasChildNodes()},get_tagName:function(){return this.$7_0.tagName},$t_0:function($p0){if($p0 in this.$5_0)return this.$5_0[$p0];else return null}};Type.registerNamespace("Sales.Common.CrmSoapServiceProxy.Stubs");Sales.Common.CrmSoapServiceProxy.Stubs.XPathResultType=function(){};Sales.Common.CrmSoapServiceProxy.Stubs.XPathResultType.prototype={ANY_TYPE:0,NUMBER_TYPE:1,STRING_TYPE:2,BOOLEAN_TYPE:3,UNORDERED_NODE_ITERATOR_TYPE:4,ORDERED_NODE_ITERATOR_TYPE:5,UNORDERED_NODE_SNAPSHOT_TYPE:6,ORDERED_NODE_SNAPSHOT_TYPE:7,ANY_UNORDERED_NODE_TYPE:8,FIRST_ORDERED_NODE_TYPE:9};Sales.Common.CrmSoapServiceProxy.Stubs.XPathResultType.registerEnum("Sales.Common.CrmSoapServiceProxy.Stubs.XPathResultType",false);Mscrm.RemoteCommandJson.registerClass("Mscrm.RemoteCommandJson");Mscrm.InternalUtilities.Sdk.registerClass("Mscrm.InternalUtilities.Sdk");Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.registerClass("Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase");Sales.Common.CrmSoapServiceProxy.AttributeType.registerClass("Sales.Common.CrmSoapServiceProxy.AttributeType");Sales.Common.CrmSoapServiceProxy.MetadataHelper.registerClass("Sales.Common.CrmSoapServiceProxy.MetadataHelper");Sales.Common.CrmSoapServiceProxy.SoapParameter.registerClass("Sales.Common.CrmSoapServiceProxy.SoapParameter");Sales.Common.CrmSoapServiceProxy.BooleanParameter.registerClass("Sales.Common.CrmSoapServiceProxy.BooleanParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.ColumnSetParameter.registerClass("Sales.Common.CrmSoapServiceProxy.ColumnSetParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.EntityParameter.registerClass("Sales.Common.CrmSoapServiceProxy.EntityParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter.registerClass("Sales.Common.CrmSoapServiceProxy.EntityReferenceParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter.registerClass("Sales.Common.CrmSoapServiceProxy.EntityReferenceCollectionParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter.registerClass("Sales.Common.CrmSoapServiceProxy.EntityRelationshipParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter.registerClass("Sales.Common.CrmSoapServiceProxy.FetchExpressionParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.GuidParameter.registerClass("Sales.Common.CrmSoapServiceProxy.GuidParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.StringParameter.registerClass("Sales.Common.CrmSoapServiceProxy.StringParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter.registerClass("Sales.Common.CrmSoapServiceProxy.OptionSetValueParameter",Sales.Common.CrmSoapServiceProxy.SoapParameter);Sales.Common.CrmSoapServiceProxy.Utils.Utils.registerClass("Sales.Common.CrmSoapServiceProxy.Utils.Utils");Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.registerClass("Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils");Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.registerClass("Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils");Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault.registerClass("Sales.Common.CrmSoapServiceProxy.Faults.OrganizationServiceFault");Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.registerClass("Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes");Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse");Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.ConvertActivityResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.CrmErrorResponse");Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.ExecuteCreateResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.QualifyLeadResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.RetrieveAttributeResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.RetrieveEntityResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.RetrieveFilteredFormsResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.RetrieveMultipleResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.RetrieveResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.SchedulingNotification.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.SchedulingNotification");Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.SchedulingResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse.registerClass("Sales.Common.CrmSoapServiceProxy.Messages.UpdateResponse",Sales.Common.CrmSoapServiceProxy.Messages.OrganizationResponse);Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity");Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityCollection");Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityMetadata",null,Sales.Common.CrmSoapServiceProxy.ObjectModel.IEntityMetadata);Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference");Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReferenceCollection");Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.MruUtilities");Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.RelatedEntityCollection");Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.registerClass("Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser",Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity);Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper.registerClass("Sales.Common.CrmSoapServiceProxy.Parser.NodeSnapshotWrapper",null,Sales.Common.CrmSoapServiceProxy.Parser.IXmlNodeList);Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory.registerClass("Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeFactory");Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper.registerClass("Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeListWrapper",null,Sales.Common.CrmSoapServiceProxy.Parser.IXmlNodeList);Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper.registerClass("Sales.Common.CrmSoapServiceProxy.Parser.XmlNodeWrapper",null,Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode);Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper.registerClass("Sales.Common.CrmSoapServiceProxy.Parser.XPathEvaluatorWrapper",null,Sales.Common.CrmSoapServiceProxy.Parser.IXmlNode);Mscrm.InternalUtilities.Sdk.$X=null;Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.$g=true;Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.soapExecuteAction="http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute";Sales.Common.CrmSoapServiceProxy.CrmSoapServiceBase.timeout=1e4;Sales.Common.CrmSoapServiceProxy.AttributeType.string=0;Sales.Common.CrmSoapServiceProxy.AttributeType.integer=1;Sales.Common.CrmSoapServiceProxy.AttributeType.guid=2;Sales.Common.CrmSoapServiceProxy.AttributeType.dateTime=3;Sales.Common.CrmSoapServiceProxy.AttributeType.entityReference=4;Sales.Common.CrmSoapServiceProxy.AttributeType.entityCollection=5;Sales.Common.CrmSoapServiceProxy.AttributeType.optionSet=6;Sales.Common.CrmSoapServiceProxy.AttributeType.bool=7;Sales.Common.CrmSoapServiceProxy.AttributeType.decimal=8;Sales.Common.CrmSoapServiceProxy.AttributeType.doubleNumber=9;Sales.Common.CrmSoapServiceProxy.AttributeType.money=10;Sales.Common.CrmSoapServiceProxy.MetadataHelper.stringAttributeType="c:string";Sales.Common.CrmSoapServiceProxy.MetadataHelper.guidAttributeType="c:guid";Sales.Common.CrmSoapServiceProxy.MetadataHelper.entityReferenceAttributeType="a:EntityReference";Sales.Common.CrmSoapServiceProxy.MetadataHelper.dateTimeAttributeType="c:dateTime";Sales.Common.CrmSoapServiceProxy.MetadataHelper.intAttributeType="c:int";Sales.Common.CrmSoapServiceProxy.MetadataHelper.booleanAttributeType="c:boolean";Sales.Common.CrmSoapServiceProxy.MetadataHelper.decimalAttributeType="c:decimal";Sales.Common.CrmSoapServiceProxy.MetadataHelper.doubleAttributeType="c:double";Sales.Common.CrmSoapServiceProxy.MetadataHelper.aliasedValueAttributeType="a:AliasedValue";Sales.Common.CrmSoapServiceProxy.MetadataHelper.optionSetAttributeType="a:OptionSetValue";Sales.Common.CrmSoapServiceProxy.MetadataHelper.entityCollectionType="a:EntityCollection";Sales.Common.CrmSoapServiceProxy.MetadataHelper.moneyAttributeType="a:Money";Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$Q=new Date(0);Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$r=new RegExp("[Z,T]","ig");Sales.Common.CrmSoapServiceProxy.Utils.DateTimeUtils.$k=new RegExp("[-]","ig");Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.objectDoesNotExist=-2147220969;Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.privilegeDenied=-2147220960;Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.unManagedIdsAccessDenied=-2147187962;Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.mustContainAtLeastACharInMention=-2147158364;Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.duplicateRecord=-2147220937;Sales.Common.CrmSoapServiceProxy.Faults.SystemErrorCodes.isvAborted=-2147220891;Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.activityIdAttributeName="activityid";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.activityTypeCodeAttributeName="activitytypecode";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.dueDateAttributeName="scheduledend";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.priorityAttributeName="prioritycode";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.subjectAttributeName="subject";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.entityLogicalName="activitypointer";Sales.Common.CrmSoapServiceProxy.ObjectModel.ActivityPointer.entityTypeCode=4200;Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.lastNameAttributeName="lastname";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.contactIdAttributeName="contactid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.emailAddress1AttributeName="emailaddress1";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.emailAddress2AttributeName="emailaddress2";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.emailAddress3AttributeName="emailaddress3";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.fullNameAttributeName="fullname";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.jobTitleAttributeName="jobtitle";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.parentCustomerIdAttributeName="parentcustomerid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.personIdAttributeName="personid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.transactionCurrencyIdAttributeName="transactioncurrencyid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.salesToDateAttributeName="salestodate";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.currentSalePipelineAttributeName="currentsalespipeline";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.openOpportunityCountAttributeName="openopportunitycount";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.emailSearchEmailAttributeName="emailsearch1.emailaddress";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.entityLogicalName="contact";Sales.Common.CrmSoapServiceProxy.ObjectModel.Contact.entityTypeCode=2;Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.emailSearchIdAttributeName="emailsearchid";Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.emailAddressAttributeName="emailaddress";Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.parentObjectIdAttributeName="parentobjectid";Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.parentObjectTypeCodeAttributeName="parentobjecttypecode";Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.entityLogicalName="emailsearch";Sales.Common.CrmSoapServiceProxy.ObjectModel.EmailSearch.entityTypeCode=4299;Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.entityLogicalName="entity";Sales.Common.CrmSoapServiceProxy.ObjectModel.Entity.$K=null;Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.incidentIdAttributeName="incidentid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.titleAttributeName="title";Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.caseNumberAttributeName="ticketnumber";Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.createdOnAttributeName="createdon";Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.entityLogicalName="incident";Sales.Common.CrmSoapServiceProxy.ObjectModel.Incident.entityTypeCode=112;Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.opportunityIdAttributeName="opportunityid";Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.topicAttributeName="name";Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.estimatedValueAttributeName="estimatedvalue";Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.estimatedCloseDateAttributeName="estimatedclosedate";Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.entityLogicalName="opportunity";Sales.Common.CrmSoapServiceProxy.ObjectModel.Opportunity.entityTypeCode=3;Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.systemFormIdAttributeName="id";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.entityLogicalName="systemform";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemForm.entityTypeCode=1030;Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.firstNameAttributeName="firstname";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.lastNameAttributeName="lastname";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.fullNameAttributeName="fullname";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.systemUserIdAttributeName="systemuserid";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.internalEmailAddressAttributeName="internalemailaddress";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.personalEmailAddressAttributeName="personalemailaddress";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.titleAttributeName="title";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.yammerEmailAddressAttributeName="yammeremailaddress";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.yammerUserIdAttributeName="yammeruserid";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.entityLogicalName="systemuser";Sales.Common.CrmSoapServiceProxy.ObjectModel.SystemUser.entityTypeCode=8</script><script id="/_static/_common/scripts/wall.interfaces.js?ver=1888157098" type="text/javascript">Type.registerNamespace("Wall.Interfaces");Wall.Interfaces.IComment=function(){};Wall.Interfaces.IComment.registerInterface("Wall.Interfaces.IComment");Wall.Interfaces.ICreateCommentResponse=function(){};Wall.Interfaces.ICreateCommentResponse.registerInterface("Wall.Interfaces.ICreateCommentResponse");Wall.Interfaces.ICreateLikeResponse=function(){};Wall.Interfaces.ICreateLikeResponse.registerInterface("Wall.Interfaces.ICreateLikeResponse");Wall.Interfaces.ICreatePostResponse=function(){};Wall.Interfaces.ICreatePostResponse.registerInterface("Wall.Interfaces.ICreatePostResponse");Wall.Interfaces.IDeleteCommentResponse=function(){};Wall.Interfaces.IDeleteCommentResponse.registerInterface("Wall.Interfaces.IDeleteCommentResponse");Wall.Interfaces.IDeleteLikeResponse=function(){};Wall.Interfaces.IDeleteLikeResponse.registerInterface("Wall.Interfaces.IDeleteLikeResponse");Wall.Interfaces.IDeletePostResponse=function(){};Wall.Interfaces.IDeletePostResponse.registerInterface("Wall.Interfaces.IDeletePostResponse");Wall.Interfaces.IEntityReference=function(){};Wall.Interfaces.IEntityReference.registerInterface("Wall.Interfaces.IEntityReference");Wall.Interfaces.IPost=function(){};Wall.Interfaces.IPost.registerInterface("Wall.Interfaces.IPost");Wall.Interfaces.IPostResponse=function(){};Wall.Interfaces.IPostResponse.registerInterface("Wall.Interfaces.IPostResponse");Wall.Interfaces.IRetrieveCommentsRequest=function(){};Wall.Interfaces.IRetrieveCommentsRequest.registerInterface("Wall.Interfaces.IRetrieveCommentsRequest");Wall.Interfaces.IRetrieveCommentsResponse=function(){};Wall.Interfaces.IRetrieveCommentsResponse.registerInterface("Wall.Interfaces.IRetrieveCommentsResponse");Wall.Interfaces.IRetrieveWallFiltersResponse=function(){};Wall.Interfaces.IRetrieveWallFiltersResponse.registerInterface("Wall.Interfaces.IRetrieveWallFiltersResponse");Wall.Interfaces.IRetrieveLikesRequest=function(){};Wall.Interfaces.IRetrieveLikesRequest.registerInterface("Wall.Interfaces.IRetrieveLikesRequest");Wall.Interfaces.IRetrieveLikesResponse=function(){};Wall.Interfaces.IRetrieveLikesResponse.registerInterface("Wall.Interfaces.IRetrieveLikesResponse");Wall.Interfaces.IRetrievePostsRequest=function(){};Wall.Interfaces.IRetrievePostsRequest.registerInterface("Wall.Interfaces.IRetrievePostsRequest");Wall.Interfaces.IRetrievePostsResponse=function(){};Wall.Interfaces.IRetrievePostsResponse.registerInterface("Wall.Interfaces.IRetrievePostsResponse");Wall.Interfaces.ISetDefaultFilterResponse=function(){};Wall.Interfaces.ISetDefaultFilterResponse.registerInterface("Wall.Interfaces.ISetDefaultFilterResponse");Wall.Interfaces.ISystemUser=function(){};Wall.Interfaces.ISystemUser.registerInterface("Wall.Interfaces.ISystemUser");Wall.Interfaces.IWall=function(){};Wall.Interfaces.IWall.registerInterface("Wall.Interfaces.IWall");Wall.Interfaces.IWallAction=function(){};Wall.Interfaces.IWallAction.registerInterface("Wall.Interfaces.IWallAction");Wall.Interfaces.IWallFilter=function(){};Wall.Interfaces.IWallFilter.registerInterface("Wall.Interfaces.IWallFilter");Wall.Interfaces.IWallService=function(){};Wall.Interfaces.IWallService.registerInterface("Wall.Interfaces.IWallService");Wall.Interfaces.IWallServiceFactory=function(){};Wall.Interfaces.IWallServiceFactory.registerInterface("Wall.Interfaces.IWallServiceFactory");Type.registerNamespace("Wall.Interfaces.EventArguments");Wall.Interfaces.EventArguments.CommentCreatedEventArgs=function(comment){Wall.Interfaces.EventArguments.CommentCreatedEventArgs.initializeBase(this);this.$2_1=comment};Wall.Interfaces.EventArguments.CommentCreatedEventArgs.prototype={$2_1:null,get_comment:function(){return this.$2_1}};Wall.Interfaces.EventArguments.CommentDeletedEventArgs=function(commentId){Wall.Interfaces.EventArguments.CommentDeletedEventArgs.initializeBase(this);this.$3_1=commentId};Wall.Interfaces.EventArguments.CommentDeletedEventArgs.prototype={$3_1:null,get_commentId:function(){return this.$3_1}};Wall.Interfaces.EventArguments.CommentsRefreshedEventArgs=function(comments){Wall.Interfaces.EventArguments.CommentsRefreshedEventArgs.initializeBase(this);this.$4_1=comments};Wall.Interfaces.EventArguments.CommentsRefreshedEventArgs.prototype={$4_1:null,get_comments:function(){return this.$4_1}};Wall.Interfaces.EventArguments.ErrorEventArgs=function(response){Wall.Interfaces.EventArguments.ErrorEventArgs.initializeBase(this);this.$8_1=response};Wall.Interfaces.EventArguments.ErrorEventArgs.prototype={$8_1:null,get_response:function(){return this.$8_1}};Wall.Interfaces.EventArguments.FiltersRefreshedEventArgs=function(filterType,filters){Wall.Interfaces.EventArguments.FiltersRefreshedEventArgs.initializeBase(this);this.$6_1=filterType;this.$5_1=filters};Wall.Interfaces.EventArguments.FiltersRefreshedEventArgs.prototype={$6_1:null,$5_1:null,get_filters:function(){return this.$5_1},get_filterType:function(){return this.$6_1}};Wall.Interfaces.EventArguments.PostCreatedEventArgs=function(post){Wall.Interfaces.EventArguments.PostCreatedEventArgs.initializeBase(this);this.$0_1=post};Wall.Interfaces.EventArguments.PostCreatedEventArgs.prototype={$0_1:null,get_post:function(){return this.$0_1}};Wall.Interfaces.EventArguments.PostCreatingEventArgs=function(post){Wall.Interfaces.EventArguments.PostCreatingEventArgs.initializeBase(this);this.$0_1=post};Wall.Interfaces.EventArguments.PostCreatingEventArgs.prototype={$0_1:null,get_post:function(){return this.$0_1}};Wall.Interfaces.EventArguments.PostDeletedEventArgs=function(postId){Wall.Interfaces.EventArguments.PostDeletedEventArgs.initializeBase(this);this.$7_1=postId};Wall.Interfaces.EventArguments.PostDeletedEventArgs.prototype={$7_1:null,get_postId:function(){return this.$7_1}};Wall.Interfaces.EventArguments.PostsInsertedEventArgs=function(posts){Wall.Interfaces.EventArguments.PostsInsertedEventArgs.initializeBase(this);this.$1_1=posts};Wall.Interfaces.EventArguments.PostsInsertedEventArgs.prototype={$1_1:null,get_posts:function(){return this.$1_1}};Wall.Interfaces.EventArguments.PostsRefreshedEventArgs=function(posts){Wall.Interfaces.EventArguments.PostsRefreshedEventArgs.initializeBase(this);this.$1_1=posts};Wall.Interfaces.EventArguments.PostsRefreshedEventArgs.prototype={$1_1:null,get_posts:function(){return this.$1_1}};Wall.Interfaces.EventArguments.PostsRefreshingEventArgs=function(retrievePostsRequest){Wall.Interfaces.EventArguments.PostsRefreshingEventArgs.initializeBase(this);this.$9_1=retrievePostsRequest};Wall.Interfaces.EventArguments.PostsRefreshingEventArgs.prototype={$9_1:null,get_retrievePostsRequest:function(){return this.$9_1}};Wall.Interfaces.EventArguments.CommentCreatedEventArgs.registerClass("Wall.Interfaces.EventArguments.CommentCreatedEventArgs",Sys.EventArgs);Wall.Interfaces.EventArguments.CommentDeletedEventArgs.registerClass("Wall.Interfaces.EventArguments.CommentDeletedEventArgs",Sys.EventArgs);Wall.Interfaces.EventArguments.CommentsRefreshedEventArgs.registerClass("Wall.Interfaces.EventArguments.CommentsRefreshedEventArgs",Sys.EventArgs);Wall.Interfaces.EventArguments.ErrorEventArgs.registerClass("Wall.Interfaces.EventArguments.ErrorEventArgs",Sys.EventArgs);Wall.Interfaces.EventArguments.FiltersRefreshedEventArgs.registerClass("Wall.Interfaces.EventArguments.FiltersRefreshedEventArgs",Sys.EventArgs);Wall.Interfaces.EventArguments.PostCreatedEventArgs.registerClass("Wall.Interfaces.EventArguments.PostCreatedEventArgs",Sys.EventArgs);Wall.Interfaces.EventArguments.PostCreatingEventArgs.registerClass("Wall.Interfaces.EventArguments.PostCreatingEventArgs",Sys.EventArgs);Wall.Interfaces.EventArguments.PostDeletedEventArgs.registerClass("Wall.Interfaces.EventArguments.PostDeletedEventArgs",Sys.EventArgs);Wall.Interfaces.EventArguments.PostsInsertedEventArgs.registerClass("Wall.Interfaces.EventArguments.PostsInsertedEventArgs",Sys.EventArgs);Wall.Interfaces.EventArguments.PostsRefreshedEventArgs.registerClass("Wall.Interfaces.EventArguments.PostsRefreshedEventArgs",Sys.EventArgs);Wall.Interfaces.EventArguments.PostsRefreshingEventArgs.registerClass("Wall.Interfaces.EventArguments.PostsRefreshingEventArgs",Sys.EventArgs)</script><script id="/_static/_common/scripts/wall.control.js?ver=1888157098" type="text/javascript">Type.registerNamespace("Wall.Control.ScriptSharp");Wall.Control.ScriptSharp.jQueryDialogOptionsImportHelper=function(){};Wall.Control.ScriptSharp.jQueryDialogOptionsImportHelper.$$cctor=function(){Wall.Control.ScriptSharp.jQueryDialogOptionsImportHelper.registerjQueryPluginOptions("jQueryDialogOptions")};Wall.Control.ScriptSharp.jQueryDialogOptionsImportHelper.registerjQueryPluginOptions=function(pluginOptionsClassName){eval(String.format("{0} = {1}",pluginOptionsClassName,Object.getName()))};Type.registerNamespace("Wall.Service.Convertors");Wall.Service.Convertors.EntityReferenceConvertor=function(){};Wall.Service.Convertors.EntityReferenceConvertor.serviceToWall=function(serviceEntityReference){if(IsNull(serviceEntityReference))return null;var $v_0=new Wall.Service.ObjectModel.EntityReference;$v_0.id=serviceEntityReference.id;$v_0.logicalName=serviceEntityReference.logicalName;$v_0.name=serviceEntityReference.name;return $v_0};Wall.Service.Convertors.EntityReferenceConvertor.wallToService=function(wallEntityReference){if(IsNull(wallEntityReference))return null;var $v_0=new Sales.Common.CrmSoapServiceProxy.ObjectModel.EntityReference;$v_0.id=wallEntityReference.id;$v_0.logicalName=wallEntityReference.logicalName;$v_0.name=wallEntityReference.name;return $v_0};Wall.Service.Convertors.SystemUserConvertor=function(){};Wall.Service.Convertors.SystemUserConvertor.serviceToWall=function(serviceUser){var $v_0=new Wall.Service.ObjectModel.SystemUser;$v_0.set_fullName(serviceUser.get_fullName());$v_0.set_internalEmailAddress(_String.isNullOrEmpty(serviceUser.get_internalEmailAddress())?"":serviceUser.get_internalEmailAddress());$v_0.set_systemUserId(serviceUser.get_systemUserId());$v_0.set_title(_String.isNullOrEmpty(serviceUser.get_title())?"":serviceUser.get_title());$v_0.set_reference(new Wall.Service.ObjectModel.EntityReference);$v_0.reference.set_id($v_0.sytemUserId);$v_0.reference.set_logicalName("systemuser");$v_0.reference.set_name($v_0.fullName);return $v_0};Wall.Service.Convertors.SystemUserConvertor.serviceToWallCollection=function(serviceUsers){var $v_0=new Array(0);if(!serviceUsers)return $v_0;for(var $v_1=0;$v_1<serviceUsers.length;$v_1++)$v_0[$v_1]=Wall.Service.Convertors.SystemUserConvertor.serviceToWall(serviceUsers[$v_1]);return $v_0};Type.registerNamespace("Wall.Service.Messages");Wall.Service.Messages.BaseResponse=function(){};Wall.Service.Messages.BaseResponse.prototype={$N_0:null,get_isSucceeded:function(){return _String.isNullOrEmpty(this.$N_0)},get_errorMessage:function(){return this.$N_0},set_errorMessage:function(value){this.$N_0=value;return value}};Wall.Service.Messages.CreateCommentResponse=function(){Wall.Service.Messages.CreateCommentResponse.initializeBase(this)};Wall.Service.Messages.CreateCommentResponse.prototype={$U_1:null,$i_1:false,get_commentId:function(){return this.$U_1},set_commentId:function(value){this.$U_1=value;return value},get_revertComment:function(){return this.$i_1},set_revertComment:function(value){this.$i_1=value;return value}};Wall.Service.Messages.CreatePostResponse=function(){Wall.Service.Messages.CreatePostResponse.initializeBase(this)};Wall.Service.Messages.CreatePostResponse.prototype={$g_1:null,$j_1:false,get_postId:function(){return this.$g_1},set_postId:function(value){this.$g_1=value;return value},get_revertPost:function(){return this.$j_1},set_revertPost:function(value){this.$j_1=value;return value}};Wall.Service.Messages.DeleteCommentResponse=function(){Wall.Service.Messages.DeleteCommentResponse.initializeBase(this)};Wall.Service.Messages.DeletePostResponse=function(){Wall.Service.Messages.DeletePostResponse.initializeBase(this)};Wall.Service.Messages.RetrieveCommentsRequest=function(){Wall.Service.Messages.RetrieveCommentsRequest.initializeBase(this)};Wall.Service.Messages.RetrieveCommentsRequest.prototype={$f_1:null,get_parentPostId:function(){return this.$f_1},set_parentPostId:function(value){this.$f_1=value;return value}};Wall.Service.Messages.RetrieveCommentsResponse=function(){Wall.Service.Messages.RetrieveCommentsResponse.initializeBase(this)};Wall.Service.Messages.RetrieveCommentsResponse.prototype={$V_1:null,$l_1:0,get_comments:function(){return this.$V_1},set_comments:function(value){this.$V_1=value;return value},get_totalCommentCount:function(){return this.$l_1},set_totalCommentCount:function(value){this.$l_1=value;return value}};Wall.Service.Messages.RetrievePostsBaseResponse=function(){Wall.Service.Messages.RetrievePostsBaseResponse.initializeBase(this)};Wall.Service.Messages.RetrievePostsBaseResponse.prototype={$h_1:null,$e_1:false,$E_1:null,get_posts:function(){return this.$h_1},set_posts:function(value){this.$h_1=value;return value},get_morePosts:function(){return this.$e_1},set_morePosts:function(value){this.$e_1=value;return value},get_pagingCookie:function(){return this.$E_1},set_pagingCookie:function(value){this.$E_1=value;return value}};Wall.Service.Messages.RetrievePostsRequest=function(){};Wall.Service.Messages.RetrievePostsRequest.prototype={$5_0:0,$8_0:0,$k_0:null,$Y_0:null,$E_0:null,get_pageNumber:function(){return this.$5_0},set_pageNumber:function(value){this.$5_0=value;return value},get_pageSize:function(){return this.$8_0},set_pageSize:function(value){this.$8_0=value;return value},get_startDate:function(){return this.$k_0},set_startDate:function(value){this.$k_0=value;return value},get_endDate:function(){return this.$Y_0},set_endDate:function(value){this.$Y_0=value;return value},get_pagingCookie:function(){return this.$E_0},set_pagingCookie:function(value){this.$E_0=value;return value}};Wall.Service.Messages.RetrieveWallFiltersResponse=function(){Wall.Service.Messages.RetrieveWallFiltersResponse.initializeBase(this)};Wall.Service.Messages.RetrieveWallFiltersResponse.prototype={$a_1:null,get_wallFilters:function(){return this.$a_1},set_wallFilters:function(value){this.$a_1=value;return value}};Wall.Service.Messages.SetDefaultFilterResponse=function(){Wall.Service.Messages.SetDefaultFilterResponse.initializeBase(this)};Type.registerNamespace("Wall.Service.ObjectModel");Wall.Service.ObjectModel.Comment=function(){};Wall.Service.ObjectModel.Comment.prototype={commentId:null,text:null,imageUrl:null,parentPost:null,createdOn:null,createdBy:null,deleteEnabled:false,formattedCreatedOn:null,get_commentId:function(){return this.commentId},set_commentId:function(value){this.commentId=value;return value},get_text:function(){return this.text},set_text:function(value){this.text=value;return value},get_imageUrl:function(){return this.imageUrl},set_imageUrl:function(value){this.imageUrl=value;return value},get_parentPost:function(){return this.parentPost},set_parentPost:function(value){this.parentPost=value;return value},get_createdOn:function(){return this.createdOn},set_createdOn:function(value){this.createdOn=value;return value},get_createdBy:function(){return this.createdBy},set_createdBy:function(value){this.createdBy=value;return value},get_deleteEnabled:function(){return this.deleteEnabled},set_deleteEnabled:function(value){this.deleteEnabled=value;return value},get_formattedCreatedOn:function(){return this.formattedCreatedOn},set_formattedCreatedOn:function(value){this.formattedCreatedOn=value;return value}};Wall.Service.ObjectModel.EntityReference=function(){};Wall.Service.ObjectModel.EntityReference.createEntityReference=function(id,logicalName,name,etc){var $v_0=new Wall.Service.ObjectModel.EntityReference;$v_0.id=id;$v_0.logicalName=logicalName;$v_0.name=name;$v_0.typecode=etc;return $v_0};Wall.Service.ObjectModel.EntityReference.prototype={id:null,logicalName:null,name:null,typecode:0,get_id:function(){return this.id},set_id:function(value){this.id=value;return value},get_logicalName:function(){return this.logicalName},set_logicalName:function(value){this.logicalName=value;return value},get_name:function(){return this.name},set_name:function(value){this.name=value;return value},get_typeCode:function(){return this.typecode},set_typeCode:function(value){this.typecode=value;return value}};Wall.Service.ObjectModel.Post=function(){};Wall.Service.ObjectModel.Post.prototype={postId:null,text:null,type:0,createdBy:null,imageUrl:null,relativeImageUrl:null,regardingId:null,commentCounter:0,likeCounter:0,likeId:null,source:0,deleteEnabled:false,createdOn:null,comments:null,formattedCreatedOn:null,errorDetails:null,get_type:function(){return this.type},set_type:function(value){this.type=value;return value},get_imageUrl:function(){return this.imageUrl},set_imageUrl:function(value){this.imageUrl=value;return value},get_regardingId:function(){return this.regardingId},set_regardingId:function(value){this.regardingId=value;return value},get_commentCounter:function(){return this.commentCounter},set_commentCounter:function(value){this.commentCounter=value;return value},get_likeCounter:function(){return this.likeCounter},set_likeCounter:function(value){this.likeCounter=value;return value},get_source:function(){return this.source},set_source:function(value){this.source=value;return value},get_formattedCreatedOn:function(){return this.formattedCreatedOn},set_formattedCreatedOn:function(value){this.formattedCreatedOn=value;return value},get_errorDetails:function(){return this.errorDetails},set_errorDetails:function(value){this.errorDetails=value;return value},get_postId:function(){return this.postId},set_postId:function(value){this.postId=value;return value},get_text:function(){return this.text},set_text:function(value){this.text=value;return value},get_comments:function(){return this.comments},set_comments:function(value){this.comments=value;return value},get_createdOn:function(){return this.createdOn},set_createdOn:function(value){this.createdOn=value;return value},get_createdBy:function(){return this.createdBy},set_createdBy:function(value){this.createdBy=value;return value},get_deleteEnabled:function(){return this.deleteEnabled},set_deleteEnabled:function(value){this.deleteEnabled=value;return value},get_liked:function(){return this.likeCounter>0},get_likeId:function(){return this.likeId},set_likeId:function(value){this.likeId=value;return value},get_relativeImageUrl:function(){return this.relativeImageUrl},set_relativeImageUrl:function(value){this.relativeImageUrl=value;return value}};Wall.Service.ObjectModel.SystemUser=function(){};Wall.Service.ObjectModel.SystemUser.prototype={fullName:null,internalEmailAddress:null,sytemUserId:null,title:null,reference:null,get_fullName:function(){return this.fullName},set_fullName:function(value){if(value!==this.fullName)this.fullName=value;return value},get_internalEmailAddress:function(){return this.internalEmailAddress},set_internalEmailAddress:function(value){if(value!==this.internalEmailAddress)this.internalEmailAddress=value;return value},get_systemUserId:function(){return this.sytemUserId},set_systemUserId:function(value){if(value!==this.sytemUserId)this.sytemUserId=value;return value},get_title:function(){return this.title},set_title:function(value){if(value!==this.title)this.title=value;return value},get_reference:function(){return this.reference},set_reference:function(value){if(value!==this.reference)this.reference=value;return value}};Wall.Service.ObjectModel.WallAction=function(text,iconUrl,disabledIconUrl,toolTip,enabled,commandName,callback,context,isPopupAction,actionType){this.text=text;this.iconUrl=iconUrl;this.disabledIconUrl=disabledIconUrl;this.toolTip=toolTip;this.enabled=enabled;this.commandName=commandName;this.callback=callback;this.context=context;this.isPopupAction=isPopupAction;this.actionType=actionType;this.isVisible=true};Wall.Service.ObjectModel.WallAction.prototype={text:null,iconUrl:null,disabledIconUrl:null,toolTip:null,enabled:false,commandName:null,callback:null,context:null,isPopupAction:false,actionType:null,isVisible:false,get_text:function(){return this.text},set_text:function(value){this.text=value;return value},get_iconUrl:function(){return this.iconUrl},set_iconUrl:function(value){this.iconUrl=value;return value},get_disabledIconUrl:function(){return this.disabledIconUrl},set_disabledIconUrl:function(value){this.disabledIconUrl=value;return value},get_toolTip:function(){return this.toolTip},set_toolTip:function(value){this.toolTip=value;return value},get_enabled:function(){return this.enabled},set_enabled:function(value){this.enabled=value;return value},get_commandName:function(){return this.commandName},set_commandName:function(value){this.commandName=value;return value},get_callback:function(){return this.callback},set_callback:function(value){this.callback=value;return value},get_context:function(){return this.context},set_context:function(value){this.context=value;return value},get_isPopupAction:function(){return this.isPopupAction},set_isPopupAction:function(value){this.isPopupAction=value;return value},get_actionType:function(){return this.actionType},set_actionType:function(value){this.actionType=value;return value},get_isVisible:function(){return this.isVisible},set_isVisible:function(value){this.isVisible=value;return value}};Wall.Service.ObjectModel.WallFilter=function(){};Wall.Service.ObjectModel.WallFilter.create=function(text,toolTip,commandName,callback,context,filterType,isSelected){var $v_0=new Wall.Service.ObjectModel.WallFilter;$v_0.text=text;$v_0.toolTip=toolTip;$v_0.commandName=commandName;$v_0.callback=callback;$v_0.context=context;$v_0.filterType=filterType;$v_0.isSelected=isSelected;return $v_0};Wall.Service.ObjectModel.WallFilter.prototype={text:null,toolTip:null,commandName:null,callback:null,context:null,filterType:null,isSelected:false,subFilters:null,get_text:function(){return this.text},set_text:function(value){this.text=value;return value},get_toolTip:function(){return this.toolTip},set_toolTip:function(value){this.toolTip=value;return value},get_commandName:function(){return this.commandName},set_commandName:function(value){this.commandName=value;return value},get_callback:function(){return this.callback},set_callback:function(value){this.callback=value;return value},get_context:function(){return this.context},set_context:function(value){this.context=value;return value},get_subFilters:function(){return this.subFilters},set_subFilters:function(value){this.subFilters=value;return value},get_filterType:function(){return this.filterType},set_filterType:function(value){this.filterType=value;return value},get_isSelected:function(){return this.isSelected},set_isSelected:function(value){this.isSelected=value;return value}};Type.registerNamespace("CommonUtils");CommonUtils.MouseButton=function(){};CommonUtils.MouseButton.prototype={left:1,middle:2,right:3};CommonUtils.MouseButton.registerEnum("CommonUtils.MouseButton",false);Type.registerNamespace("Mscrm.Yammer");Mscrm.Yammer.ConfigOptions=function(){};Mscrm.Yammer.EmailAddress=function(){};Mscrm.Yammer.Contact=function(){};Mscrm.Yammer.User=function(){};Mscrm.Yammer.ObjectProperties=function(){};Mscrm.Yammer.Config=function(){};Mscrm.Yammer.FeedOptions=function(){};Type.registerNamespace("Wall.UI");Wall.UI.WallStateEnum=function(){};Wall.UI.Wall=function(rootContainer,wallService,headerId,postTemplateId,commentTemplateId,wallContainerId,postTextBoxJQueryId,progressTemplateId,emptyTemplateId,showMoreLinkTemplateId){this.$$d_loadPosts=Function.createDelegate(this,this.loadPosts);this.$$d_resizeProgressTemplate=Function.createDelegate(this,this.resizeProgressTemplate);this.$$d_handleWindowUnload=Function.createDelegate(this,this.handleWindowUnload);this.$$d_$17_0=Function.createDelegate(this,this.$17_0);this.$X_0=new Mscrm.CrmDisposeHelper;this._events=new Sys.EventHandlerList;this.rootContainer=rootContainer;this.$3_0=0;this.$8_0=10;this.$1_0=new Array(0);this.$0_0=wallService;this.$S_0=postTemplateId;this.$M_0=commentTemplateId;this.$J_0=wallContainerId;this.headerJQuery=this.rootContainer.find(headerId);this.progressTemplatejQuery=this.rootContainer.find(String.format("#{0}",progressTemplateId));this.showMoreLinkJQuery=this.rootContainer.find(String.format("#{0}",showMoreLinkTemplateId));this.postTemplatejQuery=this.rootContainer.find(String.format("#{0}",postTemplateId));this.commentTemplatejQuery=this.rootContainer.find(String.format("#{0}",commentTemplateId));this.wallContainerjQuery=this.rootContainer.find(String.format("#{0}",wallContainerId));this.firstRunContentjQuery=this.rootContainer.find(String.format("#{0}",emptyTemplateId));this.filterContainerjQuery=this.rootContainer.find(String.format("#{0}","filterContainer"));this.filterTemplatejQuery=this.rootContainer.find(String.format("#{0}","filterTemplate"));$P_CRM(window).bind("resize",this.$$d_$17_0);Wall.Control.Utils.WindowUtils.add_onWindowUnload(this.$$d_handleWindowUnload);if(!IsNull(postTextBoxJQueryId))this.postTextBox=this.rootContainer.find(postTextBoxJQueryId).first()[0];this.$Q_0=this.rootContainer.find("#postButton").first()[0];if(Wall.Control.Utils.Browser.getCurrentBrowser().get_isIE7())window.setTimeout(this.$$d_resizeProgressTemplate,10);else this.resizeProgressTemplate()};Wall.UI.Wall.getPostById=function(postId,posts){var $v_0=_Array.filter(Wall.Interfaces.IPost,posts,function($p1_0){return $p1_0.get_postId()===postId});if($v_0&&$v_0.length>=1)return $v_0[0];else return null};Wall.UI.Wall.getCommentById=function(commentId,comments){if(!comments)return null;var $v_0=_Array.filter(Wall.Interfaces.IComment,comments,function($p1_0){return $p1_0.get_commentId()===commentId});if($v_0&&$v_0.length>=1)return $v_0[0];else return null};Wall.UI.Wall.$11=function($p0){if(IsNull($p0))return null;return $p0.get_comments()&&$p0.get_comments().length>0?$p0.get_comments()[0].get_createdOn():$p0.get_createdOn()};Wall.UI.Wall.$m=function($p0,$p1,$p2,$p3){if($p0&&$p2>0)window.setTimeout(function(){Wall.UI.Wall.$m($p0,$p1,$p2-1,$p3)},$p1);else $p3()};Wall.UI.Wall.cleanupWall=function(parentjQueryObject){unsubscribeAllEvents(parentjQueryObject);parentjQueryObject.empty()};Wall.UI.Wall.prototype={$8_0:0,$J_0:null,$S_0:null,$M_0:null,$0_0:null,$3_0:0,$R_0:false,$L_0:false,$O_0:false,wallContainerjQuery:null,filterContainerjQuery:null,postTemplatejQuery:null,filterTemplatejQuery:null,commentTemplatejQuery:null,progressTemplatejQuery:null,headerJQuery:null,showMoreLinkJQuery:null,firstRunContentjQuery:null,postTextBox:null,$Q_0:null,rootContainer:null,$1_0:null,$5_0:0,$H_0:null,$A_0:null,$D_0:false,$9_0:null,get_isDisabled:function(){return this.$D_0},get_isDisposed:function(){return this.$O_0},get_wallContainerId:function(){return this.$J_0},set_wallContainerId:function(value){this.$J_0=value;return value},get_postTemplateId:function(){return this.$S_0},set_postTemplateId:function(value){this.$S_0=value;return value},get_commentTemplateId:function(){return this.$M_0},set_commentTemplateId:function(value){this.$M_0=value;return value},get_wallService:function(){return this.$0_0},set_wallService:function(value){this.$0_0=value;return value},get_state:function(){return this.$3_0},set_state:function(value){this.$3_0=value;return value},get_pageSize:function(){return this.$8_0},set_pageSize:function(value){this.$8_0=value;return value},add_postsRefreshing:function(value){this._events.addHandler("PostsRefreshing",value)},remove_postsRefreshing:function(value){this._events.removeHandler("PostsRefreshing",value)},add_postsRefreshed:function(value){this._events.addHandler("PostsRefreshed",value)},remove_postsRefreshed:function(value){this._events.removeHandler("PostsRefreshed",value)},add_commentsRefreshed:function(value){this._events.addHandler("CommentsRefreshed",value)},remove_commentsRefreshed:function(value){this._events.removeHandler("CommentsRefreshed",value)},add_postCreated:function(value){this._events.addHandler("PostCreated",value)},remove_postCreated:function(value){this._events.removeHandler("PostCreated",value)},add_postCreating:function(value){this._events.addHandler("PostCreating",value)},remove_postCreating:function(value){this._events.removeHandler("PostCreating",value)},add_commentCreated:function(value){this._events.addHandler("CommentCreated",value)},remove_commentCreated:function(value){this._events.removeHandler("CommentCreated",value)},add_postDeleted:function(value){this._events.addHandler("PostDeleted",value)},remove_postDeleted:function(value){this._events.removeHandler("PostDeleted",value)},add_commentDeleted:function(value){this._events.addHandler("CommentDeleted",value)},remove_commentDeleted:function(value){this._events.removeHandler("CommentDeleted",value)},add_postsInserted:function(value){this._events.addHandler("PostsInserted",value)},remove_postsInserted:function(value){this._events.removeHandler("PostsInserted",value)},add_filtersRefreshed:function(value){this._events.addHandler("FiltersRefreshed",value)},remove_filtersRefreshed:function(value){this._events.removeHandler("FiltersRefreshed",value)},add_error:function(value){this._events.addHandler("Error",value)},remove_error:function(value){this._events.removeHandler("Error",value)},fireEvent:function(T,eventName,args){_Event.fireEvent(T,this._events,eventName,this,args)},refreshWallFilters:function(){this.refreshWallFilter(null)},refreshWallFilter:function(filterType){var $$t_A=this;this.rootContainer.find(".wallFilter").each(function($p1_0,$p1_1){var $v_0=$p1_1.getAttribute("FilterType");if(_String.isNullOrEmpty(filterType)||filterType===$v_0){var $v_1=$p1_1.getAttribute("TemplateId"),$v_2=$p1_1.getAttribute("IsAsync").toLowerCase()==="true",$v_3=$$t_A.rootContainer.find(String.format("#{0}",$v_1)),$v_4=$P_CRM($p1_1);if(!$v_2){var $v_5=$$t_A.$0_0.getWallFilters($v_0,null);$$t_A.$r_0($v_5,$v_0,$v_3,$v_4)}else $$t_A.$0_0.retrieveWallFilters($v_0,null,function($p2_0){if(!$p2_0.get_isSucceeded()){$$t_A.processError($p2_0);return}$$t_A.$r_0($p2_0.get_wallFilters(),$v_0,$v_3,$v_4)})}})},$r_0:function($p0,$p1,$p2,$p3){for(var $v_0=markFirstAndLast($p0),$$arr_5=$v_0,$$len_6=$$arr_5.length,$$idx_7=0;$$idx_7<$$len_6;++$$idx_7){var $v_1=$$arr_5[$$idx_7];$v_1.get_subFilters()&&$v_1.set_subFilters(markFirstAndLast($v_1.get_subFilters()))}$p3.empty();$p2.tmpl($v_0,this).appendTo($p3);var $$t_9=this;this.$X_0.schedule(function(){$p3.empty()});this.fireEvent(Wall.Interfaces.EventArguments.FiltersRefreshedEventArgs,"FiltersRefreshed",new Wall.Interfaces.EventArguments.FiltersRefreshedEventArgs($p1,$v_0))},renderOlderPosts:function(){var $v_0=this.wallContainerjQuery.find(".showMoreLink");$v_0.addClass("showMoreLinkProgress");this.$3_0=3;var $v_1=this.$0_0.getWallServiceFactory().createRetrievePostsRequest();$v_1.set_pageSize(this.$8_0);$v_1.set_endDate(this.$H_0);$v_1.set_pagingCookie(this.$A_0);this.$5_0++;$v_1.set_pageNumber(this.$5_0);var $v_2={page:this.$5_0,wallType:this.rootContainer[0].id,entity:!Xrm.Page.data?null:Xrm.Page.data.entity.getEntityName(),form:!Xrm.Page.ui?null:Xrm.Page.ui.formSelector.getCurrentItem().getId()};this.fireEvent(Wall.Interfaces.EventArguments.PostsRefreshingEventArgs,"PostsRefreshing",new Wall.Interfaces.EventArguments.PostsRefreshingEventArgs($v_1));var $$t_5=this;this.$0_0.retrievePosts($v_1,function($p1_0){$$t_5.processRetrievePostsResponse($p1_0,function(){$v_0.removeClass("showMoreLinkProgress").remove();$$t_5.$3_0=1;var $v_3=Wall.Control.Utils.WallUtils.removeDuplicatePosts($p1_0.get_posts(),$$t_5.$1_0);$$t_5.$n_0($v_3);$p1_0.get_morePosts()&&$$t_5.$o_0();$v_2["posts"]=$v_3.length;Mscrm.MetricsReporting.instance().addMetric("Wall.LoadMore",$v_2)},function(){$v_0.removeClass("showMoreLinkProgress");$v_2["posts"]=0;Mscrm.MetricsReporting.instance().addMetric("Wall.LoadMore",$v_2)},function(){$v_0.removeClass("showMoreLinkProgress");$$t_5.$3_0=5;$v_2["error"]=true;Mscrm.MetricsReporting.instance().addMetric("Wall.LoadMore",$v_2);alert($p1_0.get_errorMessage())})})},refreshAll:function(){Mscrm.Performance.PerformanceMarkerManager.get_instance().addMarker("Wall_RefreshAll_Start",1);if(!this.$9_0)this.$9_0=Xrm.Internal.startMetricsStopwatch("Refresh Wall Notes");this.$9_0.start();if(this.$D_0)return;this.setProgressState();this.$5_0=1;this.$A_0=null;var $v_0=this.$0_0.getWallServiceFactory().createRetrievePostsRequest();$v_0.set_pageNumber(this.$5_0);$v_0.set_pageSize(this.$8_0);$v_0.set_endDate(null);$v_0.set_pagingCookie(this.$A_0);this.$H_0=null;this.fireEvent(Wall.Interfaces.EventArguments.PostsRefreshingEventArgs,"PostsRefreshing",new Wall.Interfaces.EventArguments.PostsRefreshingEventArgs($v_0));this.$0_0.retrievePosts($v_0,this.$$d_loadPosts)},fetchAll:function(){Mscrm.Performance.PerformanceMarkerManager.get_instance().addMarker("Wall_FetchAll_Start",1);if(!this.$9_0)this.$9_0=Xrm.Internal.startMetricsStopwatch("Fetch All Wall Notes");this.$9_0.start();if(this.$D_0)return;this.setProgressState();this.$5_0=1;this.$A_0=null;var $v_0=this.$0_0.getWallServiceFactory().createRetrievePostsRequest();$v_0.set_pageNumber(this.$5_0);$v_0.set_pageSize(this.$8_0);$v_0.set_endDate(null);$v_0.set_pagingCookie(this.$A_0);this.$H_0=null;this.fireEvent(Wall.Interfaces.EventArguments.PostsRefreshingEventArgs,"PostsRefreshing",new Wall.Interfaces.EventArguments.PostsRefreshingEventArgs($v_0));this.$0_0.retrieveAllPosts($v_0,this.$$d_loadPosts)},loadPosts:function(retrievePostsResponse){var $$t_3=this;this.processRetrievePostsResponse(retrievePostsResponse,function(){var $v_0=Xrm.Internal.startMetricsStopwatch("Wall_RenderPosts_"+Object.getType($$t_3).getName()+"_"+$$t_3.$J_0);$v_0.start();$$t_3.setDataState();var $v_1=retrievePostsResponse.get_posts();$$t_3.$H_0=Wall.UI.Wall.$11($v_1[0]);$$t_3.$19_0($v_1);retrievePostsResponse.get_morePosts()&&$$t_3.$o_0();$v_0.stop();Mscrm.Performance.PerformanceMarkerManager.get_instance().addMarker("Wall_RefreshAll_End",1)});this.$9_0&&this.$9_0.stop()},refreshComments:function(parentPostId,pageSize,olderThen){var $v_0=this.$0_0.getWallServiceFactory().createRetrieveCommentsRequest();$v_0.set_parentPostId(parentPostId);var $v_1=this.rootContainer.find(_String.format("#{0}_commentsArea",parentPostId));$v_1.addClass("progress");var $$t_7=this;this.$0_0.retrieveComments($v_0,function($p1_0){$v_1.removeClass("progress");$$t_7.rootContainer.find(_String.format("#{0}",parentPostId)).focus();if($p1_0.get_isSucceeded()){var $v_2=$p1_0.get_comments();Wall.UI.Wall.cleanupWall($v_1);$$t_7.commentTemplatejQuery.tmpl($v_2,$$t_7).appendTo($v_1);$$t_7.rootContainer.find(_String.format("#{0}",parentPostId)).addClass("hascomments");$$t_7.fireEvent(Wall.Interfaces.EventArguments.CommentsRefreshedEventArgs,"CommentsRefreshed",new Wall.Interfaces.EventArguments.CommentsRefreshedEventArgs($v_2))}else $$t_7.processError($p1_0)})},postMessage:function(text){var $v_0=this.$0_0.getWallServiceFactory().createPost();$v_0.set_text(this.$0_0.formatPostTextForRendering(text));$v_0.set_postId("temp"+Math.random().toString().replace(".",""));var $v_1=this.$0_0.getWallServiceFactory().createPost();$v_1.set_text(text);this.createPost($v_0,$v_1)},createPost:function(post,postToCreate){if(this.$R_0)return;this.$R_0=true;var $v_0=true,$$t_4=this;this.$13_0(post,600,function(){$v_0=false});this.$Q_0.disabled=true;this.fireEvent(Wall.Interfaces.EventArguments.PostCreatingEventArgs,"PostCreating",new Wall.Interfaces.EventArguments.PostCreatingEventArgs(postToCreate));var $$t_5=this;this.$0_0.postMessage(postToCreate,function($p1_0){$$t_5.$Q_0.disabled=false;$$t_5.$R_0=false;if($p1_0.get_isSucceeded()){Wall.UI.Wall.$m($v_0,600,2,function(){$$t_5.removePost(post.get_postId());post.set_postId($p1_0.get_postId());$$t_5.$13_0(post);$$t_5.setDataState();$$t_5.fireEvent(Wall.Interfaces.EventArguments.PostCreatedEventArgs,"PostCreated",new Wall.Interfaces.EventArguments.PostCreatedEventArgs(post))});$$t_5.clearInputFields()}else{$$t_5.setDataState();$p1_0.get_revertPost()&&$$t_5.removePost(post.get_postId());$$t_5.processError($p1_0)}})},postComment:function(parentPostId,text){if(this.$L_0)return;this.$L_0=true;var $v_0=this.$0_0.getWallServiceFactory().createComment();$v_0.set_commentId("temp"+Math.random().toString().replace(".",""));$v_0.set_text(this.$0_0.formatCommentTextForRendering(text));$v_0.set_parentPost(this.$0_0.getWallServiceFactory().createPost());$v_0.get_parentPost().set_postId(parentPostId);var $v_1=this.rootContainer.find(_String.format("#{0}_replyArea",parentPostId)),$v_2=$v_1.find("input[type='button']")[0];if($v_2)$v_2.disabled=true;var $v_3=$v_1.find("textarea")[0],$v_4=this.rootContainer.find(_String.format("#{0}_commentsArea",parentPostId)),$v_5=$v_4.find(_String.format("#{0}_showAllComments",parentPostId));this.rootContainer.find(_String.format("#{0}",parentPostId)).addClass("hascomments");var $v_6=true,$$t_D=this;this.commentTemplatejQuery.tmpl($v_0,this).hide().appendTo($v_4).show(600,function(){$v_6=false});var $v_7=this.$0_0.getWallServiceFactory().createComment();$v_7.set_parentPost($v_0.get_parentPost());$v_7.set_text(text);var $$t_E=this;this.$0_0.postComment($v_7,function($p1_0){$$t_E.$L_0=false;if($p1_0.get_isSucceeded()){Wall.UI.Wall.$m($v_6,600,2,function(){$v_4.find(_String.format("#{0}",$v_0.get_commentId())).remove();$v_0.set_commentId($p1_0.get_commentId());$$t_E.commentTemplatejQuery.tmpl($v_0,$$t_E).appendTo($v_4);$$t_E.fireEvent(Wall.Interfaces.EventArguments.CommentCreatedEventArgs,"CommentCreated",new Wall.Interfaces.EventArguments.CommentCreatedEventArgs($v_0))});if($v_5.size()){var $v_8=0,$v_9=$v_5.attr("commentsCount");if(!IsNull($v_9))$v_8=parseInt($v_9);$v_8++;$v_5.text(String.format(Wall.Control.Resources.WallControl.viewAllCommentsTemplate,$v_8));$v_5.attr("commentsCount",$v_8.toString())}$v_3.value="";$v_3.focus();window.setTimeout(function(){$P_CRM($v_3).trigger("change")},10)}else{$$t_E.processError($p1_0);$p1_0.get_revertComment()&&$v_4.find(_String.format("#{0}",$v_0.get_commentId())).remove()}if($v_2)$v_2.disabled=false})},getWallActions:function(actionType,context){return this.$0_0.getWallActions(actionType,context)},deletePost:function(postId){var $v_0=this.$0_0.getWallServiceFactory().createPost();$v_0.set_postId(postId);this.removePost(postId,600);var $$t_3=this;this.$0_0.deletePost($v_0,function($p1_0){if($p1_0.get_isSucceeded())$$t_3.fireEvent(Wall.Interfaces.EventArguments.PostDeletedEventArgs,"PostDeleted",new Wall.Interfaces.EventArguments.PostDeletedEventArgs(postId));else $$t_3.processError($p1_0)})},deleteComment:function(commentId){var $v_0=this.$0_0.getWallServiceFactory().createComment();$v_0.set_commentId(commentId);var $v_1=this.rootContainer.find(_String.format("#{0}",commentId)).parent(".commentsArea").find(".showAllComments"),$v_2=parseInt($v_1.attr("commentsCount"))-1;$v_1.text(String.format(Wall.Control.Resources.WallControl.viewAllCommentsTemplate,$v_2));$v_1.attr("commentsCount",$v_2.toString());var $v_3=this.rootContainer.find(_String.format("#{0}",commentId)),$$t_7=this;$v_3.hide(600,function(){$v_3.hide(600).remove()});var $v_4=this.rootContainer.find(_String.format("#{0}",commentId)).parent(".post");!$v_4.find(".comment").size()&&!$v_4.find(".replyArea").size()&&$v_4.removeClass("hascomments");var $$t_8=this;this.$0_0.deleteComment($v_0,function($p1_0){if($p1_0.get_isSucceeded())$$t_8.fireEvent(Wall.Interfaces.EventArguments.CommentDeletedEventArgs,"CommentDeleted",new Wall.Interfaces.EventArguments.CommentDeletedEventArgs(commentId));else $$t_8.processError($p1_0)})},$17_0:function($p0){this.$3_0===2&&this.resizeProgressTemplate()},get_displayedPosts:function(){return this.$1_0},set_displayedPosts:function(value){this.$1_0=value;return value},resizeProgressTemplate:function(){var $v_0=this.getAvailableWallHeight(),$v_1=this.wallContainerjQuery.height();if($v_1>$v_0){this.progressTemplatejQuery.css("margin-bottom",($v_1-$v_0).toString()+"px");this.progressTemplatejQuery.height($v_0)}else{this.progressTemplatejQuery.css("margin-bottom","0px");this.progressTemplatejQuery.height($v_0)}},setProgressState:function(){var $v_0=Xrm.Internal.startMetricsStopwatch("Wall_SetProgressState");$v_0.start();if(this.$D_0)this.setEmptyState();else{this.$3_0=2;this.resizeProgressTemplate();this.wallContainerjQuery.hide();this.firstRunContentjQuery.hide();this.progressTemplatejQuery.show()}$v_0.stop()},setDisabledState:function(disable){this.$D_0=disable;if(disable){if(this.postTextBox)this.postTextBox.disabled=true}else if(this.postTextBox)this.postTextBox.disabled=false},setDataState:function(){this.progressTemplatejQuery.css("margin-bottom","0");this.$3_0=1;this.firstRunContentjQuery.hide();this.progressTemplatejQuery.hide();this.wallContainerjQuery.show()},setEmptyState:function(){this.progressTemplatejQuery.css("margin-bottom","0");this.$3_0=4;this.progressTemplatejQuery.hide();Wall.UI.Wall.cleanupWall(this.wallContainerjQuery);this.wallContainerjQuery.hide();this.firstRunContentjQuery.show()},setErrorState:function(){this.progressTemplatejQuery.css("margin-bottom","0");this.$3_0=5;this.progressTemplatejQuery.hide();this.wallContainerjQuery.hide();this.firstRunContentjQuery.show()},processRetrievePostsResponse:function(retrievePostsResponse,dataCallback,emptyCallback,errorCallback){if(retrievePostsResponse.get_isSucceeded()){this.$A_0=retrievePostsResponse.get_pagingCookie();if(!IsNull(retrievePostsResponse.get_posts())&&retrievePostsResponse.get_posts().length>0)dataCallback();else if(!IsNull(emptyCallback))emptyCallback();else this.setEmptyState();this.fireEvent(Wall.Interfaces.EventArguments.PostsRefreshedEventArgs,"PostsRefreshed",new Wall.Interfaces.EventArguments.PostsRefreshedEventArgs(retrievePostsResponse.get_posts()))}else if(!IsNull(errorCallback))errorCallback();else{this.processError(retrievePostsResponse);this.setErrorState()}},processError:function(response){alert(response.get_errorMessage());this.fireEvent(Wall.Interfaces.EventArguments.ErrorEventArgs,"Error",new Wall.Interfaces.EventArguments.ErrorEventArgs(response))},clearInputFields:function(){if(!IsNull(this.postTextBox)){this.postTextBox.value="";$P_CRM(this.postTextBox).trigger("change");this.postTextBox.focus()}},getAvailableWallHeight:function(){var $v_0=$P_CRM(document.body).outerHeight(true),$v_1=this.headerJQuery.outerHeight(true);return $v_0-$v_1-2},$13_0:function($p0,$p1,$p2){if(IsNull($p1))$p1=0;if($p0&&!_String.isNullOrEmpty($p0.get_text())){var $v_0="</[t|T][e|E][x|X][t|T][a|A][r|R][e|E][a|A]>",$v_1=new RegExp($v_0,"g");$p0.set_text($p0.get_text().replace($v_1,"< /textarea>"))}this.$14_0([$p0],$p1,$p2);if(Wall.Control.Utils.Browser.getCurrentBrowser().$7_0.toUpperCase()==="SAFARI"){var $v_2=$p0.get_postId(),$v_3=$v_2+"_text",$v_4=$v_2+"_userName";$P_CRM("#"+$v_2).attr("title",$P_CRM("#"+$v_4+":first a").attr("title")+" "+$P_CRM("#"+$v_3).html())}},$14_0:function($p0,$p1,$p2){if(!$p0||!$p0.length)return;if(IsNull($p1))$p1=0;this.wallContainerjQuery.find(".post").removeClass("first").removeClass("last");_Array.insertRange(this.$1_0,0,$p0);var $v_0=this.wallContainerjQuery.find(".post:first");if(!$p1)if(!$v_0.size())this.postTemplatejQuery.tmpl($p0,this).appendTo(this.wallContainerjQuery);else this.postTemplatejQuery.tmpl($p0,this).insertBefore($v_0);else if(!$v_0.size())this.postTemplatejQuery.tmpl($p0,this).hide().appendTo(this.wallContainerjQuery).show($p1,$p2);else this.postTemplatejQuery.tmpl($p0,this).hide().insertBefore($v_0).show($p1,$p2);this.wallContainerjQuery.find(".post:first").addClass("first");this.wallContainerjQuery.find(".post:last").addClass("last");var $v_1=this.rootContainer.parent().attr("walltabindex");this.wallContainerjQuery.find(".post").attr("tabindex",$v_1);this.fireEvent(Wall.Interfaces.EventArguments.PostsInsertedEventArgs,"PostsInserted",new Wall.Interfaces.EventArguments.PostsInsertedEventArgs($p0))},$n_0:function($p0){if(!$p0||!$p0.length)return;this.wallContainerjQuery.find(".post").removeClass("first").removeClass("last");var $$t_9;this.$1_0=($$t_9=this.$1_0).concat.apply($$t_9,$p0);!IsNull(this.postTemplatejQuery)&&this.postTemplatejQuery.tmpl($p0,this).appendTo(this.wallContainerjQuery);this.wallContainerjQuery.find(".post:first").addClass("first");this.wallContainerjQuery.find(".post:last").addClass("last");var $v_0=this.rootContainer.parent().attr("walltabindex");this.wallContainerjQuery.find(".post").attr("tabindex",$v_0);if(Wall.Control.Utils.Browser.getCurrentBrowser().$7_0.toUpperCase()==="SAFARI")for(var $v_1=0;$v_1<$p0.length;$v_1++){for(var $v_2=$p0[$v_1].get_postId(),$v_3=$v_2+"_text",$v_4=$v_2+"_userName",$v_5=$P_CRM("#"+$v_3+" a").size(),$v_6="",$v_7=0;$v_7<$v_5;$v_7++)$v_6+=$P_CRM("#"+$v_3+" a")[$v_7].innerHTML+" ";$P_CRM("#"+$v_2).attr("title",$P_CRM("#"+$v_4+":first a").attr("title")+" "+($v_5>0?$v_6:$P_CRM("#"+$v_3).html()))}this.fireEvent(Wall.Interfaces.EventArguments.PostsInsertedEventArgs,"PostsInserted",new Wall.Interfaces.EventArguments.PostsInsertedEventArgs($p0))},updatePostInDisplayedPostArray:function(postId,newPost){var $v_0=Array.indexOf(this.$1_0,this.findDisplayedPostById(postId));Array.remove(this.$1_0,this.findDisplayedPostById(postId));Array.insert(this.$1_0,$v_0,newPost)},removePost:function(postId,animationSpeed){var $v_0=this.rootContainer.find(_String.format("#{0}",postId));if(IsNull(animationSpeed))$v_0.remove();else{var $$t_3=this;$v_0.hide(animationSpeed,function(){$v_0.remove()})}Array.remove(this.$1_0,this.findDisplayedPostById(postId));this.wallContainerjQuery.find(".post:first").addClass("first");this.wallContainerjQuery.find(".post:last").addClass("last")},$19_0:function($p0){Wall.UI.Wall.cleanupWall(this.wallContainerjQuery);this.$1_0=new Array(0);this.$n_0($p0)},$o_0:function(){var $$t_1=this;$P_CRM(this.showMoreLinkJQuery[0].innerHTML).bind("click",function($p1_0){$$t_1.renderOlderPosts();$p1_0.preventDefault();$p1_0.stopPropagation()}).appendTo(this.wallContainerjQuery)},findDisplayedPostById:function(postId){return Wall.UI.Wall.getPostById(postId,this.$1_0)},handleWindowUnload:function(unloadEvent){this.dispose()},disposeInternal:function(){this.$1_0=null;Wall.Control.Utils.WindowUtils.remove_onWindowUnload(this.$$d_handleWindowUnload);$P_CRM(window).unbind("resize",this.$$d_$17_0);this.$X_0.dispose();Wall.UI.Wall.cleanupWall(this.wallContainerjQuery);this.headerJQuery=null;this.postTemplatejQuery=null;this.$0_0=null;this._events=null},dispose:function(){if(this.$O_0)return;this.disposeInternal();this.$O_0=true}};Type.registerNamespace("Wall.Control.Utils");Wall.Control.Utils.BrowserType=function(){};Wall.Control.Utils.Browser=function(){};Wall.Control.Utils.Browser.$x=function($p0){return Wall.Control.Utils.Browser.$w($p0.userAgent,$p0.appName,$p0.appVersion,document.documentMode)};Wall.Control.Utils.Browser.$w=function($p0,$p1,$p2,$p3){var $v_0=new Wall.Control.Utils.Browser;$v_0.$4_0=0;$v_0.$C_0=false;$v_0.$I_0=false;$v_0.$7_0=$p1;$v_0.$6_0=parseFloat($p2);$v_0.$G_0=0;if($p0.indexOf(" MSIE ")>-1){$v_0.$4_0=1;$v_0.$7_0="IE";$v_0.$6_0=parseFloat($p0.match(_RegularExpression.parse("/MSIE (\\d+\\.\\d+)/"))[1]);if($v_0.$6_0>=7)if(!IsNull($p3)&&$p3>=7)$v_0.$G_0=$p3;$v_0.$C_0=true;if($p0.indexOf("IEMobile")!==-1||$p0.indexOf("Windows Phone")!==-1)$v_0.$P_0=true;if(_Type.hasField(window.navigator,"msMaxTouchPoints")&&window.navigator.msMaxTouchPoints>0)$v_0.$I_0=true}else if($p0.indexOf(" rv:11.0")>-1){$v_0.$4_0=1;$v_0.$6_0=11;$v_0.$7_0="IE";$v_0.$C_0=true}else if($p0.indexOf(" Firefox/")>-1){$v_0.$4_0=2;$v_0.$6_0=parseFloat($p0.match(_RegularExpression.parse("/ Firefox\\/(\\d+\\.\\d+)/"))[1]);$v_0.$7_0="Firefox";$v_0.$C_0=true}else if($p0.indexOf(" Chrome/")>-1){$v_0.$4_0=3;$v_0.$6_0=parseFloat($p0.match(_RegularExpression.parse("/ Chrome\\/(\\d+(\\.\\d+)?)/"))[1]);$v_0.$7_0="Chrome"}else if($p0.indexOf(" AppleWebKit/")>-1){$v_0.$4_0=4;$v_0.$6_0=parseFloat($p0.match(_RegularExpression.parse("/ AppleWebKit\\/(\\d+(\\.\\d+)?)/"))[1]);$v_0.$7_0="Safari";if($p0.indexOf("iPhone")!==-1||$p0.indexOf("iPad")!==-1||$p0.indexOf("iPod")!==-1){$v_0.$P_0=true;$v_0.$I_0=true;$v_0.$d_0=true}if($p0.indexOf("iPad")!==-1){var $v_1=$p0.match(_RegularExpression.parse("/ CPU OS (\\d+_*.*) like Mac OS X/"));if(!IsNull($v_1)&&$v_1.length>=2)$v_0.$W_0=parseFloat($v_1[1])}}else if($p0.indexOf("Opera/")>-1)$v_0.$4_0=5;return $v_0};Wall.Control.Utils.Browser.getCurrentBrowser=function(){if(IsNull(Wall.Control.Utils.Browser.$K))Wall.Control.Utils.Browser.$K=Wall.Control.Utils.Browser.$x(window.navigator);return Wall.Control.Utils.Browser.$K};Wall.Control.Utils.Browser.prototype={$4_0:0,$7_0:null,$6_0:0,$W_0:0,$C_0:false,$G_0:0,$P_0:false,$d_0:false,$I_0:false,get_agent:function(){return this.$4_0},get_name:function(){return this.$7_0},get_version:function(){return this.$6_0},get_deviceMajorVersion:function(){return this.$W_0},get_isMobile:function(){return this.$P_0},get_isMobileSafari:function(){return this.$d_0},get_isTouchEnabled:function(){return this.$I_0},get_isIE7:function(){return this.$4_0===1&&this.$6_0<8&&this.$G_0<=7},get_isIE8OrLower:function(){return this.$4_0===1&&this.$6_0<=8},get_hasDebuggerStatement:function(){return this.$C_0},get_documentMode:function(){return this.$G_0}};Wall.Control.Utils.DateUtils=function(){};Wall.Control.Utils.DateUtils.formatDateAsReadableString=function(dateTime,formattedDateTime){return Wall.Control.Utils.DateUtils.formatDateAsReadableStringWithGivenResources(dateTime,formattedDateTime,Wall.Control.Resources.WallControl.dateUtils_Today,Wall.Control.Resources.WallControl.dateUtils_Yeserday)};Wall.Control.Utils.DateUtils.formatDateAsReadableStringWithGivenResources=function(dateTime,formattedDateTime,resourceToday,resourceYesterday){if(IsNull(dateTime)&&IsNull(formattedDateTime))return "";if(IsNull(dateTime)&&!IsNull(formattedDateTime))return formattedDateTime;var $v_0="",$v_1="";if(_String.isNullOrEmpty(formattedDateTime)||formattedDateTime.indexOf(" ")<=0){if(typeof Sys=="undefined"||typeof Sys.CultureInfo=="undefined"||typeof Sys.CultureInfo.CurrentCulture.dateTimeFormat=="undefined")return dateTime.toString();var $v_4=Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortDatePattern,$v_5=Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortTimePattern;$v_0=Mscrm.DateTimeUtility.formatDate(dateTime,$v_4);$v_1=Mscrm.DateTimeUtility.formatDate(dateTime,$v_5);formattedDateTime=$v_0+" "+$v_1}var $v_2=new Date,$v_3=new Date($v_2.getFullYear(),$v_2.getMonth(),$v_2.getDate());if(dateTime-$v_3>0)return resourceToday+" "+$v_1;if(dateTime-$v_3+8.64e7>0)return resourceYesterday+" "+$v_1;return formattedDateTime};Wall.Control.Utils.DateUtils.formattedEmailActivityDate=function(emailActivityDate,strJustNow,strHourAgo,strOn,strToday,strYesterday,strHoursAgo,strYear,strNotYetOpened,strMonth,calenderMonths,calenderWeekDays){if(IsNull(emailActivityDate))return strNotYetOpened;var $v_0=new Date,$v_1=($v_0-emailActivityDate)/1e3,$v_2=Math.floor($v_1/(Wall.Control.Utils.DateUtils.$15(emailActivityDate)?Wall.Control.Utils.DateUtils.$c(366):Wall.Control.Utils.DateUtils.$c(365))),$v_3=emailActivityDate.getHours(),$v_4=emailActivityDate.getMinutes(),$v_5=$v_3>=12?$v_3-12:$v_3,$v_6=$v_3>=12?"pm":"am",$v_7=emailActivityDate.getDate();if($v_7<10)$v_7="0"+$v_7;if($v_5<10)$v_5="0"+$v_5;if($v_4<10)$v_4="0"+$v_4;if($v_2>=1)return String.format(strYear,Wall.Control.Utils.DateUtils.$p(emailActivityDate,calenderMonths),$v_7,emailActivityDate.getFullYear(),$v_5,$v_4,$v_6);else{var $v_8=$v_1/Wall.Control.Utils.DateUtils.$c(1);if($v_8>=7)return String.format(strMonth,Wall.Control.Utils.DateUtils.$p(emailActivityDate,calenderMonths),$v_7,$v_5,$v_4,$v_6);else if($v_8>1&&$v_8<7)return String.format(strOn,Wall.Control.Utils.DateUtils.$10(emailActivityDate,calenderWeekDays),$v_5,$v_4,$v_6);else{var $v_9=$v_1/3600;if($v_9>4)return String.format($v_8>0?strToday:strYesterday,$v_5,$v_4,$v_6);else if($v_9>1&&$v_9<2){$v_9="0"+$v_9;return String.format(strHourAgo,Math.floor($v_9))}else if($v_9>1){$v_9="0"+$v_9;return String.format(strHoursAgo,Math.floor($v_9))}else return strJustNow}}};Wall.Control.Utils.DateUtils.$p=function($p0,$p1){var $v_0=$p1.split(","),$v_1=$v_0[$p0.getMonth()];return $v_1};Wall.Control.Utils.DateUtils.$10=function($p0,$p1){var $v_0=$p1.split(","),$v_1=$v_0[$p0.getDay()];return $v_1};Wall.Control.Utils.DateUtils.$c=function($p0){return $p0*24*60*60};Wall.Control.Utils.DateUtils.$15=function($p0){var $v_0=$p0.getFullYear();return !($v_0%4)&&!!($v_0%100)||!($v_0%400)};function displayErrorMessage(errorMessage){alert(errorMessage)}function isRTL(){var $v_0=$P_CRM("body").css("direction");return !IsNull($v_0)&&$v_0.toLowerCase()==="rtl"}function detectHighContrastMode(imageUrl){var $v_0=$P_CRM("div#_highContrastDetectDiv");if(!$v_0||$v_0.length<=0)$v_0=$P_CRM("<div id='_highContrastDetectDiv'></div>").css({display:"none",width:"0px",height:"0px",background:String.format("url('{0}')",imageUrl)}).appendTo(document.body);var $v_1=$v_0.css("background-image")==="none";return $v_1}function getActiveElement(){return Mscrm.Utilities.getActiveElement()}function markFirstAndLast(objects){if(objects&&objects.length>0){objects[0]["isfirst"]=true;objects[objects.length-1]["islast"]=true}return objects}function unsubscribeAllEvents(parentjQueryObject){parentjQueryObject.find("a, textarea, input, button").unbind()}function unsubscribeAllEventsOnUnload(parentjQueryObject){Wall.Control.Utils.WindowUtils.add_onWindowUnload(function(){unsubscribeAllEvents(parentjQueryObject)})}Wall.Control.Utils.WallUtilsHelper=function(){};Wall.Control.Utils.WallUtilsHelper.getSeverUrl=function(){if(IsNull(Wall.Control.Utils.WallUtilsHelper.$T)){var $v_0=GetGlobalContext();Wall.Control.Utils.WallUtilsHelper.$T=$v_0.getClientUrl()}return Wall.Control.Utils.WallUtilsHelper.$T};function formatEntityIconImage(entityTypeName,iconType,relativeImageUrl){if(!IsNull(relativeImageUrl)&&relativeImageUrl.trim().length>0)return String.format('<img alt="{0}" src="{1}"/>',Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlAttributeEncode(entityTypeName),relativeImageUrl);else return String.format("<img alt='{0}' src='{2}/_Common/icon.aspx?etn={1}&iconType={3}&cache=1' />",Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlAttributeEncode(entityTypeName),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlEncode(entityTypeName),Wall.Control.Utils.WallUtilsHelper.getSeverUrl(),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlEncode(iconType))}function formatEntityIconImageWithWindowOpenLink(entityReference,relativeImageUrl){if(IsNull(entityReference))return "";var $v_0=formatEntityIconImage(entityReference.get_logicalName(),"ribbon32",relativeImageUrl);return createWindowOpenLink(entityReference,$v_0,{tabindex:"-1"})}function formatNameWithWindowOpenLink(entityReference,attributes,userNameMaxDisplayLength){var $v_0=80;if(IsNull(entityReference)||_String.isNullOrEmpty(entityReference.get_name()))return "";if(!attributes)attributes={};if(IsNull(userNameMaxDisplayLength))userNameMaxDisplayLength=$v_0;var $v_1="...";if(!IsNull(Wall.Control.Resources))$v_1=Wall.Control.Resources.WallControl.ellipsis;var $v_2;if(entityReference.get_name().length>userNameMaxDisplayLength)$v_2=Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlEncode(_String.remove(entityReference.get_name(),userNameMaxDisplayLength-$v_1.length)+$v_1);else $v_2=Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlEncode(entityReference.get_name());if(!("title" in attributes))attributes["title"]=entityReference.get_name();return createWindowOpenLink(entityReference,$v_2,attributes)}function createWindowOpenLink(entityReference,content,attributes){var $v_0="";if(!IsNull(attributes)){var $$dict_5=attributes;for(var $$key_6 in $$dict_5){var $v_2={key:$$key_6,value:$$dict_5[$$key_6]};$v_0+=String.format(' {0}="{1}" ',$v_2.key,Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlAttributeEncode($v_2.value))}}var $v_1=convertETNtoETC(entityReference.get_logicalName());if($v_1>0)return String.format("<a href='#' onclick=\"{4}({0},'{1}'); return false;\" {3} >{2}</a>",$v_1,Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlEncode(entityReference.get_id()),content,$v_0,"Wall.Control.Utils.WindowUtils.openObject");return String.format("<a href=\"#\" onclick=\"{4}('{0}','{1}'); return false;\" {3} >{2}</a>",Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlEncode(entityReference.get_logicalName()),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlEncode(entityReference.get_id()),content,$v_0,"Wall.Control.Utils.WindowUtils.openEntityForm")}function convertETNtoETC(entityLogicalName){switch(entityLogicalName){case "account":return 1;case "appointment":return 4201;case "campaignactivity":return 4402;case "campaignresponse":return 4401;case "contact":return 2;case "contract":return 1010;case "email":return 4202;case "fax":return 4204;case "goal":return 9600;case "incident":return 112;case "invoice":return 1090;case "lead":return 4;case "letter":return 4207;case "list":return 4300;case "opportunity":return 3;case "phonecall":return 4210;case "processsession":return 4710;case "queue":return 2020;case "quote":return 1084;case "recurringappointmentmaster":return 4251;case "salesorder":return 1088;case "serviceappointment":return 4214;case "systemuser":return 8;case "task":return 4212;default:return -1}}Wall.Control.Utils.GridUtils=function(gridControl){if(IsNull(gridControl))throw Error.argumentNull("gridControl is null");this.$2_0=gridControl};Wall.Control.Utils.GridUtils.prototype={$2_0:null,get_selectedIds:function(){return this.$2_0.get_selectedIds()},get_isRefreshing:function(){if(_Type.hasProperty(this.$2_0,"isRefreshing"))return this.$2_0.get_isRefreshing();else return false},refresh:function(){_Type.hasMethod(this.$2_0,"refresh")&&this.$2_0.refresh()},getCellValue:function(columnName,rowId){if(_Type.hasMethod(this.$2_0,"getCellValue"))return this.$2_0.getCellValue(columnName,rowId);return null},showLoadingMessage:function(){_Type.hasMethod(this.$2_0,"ShowLoadingMessage")&&this.$2_0.ShowLoadingMessage()},get_element:function(){if(_Type.hasField(this.$2_0,"_element"))return this.$2_0._element;return null}};Wall.Control.Utils.jQueryEventHelper=function(){};Wall.Control.Utils.jQueryEventHelper.getKeyCode=function(evt){return evt.keyCode};Wall.Control.Utils.jQueryEventHelper.getCtrlKey=function(evt){return evt.ctrlKey};Wall.Control.Utils.jQueryEventHelper.getShiftKey=function(evt){return evt.shiftKey};Wall.Control.Utils.jQueryEventHelper.getAltKey=function(evt){return evt.altKey};Wall.Control.Utils.jQueryEventHelper.onlyTabKeyIsPressed=function(e){var $v_0=Wall.Control.Utils.jQueryEventHelper.getKeyCode(e);return $v_0===9&&!Wall.Control.Utils.jQueryEventHelper.getShiftKey(e)&&!Wall.Control.Utils.jQueryEventHelper.getCtrlKey(e)&&!Wall.Control.Utils.jQueryEventHelper.getAltKey(e)};Wall.Control.Utils.jQueryEventHelper.onlyTabAndShiftKeysArePressed=function(e){var $v_0=Wall.Control.Utils.jQueryEventHelper.getKeyCode(e);return $v_0===9&&Wall.Control.Utils.jQueryEventHelper.getShiftKey(e)&&!Wall.Control.Utils.jQueryEventHelper.getCtrlKey(e)&&!Wall.Control.Utils.jQueryEventHelper.getAltKey(e)};Wall.Control.Utils.Keyboard=function(){};Wall.Control.Utils.OutlookUtils=function(){};Wall.Control.Utils.OutlookUtils.saveMruXml=function(xml){if(Wall.Control.Utils.OutlookUtils.isOutlookHostedWindow()&&typeof getOutlookHostedWindow().saveMruXml!=="undefined"){getOutlookHostedWindow().saveMruXml(xml);return true}return false};Wall.Control.Utils.OutlookUtils.getMruXml=function(){if(Wall.Control.Utils.OutlookUtils.isOutlookHostedWindow()&&typeof getOutlookHostedWindow().getMruXml!=="undefined")return getOutlookHostedWindow().getMruXml();return null};Wall.Control.Utils.OutlookUtils.isOutlookHostedWindow=function(){return isOutlookHostedWindow()};Wall.Control.Utils.RemoteCommandFactory=function(){};Wall.Control.Utils.RemoteCommandFactory.createRemoteCommand=function(obj,command,urlBase){return new RemoteCommand(obj,command,urlBase)};Wall.Control.Utils.ScreenReader=function(){};Wall.Control.Utils.ScreenReader.say=function(message){$P_CRM("#screenReaderDiv").text(message)};Wall.Control.Utils.SelectionInfo=function(){};Wall.Control.Utils.SelectionInfo.prototype={start:0,end:0,text:null};Wall.Control.Utils.TextRangeUtils=function(){};Wall.Control.Utils.TextRangeUtils.$y=function($p0){var $v_0=$p0,$v_1=$v_0.selectionStart;if(!IsNull($v_1))return $v_1;var $v_2=document.selection;if(!IsNull($v_2)){$p0.focus();var $v_3=$v_2.createRange();if(!$v_3)return 0;var $v_4=$v_0.createTextRange(),$v_5=$v_4.duplicate();$v_4.moveToBookmark($v_3.getBookmark());$v_5.setEndPoint("EndToStart",$v_4);return $v_5.text.length}return -1};Wall.Control.Utils.TextRangeUtils.getCaretPosition=function(textAreaElement){for(var $v_0=Wall.Control.Utils.TextRangeUtils.$y(textAreaElement),$v_1=$v_0,$v_2=textAreaElement.value,$v_3=0;$v_3<$v_0;$v_3++)if($v_2.charAt($v_3)==="\r")--$v_1;return $v_1};Wall.Control.Utils.TextRangeUtils.setCaretPosition=function(element,position){if(!IsNull(element.setSelectionRange)){element.setSelectionRange(position,position);return}if(!IsNull(element.createTextRange)){var $v_0=element.createTextRange();$v_0.collapse(true);$v_0.moveEnd("character",position);$v_0.moveStart("character",position);$v_0.select()}};Wall.Control.Utils.TextRangeUtils.getClipboardValue=function(){return window.clipboardData.getData("Text")};Wall.Control.Utils.TextRangeUtils.getSelection=function(textAreaElement){var $v_0=new Wall.Control.Utils.SelectionInfo,$v_1=textAreaElement;if(Wall.Control.Utils.TextRangeUtils.$q(textAreaElement)){$v_0.text=textAreaElement.value.substring($v_1.selectionStart,$v_1.selectionEnd);if(_String.isNullOrEmpty($v_0.text))return null;$v_0.start=$v_1.selectionStart;$v_0.end=$v_1.selectionEnd}else{var $v_2=document.selection;if(!IsNull($v_2)){textAreaElement.focus();var $v_3=$v_2.createRange();if(_String.isNullOrEmpty($v_3.text))return null;$v_0.text=$v_3.text;$v_0.start=Wall.Control.Utils.TextRangeUtils.getCaretPosition(textAreaElement);$v_0.end=$v_0.start+$v_3.text.length}}return $v_0};Wall.Control.Utils.TextRangeUtils.setSelection=function(textAreaElement,startIndex,endIndex){var $v_0=textAreaElement;if(Wall.Control.Utils.TextRangeUtils.$q(textAreaElement))$v_0.setSelectionRange(startIndex,endIndex);else{var $v_1=document.selection;if(!IsNull($v_1)){textAreaElement.focus();var $v_2=$v_0.createTextRange();$v_2.collapse(true);$v_2.moveEnd("character",endIndex);$v_2.moveStart("character",startIndex);$v_2.select()}}};Wall.Control.Utils.TextRangeUtils.$q=function($p0){var $v_0=$p0,$v_1=$v_0.selectionStart;return !IsNull($v_1)};Wall.Control.Utils.WallUtils=function(){};Wall.Control.Utils.WallUtils.$u=function($p0){var $v_0=new RegExp("\\&\\#64;\\&\\#91;([a-z0-9_]{1,50}),(\\{{0,1}[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}\\}{0,1}),\\&\\#34;(.*?)\\&\\#34;\\&\\#93;","gm"),$v_1=$p0,$v_2=$v_0.exec($p0);while($v_2){if($v_2.length<3)continue;var $v_3=$v_2[1],$v_4=parseInt($v_3),$v_5=$v_2[2],$v_6="",$v_7="",$v_8="";if($v_2.length>3)if(!IsNull($v_2[3])&&$v_2[3].length>0){$v_6=$v_2[3];$v_8=$v_7=Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlDecode($v_6);if($v_7.length>60){$v_7=_String.remove($v_7,60-Wall.Control.Resources.WallControl.ellipsis.length);$v_7+=Wall.Control.Resources.WallControl.ellipsis}$v_7=Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.multilineHtmlEncode($v_7);$v_8=Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlAttributeEncode($v_8)}var $v_9=null,$v_A=isNaN($v_4);if($v_A)$v_9=_String.format('<a href=\'#\' onclick="{4}({0},\'{1}\', null, null,null,null);return false;" title="{3}" alt="{3}" >{2}</a>',Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.javaScriptEncode($v_3),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlEncode($v_5),$v_7,$v_8,"Wall.Control.Utils.WindowUtils.openEntityForm");else $v_9=_String.format('<a href=\'#\' onclick="{4}({0},\'{1}\', null, null,null,null);return false;" title="{3}" alt="{3}" >{2}</a>',Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlEncode($v_3),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.urlEncode($v_5),$v_7,$v_8,"Wall.Control.Utils.WindowUtils.openObject");$v_1=$v_1.replace($v_2[0],$v_9);$v_2=$v_0.exec($p0)}return $v_1};Wall.Control.Utils.WallUtils.$12=function($p0){if(IsNull($p0))return "";var $v_0=[],$v_1=new RegExp("((http|https|ftp|ftps|onenote|tel)://[\\S]*[a-zA-Z0-9+&@#/%=~_|$])","igm"),$v_2=$p0.match($v_1);if(!$v_2)$v_2=new Array(0);var $v_3=new RegExp("(www\\.[\\S]*[a-zA-Z0-9+&@#/%=~_|$])","igm"),$v_4=$p0.match($v_3);if(!$v_4)$v_4=new Array(0);for(var $v_5=new Array(0),$$arr_7=$v_4,$$len_8=$$arr_7.length,$$idx_9=0;$$idx_9<$$len_8;++$$idx_9){for(var $v_7=$$arr_7[$$idx_9],$v_8=true,$$arr_C=$v_2,$$len_D=$$arr_C.length,$$idx_E=0;$$idx_E<$$len_D;++$$idx_E){var $v_9=$$arr_C[$$idx_E];if($v_9.indexOf($v_7)>=0){$v_8=false;break}}if($v_8)$v_5[$v_5.length]=$v_7}$v_0=$v_2.concat.apply($v_2,$v_5);$p0=Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.multilineHtmlEncode($p0,true);if(!$v_0||!$v_0.length)return $p0;$v_0=_Array.removeDuplicatesFromArrayList($v_0);for(var $v_6=new RegExp("^((http|https|ftp|ftps|onenote|tel)://)(.*)$","i"),$v_A=0;$v_A<$v_0.length;$v_A++){var $v_B=$v_0[$v_A];if(_String.indexOfAny($v_B,["<",">","'",'"',"\r","\n"])>=0)continue;var $v_C=$v_B,$v_D=Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlEncode($v_C);if($v_C.length>60){$v_C=_String.remove($v_C,60-Wall.Control.Resources.WallControl.ellipsis.length);$v_C+=Wall.Control.Resources.WallControl.ellipsis}var $v_E=$v_B;if($v_B.toLowerCase().startsWith("www"))$v_E="http://"+$v_E;var $v_F=$v_6.exec($v_E);if($v_F&&$v_F.length>=3)$v_E=$v_F[1]+Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlEncode($v_F[3]);else continue;$p0=$p0.replace($v_D,_String.format("<a href='{0}' target='_blank' title='{2}'>{1}</a>",$v_E,Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlEncode($v_C),Sales.Common.CrmSoapServiceProxy.Utils.EncodingUtils.htmlAttributeEncode($v_B)))}return $p0};Wall.Control.Utils.WallUtils.formatTextForRendering=function(text){return Wall.Control.Utils.WallUtils.$u(Wall.Control.Utils.WallUtils.$12(text))};Wall.Control.Utils.WallUtils.mapPostsTojQueryIds=function(posts){if(IsNull(posts)||!posts.length)return "";var $v_0=_Array.map(String,posts,function($p1_0){return $p1_0.get_postId()});return "#"+$v_0.join(",#")};Wall.Control.Utils.WallUtils.mapCommentsTojQueryIds=function(comments){if(IsNull(comments)||!comments.length)return "";var $v_0=_Array.map(String,comments,function($p1_0){return $p1_0.get_commentId()});return "#"+$v_0.join(",#")};Wall.Control.Utils.WallUtils.wallResourcesLoaded=function(){return !IsNull(Wall.Control.Resources.WallControl)};Wall.Control.Utils.WallUtils.removeDuplicatePosts=function(posts,displayedPosts){if(IsNull(posts))return new Array(0);if(IsNull(displayedPosts))return posts;var $v_0=_Array.map(String,displayedPosts,function($p1_0){return $p1_0.get_postId()}),$v_1=_Array.filter(Wall.Interfaces.IPost,posts,function($p1_0){return !Array.contains($v_0,$p1_0.get_postId())});return $v_1};Wall.Control.Utils.WallUtils.enableTextSelection=function(){if(!$P_CRM.browser.msie)return;if(!_Type.hasField(document,"_events"))return;var $v_0=document._events;if(!_Type.hasField($v_0,"selectstart"))return;for(var $v_1=$v_0.selectstart,$v_2=$v_1.length-1;$v_2>=0;$v_2--)$removeHandler(document,"selectstart",$v_1[$v_2].handler)};Wall.Control.Utils.WindowUtils=function(){};Wall.Control.Utils.WindowUtils.get_$Z=function(){if(!Wall.Control.Utils.WindowUtils.$F){Wall.Control.Utils.WindowUtils.$F=new Sys.EventHandlerList;Wall.Control.Utils.WindowUtils.$B=function($p1_0){Wall.Control.Utils.WindowUtils.$B=null;_Event.fireEvent(Sys.EventArgs,Wall.Control.Utils.WindowUtils.get_$Z(),"OnWindowUnload",$P_CRM(window),Sys.EventArgs.Empty);$P_CRM(window).unbind("unload",Wall.Control.Utils.WindowUtils.$B);Wall.Control.Utils.WindowUtils.$F=null};$P_CRM(window).bind("unload",Wall.Control.Utils.WindowUtils.$B)}return Wall.Control.Utils.WindowUtils.$F};Wall.Control.Utils.WindowUtils.add_onWindowUnload=function(value){Wall.Control.Utils.WindowUtils.get_$Z().addHandler("OnWindowUnload",value)};Wall.Control.Utils.WindowUtils.remove_onWindowUnload=function(value){Wall.Control.Utils.WindowUtils.get_$Z().removeHandler("OnWindowUnload",value)};Wall.Control.Utils.WindowUtils.dispose=function(){if(IsNull(Wall.Control.Utils.WindowUtils.$B))return;Wall.Control.Utils.WindowUtils.$B(null)};Wall.Control.Utils.WindowUtils.openDialog=function(url,$sn_arguments,width,height,resizable,modeless,customWinParams){var $v_0=Mscrm.CrmUri.create(url);return openStdDlg($v_0,$sn_arguments,width,height,resizable,modeless,customWinParams)};Wall.Control.Utils.WindowUtils.openDialogWithCallback=function(url,$sn_arguments,width,height,callbackFunctionObject,resizable,modeless,customWinParams){var $v_0=Mscrm.CrmUri.create(url);return openStdDlgWithCallback($v_0,$sn_arguments,width,height,callbackFunctionObject,resizable,modeless,customWinParams)};Wall.Control.Utils.WindowUtils.openWindow=function(url,name,width,height,customWinFeatures){var $v_0=Mscrm.CrmUri.create(url);return openStdWin($v_0,name,width,height,customWinFeatures,"")};Wall.Control.Utils.WindowUtils.openObject=function(type,id,parameters,urlPrefix,mode,extraParams,typeName){return openObj(type,id,parameters,urlPrefix,mode,extraParams)};Wall.Control.Utils.WindowUtils.openEntityForm=function(name,id,parameters){Xrm.Utility.openEntityForm(name,id,parameters)};Wall.Control.Utils.XmlUtils=function(){};Wall.Control.Utils.XmlUtils.parseXmlDocument=function(xml){if(IsNull(xml))return null;var $v_0=null;if($P_CRM.browser.msie||Mscrm.Utilities.isIE11StandardOrIE11CompatibleMode())for(var $v_1=["Microsoft.XMLDOM","Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"],$v_2=0;$v_2<$v_1.length;$v_2++){$v_0=new ActiveXObject($v_1[$v_2]);if(!IsNull($v_0)){$v_0.async=false;$v_0.resolveExternals=false;$v_0.loadXML(xml);$v_0.setProperty("SelectionLanguage","XPath");if(!_String.isNullOrEmpty($v_0.text))return $v_0}}$v_0=Sys.Net.XMLDOM(xml);return $v_0};Wall.Control.ScriptSharp.jQueryDialogOptionsImportHelper.registerClass("Wall.Control.ScriptSharp.jQueryDialogOptionsImportHelper");Wall.Service.Convertors.EntityReferenceConvertor.registerClass("Wall.Service.Convertors.EntityReferenceConvertor");Wall.Service.Convertors.SystemUserConvertor.registerClass("Wall.Service.Convertors.SystemUserConvertor");Wall.Service.Messages.BaseResponse.registerClass("Wall.Service.Messages.BaseResponse",null,Wall.Interfaces.IPostResponse);Wall.Service.Messages.CreateCommentResponse.registerClass("Wall.Service.Messages.CreateCommentResponse",Wall.Service.Messages.BaseResponse,Wall.Interfaces.ICreateCommentResponse);Wall.Service.Messages.CreatePostResponse.registerClass("Wall.Service.Messages.CreatePostResponse",Wall.Service.Messages.BaseResponse,Wall.Interfaces.ICreatePostResponse);Wall.Service.Messages.DeleteCommentResponse.registerClass("Wall.Service.Messages.DeleteCommentResponse",Wall.Service.Messages.BaseResponse,Wall.Interfaces.IDeleteCommentResponse);Wall.Service.Messages.DeletePostResponse.registerClass("Wall.Service.Messages.DeletePostResponse",Wall.Service.Messages.BaseResponse,Wall.Interfaces.IDeletePostResponse);Wall.Service.Messages.RetrievePostsRequest.registerClass("Wall.Service.Messages.RetrievePostsRequest",null,Wall.Interfaces.IRetrievePostsRequest);Wall.Service.Messages.RetrieveCommentsRequest.registerClass("Wall.Service.Messages.RetrieveCommentsRequest",Wall.Service.Messages.RetrievePostsRequest,Wall.Interfaces.IRetrieveCommentsRequest);Wall.Service.Messages.RetrieveCommentsResponse.registerClass("Wall.Service.Messages.RetrieveCommentsResponse",Wall.Service.Messages.BaseResponse,Wall.Interfaces.IRetrieveCommentsResponse);Wall.Service.Messages.RetrievePostsBaseResponse.registerClass("Wall.Service.Messages.RetrievePostsBaseResponse",Wall.Service.Messages.BaseResponse,Wall.Interfaces.IRetrievePostsResponse);Wall.Service.Messages.RetrieveWallFiltersResponse.registerClass("Wall.Service.Messages.RetrieveWallFiltersResponse",Wall.Service.Messages.BaseResponse,Wall.Interfaces.IRetrieveWallFiltersResponse);Wall.Service.Messages.SetDefaultFilterResponse.registerClass("Wall.Service.Messages.SetDefaultFilterResponse",Wall.Service.Messages.BaseResponse,Wall.Interfaces.ISetDefaultFilterResponse);Wall.Service.ObjectModel.Comment.registerClass("Wall.Service.ObjectModel.Comment",null,Wall.Interfaces.IComment);Wall.Service.ObjectModel.EntityReference.registerClass("Wall.Service.ObjectModel.EntityReference",null,Wall.Interfaces.IEntityReference);Wall.Service.ObjectModel.Post.registerClass("Wall.Service.ObjectModel.Post",null,Wall.Interfaces.IPost);Wall.Service.ObjectModel.SystemUser.registerClass("Wall.Service.ObjectModel.SystemUser",null,Wall.Interfaces.ISystemUser);Wall.Service.ObjectModel.WallAction.registerClass("Wall.Service.ObjectModel.WallAction",null,Wall.Interfaces.IWallAction);Wall.Service.ObjectModel.WallFilter.registerClass("Wall.Service.ObjectModel.WallFilter",null,Wall.Interfaces.IWallFilter);Mscrm.Yammer.ConfigOptions.registerClass("Mscrm.Yammer.ConfigOptions");Mscrm.Yammer.EmailAddress.registerClass("Mscrm.Yammer.EmailAddress");Mscrm.Yammer.Contact.registerClass("Mscrm.Yammer.Contact");Mscrm.Yammer.User.registerClass("Mscrm.Yammer.User");Mscrm.Yammer.ObjectProperties.registerClass("Mscrm.Yammer.ObjectProperties");Mscrm.Yammer.Config.registerClass("Mscrm.Yammer.Config");Mscrm.Yammer.FeedOptions.registerClass("Mscrm.Yammer.FeedOptions");Wall.UI.WallStateEnum.registerClass("Wall.UI.WallStateEnum");Wall.UI.Wall.registerClass("Wall.UI.Wall",null,Wall.Interfaces.IWall,Sys.IDisposable);Wall.Control.Utils.BrowserType.registerClass("Wall.Control.Utils.BrowserType");Wall.Control.Utils.Browser.registerClass("Wall.Control.Utils.Browser");Wall.Control.Utils.DateUtils.registerClass("Wall.Control.Utils.DateUtils");Wall.Control.Utils.WallUtilsHelper.registerClass("Wall.Control.Utils.WallUtilsHelper");Wall.Control.Utils.GridUtils.registerClass("Wall.Control.Utils.GridUtils");Wall.Control.Utils.jQueryEventHelper.registerClass("Wall.Control.Utils.jQueryEventHelper");Wall.Control.Utils.Keyboard.registerClass("Wall.Control.Utils.Keyboard");Wall.Control.Utils.OutlookUtils.registerClass("Wall.Control.Utils.OutlookUtils");Wall.Control.Utils.RemoteCommandFactory.registerClass("Wall.Control.Utils.RemoteCommandFactory");Wall.Control.Utils.ScreenReader.registerClass("Wall.Control.Utils.ScreenReader");Wall.Control.Utils.SelectionInfo.registerClass("Wall.Control.Utils.SelectionInfo");Wall.Control.Utils.TextRangeUtils.registerClass("Wall.Control.Utils.TextRangeUtils");Wall.Control.Utils.WallUtils.registerClass("Wall.Control.Utils.WallUtils");Wall.Control.Utils.WindowUtils.registerClass("Wall.Control.Utils.WindowUtils");Wall.Control.Utils.XmlUtils.registerClass("Wall.Control.Utils.XmlUtils");Wall.Control.ScriptSharp.jQueryDialogOptionsImportHelper.$$cctor();Wall.UI.WallStateEnum.unknown=0;Wall.UI.WallStateEnum.data=1;Wall.UI.WallStateEnum.progress=2;Wall.UI.WallStateEnum.showMoreProgress=3;Wall.UI.WallStateEnum.empty=4;Wall.UI.WallStateEnum.error=5;Wall.UI.Wall.postjQueryTemplate="#{0}";Wall.UI.Wall.commentjQueryTemplate="#{0}";Wall.UI.Wall.commentsAreaJQueryTemplate="#{0}_commentsArea";Wall.UI.Wall.showAllCommentsJQueryTemplate="#{0}_showAllComments";Wall.UI.Wall.replyAreaJQueryTemplate="#{0}_replyArea";Wall.UI.Wall.postJQuerySelector=".post";Wall.UI.Wall.postsRefreshedEventName="PostsRefreshed";Wall.UI.Wall.commentsRefreshedEventName="CommentsRefreshed";Wall.UI.Wall.postCreatedEventName="PostCreated";Wall.UI.Wall.postCreatingEventName="PostCreating";Wall.UI.Wall.commentCreatedEventName="CommentCreated";Wall.UI.Wall.postDeletedEventName="PostDeleted";Wall.UI.Wall.commentDeletedEventName="CommentDeleted";Wall.UI.Wall.filtersRefreshedEventName="FiltersRefreshed";Wall.UI.Wall.postsRefreshingEventName="PostsRefreshing";Wall.UI.Wall.errorEventName="Error";Wall.UI.Wall.postsInsertedEventName="PostsInserted";Wall.Control.Utils.BrowserType.undefined=0;Wall.Control.Utils.BrowserType.IE=1;Wall.Control.Utils.BrowserType.firefox=2;Wall.Control.Utils.BrowserType.chrome=3;Wall.Control.Utils.BrowserType.safari=4;Wall.Control.Utils.BrowserType.opera=5;Wall.Control.Utils.Browser.$K=null;Wall.Control.Utils.WallUtilsHelper.$T=null;Wall.Control.Utils.Keyboard.tab=9;Wall.Control.Utils.Keyboard.enter=13;Wall.Control.Utils.Keyboard.shift=16;Wall.Control.Utils.Keyboard.esc=27;Wall.Control.Utils.Keyboard.space=32;Wall.Control.Utils.Keyboard.end=35;Wall.Control.Utils.Keyboard.home=36;Wall.Control.Utils.Keyboard.leftArrow=37;Wall.Control.Utils.Keyboard.upArrow=38;Wall.Control.Utils.Keyboard.rightArrow=39;Wall.Control.Utils.Keyboard.downArrow=40;Wall.Control.Utils.Keyboard.atSign=64;Wall.Control.Utils.Keyboard.comma=188;Wall.Control.Utils.Keyboard.period=190;Wall.Control.Utils.WindowUtils.$F=null;Wall.Control.Utils.WindowUtils.$B=null;Wall.Control.Utils.WindowUtils.openWindowInlineScript="Wall.Control.Utils.WindowUtils.openWindow";Wall.Control.Utils.WindowUtils.openDialogInlineScript="Wall.Control.Utils.WindowUtils.openDialog";Wall.Control.Utils.WindowUtils.openObjectInlineScript="Wall.Control.Utils.WindowUtils.openObject";Wall.Control.Utils.WindowUtils.openObjectUsingETN="Wall.Control.Utils.WindowUtils.openEntityForm"</script><script id="/_common/windowinformation/windowinformation.js.aspx?fcb=1&amp;lcid=1033&amp;ver=1888157098" type="text/javascript">function CRMWindowInfo(sUrl, iXOffset, iYOffset)
{
	this.Width	= parseInt(iXOffset, 10);
	this.Height	= parseInt(iYOffset, 10);
	this.Url	= Mscrm.CrmUri.create(sUrl);
}Type.registerNamespace('Mscrm');
Type.registerNamespace('Mscrm.Imported');
if(!Mscrm.Imported.WindowInformationImplementation) Mscrm.Imported.WindowInformationImplementation = {};
Mscrm.Imported.WindowInformationImplementation.getWindowInformationInternal = function (iObjectType) {
switch (parseInt(iObjectType, 10)) {case 4567: return new CRMWindowInfo("/tools/audit/audit_details.aspx",600,400);case 4007: return new CRMWindowInfo("/sm/resourcegroups/edit.aspx",820,660);case 4006: return new CRMWindowInfo("/sm/resourcespecs/edit.aspx",820,560);case 5003: return new CRMWindowInfo("/sm/workplans/dialogs/serviceavailability.aspx",550,380);case 5006: return new CRMWindowInfo("/sm/workplans/dialogs/occurrence.aspx",550,500);case 5007: return new CRMWindowInfo("/sm/workplans/dialogs/recurrencerule.aspx",550,500);case 5008: return new CRMWindowInfo("/sm/workplans/dialogs/timesheet.aspx",640,500);case 4003: return new CRMWindowInfo("/sm/workplans/edit.aspx",550,540);case 4503: return new CRMWindowInfo("/sfa/customeropportunityrole/edit.aspx",450,550);case 9333: return new CRMWindowInfo("/main.aspx?etc=9333&pagetype=webresourceedit",820,640);case 5: return new CRMWindowInfo("/notes/edit.aspx",500,450);case 10: return new CRMWindowInfo("/biz/business/edit.aspx",880,600);case 126: return new CRMWindowInfo("/cs/articles/viewer/default.aspx",650,630);case 1082: return new CRMWindowInfo("/cs/articles/comment/edit.aspx",500,350);case 1016: return new CRMWindowInfo("/tools/kbtemplateeditor/kbtemplateeditor.aspx",820,660);case 2010: return new CRMWindowInfo("/tools/emailtemplateeditor/emailtemplateeditor.aspx",820,660);case 9997: return new CRMWindowInfo("/tools/emailsignatureeditor/emailsignatureeditor.aspx",820,660);case 129: return new CRMWindowInfo("/tools/subjectmanager/dialogs/edit.aspx",400,300);case 132: return new CRMWindowInfo("/tools/newseditor/edit.aspx",820,660);case 1001: return new CRMWindowInfo("/activities/attachment/edit.aspx",500,280);case 3231: return new CRMWindowInfo("/connections/connectionroles/edit.aspx",860,800);case 1070: return new CRMWindowInfo("/sfa/saleslit/attachment_edit.aspx",820,660);case 1036: return new CRMWindowInfo("/biz/roles/edit.aspx",1024,790);case 1200: return new CRMWindowInfo("/biz/fieldsecurityprofiles/edit.aspx",1000,675);case 1039: return new CRMWindowInfo("/tools/vieweditor/viewmanager.aspx",800,510);case 1111: return new CRMWindowInfo("/tools/visualizationdesigner/visualizationdesigner.aspx",575,800);case 4208: return new CRMWindowInfo("/sfa/opps/closeopp.aspx",550,375);case 4209: return new CRMWindowInfo("/sfa/salesorder/cancelorder.aspx",550,375);case 4211: return new CRMWindowInfo("/sfa/quotes/closequote.aspx",550,375);case 4502: return new CRMWindowInfo("/sfa/customerrelationships/edit.aspx",720,490);case 9105: return new CRMWindowInfo("/biz/transactioncurrencies/edit.aspx",820,660);case 9106: return new CRMWindowInfo("/tools/mailmerge/edit.aspx",820,680);case 4500: return new CRMWindowInfo("/tools/relationshiproleeditor/edit.aspx",820,660);case 9100: return new CRMWindowInfo("/crmreports/viewer/viewer.aspx",880,700);case 9099: return new CRMWindowInfo("/crmreports/reportproperty.aspx",840,680);case 5004: return new CRMWindowInfo("/sm/workplans/dialogs/timeoff.aspx",550,420);case 5005: return new CRMWindowInfo("/sm/workplans/dialogs/holiday.aspx",560,460);case 5009: return new CRMWindowInfo("/sm/workplans/edit.aspx",550,540);case 5010: return new CRMWindowInfo("/sm/workplans/edit.aspx",550,540);case 2004: return new CRMWindowInfo("/_grid/cmds/dlg_addquota.aspx",600,425);case 2003: return new CRMWindowInfo("/_grid/cmds/dlg_addquota.aspx",600,425);case 2002: return new CRMWindowInfo("/_grid/cmds/dlg_addquota.aspx",600,425);case 2001: return new CRMWindowInfo("/_grid/cmds/dlg_addquota.aspx",600,425);case 2000: return new CRMWindowInfo("/_grid/cmds/dlg_addquota.aspx",600,425);case 4230: return new CRMWindowInfo("/advancedfind/advfind.aspx",900,600);case 9004: return new CRMWindowInfo("/tools/offlinedata/offlinefilter.aspx",850,720);case 4102: return new CRMWindowInfo("/tools/systemcustomization/displaystrings/edit.aspx",820,560);case 5011: return new CRMWindowInfo("/sm/activityscheduling/schedulingdialog.aspx",880,630);case 4703: return new CRMWindowInfo("/sfa/workflow/edit.aspx",1200,768);case 4700: return new CRMWindowInfo("/tools/asyncoperation/edit.aspx",900,560);case 9005: return new CRMWindowInfo("/tools/workflowinstance/edit.aspx",1000,560);case 4710: return new CRMWindowInfo("/sfa/workflowsession/edit.aspx",820,660);case 9200: return new CRMWindowInfo("/_common/error/dlg_scripterror.aspx",550,260);case 9201: return new CRMWindowInfo("/_common/error/dlg_scripterrordetails.aspx",500,300);case 9205: return new CRMWindowInfo("/tools/importwizard/importwizard.aspx",600,606);case 9203: return new CRMWindowInfo("/tools/duplicatedetection/systemwideduplicatedetection.aspx",600,580);case 9204: return new CRMWindowInfo("/tools/bulkdeletewizard/bulkdeletewizard.aspx",700,520);case 4414: return new CRMWindowInfo("/tools/duplicatedetection/duplicatedetectionrules/edit.aspx",1000,740);case 9951: return new CRMWindowInfo("/tools/systemcustomization/similarityrules/edit.aspx",1000,740);case 4411: return new CRMWindowInfo("/tools/managemaps/edit.aspx",1000,780);case 4424: return new CRMWindowInfo("/tools/bulkdelete/edit.aspx",1000,740);case 9209: return new CRMWindowInfo("/tools/solution/managedproperty/managedpropertypage.aspx",600,400);case 7100: return new CRMWindowInfo("/tools/solution/edit.aspx",1020,630);case 9207: return new CRMWindowInfo("/tools/solution/exportwizard/welcomepage.aspx",670,400);case 9208: return new CRMWindowInfo("/tools/solution/import/solutionimportwizard.aspx",670,450);case 9801: return new CRMWindowInfo("/tools/systemcustomization/entities/manageentity.aspx",1020,720);case 9804: return new CRMWindowInfo("/tools/systemcustomization/optionset/optionset.aspx",800,600);case 7101: return new CRMWindowInfo("/tools/publisher/edit.aspx",939,579);case 9202: return new CRMWindowInfo("/cs/articles/lookup_template.aspx",600,400);case 4200: return new CRMWindowInfo("/activities/dlg_create.aspx",350,350);case 9802: return new CRMWindowInfo("/tools/systemcustomization/attributes/manageattribute.aspx",1020,720);case 9803: return new CRMWindowInfo("/tools/systemcustomization/relationships/managerelationship.aspx",800,700);case 1030: return new CRMWindowInfo("/workplace/home_dashboards.aspx",880,600);case 1032: return new CRMWindowInfo("/workplace/home_dashboards.aspx",880,600);case 1031: return new CRMWindowInfo("/workplace/home_dashboards.aspx",880,600);case 9301: return new CRMWindowInfo("/convertruleitem/edit.aspx?etc=9301",1000,0);case 8199: return new CRMWindowInfo("/routingruleitem/edit.aspx?etc=8199",1000,0);case 9751: return new CRMWindowInfo("/slaitem/edit.aspx?etc=9751",1000,0);case 9812: return new CRMWindowInfo("/tools/systemcustomization/alternatekeys/managealternatekeys.aspx",1020,720);case 4606:case 4607:case 4608:case 4615:case 4616:case 4618:case 4605:case 78:case 4602:case 4603:return null;case 8000:return null;case 4450:return null;case 9753:return null;case 9755:return null;default: return new CRMWindowInfo("/userdefined/edit.aspx?etc="+parseInt(iObjectType, 10),1000,0);}}</script></head><body class="stage"><div id="stdTable" class="stdTable ms-crm-metaphor-grid-container"><span id="__Page_crmEventManager" style="display:block;height:0px;"></span><div class="ms-crm-metaphor-grid-header"><div class="ms-crm-metaphor-grid-header-bg-color"></div><table width="100%" cellpadding="0" cellspacing="0" class="homepage_table">
	<tbody><tr>
		<td style="padding: 0px;"><span id="gridControlBar"><table id="gridControlBarCompositeControl" cellspacing="0" cellpadding="0" class="ms-crm-Grid-Control-Bar" width="100%">
			<tbody><tr id="Row1" class="ms-crm-List-Title">
				<td id="crmGrid_SavedNewQuerySelectorTD" width="64%"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout:auto" id="viewSelectorContainer"><tbody><tr><td width="100%"><table cellspacing="0" cellpadding="0" width="100%" height="100%" style="table-layout:fixed"><tbody><tr><td><div style="overflow:hidden;width:100%;height:auto"><img src="./transparent_spacer.gif" alt="Pin this view as the default view for this list" tabindex="0" id="defaultViewIcon" class="ms-crm-ImageStrip-pin_visualrefresh" style="cursor: pointer;" onclick="Mscrm.RibbonActions.saveAsDefaultGridView();" onkeypress="if (event.keyCode==13 || event.keyCode==32){ Mscrm.RibbonActions.saveAsDefaultGridView();}" title="Pin this view as the default view for this list"><a role="button" aria-haspopup="true" aria-expanded="false" class="ms-crm-View-Name ms-crm-View-Name-View-Lite" style="position: relative;text-decoration: none" onclick="return false;" title="Select a view" id="crmGrid_SavedNewQuerySelector" tabindex="0" gridid="crmGrid"><span class="ms-crm-View-Name ms-crm-ViewSelector-title-associated-lite ms-crm-TextAutoEllipsis" currentview="{4EE94837-6992-4B74-95AE-A22250E92904}" defaultsavedqueryview="{4EE94837-6992-4B74-95AE-A22250E92904}" userselecteddefaultview="" userownedview="" quickfindquery="{9106A0C2-A4A3-4DBD-8226-264A45A75805}" currentviewtype="1039" style="width: auto;">Active Referrals</span><span class="ms-crm-View-icon ms-crm-ViewSelector-dropdown-icon-associated-lite"><img class="ms-crm-View-icon-associated-lite ms-crm-ImageStrip-Dropdown_Arrow" alt="Select a view" src="./transparent_spacer.gif"></span></a></div></td></tr></tbody></table></td></tr></tbody></table></td>
				<td id="gridControlBarElement_2TD" width="2.5%"><span id="gridControlBarElement_2" class="homepage_span">&nbsp;</span></td>
				<td id="crmQuickFindTD" width="30%"><table title="" width="100%" cellspacing="0" cellpadding="0"><tbody><tr id="crmGrid_quickFindContainer" gridid="crmGrid" style="height:30px;"><td style="width:100%;overflow:hidden;padding:0px;" valign="top"><div style="position:relative;"><label for="crmGrid_findCriteria" id="crmGrid_findHintText" class="ms-crm-Dialog-Lookup-QuickFindHint ms-crm-TextAutoEllipsis" style="display: inline;">Search for records</label></div><div style="height:100%"><input id="crmGrid_findCriteria" title="Search for records" hintlabelid="crmGrid_findHintText" type="text" class="ms-crm-Dialog-Lookup-QuickFind" maxlength="100" tabindex="0" value=""></div></td><td style="padding:0px;" nowrap="" class="AppQuickFind_Render_td"><a id="crmGrid_findCriteriaButton" title="Start search" class="ms-crm-FindButton" href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" target="_self" tabindex="0"><span><img id="crmGrid_findCriteriaImg" src="./transparent_spacer.gif" class="ms-crm-ImageStrip-search " imgbase="/_imgs/search" title="Start search" alt="Start search"></span></a><a style="display: none;" id="crmGrid_clearCriteriaButton" class="ms-crm-FindButton" href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" target="_self" tabindex="0"><span><img id="crmGrid_clearCriteriaImg" src="./searchclear.gif" class=" ms-crm-ImageStrip-searchclear" imgbase="/_imgs/searchclear" title="Clear search" alt="Clear search"></span></a><a style="display: none;" id="crmGrid_articleSearchButton" class="ms-crm-ArticleSearchButton" href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" target="_self" tabindex="0"><img id="articleSearchImg" src="./transparent_spacer.gif" title="Search Tools" alt="Search Tools" class="ms-crm-ImageStrip-SearchFilter_16"></a></td></tr></tbody></table></td>
			</tr>
		</tbody></table>
		</span></td>
	</tr>
</tbody></table>
</div><hr class="ms-crm-metaphor-appgridmenubar-hr" border="none"><div style="height:0px;"><div id="crmMenuBar" class="ms-crm-appgridmenubar"></div></div><div id="homepageTableCell" class="ms-crm-absolutePosition" style="margin-left:20px;top:54px;"><div class="ms-crm-grid-content-container"><div class="ms-crm-IE7-Height-Fix-Dummy-Container"><div id="crmGrid_visualizationCompositeControl" style="height:100%;"><div id="crmGrid_compositeControl" style="height:100%;width:100%;position:relative;"><div id="crmGrid_crmGridStrip" class="ms-crm-CC-GridSS-All-0-LR"><div id="crmGrid_gridStripDiv" onmouseover="window.Mscrm &amp;&amp; Mscrm.CompositeControl &amp;&amp; Mscrm.CompositeControl.glowGridStrip(true, &#39;crmGrid_visualizationCompositeControl&#39;);" onmouseout="window.Mscrm &amp;&amp; Mscrm.CompositeControl &amp;&amp; Mscrm.CompositeControl.glowGridStrip(false, &#39;crmGrid_visualizationCompositeControl&#39;);" class="ms-crm-control-SideStrip"><a href="javascript:;" grid="true" onclick="window.Mscrm &amp;&amp; Mscrm.CompositeControlResizeControl &amp;&amp; Mscrm.CompositeControlResizeControl.clickSideStrip(this.getAttribute(&#39;grid&#39;), &#39;crmGrid_splitTD&#39;);" class="ms-crm-Anchor-SideStrip" title="Click here to view the chart."><table height="100%" width="37px" cellspacing="0" cellpadding="0" class="ms-crm-control-strip-table  visualizationImageTable">
	<tbody><tr height="20px">
		<td align="center"><span><img src="./transparent_spacer.gif" imgbase="/_imgs/navRight_VisualRefresh.png" class="ms-crm-ImageStrip-navRight_VisualRefresh" alt="Click here for Normal View"></span></td>
	</tr>
	<tr>
		<td align="center" valign="top" height="100%" style="padding-top:6px;"><div class="ms-crm-stripRotateCounterClockwise"><label id="crmGrid_GridStripLabelMessage" class="ms-crm-stripLabelLeftRight ms-crm-stripGridLabelLeftRight ms-crm-StripLabel-Rotation" style="white-space:nowrap;opacity:1;text-overflow:ellipsis;letter-spacing:0px;height:25px;position:absolute;bottom:-10px;color:#2c3e50;right:0;overflow:hidden;line-height:27px;"></label></div></td>
	</tr>
</tbody></table>
</a></div></div><div id="crmGrid_crmGridTD" class="ms-crm-CC-grid-All-0-LR"><div class="ms-crm-IE7-Height-Fix-Dummy-Container"><div id="crmGrid_filterSet" gridid="crmGrid"></div><div class="ms-crm-grid-BodyContainer" style="width:100%;height:100%;position:relative;overflow:hidden;"><div id="crmGrid" class="ms-crm-ListControl" type="crmGrid" style="bottom:30px;"><div class="ms-crm-grid-body" style="bottom:0px;"><div class="ms-crm-IE7-Height-Fix-Dummy-Container"><div class="ms-crm-grid-BodyContainer" style="height:100%;position:relative" id="crmGrid_gridBodyContainer"><div class="ms-crm-ListArea" style="position:relative"><div class="ms-crm-grid-BodyContainer" style="height:40px;OVERFLOW-X:hidden;"><div id="fixedrow" class="ms-crm-ListArea-FixedRow" style="margin-left: 0px;"><table cellspacing="0" cellpadding="0" id="crmGrid_gridBar" role="presentation" class="ms-crm-List-Header ms-crm-Grid-HeaderBackColor" summary="From each column header, you can sort and filter the records in that column."><colgroup id="crmGrid_gridBarCols"><col width="40" class="ms-crm-List-NonDataColumnHeader"><col width="2"><col class="ms-crm-List-DataColumnHeader" width="300"><col width="2"><col class="ms-crm-List-DataColumnHeader" width="150"><col width="2"><col class="ms-crm-List-DataColumnHeader" width="100"><col width="2"><col width="60"><col></colgroup><tbody><tr style="height: 38px"><td style="height: 38px; padding: 0px;  padding-left:12px; "><input type="checkbox" class="ms-crm-HeaderCheckBox" id="chkAll" tabindex="0" style=" " title="Select/clear all records on this page"><img src="./transparent_spacer.gif" role="button" class="ms-crm-grid-checkbox-image-header ms-crm-ImageStrip-checkbox_visualrefresh_light" id="crmGrid_gridBodyTable_checkBox_Image_All" alt="Select/clear all records on this page" title="Select/clear all records on this page" tabindex="0" style="visibility: visible;"></td><td><span class="ms-crm-List-Row-header-spacer"></span></td><th scope="col" field="nmo_name" fieldname="nmo_name" entityname="nmo_referral" renderertype="Crm.PrimaryField" type="String.text" sourcetype="0" class="ms-crm-List-Sortable" displaylabel="Name"><table role="presentation" cellpadding="0px" cellspacing="0px" title="Name" class="ms-crm-List-Sortable"><tbody><tr><td class="ms-crm-List-Sortable"><a href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" target="_self" class="ms-crm-List-Sortable" onclick="return false;" title="Sort by Name" tabindex="0"><nobr class="ms-crm-DataCell"><label class="ms-crm-List-Sortable">Name</label><img alt="The data is sorted in ascending order on this column" src="./transparent_spacer.gif" class="ms-crm-List-Sortable ms-crm-Image-Margin ms-crm-ImageStrip-sorting_up" style="visibility:visible;"></nobr></a></td><td class="ms-crm-FilterPopupContainerTD"><table cellspacing="0" cellpadding="0" class="ms-crm-FilterPopupContainer" style="display:none"><tbody><tr><td nowrap="" align="left"><ul class="ms-crm-MenuBar-Left" style="margin-top: 0px; margin-left: 0px"><li class="ms-crm-FilterPopupMenu" tabindex="-1" menu="mnustringFilterPopupcrmGridnmo_referralnmo_name" id="stringFilterPopupcrmGridnmo_referralnmo_name" isfromfiltermenu="true" relationshipname="" attributeformat="text" isfromrelatedentity="False" attributexml="&lt;attributeinfo&gt;&lt;result value=&quot;nmo_name&quot; datatype=&quot;nvarchar&quot; maxlength=&#39;100&#39;&gt;Name&lt;/result&gt;&lt;lookupicons&gt;&lt;/lookupicons&gt;&lt;/attributeinfo&gt;" attributetype="nvarchar" attributename="nmo_name" xml_filter="&lt;Menu title=&quot;StringFilterPopupMenu&quot; menuId=&quot;stringFilterPopupcrmGridnmo_referralnmo_name&quot;&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_nameResetFilter&quot; type=&quot;ResetFilter&quot; display=&quot;Reset Filter&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/grid/disablereset.png&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_nameSortAsc&quot; type=&quot;SortAsc&quot; display=&quot;Sort A to Z&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/grid/asc.png&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_nameSortDesc&quot; type=&quot;SortDesc&quot; display=&quot;Sort Z to A&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/grid/desc.png&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_nameIsNotNull&quot; type=&quot;IsNotNull&quot; display=&quot;Contains Data&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_nameIsNull&quot; type=&quot;IsNull&quot; display=&quot;Contains No Data&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_nameCustomFilters&quot; type=&quot;CustomFilters&quot; display=&quot;Custom Filter...&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;/Menu&gt;" columnname="nmo_name" entityname="nmo_referral" gridid="crmGrid" filtermenutype="string"><div class="ms-crm-FilterPopupMenu-Label"><a href="javascript:void(0)" class="ms-crm-FilterPopupMenu-Label" tabindex="0" aria-label="Filter"><div class="ms-crm-Menu-FilterImgWrapper"><img src="./transparent_spacer.gif" alt="" id="mnuDown" role="application" class="ms-crm-Menu-ButtonFilter ms-crm-ImageStrip-dropdown"></div></a></div></li></ul></td></tr></tbody></table></td></tr></tbody></table></th><td><span "="" id="crmGrid_resize_nmo_name" class="ms-crm-List-Row-header-spacer"></span></td><th scope="col" field="nmo_clientid" fieldname="nmo_clientid" entityname="nmo_referral" renderertype="lookup" imageproviderwebresource="$webresource:" type="Lookup" sourcetype="0" class="ms-crm-List-Sortable" displaylabel="Client"><table role="presentation" cellpadding="0px" cellspacing="0px" title="Client" class="ms-crm-List-Sortable"><tbody><tr><td class="ms-crm-List-Sortable"><a href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" target="_self" class="ms-crm-List-Sortable" onclick="return false;" title="Sort by Client" tabindex="0"><nobr class="ms-crm-DataCell"><label class="ms-crm-List-Sortable">Client</label><img alt="The data is sorted in ascending order on this column" src="./transparent_spacer.gif" class="ms-crm-List-Sortable ms-crm-Image-Margin ms-crm-ImageStrip-sorting_up"></nobr></a></td><td class="ms-crm-FilterPopupContainerTD"><table cellspacing="0" cellpadding="0" class="ms-crm-FilterPopupContainer" style="display:none"><tbody><tr><td nowrap="" align="left"><ul class="ms-crm-MenuBar-Left" style="margin-top: 0px; margin-left: 0px"><li class="ms-crm-FilterPopupMenu" tabindex="-1" menu="mnulookupFilterPopupcrmGridnmo_referralnmo_clientid" id="lookupFilterPopupcrmGridnmo_referralnmo_clientid" isfromfiltermenu="true" relationshipname="" attributeformat="" isfromrelatedentity="False" attributexml="&lt;attributeinfo&gt;&lt;result value=&quot;nmo_clientid&quot; datatype=&quot;lookup&quot; nameattr=&quot;nmo_clientidname&quot; namemaxlength=&#39;320&#39; lookuptypes=&quot;2&quot; lookuptypenames=&quot;contact:2:Client&quot; lookupstyle=&quot;single&quot; crmattributeid=&quot;{7f06b18c-b90e-40ba-9ee7-55f9997fe5ea}&quot;&gt;Client&lt;/result&gt;&lt;lookupicons&gt;2:/_imgs/ico_16_2.gif?ver=1888157098&lt;/lookupicons&gt;&lt;/attributeinfo&gt;" attributetype="lookup" attributename="nmo_clientid" xml_filter="&lt;Menu title=&quot;LookupFilterPopupMenu&quot; menuId=&quot;lookupFilterPopupcrmGridnmo_referralnmo_clientid&quot;&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_clientidResetFilter&quot; type=&quot;ResetFilter&quot; display=&quot;Reset Filter&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/grid/disablereset.png&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_clientidSortAsc&quot; type=&quot;SortAsc&quot; display=&quot;Sort A to Z&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/grid/asc.png&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_clientidSortDesc&quot; type=&quot;SortDesc&quot; display=&quot;Sort Z to A&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/grid/desc.png&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_clientidIsNotNull&quot; type=&quot;IsNotNull&quot; display=&quot;Contains Data&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_clientidIsNull&quot; type=&quot;IsNull&quot; display=&quot;Contains No Data&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_clientidCustomFilters&quot; type=&quot;CustomFilters&quot; display=&quot;Custom Filter...&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_clientidChoose&quot; type=&quot;Choose&quot; display=&quot;Filter by specific {0}...&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;MenuItem id=&quot;SelectionArea&quot; type=&quot;SelectionArea&quot; display=&quot;SelectionArea&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;MenuItem id=&quot;footer&quot; type=&quot;footer&quot; display=&quot;footer&quot; OkButtonId=&quot;grid-filter-OkbuttonlookupFilterPopupcrmGridnmo_referralnmo_clientid&quot; CancelButtonId=&quot;grid-filter-CancelbuttonlookupFilterPopupcrmGridnmo_referralnmo_clientid&quot; footerType=&quot;0&quot; /&gt;&lt;/Menu&gt;" columnname="nmo_clientid" entityname="nmo_referral" gridid="crmGrid" filtermenutype="lookup"><div class="ms-crm-FilterPopupMenu-Label"><a href="javascript:void(0)" class="ms-crm-FilterPopupMenu-Label" tabindex="0" aria-label="Filter"><div class="ms-crm-Menu-FilterImgWrapper"><img src="./transparent_spacer.gif" alt="" id="mnuDown" role="application" class="ms-crm-Menu-ButtonFilter ms-crm-ImageStrip-dropdown"></div></a></div></li><div style="display:none" id="lookupFilterPopupcrmGridnmo_referralnmo_clientidhiddenlookupfilterfield"><table id="lookup_lookupFilterPopupcrmGridnmo_referralnmo_clientid_lookupTable" class="ms-crm-Lookup" cellpadding="0" cellspacing="0" style="width: 100%; table-layout:fixed;" lookupid="lookup_lookupFilterPopupcrmGridnmo_referralnmo_clientid"><tbody><tr><td valign="top" style="padding-left: 1px;padding-right: 1px;"><div role="list" ime-mode="auto" aria-labelledby="lookup_lookupFilterPopupcrmGridnmo_referralnmo_clientid" class="ms-crm-Lookup" tabindex="0"><ul style="float:left;width:100%;text-align:left;" aria-live="polite" aria-atomic="true" role="alert" title="Selected records:"></ul></div><label class="ms-crm-Hidden-NoBehavior" for="lookup_lookupFilterPopupcrmGridnmo_referralnmo_clientid_ledit"></label><input class="ms-crm-Hidden-NoBehavior" ime-mode="auto" type="text" tabindex="-1" id="lookup_lookupFilterPopupcrmGridnmo_referralnmo_clientid_ledit" maxlength="1000" style="border-right: 0px; height: 100%; padding: 2px 0px 1px; display: none;" disabled=""></td><td style="width: 21px" class="Lookup_RenderButton_td"><img id="lookup_lookupFilterPopupcrmGridnmo_referralnmo_clientid" src="./transparent_spacer.gif" class="ms-crm-ImageStrip-btn_off_lookup ms-crm-Lookup" alt="Click to select a value." isdisplayonly="false" title="Click to select a value." forcesubmit="false" isenableinlinelookupforeditforms="1" lookupstyle="multi" lookuptypes="2" lookuptypeicons="2:/_imgs/ico_16_2.gif?ver=1888157098" lookuptypenames="contact:2:Client"><a href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" onclick="Mscrm.Utilities.click(previousSibling);" tabindex="-1" title="Click to select a value."></a></td></tr></tbody></table></div></ul></td></tr></tbody></table></td></tr></tbody></table></th><td><span "="" id="crmGrid_resize_nmo_clientid" class="ms-crm-List-Row-header-spacer"></span></td><th scope="col" field="nmo_datereceived" fieldname="nmo_datereceived" entityname="nmo_referral" renderertype="datetime" type="DateTime.date" sourcetype="0" class="ms-crm-List-Sortable" displaylabel="Date Received"><table role="presentation" cellpadding="0px" cellspacing="0px" title="Date Received" class="ms-crm-List-Sortable"><tbody><tr><td class="ms-crm-List-Sortable"><a href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" target="_self" class="ms-crm-List-Sortable" onclick="return false;" title="Sort by Date Received" tabindex="0"><nobr class="ms-crm-DataCell"><label class="ms-crm-List-Sortable">Date Received</label><img alt="The data is sorted in ascending order on this column" src="./transparent_spacer.gif" class="ms-crm-List-Sortable ms-crm-Image-Margin ms-crm-ImageStrip-sorting_up"></nobr></a></td><td class="ms-crm-FilterPopupContainerTD"><table cellspacing="0" cellpadding="0" class="ms-crm-FilterPopupContainer" style="display:none"><tbody><tr><td nowrap="" align="left"><ul class="ms-crm-MenuBar-Left" style="margin-top: 0px; margin-left: 0px"><li class="ms-crm-FilterPopupMenu" tabindex="-1" menu="mnudatetimeFilterPopupcrmGridnmo_referralnmo_datereceived" id="datetimeFilterPopupcrmGridnmo_referralnmo_datereceived" isfromfiltermenu="true" relationshipname="" attributeformat="date" isfromrelatedentity="False" attributexml="&lt;attributeinfo&gt;&lt;result value=&quot;nmo_datereceived&quot; datatype=&quot;datetime&quot;&gt;Date Received&lt;/result&gt;&lt;lookupicons&gt;&lt;/lookupicons&gt;&lt;/attributeinfo&gt;" attributetype="datetime" attributename="nmo_datereceived" xml_filter="&lt;Menu title=&quot;_MIcrmGridnmo_referralnmo_datereceivedDateTimeFilterPopupMenu&quot; menuId=&quot;datetimeFilterPopupcrmGridnmo_referralnmo_datereceived&quot;&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedResetFilter&quot; type=&quot;ResetFilter&quot; display=&quot;Reset Filter&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/grid/disablereset.png&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedSortAsc&quot; type=&quot;SortAsc&quot; display=&quot;Sort Oldest to Newest&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/grid/asc.png&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedSortDesc&quot; type=&quot;SortDesc&quot; display=&quot;Sort Newest to Oldest&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/grid/desc.png&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedIsNotNull&quot; type=&quot;IsNotNull&quot; display=&quot;Contains Data&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedIsNull&quot; type=&quot;IsNull&quot; display=&quot;Contains No Data&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedDayFilterSubMenu&quot; type=&quot;submenu&quot; display=&quot;Filter by Day&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot;&gt;&lt;MenuItem id=&quot;grid-filter-yesterdaycrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-yesterdaycrmGridnmo_referralnmo_datereceived&quot; display=&quot;Yesterday&quot; buttonId=&quot;grid-filter-yesterday-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-todaycrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-todaycrmGridnmo_referralnmo_datereceived&quot; display=&quot;Today&quot; buttonId=&quot;grid-filter-today-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-tomorrowcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-tomorrowcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Tomorrow&quot; buttonId=&quot;grid-filter-tomorrow-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;/MenuItem&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedWeekFilterSubMenu&quot; type=&quot;submenu&quot; display=&quot;Filter by Week&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot;&gt;&lt;MenuItem id=&quot;grid-filter-lastweekcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-lastweekcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Last Week&quot; buttonId=&quot;grid-filter-lastweek-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-thisweekcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-thisweekcrmGridnmo_referralnmo_datereceived&quot; display=&quot;This Week&quot; buttonId=&quot;grid-filter-thisweek-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-nextweekcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-nextweekcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Next Week&quot; buttonId=&quot;grid-filter-nextweek-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;/MenuItem&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedMonthFilterSubMenu&quot; type=&quot;submenu&quot; display=&quot;Filter by Month&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot;&gt;&lt;MenuItem id=&quot;grid-filter-lastmonthcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-lastmonthcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Last Month&quot; buttonId=&quot;grid-filter-lastmonth-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-thismonthcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-thismonthcrmGridnmo_referralnmo_datereceived&quot; display=&quot;This Month&quot; buttonId=&quot;grid-filter-thismonth-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-nextmonthcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-nextmonthcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Next Month&quot; buttonId=&quot;grid-filter-nextmonth-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;/MenuItem&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedYearFilterSubMenu&quot; type=&quot;submenu&quot; display=&quot;Filter by Year&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot;&gt;&lt;MenuItem id=&quot;grid-filter-lastyearcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-lastyearcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Last Year&quot; buttonId=&quot;grid-filter-lastyear-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-thisyearcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-thisyearcrmGridnmo_referralnmo_datereceived&quot; display=&quot;This Year&quot; buttonId=&quot;grid-filter-thisyear-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-nextyearcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-nextyearcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Next Year&quot; buttonId=&quot;grid-filter-nextyear-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;/MenuItem&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedFiscalPeriodFilterSubMenu&quot; type=&quot;submenu&quot; display=&quot;Filter by Fiscal Period&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot;&gt;&lt;MenuItem id=&quot;grid-filter-lastfiscalperiodcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-lastfiscalperiodcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Last Fiscal Period&quot; buttonId=&quot;grid-filter-lastfiscalperiod-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-thisfiscalperiodcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-thisfiscalperiodcrmGridnmo_referralnmo_datereceived&quot; display=&quot;This Fiscal Period&quot; buttonId=&quot;grid-filter-thisfiscalperiod-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-nextfiscalperiodcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-nextfiscalperiodcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Next Fiscal Period&quot; buttonId=&quot;grid-filter-nextfiscalperiod-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;/MenuItem&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedFiscalYearFilterSubMenu&quot; type=&quot;submenu&quot; display=&quot;Filter by Fiscal Year&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot;&gt;&lt;MenuItem id=&quot;grid-filter-lastfiscalyearcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-lastfiscalyearcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Last Fiscal Year&quot; buttonId=&quot;grid-filter-lastfiscalyear-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-thisfiscalyearcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-thisfiscalyearcrmGridnmo_referralnmo_datereceived&quot; display=&quot;This Fiscal Year&quot; buttonId=&quot;grid-filter-thisfiscalyear-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;MenuItem id=&quot;grid-filter-nextfiscalyearcrmGridnmo_referralnmo_datereceived&quot; type=&quot;grid-filter-nextfiscalyearcrmGridnmo_referralnmo_datereceived&quot; display=&quot;Next Fiscal Year&quot; buttonId=&quot;grid-filter-nextfiscalyear-checkboxcrmGridnmo_referralnmo_datereceived&quot; ischecked=&quot;false&quot; isdummychecked=&quot;false&quot; /&gt;&lt;/MenuItem&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;_MIcrmGridnmo_referralnmo_datereceivedCustomFilters&quot; type=&quot;CustomFilters&quot; display=&quot;Custom Filter...&quot; isenabled=&quot;True&quot; iconPath=&quot;/_imgs/imagestrips/transparent_spacer.gif&quot; /&gt;&lt;MenuItem type=&quot;space&quot; display=&quot;spacer&quot; /&gt;&lt;MenuItem id=&quot;footer&quot; type=&quot;footer&quot; display=&quot;footer&quot; OkButtonId=&quot;grid-filter-OkbuttondatetimeFilterPopupcrmGridnmo_referralnmo_datereceived&quot; CancelButtonId=&quot;grid-filter-CancelbuttondatetimeFilterPopupcrmGridnmo_referralnmo_datereceived&quot; footerType=&quot;0&quot; /&gt;&lt;/Menu&gt;" columnname="nmo_datereceived" entityname="nmo_referral" gridid="crmGrid" filtermenutype="datetime"><div class="ms-crm-FilterPopupMenu-Label"><a href="javascript:void(0)" class="ms-crm-FilterPopupMenu-Label" tabindex="0" aria-label="Filter"><div class="ms-crm-Menu-FilterImgWrapper"><img src="./transparent_spacer.gif" alt="" id="mnuDown" role="application" class="ms-crm-Menu-ButtonFilter ms-crm-ImageStrip-dropdown"></div></a></div></li></ul></td></tr></tbody></table></td></tr></tbody></table></th><td><span "="" id="crmGrid_resize_nmo_datereceived" class="ms-crm-List-Row-header-spacer"></span></td><td></td><td></td><td><span class="ms-crm-GridButtons" id="gridbuttons" style="width: 60px;"><div id="filterButton" class="ms-crm-List-FilterButton"><a href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" title="Filter" id="filterButtonLink" tabindex="0"><img id="filterButtonImage" src="./transparent_spacer.gif" style="cursor:pointer; margin-top:2px; margin-left:2px; margin-right:2px" alt="Filter" title="Filter" class="ms-crm-ImageStrip-grid_visualrefresh_filter"></a></div><div id="refreshButton" class="ms-crm-List-RefreshButton"><a title="Refresh list" href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" id="refreshButtonLink" tabindex="0"><span><img id="grid_visualrefresh_refresh" src="./transparent_spacer.gif" class="ms-crm-ImageStrip-grid_visualrefresh_refresh" style="cursor:pointer" alt="Refresh list" title="Refresh list"></span></a></div></span></td></tr></tbody></table></div></div><div class="ms-crm-grid-databodycontainer" style="top:40px;bottom:40px;vertical-align:top"><div class="ms-crm-IE7-Height-Fix-Dummy-Container"><div id="crmGrid_divDataBody" class="ms-crm-List-DataBody"><div id="crmGrid_divDataArea" expandable="0" class="ms-crm-List-DataArea"><div>
	<table class="ms-crm-List-Data" cellspacing="0" cellpadding="1" rules="rows" oname="10041" allrecordscounted="1" totalrecordcount="3" primaryfieldname="nmo_name" numrecords="3" aria-label="This list contains 3 Inbound Referral records." tabindex="0" morerecords="0" role="grid" summary="This list contains 3 Inbound Referral records." title="This list contains 3 Inbound Referral records." border="1" id="gridBodyTable" style="border-style:None;border-collapse:collapse;border: none;">
		<colgroup><col width="40px" class="ms-crm-List-CheckBoxColumn"><col width="302" name="nmo_name" class="ms-crm-List-DataColumn ms-crm-List-SortedColumn"><col width="152" name="nmo_clientid" class="ms-crm-List-DataColumn"><col width="102" name="nmo_datereceived" class="ms-crm-List-DataColumn"><col width="60"><col></colgroup><thead><tr class="ms-crm-Hidden-List"><th scope="col" class="ms-crm-Hidden-List"></th><th scope="col" class="ms-crm-Hidden-List">Name</th><th scope="col" class="ms-crm-Hidden-List">Client</th><th scope="col" class="ms-crm-Hidden-List">Date Received</th></tr></thead><tbody><tr class="ms-crm-List-SelectedRow" oid="{26FA0732-4748-4AEC-88D1-2429F6ABBBD3}" otype="10041" otypename="nmo_referral" onmouseover="if(typeof(Mscrm) == &#39;undefined&#39; || typeof(Mscrm.GridControl) == &#39;undefined&#39;) { return; } Mscrm.GridControl.mouseOver(this);" onmouseout="if(typeof(Mscrm) == &#39;undefined&#39; || typeof(Mscrm.GridControl) == &#39;undefined&#39;) { return; } Mscrm.GridControl.mouseOut(this);" selected="true">
			<td class="ms-crm-List-NonDataCell" aria-checked="false" tabindex="0" aria-label="checkbox checked Hulk, The : Mental Health"><input type="checkbox" class="ms-crm-RowCheckBox" id="checkBox_{26FA0732-4748-4AEC-88D1-2429F6ABBBD3}" title="Hulk, The : Mental Health" style=" " role="presentation" tabindex="-1"><span id="gridBodyTable_lblTooltip_{26FA0732-4748-4AEC-88D1-2429F6ABBBD3}_0" role="presentation" style="height:1px;width:1px;position:absolute;overflow:hidden;top:-10px;"></span><img id="gridBodyTable_checkBox_Image_{26FA0732-4748-4AEC-88D1-2429F6ABBBD3}_0" class="ms-crm-grid-checkbox-image ms-crm-ImageStrip-checkbox_visualrefresh" tabindex="-1" alt="Checkbox" title="Checkbox" role="presentation" aria-hidden="true" src="./transparent_spacer.gif" style="visibility: visible;"></td><td class="ms-crm-List-DataCell inner-grid-cellPadding keyboardFocusClass"><nobr class="gridcellpadding" title="Hulk,The:MentalHealth"><a href="javascript:;" id="gridBodyTable_primaryField_{26FA0732-4748-4AEC-88D1-2429F6ABBBD3}_0" target="_self" title="Hulk, The : Mental Health" class="ms-crm-List-Link" tabindex="0">Hulk,&nbsp;The&nbsp;:&nbsp;Mental&nbsp;Health</a></nobr></td><td class="ms-crm-List-DataCell inner-grid-cellPadding" rawvalue="Existed" rawlookupitemid="{807B5231-E8EF-4899-8850-CF21F4B900C4}" rawlookupitemname="The Hulk" rawlookupitemtype="2" gridcellrawtype="2"><nobr class="gridcellpadding"><a href="javascript:;" id="gridBodyTable_lookup_{26FA0732-4748-4AEC-88D1-2429F6ABBBD3}_0" target="_self" class="ms-crm-List-Link" style="cursor:pointer;" title="Open The Hulk" onclick="handleLookupAnchorClick(new Sys.UI.DomEvent(event))" tabindex="0"><li style="display:inline;white-space:nowrap"><span contenteditable="false" title="The Hulk" class="gridLui" onclick="handleGridClick(new Sys.UI.DomEvent(event))" isprocessenabled="True" oid="{807B5231-E8EF-4899-8850-CF21F4B900C4}" otype="2"><span wrapper="true" tabindex="0"><span class="ms-crm-Hidden-NoBehavior" id="lblread"></span><span class="ms-crm-LookupItem-Name" wrapper="true">The Hulk</span></span></span></li></a></nobr></td><td class="ms-crm-List-DataCell inner-grid-cellPadding ms-crm-NumbersAndDates"><nobr class="gridcellpadding"><span class="gridCellSpan" tabindex="0" aria-label="11/03/2019">11/03/2019</span></nobr></td><td class="ms-crm-List-NonDataCell" role="presentation"><nobr class="gridcellpadding"></nobr></td><td class="ms-crm-List-DataCell" role="presentation"><nobr class="gridcellpadding"></nobr></td>
		</tr><tr class="ms-crm-List-Row" oid="{7EA8E3F0-D93E-42A9-AD07-E138975B03BC}" otype="10041" otypename="nmo_referral" onmouseover="if(typeof(Mscrm) == &#39;undefined&#39; || typeof(Mscrm.GridControl) == &#39;undefined&#39;) { return; } Mscrm.GridControl.mouseOver(this);" onmouseout="if(typeof(Mscrm) == &#39;undefined&#39; || typeof(Mscrm.GridControl) == &#39;undefined&#39;) { return; } Mscrm.GridControl.mouseOut(this);">
			<td class="ms-crm-List-NonDataCell" aria-checked="false" tabindex="0" aria-label="checkbox unchecked Johnson, Don : Mental Health"><input type="checkbox" class="ms-crm-RowCheckBox" id="checkBox_{7EA8E3F0-D93E-42A9-AD07-E138975B03BC}" title="Johnson, Don : Mental Health" style=" " role="presentation" tabindex="-1"><span id="gridBodyTable_lblTooltip_{7EA8E3F0-D93E-42A9-AD07-E138975B03BC}_1" role="presentation" style="height:1px;width:1px;position:absolute;overflow:hidden;top:-10px;"></span><img id="gridBodyTable_checkBox_Image_{7EA8E3F0-D93E-42A9-AD07-E138975B03BC}_1" class="ms-crm-grid-checkbox-image ms-crm-ImageStrip-checkbox_visualrefresh_light" tabindex="-1" alt="Checkbox" title="Checkbox" role="presentation" aria-hidden="true" src="./transparent_spacer.gif" style="visibility: hidden;"></td><td class="ms-crm-List-DataCell inner-grid-cellPadding"><nobr class="gridcellpadding" title="Johnson,Don:MentalHealth"><a href="javascript:;" id="gridBodyTable_primaryField_{7EA8E3F0-D93E-42A9-AD07-E138975B03BC}_1" target="_self" title="Johnson, Don : Mental Health" class="ms-crm-List-Link" tabindex="0">Johnson,&nbsp;Don&nbsp;:&nbsp;Mental&nbsp;Health</a></nobr></td><td class="ms-crm-List-DataCell inner-grid-cellPadding" rawvalue="Existed" rawlookupitemid="{D0AA4C3F-74F7-4D72-8431-93C85BAADE24}" rawlookupitemname="Don Johnson" rawlookupitemtype="2" gridcellrawtype="2"><nobr class="gridcellpadding"><a href="javascript:;" id="gridBodyTable_lookup_{7EA8E3F0-D93E-42A9-AD07-E138975B03BC}_1" target="_self" class="ms-crm-List-Link" style="cursor:pointer;" title="Open Don Johnson" onclick="handleLookupAnchorClick(new Sys.UI.DomEvent(event))" tabindex="0"><li style="display:inline;white-space:nowrap"><span contenteditable="false" title="Don Johnson" class="gridLui" onclick="handleGridClick(new Sys.UI.DomEvent(event))" isprocessenabled="True" oid="{D0AA4C3F-74F7-4D72-8431-93C85BAADE24}" otype="2"><span wrapper="true" tabindex="0"><span class="ms-crm-Hidden-NoBehavior" id="lblread"></span><span class="ms-crm-LookupItem-Name" wrapper="true">Don Johnson</span></span></span></li></a></nobr></td><td class="ms-crm-List-DataCell inner-grid-cellPadding ms-crm-NumbersAndDates"><nobr class="gridcellpadding"><span class="gridCellSpan" tabindex="0" aria-label="11/03/2019">11/03/2019</span></nobr></td><td class="ms-crm-List-NonDataCell" role="presentation"><nobr class="gridcellpadding"></nobr></td><td class="ms-crm-List-DataCell" role="presentation"><nobr class="gridcellpadding"></nobr></td>
		</tr><tr class="ms-crm-List-Row" oid="{1B274BC2-8078-40A1-B18B-FBB195D7A52C}" otype="10041" otypename="nmo_referral" onmouseover="if(typeof(Mscrm) == &#39;undefined&#39; || typeof(Mscrm.GridControl) == &#39;undefined&#39;) { return; } Mscrm.GridControl.mouseOver(this);" onmouseout="if(typeof(Mscrm) == &#39;undefined&#39; || typeof(Mscrm.GridControl) == &#39;undefined&#39;) { return; } Mscrm.GridControl.mouseOut(this);">
			<td class="ms-crm-List-NonDataCell" aria-checked="false" tabindex="0" aria-label="checkbox unchecked Reagan, Ronold : Mental Health"><input type="checkbox" class="ms-crm-RowCheckBox" id="checkBox_{1B274BC2-8078-40A1-B18B-FBB195D7A52C}" title="Reagan, Ronold : Mental Health" style=" " role="presentation" tabindex="-1"><span id="gridBodyTable_lblTooltip_{1B274BC2-8078-40A1-B18B-FBB195D7A52C}_2" role="presentation" style="height:1px;width:1px;position:absolute;overflow:hidden;top:-10px;"></span><img id="gridBodyTable_checkBox_Image_{1B274BC2-8078-40A1-B18B-FBB195D7A52C}_2" class="ms-crm-grid-checkbox-image ms-crm-ImageStrip-checkbox_visualrefresh_light" tabindex="-1" alt="Checkbox" title="Checkbox" role="presentation" aria-hidden="true" src="./transparent_spacer.gif" style="visibility: hidden;"></td><td class="ms-crm-List-DataCell inner-grid-cellPadding"><nobr class="gridcellpadding" title="Reagan,Ronold:MentalHealth"><a href="javascript:;" id="gridBodyTable_primaryField_{1B274BC2-8078-40A1-B18B-FBB195D7A52C}_2" target="_self" title="Reagan, Ronold : Mental Health" class="ms-crm-List-Link" tabindex="0">Reagan,&nbsp;Ronold&nbsp;:&nbsp;Mental&nbsp;Health</a></nobr></td><td class="ms-crm-List-DataCell inner-grid-cellPadding" rawvalue="Existed" rawlookupitemid="{E7905E00-BCE0-4BFB-8929-F51D0BE34EB7}" rawlookupitemname="Ronold Reagan" rawlookupitemtype="2" gridcellrawtype="2"><nobr class="gridcellpadding"><a href="javascript:;" id="gridBodyTable_lookup_{1B274BC2-8078-40A1-B18B-FBB195D7A52C}_2" target="_self" class="ms-crm-List-Link" style="cursor:pointer;" title="Open Ronold Reagan" onclick="handleLookupAnchorClick(new Sys.UI.DomEvent(event))" tabindex="0"><li style="display:inline;white-space:nowrap"><span contenteditable="false" title="Ronold Reagan" class="gridLui" onclick="handleGridClick(new Sys.UI.DomEvent(event))" isprocessenabled="True" oid="{E7905E00-BCE0-4BFB-8929-F51D0BE34EB7}" otype="2"><span wrapper="true" tabindex="0"><span class="ms-crm-Hidden-NoBehavior" id="lblread"></span><span class="ms-crm-LookupItem-Name" wrapper="true">Ronold Reagan</span></span></span></li></a></nobr></td><td class="ms-crm-List-DataCell inner-grid-cellPadding ms-crm-NumbersAndDates"><nobr class="gridcellpadding"><span class="gridCellSpan" tabindex="0" aria-label="11/03/2019">11/03/2019</span></nobr></td><td class="ms-crm-List-NonDataCell" role="presentation"><nobr class="gridcellpadding"></nobr></td><td class="ms-crm-List-DataCell" role="presentation"><nobr class="gridcellpadding"></nobr></td>
		</tr></tbody>
	</table>
</div><div id="divMenu" menuxml="&amp;lt;Menu&amp;gt;&amp;lt;MenuItem title=&amp;quot;Open&amp;quot; typeId=&amp;quot;0&amp;quot; disableonemptygrid=&amp;quot;yes&amp;quot;&amp;gt;&amp;lt;/MenuItem&amp;gt;&amp;lt;MenuItem title=&amp;quot;Open in a New Window&amp;quot; typeId=&amp;quot;1&amp;quot; disableonemptygrid=&amp;quot;yes&amp;quot;&amp;gt;&amp;lt;/MenuItem&amp;gt;&amp;lt;MenuItem title=&amp;quot;Copy a Link&amp;quot; typeId=&amp;quot;2&amp;quot; disableonemptygrid=&amp;quot;yes&amp;quot;&amp;gt;&amp;lt;/MenuItem&amp;gt;&amp;lt;MenuItem title=&amp;quot;Email a Link...&amp;quot; typeId=&amp;quot;3&amp;quot; disableonemptygrid=&amp;quot;yes&amp;quot;&amp;gt;&amp;lt;/MenuItem&amp;gt;&amp;lt;MenuItem title=&amp;quot;Print...&amp;quot; typeId=&amp;quot;6&amp;quot; disableonemptygrid=&amp;quot;yes&amp;quot;&amp;gt;&amp;lt;/MenuItem&amp;gt;&amp;lt;MenuItem title=&amp;quot;separator&amp;quot; isseparator=&amp;quot;yes&amp;quot;&amp;gt;&amp;lt;/MenuItem&amp;gt;&amp;lt;MenuItem title=&amp;quot;Refresh List&amp;quot; typeId=&amp;quot;7&amp;quot; disableonemptygrid=&amp;quot;no&amp;quot;&amp;gt;&amp;lt;/MenuItem&amp;gt;&amp;lt;/Menu&amp;gt;" class="ms-crm-Standard-Popup" style="display:none;" onselectstart="return false;"></div></div></div></div></div></div></div><div style="display:none;" id="divGridProps"><div id="sortColumns" value="nmo_name:1"></div><div id="pageNum" value="1"></div><div id="recsPerPage" value="50"></div><div id="dataProvider" value="Microsoft.Crm.Application.Platform.Grid.GridDataProviderQueryBuilder"></div><div id="uiProvider" value="Microsoft.Crm.Application.Controls.GridUIProvider"></div><div id="cols" value=""></div><div id="max" value="-1"></div><div id="refreshAsync" value="False"></div><div id="pagingCookie" value=""></div><div id="enableMultiSort" value="true"></div><div id="enablePagingWhenOnePage" value="true"></div></div><div style="display:none;" id="divGridParams"><div id="autorefresh" value="1"></div><div id="isGridHidden" value="false"></div><div id="isGridFilteringEnabled" value="1"></div><div id="viewid" value="{4EE94837-6992-4B74-95AE-A22250E92904}"></div><div id="viewtype" value="1039"></div><div id="RecordsPerPage" value="50"></div><div id="viewTitle" value="Active Referrals"></div><div id="layoutXml" value="&lt;grid name=&quot;resultset&quot; jump=&quot;nmo_name&quot; select=&quot;1&quot; icon=&quot;1&quot; preview=&quot;1&quot; object=&quot;10041&quot;&gt;&lt;row name=&quot;result&quot; id=&quot;nmo_referralid&quot;&gt;&lt;cell name=&quot;nmo_name&quot; width=&quot;300&quot;/&gt;&lt;cell name=&quot;nmo_clientid&quot; width=&quot;150&quot; imageproviderfunctionname=&quot;&quot; imageproviderwebresource=&quot;$webresource:&quot;/&gt;&lt;cell name=&quot;nmo_datereceived&quot; width=&quot;100&quot;/&gt;&lt;/row&gt;&lt;/grid&gt;"></div><div id="otc" value="10041"></div><div id="otn" value="nmo_referral"></div><div id="entitydisplayname" value="Inbound Referral"></div><div id="titleformat" value="{0} {1}"></div><div id="entitypluraldisplayname" value="Inbound Referrals"></div><div id="isWorkflowSupported" value="true"></div><div id="fetchXmlForFilters" value="&lt;fetch version=&quot;1.0&quot; mapping=&quot;logical&quot;&gt;&lt;entity name=&quot;nmo_referral&quot;&gt;&lt;attribute name=&quot;nmo_name&quot; /&gt;&lt;order attribute=&quot;nmo_name&quot; descending=&quot;false&quot; /&gt;&lt;filter type=&quot;and&quot;&gt;&lt;condition attribute=&quot;statecode&quot; operator=&quot;eq&quot; value=&quot;0&quot; /&gt;&lt;/filter&gt;&lt;attribute name=&quot;nmo_datereceived&quot; /&gt;&lt;attribute name=&quot;nmo_clientid&quot; /&gt;&lt;attribute name=&quot;nmo_referralid&quot; /&gt;&lt;/entity&gt;&lt;/fetch&gt;" requiredmask="1"></div><div id="isFetchXmlNotFinal" value="False" requiredmask="1"></div><div id="effectiveFetchXml" value="&lt;fetch distinct=&quot;false&quot; useraworderby=&quot;false&quot; no-lock=&quot;false&quot; mapping=&quot;logical&quot; page=&quot;1&quot; count=&quot;50&quot; returntotalrecordcount=&quot;true&quot;&gt;&lt;entity name=&quot;nmo_referral&quot;&gt;&lt;attribute name=&quot;nmo_name&quot; /&gt;&lt;attribute name=&quot;nmo_datereceived&quot; /&gt;&lt;attribute name=&quot;nmo_clientid&quot; /&gt;&lt;attribute name=&quot;nmo_referralid&quot; /&gt;&lt;attribute name=&quot;nmo_name&quot; /&gt;&lt;attribute name=&quot;nmo_clientid&quot; /&gt;&lt;attribute name=&quot;nmo_datereceived&quot; /&gt;&lt;filter type=&quot;and&quot;&gt;&lt;condition attribute=&quot;statecode&quot; operator=&quot;eq&quot; value=&quot;0&quot; /&gt;&lt;/filter&gt;&lt;order attribute=&quot;nmo_name&quot; descending=&quot;false&quot; /&gt;&lt;/entity&gt;&lt;/fetch&gt;" requiredmask="1"></div><div id="LayoutStyle" value="GridList"></div><div id="enableFilters" value="1"></div></div></div></div><div class="ms-crm-List-StatusBar" id="crmGrid_StatusBar" style="height:40px;"><div><table cellspacing="0" cellpadding="0" id="gridStatusBar" style="white-space: nowrap;" class="ms-crm-List-StatusBar ms-crm-List-StatusBar-Height"><tbody><tr><td class="ms-crm-List-StatusBar-Label ms-crm-List-StatusBar-Label-Padding" width="auto" style="display: table-cell;white-space: nowrap;" id="crmGrid_RecordSelectInfo"><span id="crmGrid_FirstItem">1</span> - <span id="crmGrid_LastItem">3</span><span id="crmGrid_TotalCountInfo" style="display: inline;">&nbsp;of <span id="crmGrid_ItemsTotal">3</span></span><span id="crmGrid_ItemsSelectedInfo">&nbsp;(<span id="crmGrid_ItemsSelected">1</span> selected)</span><span id="crmGrid_RecordSelectEndMarker" style="VISIBILITY: hidden;">M</span></td><td width="2px" style="padding-top:9px;padding-bottom:9px;"><div style="opacity:0.5;height: 18px;border:1px solid #4A4A4A;"></div>  </td><td nowrap="" class="ms-crm-List-StatusBar-Label ms-crm-List-StatusBar-Label-Padding-For-Alphabet" width="auto" style="display: table-cell;white-space: nowrap;" id="crmGrid_Footer"><div class=" style=" position:absolute;="" bottom:8px;="" width:80%;"=""><table id="crmGrid_JumpBar" gridid="crmGrid" class="ms-crm-List-Index ms-crm-List-Index-Padding" cellpadding="2" cellspacing="0" style="top: auto; height: 24px; background-color: rgb(243, 243, 243); border: none; visibility: visible;"><tbody><tr title="View records that start with this letter"><td style="width:5%;" title="View all records" tabindex="0" class="ms-crm-List-DefaultIndex ms-crm-List-SelectedIndex" nowrap="">All</td><td tabindex="0" filter="0|1|2|3|4|5|6|7|8|9" aria-label="0|1|2|3|4|5|6|7|8|9" title="View records that start with numbers from 0 to 9">#</td><td tabindex="0" filter="a" aria-label="a">A</td><td tabindex="0" filter="b" aria-label="b">B</td><td tabindex="0" filter="c" aria-label="c">C</td><td tabindex="0" filter="d" aria-label="d">D</td><td tabindex="0" filter="e" aria-label="e">E</td><td tabindex="0" filter="f" aria-label="f">F</td><td tabindex="0" filter="g" aria-label="g">G</td><td tabindex="0" filter="h" aria-label="h">H</td><td tabindex="0" filter="i" aria-label="i">I</td><td tabindex="0" filter="j" aria-label="j">J</td><td tabindex="0" filter="k" aria-label="k">K</td><td tabindex="0" filter="l" aria-label="l">L</td><td tabindex="0" filter="m" aria-label="m">M</td><td tabindex="0" filter="n" aria-label="n">N</td><td tabindex="0" filter="o" aria-label="o">O</td><td tabindex="0" filter="p" aria-label="p">P</td><td tabindex="0" filter="q" aria-label="q">Q</td><td tabindex="0" filter="r" aria-label="r">R</td><td tabindex="0" filter="s" aria-label="s">S</td><td tabindex="0" filter="t" aria-label="t">T</td><td tabindex="0" filter="u" aria-label="u">U</td><td tabindex="0" filter="v" aria-label="v">V</td><td tabindex="0" filter="w" aria-label="w">W</td><td tabindex="0" filter="x" aria-label="x">X</td><td tabindex="0" filter="y" aria-label="y">Y</td><td tabindex="0" filter="z" aria-label="z">Z</td></tr></tbody></table></div></td><td width="2px" style="padding-top:9px;padding-bottom:9px;"><div style="opacity:0.5;height: 18px;border:1px solid #4A4A4A;"></div>  </td><td nowrap="" width="auto" style="display: table-cell;white-space: nowrap;" id="crmGrid_PageInfo" class="ms-crm-List-Paging ms-crm-List-StatusBar-Label-Padding"><a title="Load First Page" onclick="return false;" href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" target="_self" disabled="disabled" class="toolbarbutton" id="fastRewind" style="padding-bottom: 2px; cursor: default;" tabindex="-1"><img disabled="disabled" temptooltip="Load First Page" alt="" src="./transparent_spacer.gif" class="ms-crm-ImageStrip-page_visualrefresh_FL0" id="page_FL0" align="absmiddle" title=""></a><a title="Load Previous Page" onclick="return false;" href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" target="_self" disabled="disabled" class="toolbarbutton" id="_prevPageImg" style="padding-bottom: 2px; cursor: default;" tabindex="-1"><img disabled="disabled" temptooltip="Load Previous Page" alt="" src="./transparent_spacer.gif" class="ms-crm-ImageStrip-page_visualrefresh_L0 Pagination-Previous-Icon-Padding" id="page_L0" hspace="6" align="absmiddle" "="" title=""></a>Page <span id="_PageNum">1</span><a title="Load Next Page" onclick="return false;" href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" target="_self" disabled="disabled" class="toolbarbutton" id="_nextPageImg" style="padding-bottom: 2px; cursor: default;" tabindex="-1"><img disabled="disabled" temptooltip="Load Next Page" alt="" src="./transparent_spacer.gif" class="ms-crm-ImageStrip-page_visualrefresh_R0 Pagination-Next-Icon-Padding" id="page_R0" hspace="6" align="absmiddle" "="" title=""></a>&nbsp;</td></tr></tbody></table></div></div><div style="display:none"><iframe id="exportFrame" name="exportFrame" style="display:none" src="./blank.html"></iframe></div></div></div></div></div><div id="crmGrid_splitTD" class="ms-crm-CC-splitter-All-0-LR ms-crm-CC-splitter" panesize="0" requiredelements="All" layout="0" gridid="crmGrid" onmousedown="window.Mscrm &amp;&amp; Mscrm.CompositeControl &amp;&amp; Mscrm.CompositeControl.mouseAction(new Sys.UI.DomEvent(event),&#39;1&#39;, &#39;crmGrid_visualizationCompositeControl&#39; );" ondblclick="$find(&#39;crmGrid_splitTD&#39;).togglePaneSize();"><div class="ms-crm-IE7-Height-Fix-Dummy-Container"> <table cellspacing="0" cellpadding="0" style="height:100%;cursor:col-resize;"><tbody><tr><td> <a aria-hidden="true" tabindex="-1" style="cursor:col-resize;display:inline-block;" onkeypress="$find(&#39;crmGrid_splitTD&#39;).togglePane_keypress(new Sys.UI.DomEvent(event));" href="javascript:void(0);"><img class="ms-crm-ImageStrip-verticalGripper ms-crm-ImageStrip-verticalGripper" style="cursor:col-resize" id="crmGrid_splitterImage" alt="" src="./transparent_spacer.gif"></a></td></tr></tbody></table></div></div><div id="crmGrid_paneTD" class="ms-crm-CC-pane-All-0-LR"><div class="ms-crm-IE7-Height-Fix-Dummy-Container"><div id="crmGrid_pane" style="height:100%;"><span id="crmGrid_paneControl" class="paneControl" style="height:100%;display:block;"><div id="paneContent" border="0" class="ms-crm-CompositeControl ms-crm-CompCntrlBrdr"><div id="headerRowTR" style="display:none"><div id="vizCollectionTD" style="width:100%;"><table id="vizTable" table-layout="fixed" cellpadding="0" cellspacing="0" class="ms-crm-visualization-list-row"><tbody><tr><td id="vizList" width="50%" style="padding:0px"><table id="visualizationList" table-layout="fixed" style="table-layout:fixed; height:100%" cellspacing="0" cellpadding="0" width="100%"><tbody><tr><td style="overflow:hidden;"><div style="overflow:hidden;"><a cssclass="ms-crm-Viz-Name" class="ms-crm-Viz-Name" id="visualizationListLink" width="100%" onclick="return false;" title="Select a chart" href="javascript:void(0);"><span id="visualizationListContainer" class="ms-crm-Viz-Name ms-crm-TextAutoEllipsis" menuxml="&lt;Menu&gt;&lt;/Menu&gt;"></span><span class="ms-crm-View-icon"><img class="ms-crm-View-icon ms-crm-ImageStrip-Dropdown_Arrow" src="./transparent_spacer.gif" alt="Select a chart"></span></a></div></td></tr></tbody></table></td><td id="chartPaneCommandBar" width="*" style="text-align:right;visibility: visible;"></td><td class="ms-crm-PaneChevron" width="27px"><span><span id="runtimeChevron"><a onclick="$find(&#39;crmGrid_paneControl&#39;).hideVisualizationPane();" href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" title="Click here for Collapsed View"><img id="runtimeChevron_image" imgbase="/_imgs/navRight" src="./transparent_spacer.gif" class="Heading ms-crm-ImageStrip-navRight" alt="Click here for Collapsed View"></a></span></span></td></tr></tbody></table></div></div><div class="ms-crm-absolutePosition" id="contentContainer" style="top:43px;bottom:45px;"><div class="ms-crm-IE7-Height-Fix-Dummy-Container"><div style="height:100%"><div id="vizContent" align="center" class="ms-crm-visualizationpane-contentarea"><span id="loadingSpan" style="display:none;height:100%;"><table id="loadingContent" style="text-align:center;height:100%"><tbody><tr><td><div><img src="./progress.gif" alt="Loading..."></div><div><label id="loadingLabel">Loading...</label></div></td></tr></tbody></table></span><span id="emptyVizSpan" class="ms-crm-emptyvizpane"><table style="text-align:center;height:100%"><tbody><tr><td><label id="emptymessage" class="ms-crm-Info-Label"></label><br><a id="openDesignerLink" onclick="$find(&#39;crmGrid_paneControl&#39;).switchMode(1);" href="https://tehi.crm6.dynamics.com/_root/homepage.aspx?etc=10041&amp;pagemode=iframe&amp;sitemappath=SFA%7cInbox%7cnav_referrals#" class="ms-crm-VisualizationPaneDesigner-NewChartLink">Click here to create a new chart</a></td></tr></tbody></table></span><div id="contentSpan" style="display: none; height: 100%" class="ms-crm-iframe-scroller"></div></div></div></div></div><div class="ms-crm-absolutePosition" style="top:auto;"><div><div class="ms-crm-PaneControl-LeftRight-footer"><div style="width:100%;height:100%;display:none;white-space:nowrap" id="notificationRow"><span style="width:20px;display:inline-block;margin-top:5px;margin-left:5px"><img id="notificationImg" src="./transparent_spacer.gif" class="ms-crm-Lookup-Item ms-crm-ImageStrip-notif_icn_info16" alt="" style="vertical-align:middle"></span><span style="display:inline-block;width:90%"><label id="visualizationPaneMessageLabel" class="ms-crm-drillDown-info" style="display:inline-block;vertical-align:middle;padding-left:0px;"></label></span></div></div></div></div></div><div id="divPaneParams" style="display:none;"><div id="vizPaneMode" value="0"></div><div id="compositeLayout" value="0"></div><div id="paneSize" value="0"></div><div id="CurrentVisualizationId" value=""></div><div id="CurrentVisualizationType" value="0"></div><div id="vizPaneViewId" value="&amp;#123;4EE94837-6992-4B74-95AE-A22250E92904&amp;#125;"></div><div id="vizPaneViewType" value="1039"></div><div id="vizPanePrimaryEntityName" value="nmo_referral"></div><div id="vizPaneOtc" value="10041"></div><div id="gridid" value="crmGrid"></div><div id="entityDisplayName" value="Inbound&amp;#32;Referral"></div><div id="ShowChartPicker" value="true"></div></div></span></div></div></div><div id="crmGrid_crmVisualizationPaneStrip" class="ms-crm-CC-PaneSS-All-0-LR" style="width:37px;"><div id="crmGrid_paneStripDiv" onmouseover="window.Mscrm &amp;&amp; Mscrm.CompositeControl &amp;&amp; Mscrm.CompositeControl.glowPaneStrip(true, &#39;crmGrid_visualizationCompositeControl&#39;);" onmouseout="window.Mscrm &amp;&amp; Mscrm.CompositeControl &amp;&amp; Mscrm.CompositeControl.glowPaneStrip(false, &#39;crmGrid_visualizationCompositeControl&#39;);" class="ms-crm-control-SideStrip"><a href="javascript:;" grid="false" onclick="window.Mscrm &amp;&amp; Mscrm.CompositeControlResizeControl &amp;&amp; Mscrm.CompositeControlResizeControl.clickSideStrip(this.getAttribute(&#39;grid&#39;), &#39;crmGrid_splitTD&#39;);" class="ms-crm-Anchor-SideStrip" title="Click here to view the chart."><table height="100%" width="37px" cellspacing="0" cellpadding="0" class="ms-crm-control-strip-table  visualizationImageTable">
	<tbody><tr height="20px">
		<td align="center"><span><img src="./transparent_spacer.gif" imgbase="/_imgs/navLeft_VisualRefresh.png" class="ms-crm-ImageStrip-navLeft_VisualRefresh" alt="Click here for Normal View"></span></td>
	</tr>
	<tr>
		<td align="center" valign="top" height="50px" style="padding-top:12px;padding-bottom:20px;"><div class="ms-crm-stripRotateClockwise"><label id="crmGrid_VisualizationPaneStripLabelMessage" class="ms-crm-stripLabelLeftRight ms-crm-stripChartLabelLeftRight ms-crm-StripLabel-Rotation" style="opacity:1;left:0;width:55px;text-overflow:ellipsis;line-height:27px;height:25px;color:#2c3e50;letter-spacing:0px;overflow:hidden;">Charts</label></div></td>
	</tr>
	<tr>
		<td align="center" width="37px" valign="top"><span><img src="./transparent_spacer.gif" imgbase="/_imgs/visualization/chartsidelite_VisualRefresh.png" class="ms-crm-ImageStrip-chartsidelite_VisualRefresh" alt=""></span></td>
	</tr>
</tbody></table>
</a></div></div></div><div id="compositeControlParams" style="display:none;"><div id="isOutlookControlProxy" value="False"></div><div id="elementsMask" value="All"></div><div id="gridid" value="crmGrid"></div></div></div></div></div></div></div><script type="text/javascript">
var LOCID_IPADWINCLOSED = 'An error has occurred. Please return to the home page and try again.';
var LOCID_PUBLISH_MESSAGE_SINGLE = 'Publishing mobile offline profile and profile items\u2026';
var LOCID_PUBLISH_MESSAGE_MULTIPLE = 'Publishing selected mobile offline profiles and profile items\u2026';
var LOCID_MESSAGE_USER_MULTI_PROFILE = 'This user already exists in another mobile offline profile. If you add the user to this profile, the user will be removed from the other profile. Are you sure you want to continue\x3f';
var LOCID_TITLE_USER_MULTI_PROFILE = 'User already exists in another profile';
var LOCID_CLONE_MESSAGE = 'Create a new mobile offline profile from this mobile offline profile.';
var LOCID_CLONE_TITLE = 'Clone mobile offline profile';
var LOCID_ANALYZE_MESSAGE = 'Preparing profile report for download and analysis...';
var LOCID_BRANDNAME = 'Microsoft Dynamics 365';
var LOCID_ENTUTL_CONFIRMDEL = 'Deleting an entity cannot be reversed. All records for the entity, including notes related to the entity, will be deleted. If post plug-ins are set on record deletion, they will not run. To delete this entity, click OK. To cancel the deletion, click Cancel.';
var LOCID_VERBOSELOG_ERROR = 'An error occurred while toggling verbose logging for selected mailboxes.';
var LOCID_VERBOSELOG_SUCCESS = 'Verbose logging toggled for selected mailboxes.';
var LOCID_VERBOSELOG_MAXMAILBOX = 'Verbose logging  cannot be enabled for more than \x7b0\x7d mailboxes.';
var LOCID_MAILBOXSTATISTICS_ON = 'Mailbox statistics table is now collecting information';
var LOCID_MAILBOXSTATISTICS_OFF = 'Mailbox statistics table stopped collecting information';
var LOCID_UNAPPROVE_MAILBOX_VIEW = 'Email won\x27t be processed for selected mailbox until the email address of the mailbox is approved by an Office 365 administrator';
var LOCID_SAVE_GLOBAL_QUICKCREATE = 'Save';
var LOCID_CANCEL_GLOBAL_QUICKCREATE = 'Cancel';
var LOCID_CLOSE_GLOBAL_QUICKCREATE = 'Close';
var LOCID_TITLE_GLOBAL_QUICKCREATE = 'Quick Create\x3a';
var LOCID_AF_EQUALSCURRENTUSER = 'Equals Current User';
var LOCID_AF_DOESNOTEQUALCURRENTUSER = 'Does Not Equal Current User';
var LOCID_AF_EQUALSCURRENTUSERTEAMS = 'Equals Current User\x27s Teams';
var LOCID_AF_EQUALSCURRUSERORTEAMS = 'Equals Current User Or User\x27s Teams';
var LOCID_AF_EQUALSUSERORTREE = 'Equals Current User Or His Reporting Hierarchy';
var LOCID_AF_EQUALSUSERORTREETEAMS = 'Equals Current User And His Teams Or His Reporting Hierarchy And Their Teams';
var LOCID_INLINELOOKUP_RESULT = 'result';
var LOCID_INLINELOOKUP_RESULTS = 'results';
var LOCID_INLINELOOKUP_RFORMAT = '\x7b0\x7d \x7b1\x7d';
var LOCID_INLINELOOKUP_NEW = 'New';
var LOCID_INLINELOOKUP_NEW_RECORD = 'Create a new \x7b0\x7d.';
var LOCID_INLINELOOKUP_NO_RECORDS = 'No records found. Create a new record.';
var LOCID_INLINELOOKUP_SHOWMORE = 'Look Up More Records';
var LOCID_INLINELOOKUP_MRU_HEADER = 'RECENT';
var LOCID_INLINELOOKUP_MRUSEARCHMORE = 'Search For More Records';
var LOCID_INLINELOOKUP_MOREMATCHES = 'We found more than one match.';
var LOCID_INLINELOOKUP_NOMATCH = 'No records found. Create a new record.';
var LOCID_INLINELOOKUP_ERROR_SEARCH = 'An error occurred. Please try your search again.';
var LOCID_LU_MRUUNRESOLVEDTOOLTIP = 'The record is deleted or has been deactivated.';
var LOCID_INLINELOOKUP_SELECT_VALUE = 'Select a value.';
var LOCID_INLINELOOKUP_CASES_HEADER = 'CHOOSE AN EXISTING CASE';
var LOCID_INLINELOOKUP_NONAME = '\x28No name\x29';
var LOCID_EGC_NAME = 'Editable Grid';
var LOCID_EGC_ARIA_EMPTY_CELL = '\x28empty\x29';
var LOCID_EGC_CB_SORT_ICON_TEXT = 'Sort';
var LOCID_EGC_CB_SORT_TOOL_TIP_TEXT = 'Sort records by a specific column.';
var LOCID_EGC_CB_SELECT_TEXT = 'Select';
var LOCID_EGC_SELECT_TOOL_TIP_TEXT = 'Select records on this page.';
var LOCID_EGC_ARIA_CELL_TEMPLATE = '\x7b0\x7d\x3a \x7b1\x7d';
var LOCID_EGC_CHOOSECOLUMNS_MENUHDR = 'Choose columns';
var LOCID_EGC_DURATION_DAY = 'Day';
var LOCID_EGC_DURATION_DAYS = 'Days';
var LOCID_EGC_DURATION_HOUR = 'Hour';
var LOCID_EGC_DURATION_HOURS = 'Hours';
var LOCID_EGC_DURATION_MINUTE = 'Minute';
var LOCID_EGC_DURATION_MINUTES = 'Minutes';
var LOCID_EGC_GROUPBY_ITEMS = '\x7b0\x7d \x28\x7b1\x7d Items\x29';
var LOCID_EGC_GROUPBY_MENUHEADER = 'Group By';
var LOCID_EGC_LOOKUP_DISABLE_FILTER = 'Disable filter by related record';
var LOCID_EGC_LOOKUP_ENABLE_FILTER = 'Filter by related record';
var LOCID_EGC_NO_RECORDS = 'No data available.';
var LOCID_EGC_NOGROUPING = '\x28no grouping\x29';
var LOCID_EGC_PAGING_FIRST = 'First page';
var LOCID_EGC_PAGING_NEXT = 'Next page';
var LOCID_EGC_PAGING_CURRENT = 'Current page';
var LOCID_EGC_PAGING_PREVIOUS = 'Previous page';
var LOCID_EGC_SELECTION_ALL = 'Select All';
var LOCID_EGC_ROLLUP_LAST_UPDATE = 'Last updated\x3a';
var LOCID_EGC_SAVE = 'Save';
var LOCID_EGC_REFRESH = 'Refresh';
var LOCID_EGC_UNSAVED_STATUS = 'unsaved changes';
var LOCID_EGC_SAVING_STATUS = 'saving';
var LOCID_EGC_REFRESH_STATUS = 'Loading records';
var LOCID_EGC_FILTER_ASCENDING = 'Ascending';
var LOCID_EGC_FILTER_DESCENDING = 'Descending';
var LOCID_EGC_FILTER_APPLY = 'Apply';
var LOCID_EGC_FILTER_CLEAR = 'Clear';
var LOCID_EGC_FILTER_CONDITION = 'Filter by Condition';
var LOCID_EGC_FILTERVALUE = 'Filter by Value';
var LOCID_EGC_FILTERVALUE_SEARCH = 'Search';
var LOCID_EGC_FILTERVALUE_SELECTALL = 'Select All';
var LOCID_EGC_FILTERVALUE_NULL = '\x28nothing\x29';
var LOCID_EGC_FILTERCOND_HEADER = 'Show items that match these values.';
var LOCID_EGC_FILTERCOND_AND = 'And';
var LOCID_EGC_FILTERCOND_OR = 'Or';
var LOCID_EGC_FILTERCOND_NOTSET = '\x28not set\x29';
var LOCID_EGC_FILTERCOND_EQUALS = 'Equals';
var LOCID_EGC_FILTERCOND_NOTEQUAL = 'Does not equal';
var LOCID_EGC_FILTERCOND_BEGINSWITH = 'Begins with';
var LOCID_EGC_FILTERCOND_ENDSWITH = 'Ends with';
var LOCID_EGC_FILTERCOND_CONTAINS = 'Contains';
var LOCID_EGC_FILTERCOND_NOTCONTAIN = 'Does not contain';
var LOCID_EGC_FILTERCOND_GREATER = 'Is Greater than';
var LOCID_EGC_FILTERCOND_GREATEROREQ = 'Is Greater than or equal to';
var LOCID_EGC_FILTERCOND_LESS = 'Is Less than';
var LOCID_EGC_FILTERCOND_LESSOREQUAL = 'Is Less than or equal to';
var LOCID_EGC_FILTERCOND_ISBEFORE = 'Is Before';
var LOCID_EGC_FILTERCOND_ISAFTER = 'Is After';
var LOCID_EGC_FEATURE_NOT_SUPPORTED = 'The feature is not supported in the current version of the product';
var LOCID_EGC_ROWNAVIGATION_TOOLTIP = 'Open Record';
var LOCID_EGC_ROWDELETE_TOOLTIP = 'Delete Record';
var LOCID_EGC_JUMPBAR_BUTTON_TEXT = 'ABC';
var LOCID_EGC_MSO_TYPEAHEAD = 'Enter text here';
var LOCID_EGC_MSO_MORE = '\x7b0\x7d more';
var LOCID_EGC_MSO_LESS = 'less';
var LOCID_EGC_MSO_SELECT_ALL = 'Select All';
var LOCID_EGC_MSO_NOITEMS = 'No entries found';
var LOCID_EGC_MSO_FIELD_TEXT = 'Type something to filter or use arrow key to navigate';
var LOCID_EGC_MSO_VAL_DELETE = 'Press delete key to remove selection';
var LOCID_EGC_MSO_VAL_DELETED = '\x7b0\x7d removed';
var LOCID_EGC_MSO_VAL_ADD = '\x7b0\x7d selected';
var LOCID_EGC_MSO_ITEM_ARIALABEL = '\x7b0\x7d \x7b1\x7d of \x7b2\x7d';
var LOCID_EGC_MSO_INPUT_ARIALABEL = 'Enter a value to filter on, or select enter to show available options.';
var LOCID_EGC_MSO_LIST_NAVIGATION = 'In selected list, use left right arrow keys to navigate, press delete key to remove selection';
var LOCID_EGC_MSO_ITEMS_REMOVED = '\x7b0\x7d Removed';
var LOCID_EGC_MSO_MORELINK_TITLE = '\x7b0\x7d results. Select Enter to show all results in the list.';
var LOCID_EGC_MSO_LESSLINK_TITLE = 'Show less. Select enter to include fewer results the list.';
var LOCID_EGC_MSO_SELALL_FOCUSTITLE = 'Select all. List includes \x7b0\x7d items. Use the arrow keys to move up or down in the list.';
var LOCID_EGC_MSO_SELALL_DESELECT = '\x7b0\x7d items removed';
var LOCID_EGC_MSO_SELALL_SELECT = '\x7b0\x7d items selected';
var LOCID_EGC_MSO_TOTAL_ITEMS = '\x7b0\x7d Items';
var LOCID_EGC_MSO_DELETE_TITLE = 'Remove the value';
var LOCID_EGC_STREAM_FILTERED = 'Filtered';
var LOCID_EGC_STREAM_UNFILTERED = 'Unfiltered';
var LOCID_EGC_CMD_FLYOUT_OPEN = ' ';
var LOCID_EGC_GRID_PAGING_MASK = 'Page \x7b0\x7d';
var LOCID_EGC_ACCE_EDIT_INSTRUCT = 'Press Spacebar to launch editor and start editing';
var LOCID_EGC_SELECTALLROWS = ' ';
var LOCID_EGC_ROW_NAV_TOOLTIP = ' ';
var LOCID_EGC_TOOLTIP_SORTBY = 'Sort by \x7b0\x7d';
var LOCID_EGC_TOOLTIP_SORTEDBY = ' ';
var LOCID_EGC_FILTERS_SR_LABEL = 'Filter applied on, \x7b0\x7d';
var LOCID_EGC_NO_FILTER_TOOLTIP = 'No filter applied';
var LOCID_EGC_STREAM_HD_CMD_MS = ' ';
var LOCID_EGC_CLOSEBUTTON = ' ';
var LOCID_EGC_STREAM_HD_SORT_ASC = ' ';
var LOCID_EGC_STREAM_HD_SORT_DESC = ' ';
var LOCID_EGC_GRID_ROW_TEXT = ' ';
var LOCID_EGC_GRID_HEADER_ROW_TEXT = ' ';
var LOCID_EGC_GRID_DATA_ROW_TEXT = ' ';
var LOCID_EGC_LISTCARD_EXPAND_TEXT = ' ';
var LOCID_EGC_LISTCARD_COLLAPSE_TEXT = ' ';
var LOCID_EGC_CLOSE_SORT_POP_BUTTON = ' ';
var LOCID_EGC_GRID_EXPAND_TEXT = ' ';
var LOCID_EGC_GRID_COLLAPSE_TEXT = ' ';
var LOCID_EGC_GROUPROW_TEXT = ' ';
var LOCID_VALIDATION_ERROR = 'There is at least one error that must be fixed before you can proceed.';
var LOCID_VALIDATION_ERROR_CURRENCY = 'A currency is required when one or more money fields contain values. Select a currency, or remove the values in the money fields, and try again.';
var LOCID_VALIDATION_ERROR_DECIMAL = 'You must enter a number between \x7b0\x7d and \x7b1\x7d.';
var LOCID_VALIDATION_ERROR_EMAIL = 'You must enter a valid email address.';
var LOCID_VALIDATION_ERROR_INTEGER = 'You must enter a whole number between \x7b0\x7d and \x7b1\x7d.';
var LOCID_VALIDATION_ERROR_MONEY = 'A currency is required if a value exists in a money field. Select a currency and try again.';
var LOCID_VALIDATION_ERROR_READONLY = 'File is read-only.';
var LOCID_VALIDATION_ERROR_REQUIRED = 'You must provide a value.';
var LOCID_VALIDATION_ERROR_URL = 'You must enter a valid url.';
var LOCID_VALIDATION_ERROR_MSOS_MAX = 'You have selected more than maximum number of values\x28\x7b0\x7d of \x7b1\x7d\x29. Please reduce the number of selections and try again.';
var LOCID_VPD_NAMETEMPLATEWITHTOP = 'Top \x7b0\x7d\x3a \x7b1\x7d by \x7b2\x7d';
var LOCID_VPD_NAMETEMPLATEWITHBOTTOM = 'Bottom \x7b0\x7d\x3a \x7b1\x7d by \x7b2\x7d';
var LOCID_VPD_SERIESNAMETEMPLATE = '\x7b0\x7d';
var LOCID_VPD_MULSERIESNAMETEMPLATE = '\x7b0\x7d, \x7b1\x7d';
var LOCID_VPD_CATEGORYNAMETEMPLATE = '\x7b0\x7d';
var LOCID_VPD_MULCATEGRYNAMETEMPLATE = '\x7b0\x7d and \x7b1\x7d';
var LOCID_VPD_ELLIPSISNAMETEMPLATE = '\x7b0\x7d ...';
var LOCID_VPD_TOPICON_TOOLTIP_TOP = 'Displays top \x7b0\x7d \x7b1\x7d records.';
var LOCID_VPD_TOPICON_TOOLTIP_BOTTOM = 'Displays bottom \x7b0\x7d \x7b1\x7d records.';
var LOCID_VPD_TEXTBOXALERT = 'The specified value is invalid. Specify a numeric value that is greater than or equal to 1.';
var LOCID_CHART_ICON_TOOLTIP = 'Current chart type\x3a \x7b0\x7d. Click here to change the chart type.';
var LOCID_COLUMN_CHART = 'Column';
var LOCID_STACKEDCOLUMN_CHART = 'Stacked Column';
var LOCID_STACKEDCOLUMN100_CHART = '100\x25 Stacked Column';
var LOCID_BAR_CHART = 'Bar';
var LOCID_STACKEDBAR_CHART = 'Stacked Bar';
var LOCID_STACKEDBAR100_CHART = '100\x25 Stacked Bar';
var LOCID_AREA_CHART = 'Area';
var LOCID_STACKEDAREA_CHART = 'Stacked Area';
var LOCID_STACKEDAREA100_CHART = '100\x25 Stacked Area';
var LOCID_LINE_CHART = 'Line';
var LOCID_PIE_CHART = 'Pie';
var LOCID_FUNNEL_CHART = 'Funnel';
var LOCID_TAG_CHART = 'Tag';
var LOCID_DOUGHNUT_CHART = 'Doughnut';
var LOCID_TOPBOTTOM_ICON = 'Apply Top\x2fBottom Rule';
var LOCID_TOP_ICON = 'Top \x7b0\x7d items';
var LOCID_BOTTOM_ICON = 'Bottom \x7b0\x7d items';
var LOCID_MAXLENGTH_EXCEEDED = 'You have exceeded the maximum number of \x7b0\x7d characters in this field\x3b it will be truncated.';
var LOCID_UI_DIR = 'LTR';
var LOCID_ACTION_UNSUPPORTED_ERROR = 'This action is not supported.';
var LOCID_UNSUPPORTED_RIBBONACTION = 'This action is not supported on the browser that you are using.';
var LOCID_LOOKUP_LABEL_FOR_EDIT = '\x7b0\x7d \x7b1\x7d';
var LOCID_EMAIL_PREFIX_REPLY = 'RE\x3a';
var LOCID_EMAIL_PREFIX_FORWARD = 'FW\x3a';
var LOCID_EMAIL_FOLLOWUP_TO = 'To\x3a';
var LOCID_EMAIL_FOLLOWUP_SUBJECT = 'Subject\x3a';
var LOCID_EMAIL_FOLLOWUP_SENDER = 'From\x3a';
var LOCID_EMAIL_FOLLOWUP_RECEIVED = 'Received\x3a';
var LOCID_EMAIL_FOLLOWUP_CC = 'Cc\x3a';
var LOCID_MSCRM_MSGBODY_FONTS = 'Tahoma, Verdana, Arial';
var LOCID_DLG_OK_BTN_LABEL = 'OK';
var LOCID_DLG_CANCEL_BTN_LABEL = 'Cancel';
var LOCID_NAV_RIGHTLINK_TOOLTIP = 'Go to next page';
var LOCID_NAV_LEFTLINK_TOOLTIP = 'Go to previous page';
var LOCID_DLG_RETURNTOCRM_TITLE = 'Any changes in Excel will be lost';
var LOCID_DLG_RETURNTOCRM_TEXT = 'The changes you make in Excel will be lost unless you submit the changes to Dynamics 365.';
var LOCID_RESOLVE_WARNING_TEXT = 'Some changes didn\x27t apply successfully because of form and attribute settings, but you can still save your changes and resolve the sync error.';
var LOCID_RESOLVE_INFO_TEXT = 'Your changes are applied successfully and you can save and resolve the sync error.';
var LOCID_FIRST_WEEK_SELECT = 'FirstDay';
var LOCID_CLONE_THEME = 'Copy of \x7b0\x7d';
var LOCID_FIELD_SCREENREADER_LABEL = 'Select the Enter key to edit';
var LOCID_LOOKUP_SEARCH_LABEL = 'Enter a search term, then select the Enter key to search';
var LOCID_NONEMPTY_LOOKUP_LABEL = 'Select the Enter key to edit the lookup field, and the Control and Enter keys to open the link';
var LOCID_LOOKUP_CONTROL_LABEL = 'Select the Enter key to edit the lookup field';
var LOCID_DATETIME_CONTROL_FORMAT = 'Enter a date in the format \x7b0\x7d';
var LOCID_DELETE_CONFIRM_ONE = 'If you delete this resource and it is used in a service, then the service may no longer have enough resources to be scheduled.';
var LOCID_DELETE_CONFIRM_TWO = 'Are you sure you want to delete this facility\x2fequipment\x3f';
var LOCID_EMAIL_NORECORDS_MSG = 'Direct email cannot be sent because no records were returned for the current view. You need to select a different view or record\x28s\x29 to be able to send direct email.';
var LOCID_USERS_TOO_MANY = 'You can only perform this action for one user at a time.';
var LOCID_DEACTIVATE_WORKFLOW = 'This process can\x27t be deactivated because it is a system-generated process.';
var LOCID_DELETE_WORKFLOW = 'This process can\x27t be deleted because it is a system-generated process.';
var LOCID_ACTIVATE_WORKFLOW = 'This process can\x27t be activated because it is a system-generated process.';
var LOCID_INCOM_TYPE_CAMP = 'You cannot perform this action for campaign activities.';
var LOCID_INCOM_TYPE_EMAIL = 'You cannot perform this action for email activities.';
var LOCID_SOCIAL_ACTIVITY_ACTIONERR = 'You can not perform this action for social activities.';
var LOCID_HETROGENEOUS_ACTIVITY = 'You can only perform this action for activities of the same type.';
var LOCID_HETROGENEOUS_DATASOURCE = 'You can only perform this action for data sources of the same type.';
var LOCID_EMPTY_GRID_MESSAGE = 'To add or remove items, save this record.';
var LOCID_EMPTY_GRID_MESSAGE_REFRESH = 'To enable this content, create the record.';
var LOCID_EMPTY_SUBGRID_MSG_REFRESH = 'There are no \x7b0\x7d for this \x7b1\x7d in this view.';
var LOCID_EMPTY_SUBGRID_IMG_TOOLTIP = 'Empty State Image';
var LOCID_LOADING_GRID_DATA_REFRESH = 'Loading records';
var LOCID_GRID_TOO_MANY_RECORDS_IWF = 'You can select only one record at a time for this action.';
var LOCID_MINICAMP_NORECORDS_MSG = 'Quick Campaign cannot be created because no records were found on the current page.';
var LOCID_MINICAMP_TOOMANY_RECORDS = 'You cannot create a Quick Campaign for more than one marketing list at a time.  Please select only one marketing list.';
var LOCID_MINICAMP_CANNOT_RUN = 'This option is not available for the current view. Not all views will work with the option For All Records on All Pages. Select a different view or a different Quick Campaign option and try again.';
var LOCID_QC_CANNOT_RUN_ASSO = 'This option is not available for the current view. Select a different Quick Campaign option and try again.';
var LOCID_MC_CANNOT_RUN_INACTLST = 'Quick campaigns cannot be run on a Marketing List that is inactive. Activate the Marketing List or select a different Marketing List, and try again.';
var LOCID_DEDUPE_CANNOT_RUN = 'This option is not available for the current view. Not all views will work with the option For All Records on All Pages. Select a different view or a different Duplicate Detection option and try again.';
var LOCID_GRID_UNSELECTED_CHECKBOX = 'The record is not selected.';
var LOCID_GRID_SELECTED_CHECKBOX = 'The record is selected.';
var LOCID_GRID_NO_VIEW_NAME = 'Not Available';
var LOCID_GRID_EXACTTOTALCOUNT = '\x7b0\x7d';
var LOCID_GRID_APPROXTOTALCOUNT = '\x7b0\x7d\x2b';
var LOCID_QTY_PRICE_NEGATIVE = 'You cannot specify negative values for both Quantity and Price Per Unit. Change either of these values and try again.';
var LOCID_INVITE_MULTIPLE = 'Microsoft Dynamics 365 does not currently support invitations to multiple users. Select users individually and try again.';
var LOCID_PROMOTETOADMIN_MULTIPLE = 'You can promote only one user to admin at a time. Select users individually and try again.';
var LOCID_INVITE_NOTAVAILABLE_URL = 'https\x3a\x2f\x2fport.crm6.dynamics.com\x2fportal\x2fnotification\x2ffeaturenotification.aspx\x3ftype\x3dUserInviteFeatureOutage\x26showbackbtn\x3dFalse\x26showhomebtn\x3dFalse\x26showclosebtn\x3dTrue';
var LOCID_BU_CANNOTDISABLE = 'It has been detected that this operation would deactivate all remaining business units and cannot proceed.';
var LOCID_MERGE_CASE_TOOMANY_RECORDS = 'You can merge only \x7b0\x7d cases at a time.';
var LOCID_ASSCO_TOOMANY_RECORDS = 'A Parent Case cannot have more than \x7b0\x7d child cases. Contact your administrator for more details.';
var LOCID_MERGE_LESS_RECORDS = 'Select at least two records to merge.';
var LOCID_ASSCO_LESS_RECORDS = 'Select at least two records to associate parent child relationship.';
var LOCID_GRID_TOO_MANY_RECORDS_1 = 'You can select only 1 row.';
var LOCID_SLADEFAULT_INACTIVE_MSG = 'You cannot set an inactive SLA as the default.';
var LOCID_ENTITLEMENT_CANCEL_TH_MSG = 'The maximum record limit is exceeded for this operation. Reduce the number of records to \x7b0\x7d.';
var LOCID_ENTITLEMENT_CANCEL_TH_LT = '50';
var LOCID_ENT_DEFAULT_DIALOG_WIDTH = '1000';
var LOCID_ENT_DEFAULT_DIALOG_HEIGHT = '200';
var LOCID_KNOWART_BULKMAJOR_TITLE = 'Confirm major articles';
var LOCID_KNOWART_BULKMAJOR_TEXT = 'Are you sure you want to create a new major version of this article\x3f';
var LOCID_KNOWART_BULKMINOR_TITLE = 'Confirm minor articles';
var LOCID_KNOWART_BULKMINOR_TEXT = 'Are you sure you want to create a new minor version of this article\x3f';
var LOCID_KNOWART_BULKAPRV_TITLE = 'Confirm approve articles';
var LOCID_KNOWART_BULKAPRV_TEXT = 'Are you sure you want to approve this version of the article\x3f';
var LOCID_KNOWART_BULKPUB_TITLE = 'Confirm publish articles';
var LOCID_KNOWART_BULKPUB_TEXT = 'Confirm publish articles';
var LOCID_KNOWART_BULKREV_TITLE = 'Confirm revert to draft articles';
var LOCID_KNOWART_BULKREV_TEXT = 'Are you sure you want to revert this version of the article back to being a draft\x3f';
var LOCID_KNOWART_BULKARCV_TITLE = 'Confirm archive articles';
var LOCID_KNOWART_BULKARCV_TEXT = 'Are you sure you want to archive this version of the article\x3f';
var LOCID_KNOWART_BULKDISCARD_TITLE = 'Confirm trash articles';
var LOCID_KNOWART_BULKDISCARD_TEXT = 'Are you sure you want to send this version of the article to the trash\x3f';
var LOCID_KNOWART_APPROVE_TITLE = 'Confirm approve article';
var LOCID_KNOWART_APPROVE_TEXT = 'Are you sure you want to approve this version of the article\x3f';
var LOCID_KNOWART_PUBLISH_TITLE = 'Confirm publish article';
var LOCID_KNOWART_PUBLISH_TEXT = 'Confirm publish article';
var LOCID_KNOWART_CHKPUBLISH_TITLE = 'Confirm publish article';
var LOCID_KNOWART_CHKPUBLISH_TEXT = 'You\x27re publishing an earlier version of the currently published article. Do you want to continue\x3f';
var LOCID_KNOWART_ARCHIVE_TITLE = 'Confirm archive article';
var LOCID_KNOWART_ARCHIVE_TEXT = 'Are you sure you want to archive this version of the article\x3f';
var LOCID_KNOWART_DISCARD_TITLE = 'Confirm trash article';
var LOCID_KNOWART_DISCARD_TEXT = 'Are you sure you want to send this version of the article to the trash\x3f';
var LOCID_KNOWART_REVERTDRAFT_TITLE = 'Confirm revert to draft article';
var LOCID_KNOWART_REVERTDRAFT_TEXT = 'Are you sure you want to revert this version of the article back to being a draft\x3f';
var LOCID_KNOWART_UPDATE_TITLE = 'Confirm updates';
var LOCID_KNOWART_UPDATE_TEXT = 'Do you want to save the updates made to this article\x3f The updates will take effect immediately, even if the article is already published.';
var LOCID_KNOWART_CREATEMAJOR_TITLE = 'Confirm create major for article';
var LOCID_KNOWART_CREATEMAJOR_TEXT = 'This will create a new major version of the Article \x28v\x7b0\x7d.0\x29 with content from the version you\u2019re currently on \x28v\x7b1\x7d.\x7b2\x7d\x29. Do you want to proceed\x3f';
var LOCID_KNOWART_CREATEMINOR_TITLE = 'Confirm create minor for article';
var LOCID_KNOWART_CREATEMINOR_TEXT = 'This will create a new minor version of the Article \x28v\x7b0\x7d.\x7b1\x7d\x29 with content from the version you are currently on \x28v\x7b2\x7d.\x7b3\x7d\x29. Do you want to proceed\x3f';
var LOCID_KNOWART_RESTORE_TITLE = 'Confirm restore article';
var LOCID_KNOWART_RESTORE_TEXT = 'Are you sure you want to restore the article\x3f It will be in the Draft state again.';
var LOCID_KNOWART_REJECT_TITLE = 'Confirm reject article';
var LOCID_KNOWART_REJECT_TEXT = 'Confirm reject article';
var LOCID_KNOWART_REJECT_NOTE_TITLE = 'Article Review Rejected - Please Update';
var LOCID_KNOWART_TRANSLATE_LATEST = 'Latest Version';
var LOCID_KNOWART_TRANSLATE_MAJOR = 'Major version number\x3a ';
var LOCID_KNOWART_TRANSLATE_MINOR = 'Minor version number\x3a ';
var LOCID_KNOWART_TRANSLATE_NOTRANS = 'No translations exist for this language';
var LOCID_KNOWART_EXPIREON_ISVALID = 'An article\u2019s expiration date must be set at some point in the future after the publishing date.';
var LOCID_KNOWART_PUBLISH_DATETIME = 'Please select a different date. The publishing date must be a date between today and the expiration date for the article.';
var LOCID_KNOWART_PUBLISH_EXPSTATE = 'You must provide a value for Expiration State.';
var LOCID_KNOWART_PUBLISH_EXPSTATUS = 'You must provide a value for Expiration Status.';
var LOCID_KNOWART_PUBLISH_DATE = 'You must provide a value for PublishingDateTime.';
var LOCID_KNOWART_NOTIFY_READONLY = 'This knowledge article can\x27t be edited here. You can edit the article in the Customer Service Hub.';
var LOCID_KNOWART_TRANSLATE_LANGUAGE = 'Select a language to use for the translation.';
var LOCID_KNOWART_SAVEPUBLISHED_TEXT = 'This article is published or is scheduled to be published. To save and publish your changes, use the Update action.';
var LOCID_KNOWART_PUBLISH_MSG = 'The save is blocked. Please press the \x22Update\x22 ribbon action to update articles scheduled or published';
var LOCID_CONVERT_CASE_KNOWART_OWNER = 'Please select a owner.';
var LOCID_CONVERT_CASE_KNOWART_SAVE = 'You must save the changes before you can convert this case.';
var LOCID_KNOWART_MARKINTERNAL_TEXT = 'Would you like to mark all related versions and translations as internal\x3f';
var LOCID_KNOWART_MARKEXTERNAL_TEXT = 'Would you like to mark all related versions and translations as external\x3f';
var LOCID_KNOWART_CONFIRMBUTTONLABEL = 'Yes';
var LOCID_KNOWART_CANCELBUTTONLABEL = 'No';
var LOCID_DOWNLOADMAP_ERROR = 'You can only download one data map at a time.';
var LOCID_DWNLDMAP_SLCT_ONERECORD = 'Select a data map to export.';
var LOCID_REFRESH_CANCELED = 'Refresh was canceled by user.';
var LOCID_REMOTECOMMAND_ERROR = 'An error has occurred. Try this action again. If the problem continues, check the Microsoft Dynamics 365 Community for solutions or contact your organization\x27s Microsoft Dynamics 365 Administrator. Finally, you can contact Microsoft Support.';
var LOCID_NON_SRS_FILTERSCHEDULE = 'Only SQL Server Reporting Services reports can be filtered or scheduled.';
var THEME_ID = '1eb9500d-8979-415c-b378-f5e8e52ff305';
var THEME_UPDATE_TIMESTAMP = '636874335651413007';
var WEB_APP_URL = '';
var HELP_SKU = 'LIVE';
var IS_OUTLOOK_LAPTOP_CLIENT = false;
var IS_OUTLOOK_14_CLIENT = false;
var CLIENT_MAJOR_VERSION = 9;
var _bShowPendingApprovalReminder = false;
var _EnforceStateTransitions = '0';
var YAMMER_IS_INSTALLED = true;
var YAMMER_IS_CONFIGURED_FOR_ORG = false;
var YAMMER_APP_ID = 'e3HEvk9cqzVW4yyn8tIM3g';
var YAMMER_NETWORK_NAME = '';
var YAMMER_GROUP_ID = 0;
var YAMMER_TOKEN_EXPIRED = false;
var YAMMER_IS_CONFIGURED_FOR_USER = false;
var YAMMER_HAS_CONFIGURE_PRIVILEGE = true;
var YAMMER_POST_METHOD = 0;
var YAMMER_YAMMEREMBED_WRPCTOKEN = 'Tmw\x2fRi2dEemoSQANOtJtmsDRYjaMiEbtyDKb9kbMevB5TPGCHVWFsP4\x2fmekFcrwN';
var YAMMER_YAMMEREMBED_TIMESTAMP = '636878709376195823';
var IS_ACTIONHUB_ENABLED = true;
var REMIND_AUTH_EXPIRATION = true;
var AUTH_EXPIRATION_REMINDER_TIME_IN_SECONDS = 71534;
var AUTH_EXPIRATION_AFTER_REMINDER_IN_SECONDS = 72734;
var AUTH_EXPIRATION_LAST_UPDATE = '20190311031537';
var DIALOG_REAUTH_DESCRIPTION = 'Your Microsoft Dynamics 365 session is about to expire. To continue working, please sign in again.';
var DIALOG_REAUTH_EXPIRED_DESCRIPTION = 'Your session has expired. Any unsaved changes have been lost.';
var DIALOG_REAUTH_SIGNIN_BUTTON = 'Sign In';
var DIALOG_REAUTH_CANCEL_BUTTON = 'Cancel';
var DIALOG_REAUTH_CLOSE_BUTTON = 'Close';
var _currentTypeCode = 10041;
var _ISFLATUIPAGE = true;
var GF_MAXRECORDS_LOOKUP = 300;
var EnabledLanguages = {"1033":"English"};
var MaxSelectionsAllowed = 150;
var nmo_referral_HasStateCode = true;
var FiscalPeriodDisplayName = {"1":"Quarter 1","2":"Quarter 2","3":"Quarter 3","4":"Quarter 4","101":"January","102":"February","103":"March","104":"April","105":"May","106":"June","107":"July","108":"August","109":"September","110":"October","111":"November","112":"December","201":"Semester 1","202":"Semester 2","301":"Annual","401":"P1","402":"P2","403":"P3","404":"P4","405":"P5","406":"P6","407":"P7","408":"P8","409":"P9","410":"P10","411":"P11","412":"P12","413":"P13"};
var FiscalYearDisplayName = {"2038":"FY2038","2037":"FY2037","2036":"FY2036","2035":"FY2035","2034":"FY2034","2033":"FY2033","2032":"FY2032","2031":"FY2031","2030":"FY2030","2029":"FY2029","2028":"FY2028","2027":"FY2027","2026":"FY2026","2025":"FY2025","2024":"FY2024","2023":"FY2023","2022":"FY2022","2021":"FY2021","2020":"FY2020","2019":"FY2019","2018":"FY2018","2017":"FY2017","2016":"FY2016","2015":"FY2015","2014":"FY2014","2013":"FY2013","2012":"FY2012","2011":"FY2011","2010":"FY2010","2009":"FY2009","2008":"FY2008","2007":"FY2007","2006":"FY2006","2005":"FY2005","2004":"FY2004","2003":"FY2003","2002":"FY2002","2001":"FY2001","2000":"FY2000","1999":"FY1999","1998":"FY1998","1997":"FY1997","1996":"FY1996","1995":"FY1995","1994":"FY1994","1993":"FY1993","1992":"FY1992","1991":"FY1991","1990":"FY1990","1989":"FY1989","1988":"FY1988","1987":"FY1987","1986":"FY1986","1985":"FY1985","1984":"FY1984","1983":"FY1983","1982":"FY1982","1981":"FY1981","1980":"FY1980","1979":"FY1979","1978":"FY1978","1977":"FY1977","1976":"FY1976","1975":"FY1975","1974":"FY1974","1973":"FY1973","1972":"FY1972","1971":"FY1971","1970":"FY1970"};
var _highContrastEnabled = false;
var LOCID_LOADING_CRMGRID = 'Loading Inbound Referral records...';
var CAN_CUSTOMIZE_VISUALIZATION = true;
var GCCDatacenter = false;
var WEB_RESOURCE_ORG_VERSION_NUMBER = '\x7b636878706300003032\x7d';
var _DebugOnScriptError = false;
var ORG_UNIQUE_NAME = 'org205357aa';
var ORG_ID = '\x7b953EBDBE-005C-43D9-998F-DA47F8401849\x7d';
var USE_READ_FORM = true;
var IS_PATHBASEDURLS = false;
var USER_HELP_LCID = 1033;
var USER_LANGUAGE_CODE = 1033;
var IS_OUTLOOK_CLIENT = false;
var IS_UEIP_ENABLED = true;
var IS_ONLINE = true;
var IS_SANDBOX_ORG = true;
var IS_SUPPORT_ORG = false;
var IS_PREVIEW_ORG = false;
var IS_PRESERVE_IFRAME = false;
var IS_EMAIL_CONVERSATION_FCB = true;
var IS_ACTIVITY_SORTING = true;
var IS_GRID_WITH_IMAGE = true;
var IS_AUTO_CAPTURE = true;
var IS_TEXT_WRAP_ENABLED = true;
var IS_WEBCLIENT_VISUAL_REFRESH_ENABLED = true;
var IS_GREY_SHADE_ONRESIZE_ENABLED = true;
var IS_RECENTLY_VIEW_ENABLED = true;
var BROWSER_RELOAD_COUNT_CONFIG = '\x7b\x22IE\x22\x3a60,\x22Legacy\x22\x3a60,\x22Other\x22\x3a120,\x22Modern\x22\x3a120\x7d';
var REQ_ID = '83d727e3-0ca7-4edd-9e67-94a27004d81b';
var VERSION_STAMP = 1888157098;
var IsCarinaFeatureAvailable = true;
var IsParatureAtriaDependenciesAvailable = true;
var IsCorsEnabledForKmControl = 0;
var ISV_ADDITIONAL_AUTH = '';
var IsCurrentKMParature = false;
var IsParatureKnowledgebaseVisable = true;
var CUSTOM_ETC_LIST = '\x5b10001,10024,10037,10023,10033,10039,10038,10034,10025,10012,10014,10007,10040,10011,10030,10004,10009,10002,10041,10020,10013,10005,10027,10010,10018,10035,10031,10006,10036,10017,10032,10008,10003,10016,10042,10029,10022,10015,9704,10026,10019,10021,10028,10000\x5d';
var CollapsedWidth = '40px';
var ExpandedWidth = '23\x25';
var FeatureControl = {"FCB.SalesStudioRole":false,"FCB.Moca.LandingPageActivities":false,"FCB.BulkWorkflowSyncOperations":false,"FCB.ExportToExcel":true,"FCB.OfflineProfileRuleEnhancementsSlidingWindowForProfileItemAssociation":true,"FCB.EnableRedisForCache":false,"FCB.ShowQueryHintUI":false,"FCB.ThemeDesigner":true,"FCB.TimelineWall.UserPosts":true,"FCB.ClientDependenciesCacheEnabledForUci":false,"FCB.VirtualEntity":true,"FCB.AMMUpdateForOfflineAppsOnly":true,"FCB.TimelineWall.WhatsChanged":true,"FCB.Categories":true,"FCB.OrgInsightsV2":false,"FCB.SharePointS2S":false,"FCB.UnifiedClientCDN":false,"FCB.CloudSSS":false,"FCB.AllowGeoDbAccessForCallerIdValidation":false,"FCB.OfflineProfileRuleEnhancementsSlidingWindowForProfileItem":true,"FCB.OData.Throttling":true,"FCB.AppModuleCacheInvalidationFix":true,"FCB.MDDSolutionAwareness":true,"FCB.Moca.InteractionCentricDashboard":true,"FCB.Feedback":true,"FCB.UseNewRIConfig":true,"FCB.CardControl":false,"FCB.EnableExcelTemplatePerfFix":true,"FCB.UpgradeFormMerge":true,"FCB.UCIInactivityTimeout":true,"FCB.AppSwitcherInFocusMode":false,"FCB.Moca.PrivilegeBasedMetadataSync":true,"FCB.ThrowErrorOnCyclicDependency":false,"FCB.Playbook":true,"FCB.ServiceBusAutoDetectMode":true,"FCB.TaskBasedFlowListSupport":false,"FCB.InteractionCentricKbSearchControl":true,"FCB.AdvancedFindOnUCI":false,"FCB.AllowCustomSessionDuration":true,"FCB.MailAppModuleCRMContactsSearchFilter":false,"FCB.MobileOfflinePrepareSyncFlag":false,"FCB.ProcessControlTheme":false,"FCB.RelationshipAssisstantFeature3":false,"FCB.LivePersonaCardUCI":false,"FCB.AllowCustomInactivityDuration":true,"FCB.SkipNavigation":true,"FCB.ActivityInsights":false,"FCB.UseAttributeLogicalNameForMappingInAttributeMap":true,"FCB.ExportAppointmentRichEditorExperienceOrgSetting":false,"FCB.RollupsV2":true,"FCB.GuidedHelp":true,"FCB.EditableGridControlJsEvents":true,"FCB.TimelineWall.CommandBar.Activities":true,"FCB.WebResourceAndIFrameOnISH":true,"FCB.AllowMsosEditingInGrid":true,"FCB.RuntimeDependencyDeletionOptimizationForUCI":true,"FCB.UnifiedProcessDesignerV2":false,"FCB.MetadataCreateBulkOptimizationsForSolutions":false,"FCB.EnableDataSyncService":false,"FCB.ExternalStorage":false,"FCB.SdkMessageProcessingStepRemoval":true,"FCB.TrackUsingCategoriesDefaultValue":false,"FCB.SalesAssistant":false,"FCB.MailAppAttributeTargets":true,"FCB.Moca.ExportToExcelMobile":true,"FCB.CheckInvalidSolutionLayerDependency":false,"FCB.Moca.ApplicationMetadataOnDemandSync":false,"FCB.Flow.Notifications":true,"FCB.AzureWebAppPlugins":false,"FCB.FPI.Staging":false,"FCB.SharedCache2":false,"FCB.TaskBasedFlowEditor":true,"FCB.CommandbarDesigner":false,"FCB.RibbonMDUpdateDuringSolutionUninstall":true,"FCB.UninstallPerformance":true,"FCB.ISHDashboardSolutionSupport":false,"FCB.SSSDisableMailbox":true,"FCB.SocialInsights":true,"FCB.CustomControlSolutionUninstall":false,"FCB.ImmediateSyncClient":false,"FCB.MailAppEnableCRMInsights":true,"FCB.ViewDesigner":true,"FCB.TimelineWall.Notes":true,"FCB.EnableBulkDeleteImprovement":true,"FCB.SynchronizeSandboxCallbacks":true,"FCB.Moca.WordDocumentTemplate":true,"FCB.UpgradeRollupCurrencyCalculationsWithHigherPrecision":true,"FCB.ProcessUnificationV2":true,"FCB.BpfActionSupportPUV2":true,"FCB.UnifiedClientCDNForShim":false,"FCB.UCIMetadataClientBrowserCache":true,"FCB.PublishMEAP":true,"FCB.USDNPSSurvey":false,"FCB.DataSetControl":true,"FCB.EnablePowerAppsNavBar":false,"FCB.ActionCard":true,"FCB.OrganizationSdk.Throttling":true,"FCB.PlaybookV2":false,"FCB.EmailConversationView":true,"FCB.WebResourceGeneratorOptimizationWithResxCacheForUci":false,"FCB.WebresourceLocalizationAndDependency":true,"FCB.ForceStrongNamePluginAssemblyRegistration":false,"FCB.NotUseSentinelRow":false,"FCB.WebResourceDesigner":true,"FCB.MailAppOpenRecordInBrowser":true,"FCB.PreserveIframe":false,"FCB.ServeStaticResourcesFromAzureCDN":false,"FCB.AMMUpdateEnqueueCheck":true,"FCB.AlwaysCheckMetadataTimestamp":false,"FCB.PublishReportsOnDemand":true,"FCB.TimelineWall":true,"FCB.AutoDataCaptureUCI":true,"FCB.SSSMailboxErrorDynamicLink":true,"FCB.OneNoteIntegration":true,"FCB.LookupService":false,"FCB.PredictiveOpportunityScoring":true,"FCB.YammerPostsOnUCI":true,"FCB.TalkingPoints":false,"FCB.EnableJobsFxOrgDBUpdate":false,"FCB.WorkflowXamlValidation":true,"FCB.CustomerLookupAttributeType":true,"FCB.ImmersiveSkype":false,"FCB.KnowledgeArticle":true,"FCB.PowerBi":true,"FCB.Moca.ExcelDocumentTemplate":true,"FCB.Cortana.ProactiveExperience":false,"FCB.PerformSDKPreCreateCleanUp":true,"FCB.KernelContract.PartnerCredentials":true,"FCB.SolutionSegmentation":true,"FCB.WorkflowOobSdkMsgSupport":true,"FCB.MapControlEnabled":true,"FCB.OfficeGraphSyncEnabled":false,"FCB.DependencyCalculationForWorkflowActivation":true,"FCB.AppsForCrm":true,"FCB.ServiceCaseTopicAnalysis":false,"FCB.OfficeMailAppLegacyAuth":false,"FCB.ReportServerNoActiveDirectory":false,"FCB.KmControl":true,"FCB.CustomControlSolutionExport":true,"FCB.UnboundCustomControlSupport":false,"FCB.UseFontIconsForWebclient":false,"FCB.Moca.LookupRelationshipFilters":true,"FCB.Moca.Telemetry":false,"FCB.EnablePartialLoadMetadataCache":false,"FCB.ServiceCaseTopicAnalysisStaging":false,"FCB.PluginTraceLogging":true,"FCB.EnableSchedulingEngine":false,"FCB.MailAppAppointmentsReliablePromote":true,"FCB.ReverseHybridSSS":true,"FCB.EnableCanvasAppEmbedding":true,"FCB.ConditionalAccessPolicy.LocationValidation":false,"FCB.AutoConvertInnerJoinToIn":false,"FCB.AppSwitcherShell":true,"FCB.RollupCurrencyCalculationsWithHigherPrecision":true,"FCB.Refresh.Service":true,"FCB.UCIUserMetadataVersionOptimization":false,"FCB.OfficeMailAppMetadata":true,"FCB.Carina":false,"FCB.EnableRecentlyViewed":true,"FCB.MSTeamsUserSyncPreview":false,"FCB.GridWithImageRendering":true,"FCB.EnableAddProductPropertiesAtRootLevel":false,"FCB.AppDesigner":true,"FCB.CheckCyclicDependency":true,"FCB.WorkflowRelatedEntityCondition":true,"FCB.CanvasAppEmbedding.EnableRecordTemplate":false,"FCB.MobileOfflineDefaultNonProductionInstanceSupport":false,"FCB.InteractionCentricEmailLink":true,"FCB.SkipTenantInfoMarsServiceLivePlatformCall":true,"FCB.SitemapAdminAreaForUCI":false,"FCB.CustomSearchProviderOnUCI":false,"FCB.TrialOrgRelevanceSearch":false,"FCB.OfflineProfileRuleEnhancementsORSupportForProfileItem":true,"FCB.MailAppAttachmentsReliablePromote":true,"FCB.Rollups":true,"FCB.DisableEditableGridControlOnPhone":true,"FCB.AllowPinProcessWhiteList":true,"FCB.GuidedHelpOnUCI":true,"FCB.HierarchyControlForUCI":false,"FCB.LinkedInAnalysis":false,"FCB.AnalyzeMobileOfflineProfile":false,"FCB.SalesStudioRank":false,"FCB.AppCreationFromSolution":true,"FCB.Moca.ISHMetadataOnDemand":false,"FCB.RelationshipAssisstantFeature2":false,"FCB.PowerBI.PowerBIGroups":true,"FCB.Moca.LandingPage":true,"FCB.KernelContract.ExtIntegration":true,"FCB.PipelineInfoTrace":false,"FCB.NPSSurvey":true,"FCB.EnableBPFCCPhase3":false,"FCB.ResourceBookingExchangeSync":true,"FCB.TeaserCards":false,"FCB.SSSCustomProperty":true,"FCB.DataPerformanceDashboardLogAllQueries":false,"FCB.OfficeWaffleMenu":true,"FCB.AutoDataCapture":true,"FCB.CascadingOptionSet":false,"FCB.ProductRecommendations":false,"FCB.RibbonMDUpdateDuringSolutionImport":true,"FCB.AADGroups":false,"FCB.CustomControlSitemapSupport":false,"FCB.SolutionPerformanceImprovement":false,"FCB.Dynamics365Bot":false,"FCB.UnifiedClient":true,"FCB.RepointActiveSdkStepToUpgradeSolution":true,"FCB.ServiceBusPremiumMode":false,"FCB.ShowUserNameInTopNav":false,"FCB.SalesPartnerApps":false,"PHONETICBASEDSEARCH":false,"FCB.SSSReliability":false,"FCB.GlobalSearchRecords":true,"FCB.CustomizableHelp":true,"FCB.Mobile.KmSearchControl":true,"FCB.OfficeMailAppWebDeployment":true,"FCB.Refresh.Common":true,"FCB.EnableSearchPreviewOption":false,"FCB.CustomActivity":false,"FCB.ParatureAtriaDependencies":false,"FCB.AuditNoSqlWrite":false,"FCB.SalesSettingsOnUCI":true,"FCB.UciShellRefresh":true,"FCB.SitemapCacheInvalidationFix":true,"FCB.OneDriveIntegration":true,"FCB.ShowLinkTypeUIInAdvancedFind":false,"FCB.BulkOptimizationsBatchSQL":true,"FCB.MailAppEnableAria":false,"FCB.MultiEntitySearch":true,"FCB.OfficeProductivityOnUCI":false,"FCB.SkipAddInitialUserToConfigDB":false,"FCB.FlowIntegration":true,"FCB.PredictiveForecastPreview":true,"FCB.DisableLegacyExtensionParameters":false,"FCB.WhoKnowsWhom":false,"FCB.EnableJobsFxAppUpdate":false,"FCB.IgnoreExtendedRetrieveMultipleTimeoutFromSandbox":true,"FCB.LeoServiceFeatures":true,"FCB.RAFeaturesForFall2018":true,"FCB.OfficeGraphIntegrationUsingGraphApi":false,"FCB.MetadataDrivenFilterForKbSearch":false,"FCB.NotesAnalysis":false,"FCB.SSSExchangeSubscriptionCheck":false,"FCB.EmailEngagement":true,"FCB.ConfigurableSync":false,"FCB.UseUnionForEachQuickFindCondition":false,"FCB.LazyLoadSubgrids":false,"FCB.Refresh.Sales":true,"FCB.LookupChangeViewOnUCI":false,"FCB.ReimaginedCharts":false,"FCB.TimelineWall.Activities":true,"FCB.BlackForestRI":false,"FCB.CalculatedFields":true,"FCB.D365SecurityRoleAssignment":true,"FCB.AllowLegacyDialogsInUci":true,"FCB.RetrieveCustomActivityInfoUsingSandboxPlugin":true,"FCB.LegacyCustomerCheck":false,"FCB.EventExpander":false,"FCB.PipelineQosTraceLogging":true,"FCB.SitemapDesigner":true,"FCB.UCIByDefaultPhase2":false,"FCB.WebClientVisualRefresh":true,"FCB.DefaultSolutionUpgrade":false,"FCB.AdvancedSimilaritySearch":false,"FCB.TestExchangeServer":true,"FCB.WorkflowXamlValidationErrorReport":false,"FCB.VersionNumberFiltering":true,"FCB.SSSTroubleShooting":true,"FCB.AuditSqlWrite":true,"FCB.ActivityLogging":true,"FCB.ProcessUnificationV2EntityCustomization":true,"FCB.WorkFlowDesignerV2":false,"FCB.UnifiedClientCacheModeEnabled":false,"FCB.AppModuleForOrganization":true,"FCB.OfficeMailAppMobile":true,"FCB.ApiInstrumentation":true,"FCB.CustomControlFormDataType":false,"FCB.ProcessUnification":true,"FCB.MetadataCreateBulkOptimizationsV2":true,"FCB.DocumentRecommendations":false,"FCB.RuntimeDependencyCacheLoadOptimizationForUCI":true,"FCB.OfficeMailAppRestApi":false,"FCB.ActivityWallSorting":true,"FCB.Orion.Air":true,"FCB.MultiThreadMetadataGeneration":true,"FCB.EnableSolutionHistoryData":true,"FCB.ResourceBookingExchangeSyncTelemetry":false,"FCB.AllowEmailApprovalFromFromNonTenantAdmin":false,"FCB.MultiSelectOptionSet":true,"FCB.TimelineWall.Filters":true,"FCB.MocaOfflineProfileRuleEnhancements":true,"FCB.TurboForms":false,"FCB.EnableCanvasAppEntities":true,"FCB.CustomControlSolutionImport":true,"FCB.UCIMaxSessionTimeout":true,"FCB.HybridSSS":true,"FCB.MSTeamsIntegration":false,"FCB.NonBaseActionCard":true,"FCB.PredictiveOpportunityScoringFeatureSelection":false,"FCB.MSTeamsCollaborationPreview":false,"FCB.OfficeMailAppEmailEngagement":true,"FCB.UseMetadataCacheForStagedData":false,"FCB.OwinOpenIdAuthentication":true,"FCB.InAppSupportOrg":false,"FCB.BpfActionSupportPUV2GA":true,"FCB.SharePointForWordDocumentEnable":false,"FCB.AppModuleDebugLogging":false,"FCB.SalesStudioFlow":false,"FCB.DelveActionHubIntegration":false,"FCB.Refresh.Fall":true,"FCB.IgnoreInvalidManagedPropertyChange":true,"FCB.ManualForecast":false,"FCB.CustomControlMobile":true,"FCB.LookupQuickFind":true,"FCB.DisableActiveStageTraversedPathDeprecation":true,"FCB.EnableMobileOfflineRowVersioning":false,"FCB.ThrowOnInvalidSolutionLayerDependency":false,"FCB.Moca.PaneStackingOnPhones":true,"FCB.DependencyCacheOptimization":true,"FCB.ResetProductPropertiesFromBundle":false,"FCB.EnableMobileOfflineReadOnly":false,"FCB.SalesStudio":false,"FCB.OfficeMailAppAppointment":true,"FCB.BpfActionSupportActionQuerying":true,"FCB.OfficeMailAppOutlookMacCompose":false,"FCB.UseCreateOrAlterView":false,"FCB.EnableCascadeAssignImprovements":false,"FCB.EnableControlMappings":false,"FCB.TimelineWall.Posts":true,"FCB.AllowMalformedBearerTypeHeader":true,"FCB.ActionCardGenerationAsync":true,"FCB.OneToManyExpand":true,"FCB.UnifiedProcessDesigner":true,"FCB.AnyChanelToAnyEntityRecordCreation":true,"FCB.AppDesigner.ClientTypeSelection":true,"FCB.LinkedInIntegration":false,"FCB.Moca.AppLinking":true,"FCB.CustomControlIshSupport":false,"FCB.SMBImport":true,"FCB.Moca.InteractionCentricMultiEntityChartsFeature":true,"FCB.SimilarityRule":false,"FCB.WorkflowAllowStepsDeletion":false,"FCB.EnableMultipleContactResolution":true,"FCB.ACIForEmailEngagement":false,"FCB.OnDemandWorkflowUCI":true,"FCB.ProductRecommendationsStaging":false,"FCB.BackStackForTurboForm":false,"FCB.BPFBusinessRuleConditions":true,"FCB.TaskBasedFlowCustomControls":false,"FCB.BatchSSSOutgoingEmails":false,"FCB.CanvasAppEmbedding.EnableAppToHostCommunication":true,"FCB.InAppSupport":false,"FCB.FullTextSearch":false,"FCB.AppDesignerICDashboards":true,"FCB.OrgChart":true,"FCB.Moca.DeviceIntegration":true,"FCB.EnableLanguageProvisioningStagedCommits":true,"FCB.SolutionFrameworkV2":false,"FCB.ElasticSearch":true,"FCB.LanguagePackUpdateMaintenanceJob":false,"FCB.PowerBI.PowerBIEmbed":true,"FCB.AppConfigForOrganization":true,"FCB.EnableUserSettingsThroughSequence":false,"FCB.AppDesigner.WelcomePage":true,"FCB.ProcessWithGraphJustInTime":true,"FCB.OfficeMailApp":true,"FCB.Moca.InteractionCentricLookupAutoResolve":true,"FCB.RelationshipAssisstantFeature1":false,"FCB.Theme":true,"FCB.EnableReadCommittedTransactions":false,"FCB.TaskBasedFlowSolutionAware":true,"FCB.NativeWebSessionCookie.SkipOrgCheck":false,"FCB.DataTierPerf.UseAdditionalPOAData":true,"FCB.SSSSynchronousEws":false,"FCB.IncrementalSyncSelectors":true,"FCB.CustomControlViewSupport":true,"FCB.ManagedWorkflowDeletionValidation":true,"FCB.EmailEngagementComposeForUCI":true,"FCB.MetadataDrivenDialog":false,"FCB.SSSReliablePromote":true,"FCB.EnableSolutionLayeringForRibbonDepdendencies":false,"FCB.HierarchicalRelationship":true,"FCB.PipelineExecutionTraceLogging":true,"FCB.ChatOnWebClient":false,"FCB.EditableGridControlPbl":true,"FCB.DocumentTemplateUCI":false,"FCB.UseRecompileHintForLeadingWildcardQuickFind":false,"FCB.OnePartyModel":false,"FCB.MSTeamsIntegrationSetting":false,"FCB.MobileOffline":false,"FCB.FormDesigner":true,"FCB.RIThirdPartySolution":true,"FCB.PotassiumAppForOutlook":true,"FCB.EmailSignature":true,"FCB.AuditSqlRead":true,"FCB.PreviewApril2019":false,"FCB.SkipRemovingOrgNameFromURIPath":false,"FCB.EnableReparentingForProduct":false,"FCB.SSSReliabilityAutoApprove":true,"FCB.Moca.MobileClientTheming":true,"FCB.XrmTelemetryEnabledForClientMetadataSync":false,"FCB.NoLongerInOrg":false,"FCB.EnableModernFlowProcessEntities":true,"FCB.DupUsersOnSalesTeam":false,"FCB.PredictiveLeadScoring":false,"FCB.DisablePublishingSystemUserAuthRecordsToGeo":false,"FCB.OrgInsights":true,"FCB.Moca.AssociatedGridURLAddressability":true,"FCB.EnableBPFNonDefaultCustomControls":false,"FCB.ExportSelectedToExcel":false,"FCB.EnableReusePluginTypeIdForDifferentPluginAssembly":true,"FCB.OfflineProfileRuleEnhancementsORSupportForProfileItemAssociation":true,"FCB.BrowserOfflineEnabledForTest":false,"FCB.ForceStrongNamePluginAssemblyRuntime":false,"FCB.AppDesigner.MobileOffline":true,"FCB.TaskBasedFlow":true,"FCB.PersistDatabaseFunctionMitigationsThroughDBUpdate":true,"FCB.MailAppModuleAccountViewSelector":false,"FCB.SkipSampleDataLivePlatformCall":true,"FCB.ReferencePanelControl":true,"FCB.MailAppTile":true,"FCB.IgnoreHttpsValidationForSandboxRequest":true,"FCB.WidgetManager":true,"FCB.OrToUnion":false,"FCB.EnableBulkDeleteParallel":false,"FCB.QuickFindSearchOnISH":true,"FCB.OfficeGraphIntegration":false,"FCB.AllowExcelBrowserCache":false,"FCB.AllowNotInAdvancedFind":true,"FCB.PowerBI.TenantAuth":false,"FCB.EnableMetadataServiceVNextforDbUpdates":false,"FCB.WebhookEndpoint":true,"FCB.EnableBPFApprovalFlows":false,"FCB.EnableAppModuleEventHandlers":true,"FCB.ThrowErrorIfTransactionCurrencyIsInvalid":true,"FCB.DataPerformanceDashboard":true,"FCB.AppModuleOnUCI":false,"FCB.SdkListener.Throttling":true,"FCB.EnableStagedComponents":false,"FCB.KMSimpleRelevanceSearch":false,"FCB.UCIByDefault":true,"FCB.DisableSandboxPlugin":false,"FCB.SkypeForBusiness":true,"FCB.ExportToExcelUCI":true,"FCB.AutoEnableBusinessProcessForCDSEntities":true,"FCB.PredictiveLeadScoringFeatureSelection":false,"FCB.GlobalDiscoEntitySync":false,"FCB.Moca.Offline":false,"FCB.SLAV2":true,"FCB.LatencyAndBandwidth":true,"FCB.MarsLegacyClientEnabled":false,"FCB.DependentOptionSetSgFCB":false};
var IsActionCardEnabled = false;
var CUSTOMIZED_HELP_ENABLED = false;
var _bIsOsdpOrg = true;
var IS_LIVE = true;
var IS_ONPREMISE = false;
var IS_SPLA = false;
var IS_CLAIMS = true;
var UseTabletExperience = false;
var _ErrorCodesIsvAborted = '0x80040265';
var ScriptErrorReportingPreference = 1;
var _bPresenceEnabled = true;
var LOCID_PRESENCE_AVAILABLE = 'Available';
var LOCID_PRESENCE_OFFLINE = 'Offline';
var LOCID_PRESENCE_AWAY = 'Away';
var LOCID_PRESENCE_BUSY = 'Busy';
var LOCID_PRESENCE_INCALL = 'In a call';
var LOCID_PRESENCE_INMEETING = 'In a meeting';
var LOCID_PRESENCE_OUTOFOFFICE = 'Out of office';
var LOCID_PRESENCE_UNKNOWN = 'Presence unknown';
var AUTO_SAVE_ENABLED = true;
var ENABLE_MICROSOFT_FLOW_INTEGRATION = true;
var MICROSOFT_FLOW_INTEGRATED_ENVIRONMENT = '';
var MICROSOFT_FLOW_FIRSTPARTYINTEGRATION_SITE_URL = 'https\x3a\x2f\x2fwww.crmdynint.com\x2fMicrosoftFlows\x2f9.0\x2fRuntime.html\x3fuserId\x3dalby\x40nmo.org.nz\x26env\x3dprod\x26flowLocale\x3den-nz\x26tenantId\x3d169cad8d-2393-41ee-aed6-2f18d780cc38';
var MICROSOFT_FLOW_DESTINATIONURL = 'https\x3a\x2f\x2fwww.crmdynint.com';
var DISPLAY_NAVIGATION_TOUR = true;
var DISPLAY_TURBO_FORM = true;
var METADATA_TIMESTAMP = '1144437';
var USER_TIMESTAMP = '131967477144549958';
var ChangeDoubleQuoteToSingleQuote = false;
var MakeSocialPanePhoneCallCompleted = true;
var EmailEditorSkipNewLineInIE = false;
var ORG_BASE_CURRENCY_ID = '0aac8fad-723c-e911-a864-000d3ae0e155';
var ORG_DEFAULT_COUNTRY_CODE = '';
var ORG_LANGUAGE_CODE = 1033;
var ORG_MAX_CHILD_INCIDENT_NUMBER = 100;
var ORG_MAX_INCIDENT_MERGE_NUMBER = 10;
var ORG_FULLNAME_FORMAT = 1;
var ORG_SKYPE_PROTOCOL = true;
var ORG_IS_APP_MODE = false;
var SERVER_URL = 'https\x3a\x2f\x2ftehi.crm6.dynamics.com\x2f';
var AUTHENTICATION_TYPE = 3;
var CRM2007_WEBSERVICE_NS = 'http\x3a\x2f\x2fschemas.microsoft.com\x2fcrm\x2f2007\x2fWebServices';
var CRM2007_CORETYPES_NS = 'http\x3a\x2f\x2fschemas.microsoft.com\x2fcrm\x2f2007\x2fCoreTypes';
var CURRENT_THEME_TYPE = 'Outlook15White';
var CURRENT_WEB_THEME = 'Default';
var RefreshFormTheme = 'Outlook15White';
var USER_DEFAULT_COUNTRY_CODE = '';
var USER_ROLES = ['2c56d7ff-633c-e911-a864-000d3ae0e155', 'c281cf05-643c-e911-a864-000d3ae0e155'];
var USER_TRANSACTION_CURRENCY_ID = '0aac8fad-723c-e911-a864-000d3ae0e155';
var USER_GUID = '\x7bC96EA530-84BE-48D7-B6EE-FF4B21CAB67E\x7d';
var USER_NAME = 'Alby Bott';
var USER_LANGUAGE_TWO_LETTER_NAME = 'en';
var USER_IS_GUIDED_HELP_ENABLED = true;
var VERBOSELOG_MAXMAILBOX = 5;
var ORG_DATE_START_DAY = 0;
var USER_DATE_FORMATSTRING = 'd\x2fMM\x2fyyyy';
var USER_DATE_SEPARATOR = '\x2f';
var USER_DATE_FORMATTED_FORMATSTRING = 'd\x2fMM\x2fyyyy';
var USER_DATE_START_DAY = 0;
var USER_TIME_FORMAT = 'h\x3amm tt';
var USER_SHOW_WEEK_NUMBER = false;
var ORG_TIMEZONE_OFFSET = 780;
var ORG_TIMEZONE_OFFSET_STRING = 780;
var USER_TIMEZONE_OFFSET = 780;
var USER_TIMEZONE_OFFSET_STRING = 780;
var __cultureInfo = {"dateTimeFormat":{"AMDesignator":"AM","Calendar":{"MinSupportedDateTime":"0001-01-01T00:00:00","MaxSupportedDateTime":"9999-12-31T23:59:59.9999999","AlgorithmType":1,"CalendarType":1,"Eras":[1],"TwoDigitYearMax":2029,"IsReadOnly":false},"DateSeparator":"/","FirstDayOfWeek":0,"CalendarWeekRule":0,"FullDateTimePattern":"dddd, d MMMM yyyy h:mm:ss tt","LongDatePattern":"dddd, d MMMM yyyy","LongTimePattern":"h:mm:ss tt","MonthDayPattern":"dd MMMM","PMDesignator":"PM","RFC1123Pattern":"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'","ShortDatePattern":"d/MM/yyyy","ShortTimePattern":"h:mm tt","SortableDateTimePattern":"yyyy'-'MM'-'dd'T'HH':'mm':'ss","TimeSeparator":":","UniversalSortableDateTimePattern":"yyyy'-'MM'-'dd HH':'mm':'ss'Z'","YearMonthPattern":"MMMM yyyy","AbbreviatedDayNames":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"ShortestDayNames":["Su","Mo","Tu","We","Th","Fr","Sa"],"DayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"AbbreviatedMonthNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"IsReadOnly":false,"NativeCalendarName":"Gregorian Calendar","AbbreviatedMonthGenitiveNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthGenitiveNames":["January","February","March","April","May","June","July","August","September","October","November","December",""]},"eras":[1,"AD",null,0],"name":"en-NZ","numberFormat":{"CurrencyDecimalDigits":2,"CurrencyDecimalSeparator":".","IsReadOnly":false,"CurrencyGroupSizes":[3],"NumberGroupSizes":[3],"PercentGroupSizes":[3],"CurrencyGroupSeparator":",","CurrencySymbol":"$","NaNSymbol":"NaN","CurrencyNegativePattern":1,"NumberNegativePattern":1,"PercentPositivePattern":1,"PercentNegativePattern":1,"NegativeInfinitySymbol":"-","NegativeSign":"-","NumberDecimalDigits":2,"NumberDecimalSeparator":".","NumberGroupSeparator":",","CurrencyPositivePattern":0,"PositiveInfinitySymbol":"","PositiveSign":"+","PercentDecimalDigits":2,"PercentDecimalSeparator":".","PercentGroupSeparator":",","PercentSymbol":"%","PerMilleSymbol":"","NativeDigits":["0","1","2","3","4","5","6","7","8","9"],"DigitSubstitution":1}};
var HELP_SERVER_URL = 'http\x3a\x2f\x2frc.crm.dynamics.com\x2frc\x2fredir\x2fcrm\x2f';
var HELP_REDIRECT_AVAILABLE = true;
var WEB_SERVER_HOST = 'tehi.crm6.dynamics.com';
var WEB_SERVER_PORT = 443;
var APPLICATION_VERSION = '9.1';
var APPLICATION_FULL_VERSION = '9.1.0.3032';
var IMAGE_STRIPS_ENABLED = true;
var DEF_SOL_ID = '\x7bfd140aaf-4df4-11dd-bd17-0019b9312238\x7d';
var CRM_ONLINE_LEGAL_LINK = 'https\x3a\x2f\x2fgo.microsoft.com\x2ffwlink\x2f\x3fLinkID\x3d226323\x26clcid\x3d0x409';
var CRM_ONLINE_PRIVACY_LINK = 'https\x3a\x2f\x2fgo.microsoft.com\x2ffwlink\x2f\x3fLinkId\x3d226324\x26clcid\x3d0x409';
var IsOneDriveEnabledOnOrgSettings = false;
var IsRelevanceSearchEnabledInOrgSettings = false;
var IsCustomSearchEnabled = false;
var DefaultSearchUserSettings = '2';
var SocialPaneQueryHint = -1;
var MARKERS_CACHE_ID = '83d727e3-0ca7-4edd-9e67-94a27004d81b';
var MAX_INCIDENT_MERGE_NUMBER = '10';
var MAX_CHILD_INCIDENT_NUMBER = '100';
var _sWebServicesNamespace = 'http\x3a\x2f\x2fschemas.microsoft.com\x2fcrm\x2f2009\x2fWebServices';
var ERRORCODE_ETM = '0x8004A001';
var EDIT_PRELOAD = true;
var _aWrpcTokens = {};
var initialFormXml = '';
var APP_SOLUTION_ID = '';
var LOCID_UNSAVEDCHANGES = 'unsaved changes';
var LOCID_SAVING = 'saving';
var LOCID_READONLY = 'Read only';
var LOCID_MISSINGREQUIREDFIELDS = 'required fields missing';
var LOCID_TITLE_GLOBAL_QUICKCREATE = 'Quick Create\x3a';
var LOCID_SAVE_GLOBAL_QUICKCREATE = 'Save';
var LOCID_CANCEL_GLOBAL_QUICKCREATE = 'Cancel';
var _resourceStrings = {};
</script>
<script type="text/javascript" src="./pageloader.js.download"></script>
<script type="text/javascript" src="./MicrosoftAjax.js.download"></script>
<script type="text/javascript" src="./crminternalutility.js.download"></script>
<script type="text/javascript">
window.initActionQueueParams = {};
function SetPLTMarker()
{
window.SetPLTMarker = (new Date()).getTime();
if(!window.PostRenderTime){window.PostRenderTime = (new Date()).getTime();}
}
function LoadGlobalJSAndScriptResourceJS()
{
window.LoadGlobalJSAndScriptResourceJS = (new Date()).getTime();
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fMicrosoftAjax.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fMicrosoftAjax.js\x3fver\x3d1888157098', false, function() {
 loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fEncodeDecode.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fEncodeDecode.js\x3fver\x3d1888157098', false, function() {
  loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fMicrosoft.Crm.Client.Core.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fMicrosoft.Crm.Client.Core.js\x3fver\x3d1888157098', false, function() {
Microsoft.Crm.Client.Core.SharedScript.loadAsync(window, '\x2f_static\x2f_common\x2fscripts\x2fCrmServiceProxy.js\x3fver\x3d1888157098', function(host){
	Type.registerNamespace('Microsoft.Crm.Client');
	Type.registerNamespace('Xrm');

	window.Microsoft.Crm.Client.Core = host.Microsoft.Crm.Client.Core;
	window.Xrm.Soap = host.Xrm.Soap;
	window.Xrm.Gen = host.Xrm.Gen;
}, function (win, success) { win.loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fCrmServiceProxy.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fCrmServiceProxy.js\x3fver\x3d1888157098', false, success); }, function() {
 Microsoft.Crm.Client.Core.SharedScript.loadAsync(window, '\x2f_static\x2f_common\x2fscripts\x2fCrmServiceProxyFramework.js\x3fver\x3d1888157098', function(host){
	Type.registerNamespace('Microsoft.Crm.Client');
	Type.registerNamespace('Xrm');

	window.Microsoft.Crm.Client.Core = host.Microsoft.Crm.Client.Core;
	window.Xrm.Soap = host.Xrm.Soap;
	window.Xrm.Gen = host.Xrm.Gen;
	window.Xrm.Sdk = host.Xrm.Sdk;
	window.Xrm.Objects = host.Xrm.Objects;
	window._Math = host._Math;
	window._Script = host._Script;
}, function (win, success) { win.loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fCrmServiceProxyFramework.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fCrmServiceProxyFramework.js\x3fver\x3d1888157098', false, success); }, function() {
loadScriptAdv('\x2f_common\x2fglobal.ashx\x3fver\x3d1888157098', '\x2f_common\x2fglobal.ashx\x3fver\x3d1888157098', false, function() {
});
 });
});
  });
 });
});
loadScriptAdv('\x2f_common\x2fScriptResx.ashx\x3flcid\x3d1033\x26ver\x3d1888157098', '\x2f_common\x2fScriptResx.ashx\x3flcid\x3d1033\x26ver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fjquery-2.1.1.min.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fjquery-2.1.1.min.js\x3fver\x3d1888157098', false);

}
function WaitGlobalJSAndScriptResourceJsScriptsToLoad()
{
window.WaitGlobalJSAndScriptResourceJsScriptsToLoad = (new Date()).getTime();
waitForJScriptsToLoad();
}
function LoadJsScripts()
{
window.LoadJsScripts = (new Date()).getTime();
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fjquery-2.1.1.min.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fjquery-2.1.1.min.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_common\x2fentityproperties\x2fentitypropertiesutil.js.aspx\x3flcid\x3d1033\x26tstamp\x3d1144437\x26ver\x3d1888157098', '\x2f_common\x2fentityproperties\x2fentitypropertiesutil.js.aspx\x3flcid\x3d1033\x26tstamp\x3d1144437\x26ver\x3d1888157098', false);
loadScriptAdv('\x2f_common\x2fEntitiesCustomizedHelp\x2fEntitiesCustomizedHelp.js.aspx\x3ftstamp\x3d1144437\x26ver\x3d1888157098', '\x2f_common\x2fEntitiesCustomizedHelp\x2fEntitiesCustomizedHelp.js.aspx\x3ftstamp\x3d1144437\x26ver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fes6-shim.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fes6-shim.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fperformanceui.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fperformanceui.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fcrminternalutility.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fcrminternalutility.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fperformance.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fperformance.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fmaxsessionmonitor.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fmaxsessionmonitor.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fstage.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fstage.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_root\x2fhomepage.js\x3fver\x3d1888157098', '\x2f_static\x2f_root\x2fhomepage.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_forms\x2fform.js\x3fver\x3d1888157098', '\x2f_static\x2f_forms\x2fform.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_forms\x2fselect.js\x3fver\x3d1888157098', '\x2f_static\x2f_forms\x2fselect.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_grid\x2fGridControl.js\x3fver\x3d1888157098', '\x2f_static\x2f_grid\x2fGridControl.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_controls\x2fHintText\x2fHintText.js\x3fver\x3d1888157098', '\x2f_static\x2f_controls\x2fHintText\x2fHintText.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fglowingimage.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fglowingimage.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_controls\x2fcommandbar\x2fcommandbar.js\x3fver\x3d1888157098', '\x2f_static\x2f_controls\x2fcommandbar\x2fcommandbar.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_controls\x2fpane\x2fvisualizationpane.js\x3fver\x3d1888157098', '\x2f_static\x2f_controls\x2fpane\x2fvisualizationpane.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_controls\x2fmenuselector\x2fmenuselector.js\x3fver\x3d1888157098', '\x2f_static\x2f_controls\x2fmenuselector\x2fmenuselector.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2fvisualization\x2fvisualizationactions.js\x3fver\x3d1888157098', '\x2f_static\x2fvisualization\x2fvisualizationactions.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_controls\x2fGridFilters\x2fGridFilters.js\x3fver\x3d1888157098', '\x2f_static\x2f_controls\x2fGridFilters\x2fGridFilters.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fmscrm.caching.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fmscrm.caching.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_controls\x2flookup\x2flookup.js\x3fver\x3d1888157098', '\x2f_static\x2f_controls\x2flookup\x2flookup.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_forms\x2flookupbehavior.js\x3fver\x3d1888157098', '\x2f_static\x2f_forms\x2flookupbehavior.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_grid\x2fDataSetControl.js\x3fver\x3d1888157098', '\x2f_static\x2f_grid\x2fDataSetControl.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_forms\x2fcheckbox.js\x3fver\x3d1888157098', '\x2f_static\x2f_forms\x2fcheckbox.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_forms\x2ftextinputbehavior.js\x3fver\x3d1888157098', '\x2f_static\x2f_forms\x2ftextinputbehavior.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_controls\x2fribbon\x2fribbon.js\x3fver\x3d1888157098', '\x2f_static\x2f_controls\x2fribbon\x2fribbon.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fribbonactions.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fribbonactions.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fcommandbaractions.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fcommandbaractions.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_controls\x2fribbon\x2fRibbonLayout.js.aspx\x3fcb\x3dtrue\x26econtext\x3dHomePageGrid\x26etn\x3dnmo_referral\x26hierarchy\x3d00000000-0000-0000-0000-000000000000\x26id\x3dMscrm.CommandBar\x26ie\x3d0\x26ise\x3d1\x26lcid\x3d1033\x26mver\x3d1144437\x26oc\x3d0\x26page\x3d\x252f_ROOT\x252fHOMEPAGE.ASPX\x26relName\x3d\x26relType\x3dNoRelationship\x26rver\x3d-276374248\x26ver\x3d1888157098\x26wrdepver\x3deafa556b3e344e65a63e67ab5dc1e66f', '\x2f_controls\x2fribbon\x2fRibbonLayout.js.aspx\x3fcb\x3dtrue\x26econtext\x3dHomePageGrid\x26etn\x3dnmo_referral\x26hierarchy\x3d00000000-0000-0000-0000-000000000000\x26id\x3dMscrm.CommandBar\x26ie\x3d0\x26ise\x3d1\x26lcid\x3d1033\x26mver\x3d1144437\x26oc\x3d0\x26page\x3d\x252f_ROOT\x252fHOMEPAGE.ASPX\x26relName\x3d\x26relType\x3dNoRelationship\x26rver\x3d-276374248\x26ver\x3d1888157098\x26wrdepver\x3deafa556b3e344e65a63e67ab5dc1e66f', false);
loadScriptAdv('\x2f_static\x2f_common\x2fscripts\x2fpresence.js\x3fver\x3d1888157098', '\x2f_static\x2f_common\x2fscripts\x2fpresence.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_grid\x2faction.js\x3fver\x3d1888157098', '\x2f_static\x2f_grid\x2faction.js\x3fver\x3d1888157098', false);
loadScriptAdv('\x2f_static\x2f_forms\x2faddrelated.js\x3fver\x3d1888157098', '\x2f_static\x2f_forms\x2faddrelated.js\x3fver\x3d1888157098', false);

}
function WaitRemainingJsScriptsToLoad()
{
window.WaitRemainingJsScriptsToLoad = (new Date()).getTime();
waitForJScriptsToLoad();
}
function InitControls()
{
window.InitControls = (new Date()).getTime();
Sys.Application.beginCreateComponents();
crmCreate(Mscrm.GridSizeCalculator,{"subscribedEvents":[9]},null,{"eventManager":"__Page_crmEventManager"},$get('homepageTableCell'));
crmCreate(Mscrm.PageManager,{"id":"crmPageManager","mode":"iframe","executeDeferredActionsOnDemand":false,"deferredActionList":[],"deferredActionParameters":[],"pageOnLoadScriptList":[],"rootElement":""},null,{"eventManager":"__Page_crmEventManager"},null);
crmCreate(Mscrm.EventManager,{"eventSubscribers":[],"childEventManagerIds":null,"parentEventManagerId":"","id":"__Page_crmEventManager"},null,{},null);
crmCreate(Mscrm.GridViewSelector,{"showNewVSControl":true,"showOriginalSelectBox":false,"viewEntityName":"nmo_referral","selectedSavedQuery":"\x7b4EE94837-6992-4B74-95AE-A22250E92904\x7d","selectedSavedQueryName":"Active Referrals","selectedSavedQueryType":"1039","userSelectedDefaultView":"","userOwnedView":"","quickFindQuery":"\x7b9106A0C2-A4A3-4DBD-8226-264A45A75805\x7d","createPersonalViewEnabled":true,"saveFilterOptionsEnabled":true,"systemViewsXml":"\x3csavedqueries morerecords\x3d\x220\x22 totalrecordcount\x3d\x223\x22 totalrecordcountlimitexceeded\x3d\x220\x22\x3e\x3csavedquery\x3e\x3csavedqueryid\x3e\x7b4EE94837-6992-4B74-95AE-A22250E92904\x7d\x3c\x2fsavedqueryid\x3e\x3cmodifiedon date\x3d\x227\x2f03\x2f2019\x22 time\x3d\x227\x3a03 PM\x22\x3e2019-03-07T19\x3a03\x3a41\x2b13\x3a00\x3c\x2fmodifiedon\x3e\x3cfetchxml\x3e\x26lt\x3bfetch version\x3d\x221.0\x22 mapping\x3d\x22logical\x22\x26gt\x3b\x26lt\x3bentity name\x3d\x22nmo_referral\x22\x26gt\x3b\x26lt\x3battribute name\x3d\x22nmo_name\x22 \x2f\x26gt\x3b\x26lt\x3border attribute\x3d\x22nmo_name\x22 descending\x3d\x22false\x22 \x2f\x26gt\x3b\x26lt\x3bfilter type\x3d\x22and\x22\x26gt\x3b\x26lt\x3bcondition attribute\x3d\x22statecode\x22 operator\x3d\x22eq\x22 value\x3d\x220\x22 \x2f\x26gt\x3b\x26lt\x3b\x2ffilter\x26gt\x3b\x26lt\x3battribute name\x3d\x22nmo_datereceived\x22 \x2f\x26gt\x3b\x26lt\x3battribute name\x3d\x22nmo_clientid\x22 \x2f\x26gt\x3b\x26lt\x3battribute name\x3d\x22nmo_referralid\x22 \x2f\x26gt\x3b\x26lt\x3b\x2fentity\x26gt\x3b\x26lt\x3b\x2ffetch\x26gt\x3b\x3c\x2ffetchxml\x3e\x3cquerytype formattedvalue\x3d\x220\x22\x3e0\x3c\x2fquerytype\x3e\x3cisquickfindquery name\x3d\x22No\x22\x3efalse\x3c\x2fisquickfindquery\x3e\x3cname\x3eActive Referrals\x3c\x2fname\x3e\x3cisdefault name\x3d\x22Yes\x22\x3etrue\x3c\x2fisdefault\x3e\x3c\x2fsavedquery\x3e\x3csavedquery\x3e\x3csavedqueryid\x3e\x7bF518105F-C2A6-4B52-82AD-829B53F1F541\x7d\x3c\x2fsavedqueryid\x3e\x3cmodifiedon date\x3d\x226\x2f03\x2f2019\x22 time\x3d\x222\x3a37 PM\x22\x3e2019-03-06T14\x3a37\x3a47\x2b13\x3a00\x3c\x2fmodifiedon\x3e\x3cfetchxml\x3e\x26lt\x3bfetch version\x3d\x221.0\x22 mapping\x3d\x22logical\x22\x26gt\x3b\x26lt\x3bentity name\x3d\x22nmo_referral\x22\x26gt\x3b\x26lt\x3battribute name\x3d\x22nmo_referralid\x22 \x2f\x26gt\x3b\x26lt\x3battribute name\x3d\x22nmo_name\x22 \x2f\x26gt\x3b\x26lt\x3battribute name\x3d\x22createdon\x22 \x2f\x26gt\x3b\x26lt\x3border attribute\x3d\x22nmo_name\x22 descending\x3d\x22false\x22 \x2f\x26gt\x3b\x26lt\x3bfilter type\x3d\x22and\x22\x26gt\x3b\x26lt\x3bcondition attribute\x3d\x22statecode\x22 operator\x3d\x22eq\x22 value\x3d\x221\x22 \x2f\x26gt\x3b\x26lt\x3b\x2ffilter\x26gt\x3b\x26lt\x3b\x2fentity\x26gt\x3b\x26lt\x3b\x2ffetch\x26gt\x3b\x3c\x2ffetchxml\x3e\x3cquerytype formattedvalue\x3d\x220\x22\x3e0\x3c\x2fquerytype\x3e\x3cisquickfindquery name\x3d\x22No\x22\x3efalse\x3c\x2fisquickfindquery\x3e\x3cname\x3eInactive Referrals\x3c\x2fname\x3e\x3cisdefault name\x3d\x22No\x22\x3efalse\x3c\x2fisdefault\x3e\x3c\x2fsavedquery\x3e\x3csavedquery\x3e\x3csavedqueryid\x3e\x7b9106A0C2-A4A3-4DBD-8226-264A45A75805\x7d\x3c\x2fsavedqueryid\x3e\x3cmodifiedon date\x3d\x226\x2f03\x2f2019\x22 time\x3d\x222\x3a37 PM\x22\x3e2019-03-06T14\x3a37\x3a58\x2b13\x3a00\x3c\x2fmodifiedon\x3e\x3cfetchxml\x3e\x26lt\x3bfetch version\x3d\x221.0\x22 mapping\x3d\x22logical\x22\x26gt\x3b\x26lt\x3bentity name\x3d\x22nmo_referral\x22\x26gt\x3b\x26lt\x3battribute name\x3d\x22nmo_referralid\x22 \x2f\x26gt\x3b\x26lt\x3battribute name\x3d\x22nmo_name\x22 \x2f\x26gt\x3b\x26lt\x3battribute name\x3d\x22createdon\x22 \x2f\x26gt\x3b\x26lt\x3border attribute\x3d\x22nmo_name\x22 descending\x3d\x22false\x22 \x2f\x26gt\x3b\x26lt\x3bfilter type\x3d\x22and\x22\x26gt\x3b\x26lt\x3bcondition attribute\x3d\x22statecode\x22 operator\x3d\x22eq\x22 value\x3d\x220\x22 \x2f\x26gt\x3b\x26lt\x3b\x2ffilter\x26gt\x3b\x26lt\x3bfilter type\x3d\x22or\x22 isquickfindfields\x3d\x221\x22\x26gt\x3b\x26lt\x3bcondition attribute\x3d\x22nmo_name\x22 operator\x3d\x22like\x22 value\x3d\x22\x7b0\x7d\x22 \x2f\x26gt\x3b\x26lt\x3b\x2ffilter\x26gt\x3b\x26lt\x3b\x2fentity\x26gt\x3b\x26lt\x3b\x2ffetch\x26gt\x3b\x3c\x2ffetchxml\x3e\x3cquerytype formattedvalue\x3d\x224\x22\x3e4\x3c\x2fquerytype\x3e\x3cisquickfindquery name\x3d\x22Yes\x22\x3etrue\x3c\x2fisquickfindquery\x3e\x3cname\x3eQuick Find Active Referrals\x3c\x2fname\x3e\x3cisdefault name\x3d\x22Yes\x22\x3etrue\x3c\x2fisdefault\x3e\x3c\x2fsavedquery\x3e\x3c\x2fsavedqueries\x3e","userViewsXml":"","systemViewsLabel":"System Views","userViewsLabel":"My Views","customViewsLabel":"Custom Views","renderForPrint":false,"isActivitiesViewSelector":false,"activityList":[{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"All Activities","TypeCode":4200,"TypeDisplayName":null,"TypeName":"activitypointer"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Task","TypeCode":4212,"TypeDisplayName":null,"TypeName":"task"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Fax","TypeCode":4204,"TypeDisplayName":null,"TypeName":"fax"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Phone Call","TypeCode":4210,"TypeDisplayName":null,"TypeName":"phonecall"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Email","TypeCode":4202,"TypeDisplayName":null,"TypeName":"email"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Letter","TypeCode":4207,"TypeDisplayName":null,"TypeName":"letter"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Appointment","TypeCode":4201,"TypeDisplayName":null,"TypeName":"appointment"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Service Activity","TypeCode":4214,"TypeDisplayName":null,"TypeName":"serviceappointment"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Campaign Response","TypeCode":4401,"TypeDisplayName":null,"TypeName":"campaignresponse"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Campaign Activity","TypeCode":4402,"TypeDisplayName":null,"TypeName":"campaignactivity"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Recurring Appointment","TypeCode":4251,"TypeDisplayName":null,"TypeName":"recurringappointmentmaster"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Social Activity","TypeCode":4216,"TypeDisplayName":null,"TypeName":"socialactivity"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Survey invite","TypeCode":10033,"TypeDisplayName":null,"TypeName":"msfp_surveyinvite"},{"Action":null,"Id":"00000000-0000-0000-0000-000000000000","Name":"Survey response","TypeCode":10034,"TypeDisplayName":null,"TypeName":"msfp_surveyresponse"}],"selectOptionsXml":"\x3cselect  GridId\x3d\x22crmGrid\x22 quickFindQuery\x3d\x22\x7b9106A0C2-A4A3-4DBD-8226-264A45A75805\x7d\x22 id\x3d\x22crmGrid_SavedNewQuerySelector\x22 name\x3d\x22crmGrid_SavedNewQuerySelector\x22 class\x3d\x22ms-crm-SelectBox\x26\x2332\x3b\x22 onchange\x3d\x22handleView\x28this,\x26\x2332\x3b\x24find\x28\x26\x2339\x3bcrmGrid\x26\x2339\x3b\x29\x29\x22\x3e\x3cOPTGROUP  LABEL\x3d\x22System\x26\x2332\x3bViews\x22 id\x3d\x22AppSystemViews\x22\x3e\x3coption value\x3d\x22\x7b4EE94837-6992-4B74-95AE-A22250E92904\x7d\x22 Type\x3d\x221039\x22 title\x3d\x22Active\x26\x2332\x3bReferrals\x22\x3eActive Referrals\x3c\x2foption\x3e\x3coption value\x3d\x22\x7bF518105F-C2A6-4B52-82AD-829B53F1F541\x7d\x22 Type\x3d\x221039\x22 title\x3d\x22Inactive\x26\x2332\x3bReferrals\x22\x3eInactive Referrals\x3c\x2foption\x3e\x3c\x2fOPTGROUP\x3e\x3c\x2fselect\x3e","createPersonalViewLabel":"Create Personal View","saveFiltersAsNewViewLabel":"Save Filters as New View","saveFiltersToCurrentViewLabel":"Save Filters to Current View","onDefaultViewToolTip":"Default view for this list","setDefaultViewToolTip":"Pin this view as the default view for this list","gridFiltersEnabled":true,"subscribedEvents":[62,14,47,92,91]},null,{"eventManager":"__Page_crmEventManager","rootManager":"crmPageManager"},$get('crmGrid_SavedNewQuerySelector'));
crmCreate(Mscrm.QuickFindControl,null,null,null,$get('crmGrid_quickFindContainer'));
crmCreate(Mscrm.HintText,{},null,{},$get('crmGrid_findCriteria'));
crmCreate(Mscrm.GlowingImage,{},null,{},$get('crmGrid_findCriteriaImg'));
crmCreate(Mscrm.GlowingImage,{},null,{},$get('crmGrid_clearCriteriaImg'));
crmCreate(Microsoft.Crm.CommandBar.MenuBarControl,{},null,{},$get('mnuBar1'));
crmCreate(Mscrm.CompositeControlResizeControl,{"subscribedEvents":[27,26,28,9,70,74,53]},null,{"eventManager":"__Page_crmEventManager","rootManager":"crmPageManager"},$get('crmGrid_splitTD'));
crmCreate(Mscrm.CompositeControl,{"subscribedEvents":[27,26,28,9,70,74,53]},null,{"eventManager":"__Page_crmEventManager","rootManager":"crmPageManager"},$get('crmGrid_visualizationCompositeControl'));
crmCreate(Mscrm.FilterSet,{},null,{},$get('crmGrid_filterSet'));
crmCreate(Mscrm.GridControl,{"subscribedEvents":[42,4,50,95,38,9,87]},null,{"eventManager":"__Page_crmEventManager","rootManager":"crmPageManager"},$get('crmGrid'));
crmCreate(Mscrm.StringFilterPopup,{},null,{},$get('stringFilterPopupcrmGridnmo_referralnmo_name'));
crmCreate(Mscrm.FormInputControl.PresenceLookupUIBehavior,{},null,{},$get('lookup_lookupFilterPopupcrmGridnmo_referralnmo_clientid'));
crmCreate(Mscrm.LookupFilterPopup,{},null,{},$get('lookupFilterPopupcrmGridnmo_referralnmo_clientid'));
crmCreate(Mscrm.DateTimeFilterPopup,{},null,{},$get('datetimeFilterPopupcrmGridnmo_referralnmo_datereceived'));
crmCreate(Mscrm.VisualizationPane,{},null,{"eventManager":"__Page_crmEventManager","rootManager":"crmPageManager"},$get('crmGrid_paneControl'));
crmCreate(Mscrm.CommandBarData,{"serverInformation":{"CommandIds":["|NoRelationship||Mscrm.DynamicMenu.NewActivity.task","|NoRelationship||Mscrm.DynamicMenu.NewActivity.fax","|NoRelationship||Mscrm.DynamicMenu.NewActivity.phonecall","|NoRelationship||Mscrm.DynamicMenu.NewActivity.email","|NoRelationship||Mscrm.DynamicMenu.NewActivity.letter","|NoRelationship||Mscrm.DynamicMenu.NewActivity.appointment","|NoRelationship||Mscrm.DynamicMenu.NewActivity.serviceappointment","|NoRelationship||Mscrm.DynamicMenu.NewActivity.campaignresponse","|NoRelationship||Mscrm.DynamicMenu.NewActivity.recurringappointmentmaster","|NoRelationship||Mscrm.DynamicMenu.NewActivity.msfp_surveyinvite","|NoRelationship||Mscrm.DynamicMenu.NewActivity.msfp_surveyresponse","|NoRelationship||Mscrm.DynamicMenu.NewRecord.contact","|NoRelationship||Mscrm.DynamicMenu.NewRecord.account","|NoRelationship||Mscrm.DynamicMenu.NewRecord.nmo_referral","|NoRelationship||Mscrm.DynamicMenu.NewRecord.nmo_electronicsubmission","|NoRelationship||Mscrm.DynamicMenu.NewRecord.nmo_hbuevaluation","|NoRelationship||Mscrm.DynamicMenu.NewRecord.report","|NoRelationship||Mscrm.DynamicMenu.NewRecord.nmo_service","|NoRelationship||Mscrm.DynamicMenu.NewRecord.nmo_ethnicity","|NoRelationship||Mscrm.DynamicMenu.NewRecord.nmo_iwi","|NoRelationship||Mscrm.BasicHomeTab","|NoRelationship||Mscrm.Enabled","|NoRelationship||Mscrm.BasicHomeTabNew","|NoRelationship||Mscrm.DynamicMenu.NewActivity","|NoRelationship||Mscrm.DynamicMenu.NewRecord","|NoRelationship||Mscrm.ImportData","|NoRelationship||Mscrm.OpenAdvancedFind","|NoRelationship||Mscrm.OpenMultipleEntityQuickFindSearch","|NoRelationship||Mscrm.OutlookHelp","|NoRelationship||Mscrm.Ribbon.TabSwitch","|NoRelationship||Mscrm.Ribbon.RootEvent","|NoRelationship||Mscrm.Jewel","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Flows.TriggerFlow","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Flows.TriggerWorkflow","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ReportsMenu.NoReportsAvailable","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ReportsMenu.RunReport.Grid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DocumentTemplate.NoTemplatesAvailable","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DocumentTemplate.TemplatesMenu","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DocumentTemplate.CreateDocumentTemplate","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DocumentTemplate.OpenDocumentTemplateInExcelOnline","nmo_referral|NoRelationship|HomePageGrid|Mscrm.WordTemplate.NoTemplatesAvailable","nmo_referral|NoRelationship|HomePageGrid|Mscrm.WordTemplate.CreateWordTemplate.Grid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.WordTemplate.CreateWordTemplate.Form","nmo_referral|NoRelationship|HomePageGrid|Mscrm.WordTemplate.TemplatesMenu.Grid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.WordTemplate.TemplatesMenu.Form","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.{!EntityLogicalName}.MainTab","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.MainTab","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Enabled","nmo_referral|NoRelationship|HomePageGrid|Mscrm.NewRecordFromGrid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.NewRecordForBPFEntity","nmo_referral|NoRelationship|HomePageGrid|Mscrm.EditSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.Activate","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.Deactivate","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.OpenActiveStage","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.DeleteSplitButtonCommand","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DeleteSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.BulkDelete","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.DetectDupes","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.DetectDupesSelected","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.DetectDupesAll","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ChangeControlCommand","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DynamicMenu.ChangeControlCommand","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Modern.refreshCommand","nmo_referral|NoRelationship|HomePageGrid|Mscrm.NavigateToHomepageGrid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddEmailToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AssignSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ShareSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ViewHierarchyForSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.CopyShortcutSelected.EnabledInIEBrowser","nmo_referral|NoRelationship|HomePageGrid|Mscrm.CopyShortcutSelected","nmo_referral|NoRelationship|HomePageGrid|Mscrm.CopyShortcutView","nmo_referral|NoRelationship|HomePageGrid|Mscrm.SendShortcutSelected.AlwaysEnabled","nmo_referral|NoRelationship|HomePageGrid|Mscrm.SendShortcutSelected","nmo_referral|NoRelationship|HomePageGrid|Mscrm.SendShortcutView","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddConnectionGrid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddConnectionToMeGrid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddSelectedToQueue","nmo_referral|NoRelationship|HomePageGrid|Mscrm.RunWorkflowSelected","nmo_referral|NoRelationship|HomePageGrid|Mscrm.RunInteractiveWorkflowSelected","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Form.Flows","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DynamicMenu.Grid.Flows.PopulateMenu","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ReportMenu.Grid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ReportsMenu.Populate.Grid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DocumentTemplate.Templates","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DocumentTemplate.Populate.Flyout","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.WordTemplate","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.WordTemplate.Populate.Flyout","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ExportToExcel","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ExportToExcel.Online","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ExportToExcel.AllStaticXlsx","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ExportToExcel.StaticXlsx","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ExportToExcel.DynamicXlsx","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ExportToExcel.PivotXlsx","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ExportSelectedToExcel","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ImportDataFromExcel","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ImportDataFromCSV","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ImportDataSplitButton","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ImportData","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ExportDataTemplate","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Filters","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Filters.Query","nmo_referral|NoRelationship|HomePageGrid|Mscrm.OpenGridAdvancedFind","nmo_referral|NoRelationship|HomePageGrid|Mscrm.OpenMultipleEntityQuickFindSearch","nmo_referral|NoRelationship|HomePageGrid|Mscrm.OutlookHelp","nmo_referral|NoRelationship|HomePageGrid|Playbook.HomepageGrid.Launch","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.FollowCommand","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.UnfollowCommand","nmo_referral|NoRelationship|HomePageGrid|loadGuidedHelp","nmo_referral|NoRelationship|HomePageGrid|launchLPLibrary","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Ribbon.TabSwitch","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Ribbon.RootEvent","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Jewel","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.{!EntityLogicalName}.View","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.View","nmo_referral|NoRelationship|HomePageGrid|Mscrm.FiltersGroup","nmo_referral|NoRelationship|HomePageGrid|Mscrm.SaveAsDefaultGridView","nmo_referral|NoRelationship|HomePageGrid|Mscrm.CustomizePreviewPane","nmo_referral|NoRelationship|HomePageGrid|Mscrm.SaveToCurrentView","nmo_referral|NoRelationship|HomePageGrid|Mscrm.SaveAsNewView","nmo_referral|NoRelationship|HomePageGrid|Mscrm.NewPersonalView","nmo_referral|NoRelationship|HomePageGrid|Mscrm.RefreshGrid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.{!EntityLogicalName}.Chart","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.Chart","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Charts.Flyout","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ChartsLayout.LeftRight","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Charts.Layout.Query.LeftRight","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ChartsLayout.Top","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Charts.Layout.Query.Top","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Charts.HomePage.Off","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Charts.Query.Off","nmo_referral|NoRelationship|HomePageGrid|Mscrm.VisualizationTab.NewChart","nmo_referral|NoRelationship|HomePageGrid|Mscrm.VisualizationTab.EditChart","nmo_referral|NoRelationship|HomePageGrid|Mscrm.VisualizationTab.ExpandChart","nmo_referral|NoRelationship|HomePageGrid|Mscrm.VisualizationTab.CopyChart","nmo_referral|NoRelationship|HomePageGrid|Mscrm.VisualizationTab.ImportChart","nmo_referral|NoRelationship|HomePageGrid|Mscrm.VisualizationTab.ExportChart","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DeleteChart","nmo_referral|NoRelationship|HomePageGrid|Mscrm.VisualizationTab.RefreshChart","nmo_referral|NoRelationship|HomePageGrid|Mscrm.VisualizationTab.AssignVisualization","nmo_referral|NoRelationship|HomePageGrid|Mscrm.VisualizationTab.ShareVisualization","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DynamicMenu.Grid.AddActivity.msfp_surveyinvite","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DynamicMenu.Grid.AddActivity.msfp_surveyresponse","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.{!EntityLogicalName}.Related","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.Related","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddFileToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddNoteToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddTaskToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.SendEmailToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddPhoneToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddLetterToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddFaxToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddAppointmentToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddRecurringAppointmentToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddServiceActivityToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.Grid.AddCustomActivity","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DynamicMenu.Grid.AddActivity","nmo_referral|NoRelationship|HomePageGrid|Mscrm.MailMergeSelected","nmo_referral|NoRelationship|HomePageGrid|Mscrm.AddCampaignResponseToSelectedRecord","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.{!EntityLogicalName}.Developer","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.Developer","nmo_referral|NoRelationship|HomePageGrid|Mscrm.DesignView","nmo_referral|NoRelationship|HomePageGrid|Mscrm.CreateView","nmo_referral|NoRelationship|HomePageGrid|Mscrm.CustomizeEntity","nmo_referral|NoRelationship|HomePageGrid|Mscrm.ManageViews","nmo_referral|NoRelationship|HomePageGrid|Mscrm.SaveFilterForSystemQuery","nmo_referral|NoRelationship|HomePageGrid|Mscrm.PublishEntity","nmo_referral|NoRelationship|HomePageGrid|Mscrm.PublishAll","|NoRelationship||Mscrm.VisualizationTab.Command","|NoRelationship||Mscrm.VisualizationTab.SaveChart","|NoRelationship||Mscrm.VisualizationTab.SaveAndCloseChart","|NoRelationship||Mscrm.VisualizationTab.CopyChart","|NoRelationship||Mscrm.VisualizationTab.ExpandChart","|NoRelationship||Mscrm.VisualizationTab.ChartsGroup","|NoRelationship||Mscrm.VisualizationDesignerTab.ColumnFlyout","|NoRelationship||Mscrm.VisualizationDesignerTab.Charts.Column","|NoRelationship||Mscrm.VisualizationDesignerTab.Charts.StackedColumn","|NoRelationship||Mscrm.VisualizationDesignerTab.Charts.StackedColumn100","|NoRelationship||Mscrm.VisualizationDesignerTab.BarFlyout","|NoRelationship||Mscrm.VisualizationDesignerTab.Charts.Bar","|NoRelationship||Mscrm.VisualizationDesignerTab.Charts.StackedBar","|NoRelationship||Mscrm.VisualizationDesignerTab.Charts.StackedBar100","|NoRelationship||Mscrm.VisualizationDesignerTab.AreaFlyout","|NoRelationship||Mscrm.VisualizationDesignerTab.Charts.Area","|NoRelationship||Mscrm.VisualizationDesignerTab.Charts.StackedArea","|NoRelationship||Mscrm.VisualizationDesignerTab.Charts.StackedArea100","|NoRelationship||Mscrm.VisualizationDesignerTab.LineChart","|NoRelationship||Mscrm.VisualizationDesignerTab.PieChart","|NoRelationship||Mscrm.VisualizationDesignerTab.FunnelChart","|NoRelationship||Mscrm.VisualizationDesignerTab.TopFlyout","|NoRelationship||Mscrm.VisualizationDesignerTab.TopBottom.Top3","|NoRelationship||Mscrm.VisualizationDesignerTab.TopBottom.Top5","|NoRelationship||Mscrm.VisualizationDesignerTab.TopBottom.TopX","|NoRelationship||Mscrm.VisualizationDesignerTab.BottomFlyout","|NoRelationship||Mscrm.VisualizationDesignerTab.TopBottom.Bottom3","|NoRelationship||Mscrm.VisualizationDesignerTab.TopBottom.Bottom5","|NoRelationship||Mscrm.VisualizationDesignerTab.TopBottom.BottomX","|NoRelationship||Mscrm.VisualizationDesignerTab.TopBottom.Clear","|NoRelationship||Mscrm.VisualizationTab.CloseDesigner","|NoRelationship||Mscrm.VisualizationTools.Command","|NoRelationship||Mscrm.Jewel.SaveMenu","|NoRelationship||Mscrm.SavePrimary","|NoRelationship||Mscrm.SaveAndClosePrimary","|NoRelationship||Mscrm.SaveAndNewPrimary","|NoRelationship||Mscrm.Jewel.FormProperties","|NoRelationship||Mscrm.Jewel.PrintPreview","|NoRelationship||Mscrm.ShowToolsMenu","|NoRelationship||Mscrm.DuplicateDetection","|NoRelationship||Mscrm.BulkDelete","|NoRelationship||Mscrm.PersonalSettings","|NoRelationship||Mscrm.LoadHelp","|NoRelationship||Mscrm.HelpContents","|NoRelationship||Mscrm.HelpAdminGuide","|NoRelationship||Mscrm.HelpTroubleshooting","|NoRelationship||Mscrm.HelpCrmLive","|NoRelationship||Mscrm.HelpUpdatesOutlook","|NoRelationship||Mscrm.HelpLegal","|NoRelationship||Mscrm.HelpPrivacy","|NoRelationship||Mscrm.HelpAbout","|NoRelationship||Mscrm.Close"],"InitialTabId":"Mscrm.BasicHomeTab","IsDefaultData":false,"TabList":[{"TabId":"Mscrm.BasicHomeTab"},{"TabId":"Mscrm.HomepageGrid.AllEntities.VisualizationTab"},{"TabId":"EntityTemplateTab.nmo_referral.NoRelationship.HomePageGrid.Mscrm.HomepageGrid.nmo_referral.MainTab"},{"TabId":"EntityTemplateTab.nmo_referral.NoRelationship.HomePageGrid.Mscrm.HomepageGrid.nmo_referral.View"},{"TabId":"EntityTemplateTab.nmo_referral.NoRelationship.HomePageGrid.Mscrm.HomepageGrid.nmo_referral.Chart"},{"TabId":"EntityTemplateTab.nmo_referral.NoRelationship.HomePageGrid.Mscrm.HomepageGrid.nmo_referral.Related"},{"TabId":"EntityTemplateTab.nmo_referral.NoRelationship.HomePageGrid.Mscrm.HomepageGrid.nmo_referral.Developer"}],"TrimList":["Mscrm.BasicHomeTab","Mscrm.BasicHomeTab.New","Mscrm.BasicHomeTab.New.NewActivity","Mscrm.BasicHomeTab.New.NewActivity.task","Mscrm.BasicHomeTab.New.NewActivity.fax","Mscrm.BasicHomeTab.New.NewActivity.phonecall","Mscrm.BasicHomeTab.New.NewActivity.email","Mscrm.BasicHomeTab.New.NewActivity.letter","Mscrm.BasicHomeTab.New.NewActivity.appointment","Mscrm.BasicHomeTab.New.NewActivity.serviceappointment","Mscrm.BasicHomeTab.New.NewActivity.campaignresponse","Mscrm.BasicHomeTab.New.NewActivity.recurringappointmentmaster","Mscrm.BasicHomeTab.New.NewActivity.msfp_surveyinvite","Mscrm.BasicHomeTab.New.NewActivity.msfp_surveyresponse","Mscrm.BasicHomeTab.New.NewRecord","Mscrm.BasicHomeTab.New.NewRecord.contact","Mscrm.BasicHomeTab.New.NewRecord.account","Mscrm.BasicHomeTab.New.NewRecord.nmo_referral","Mscrm.BasicHomeTab.New.NewRecord.nmo_electronicsubmission","Mscrm.BasicHomeTab.New.NewRecord.nmo_hbuevaluation","Mscrm.BasicHomeTab.New.NewRecord.report","Mscrm.BasicHomeTab.New.NewRecord.nmo_service","Mscrm.BasicHomeTab.New.NewRecord.nmo_ethnicity","Mscrm.BasicHomeTab.New.NewRecord.nmo_iwi","Mscrm.BasicHomeTab.Tools","Mscrm.BasicHomeTab.Tools.ImportData","Mscrm.BasicHomeTab.Tools.AdvancedFind","Mscrm.BasicHomeTab.Tools.Meqf","Mscrm.BasicHomeTab.OutlookHelp","Mscrm.BasicHomeTab.Help","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.NewRecordForBPFEntity","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.OpenActiveStage","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.Detect","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.RefreshModernButton","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.NavigateToHomepageGrid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.SendDirectEmail","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddConnection","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddConnectionNew","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddConnectionToMe","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddToQueue","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.ExportSelectedToExcel","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.ImportDataFromExcel","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.ImportDataFromCSV","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.MainFilters","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AdvancedFind","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.Meqf","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.MainTab.OutlookHelp","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.Help","nmo_referral|NoRelationship|HomePageGrid|msdyn.HomepageGrid.nmo_referral.LaunchPlaybook.Button","nmo_referral|NoRelationship|HomePageGrid|GuidedHelpnmo_referral.Grid","nmo_referral|NoRelationship|HomePageGrid|LPLibrarynmo_referral.Grid","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.SaveAsDefaultGridView","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.CustomizePreviewPane","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.ViewFilters","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.SaveToCurrent","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.SaveAsNew","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.NewView","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.Chart.RefreshButton","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddFile","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddNote","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddTask","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddEmail","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddPhone","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddLetter","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddFax","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddAppointment","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddRecurringAppointment","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddServiceActivity","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddOtherActivities","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.MailMerge","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.AddCampaignResponse","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.PublishEntity","nmo_referral|NoRelationship|HomePageGrid|Mscrm.HomepageGrid.nmo_referral.PublishAll","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Save.SaveAndClose","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.ColumnFlyout","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Column.Column","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Column.StackedColumn","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Column.StackedColumn100","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.BarFlyout","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Bar.Bar","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Bar.StackedBar","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Bar.StackedBar100","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.AreaFlyout","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Area.Area","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Area.StackedArea","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Area.StackedArea100","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Line","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Pie","Mscrm.HomepageGrid.AllEntities.VisualizationTab.Charts.Other","Mscrm.HomepageGrid.AllEntities.VisualizationTab.TopBottom","Mscrm.HomepageGrid.AllEntities.VisualizationTab.TopBottom.TopFlyout","Mscrm.HomepageGrid.AllEntities.VisualizationTab.TopBottom.Top3","Mscrm.HomepageGrid.AllEntities.VisualizationTab.TopBottom.Top5","Mscrm.HomepageGrid.AllEntities.VisualizationTab.TopBottom.TopX","Mscrm.HomepageGrid.AllEntities.VisualizationTab.TopBottom.BottomFlyout","Mscrm.HomepageGrid.AllEntities.VisualizationTab.TopBottom.Bottom3","Mscrm.HomepageGrid.AllEntities.VisualizationTab.TopBottom.Bottom5","Mscrm.HomepageGrid.AllEntities.VisualizationTab.TopBottom.BottomX","Mscrm.HomepageGrid.AllEntities.VisualizationTab.TopBottom.Clear","Mscrm.Jewel.SaveMenu","Mscrm.Jewel.SaveMenu.SaveAndNew","Mscrm.Jewel.FormProperties","Mscrm.Jewel.Help.Updates","Mscrm.Jewel.Help.Legal","Mscrm.Jewel.Help.Privacy"]},"subscribedEvents":[9,29,87,45,38,39,101],"id":"crmRibbonData"},null,{"permanentlySelectedControl":"crmGrid","eventManager":"__Page_crmEventManager"},null);
Sys.Application.endCreateComponents();

}
function InitPageManager()
{
window.InitPageManager = (new Date()).getTime();
Sys.Application.findComponent('crmPageManager').applicationLoadHandler();
}
window.initActionQueueParams[InitPageManager]={doNotUseSetTimeout:true};
function InitWrpcTokens()
{
window.InitWrpcTokens = (new Date()).getTime();
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fSYSTEMCUSTOMIZATION.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmiLs4krRLyePqtl5mBaIyUk0eComcL\x2fUfmbBmDR\x2fnB7c', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fSYSTEMCUSTOMIZATION.ASHX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmhoFFy1qC7\x2fzvioy24J8pz4GoDKkuacDf1MwpqQBDS4P', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fCUSTOMERSERVICE.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmmtuE4fVFGuP7049fM\x2fJCrXoMwMWqc4XPsCpuXYxusaV', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fCUSTOMERSERVICE.ASHX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmkdZm4\x2bpr4QMEPy\x2fr\x2fsUFN1Vds4z\x2f5OZlAr4nyztMNLR', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fMAILBOXSERVICE.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmr6xxhPPQ\x2b6\x2fgu9Jh9oens45Bgj8HmL3fVEUBC\x2bH0r83', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fTOOLS\x2fPERSONALSETTINGS\x2fCMDS\x2fCMD_UPDATE.ASPX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmhzDPLw8UVkJ5h2WQLT\x2f\x2bp2\x2faSQtCeJkekEkgKo7tzeL', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fADVANCEDFIND.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmi3TYtj\x2bosf91L8K4vXlURMU0hYmO5gBztQGnaK1CuSi', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fSAVEDQUERYSELECTORWEBSERVICE.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmnrOQqhvOSdkcmndrwJImnBkEtkkUIO8dwtAGSdOuFtC', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2f_ROOT\x2fHOMEPAGE.ASPX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmsf6QnwuWf0iGUqsYhkhSsARdgSor1JIg\x2bCuqvzGc\x2bhS', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fPANEWEBSERVICE.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmh2R60l9sGZJLSCwNREB1gdgXy4Lwgqif3wBlpSWWFm7', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fLOOKUPSERVICE.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmkSpCHuvXGbFOiZ\x2bzJwymuAzwyuaZC\x2f6dUPNdse8fDmQ', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fRELATIONSHIPROLEPICKLIST.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmkfNvMU15VOjyV8hHTq\x2fYJCDuDIO2WGbOvuHqRPJMFYm', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fUSERQUERY.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmkKXaBNLVR6dcEA466xfQ8xN9UlQ\x2fBCSDYsLb9m7QuMd', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fMARKETINGAUTOMATION.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmiCRpH\x2fQ\x2bq4xJJHvplrygFeJZLb9U\x2fn6UgAj1UfXkIl4', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fDUPLICATEDETECTION.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmtcXjYTh8uABpWbRHlUbIdeLIF\x2f5fSDRHvOdAnZktAXN', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fASSOCIATERECORDS.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmlJQfqsHC3GORFCt67Z5\x2fLh3W\x2frDPkIi4gqLSuphFaj8', Timestamp: "636878709376745917"};
_aWrpcTokens['\x2fAPPWEBSERVICES\x2fSCRIPTERROR.ASMX']={Token: 'Tmw\x2fRi2dEemoSQANOtJtmkQeeSsx2ZoI54ES6pD16E5pf7q6ZgRL\x2bEpBE9E9t66I', Timestamp: "636878709376745917"};

}
function SetEntityLogicalName()
{
window.SetEntityLogicalName = (new Date()).getTime();
window.self['EntityLogicalCollectionName']='nmo_referrals';window.self['EntityLogicalName']='nmo_referral';window.self['EntityTypeCode']='10041';window.self['IsCustomEntity']='true';window.self['IsBpfEntity']='false';
}
function CollectAndReportClientMetrics()
{
window.CollectAndReportClientMetrics = (new Date()).getTime();
if(Mscrm && Mscrm.MetricsCollector && Mscrm.MetricsCollector.collectAndReportClientMetrics){Mscrm.MetricsCollector.collectAndReportClientMetrics(1);}
}
function HomeOnLoad()
{
window.HomeOnLoad = (new Date()).getTime();
homepageWindowOnload();
}
function INITIALIZE_NOTIFICATIONCONTEXT()
{
window.INITIALIZE_NOTIFICATIONCONTEXT = (new Date()).getTime();
window.top.notificationContext='Global';
}
function LoadResourcesforGenericQuickCreate()
{
window.LoadResourcesforGenericQuickCreate = (new Date()).getTime();
var scripts = ['/_static/_common/scripts/InlineEditCommon.js', '/_static/_controls/GlobalQuickCreate/GlobalQuickCreateBehavior.js'];
										for(var i=0;i<scripts.length;i=i+1) {
											var element = document.createElement('script');
											element.src = scripts[i];
											document.head.appendChild(element);
										}
}
function PrefetchFormLayoutAndResources()
{
window.PrefetchFormLayoutAndResources = (new Date()).getTime();
try {{ $find('crmGrid').get_innerGrid().InitiateEntityLayoutPrefetch(); }} catch(e) {{}};
}
var _footerOnLoad=function(){ applyActionQueue([SetPLTMarker,
LoadGlobalJSAndScriptResourceJS,
WaitGlobalJSAndScriptResourceJsScriptsToLoad,
LoadJsScripts,
WaitRemainingJsScriptsToLoad,
InitControls,
InitPageManager,
InitWrpcTokens,
SetEntityLogicalName,
CollectAndReportClientMetrics,
HomeOnLoad,
INITIALIZE_NOTIFICATIONCONTEXT,
LoadResourcesforGenericQuickCreate,
PrefetchFormLayoutAndResources]); }
registerEvents(window, 'load', _footerOnLoad);
var _footerUnLoad=function(){try{if(_footerOnLoad){unregisterEvents(window, 'load', _footerOnLoad);_footerOnLoad=null;}}catch(exc){}try{unregisterEvents(window, 'unload', _footerUnLoad);_footerUnLoad=null;}catch(exc){}window.onresize=null;window.onerror=null;window.onload=null;stopAndCleanExecuteActionQueue(); }
registerEvents(window, 'unload', _footerUnLoad);
</script>
<script type="text/javascript">
var _homepageParameterInfo = [{ 'controlId' : 'crmGrid_SavedNewQuerySelector', 'parameterName' : 'viewid'}];
</script>
<script id="/_static/_common/scripts/microsoftajax.js?ver=1888157098" type="text/javascript" src="./MicrosoftAjax.js.download" async="" dynamic="true" loaded="true"></script><script id="/_common/scriptresx.ashx?lcid=1033&amp;ver=1888157098" type="text/javascript" src="./ScriptResx.ashx" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/jquery-2.1.1.min.js?ver=1888157098" type="text/javascript" src="./jquery-2.1.1.min.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/encodedecode.js?ver=1888157098" type="text/javascript" src="./EncodeDecode.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/microsoft.crm.client.core.js?ver=1888157098" type="text/javascript" src="./Microsoft.Crm.Client.Core.js.download" async="" dynamic="true" loaded="true"></script><script id="/_common/global.ashx?ver=1888157098" type="text/javascript" src="./global.ashx" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/jquery-2.1.1.min.js?ver=1888157098" type="text/javascript" src="./jquery-2.1.1.min.js.download" async="" dynamic="true" loaded="true"></script><script id="/_common/entityproperties/entitypropertiesutil.js.aspx?lcid=1033&amp;tstamp=1144437&amp;ver=1888157098" type="text/javascript" src="./entitypropertiesutil.js.aspx" async="" dynamic="true" loaded="true"></script><script id="/_common/entitiescustomizedhelp/entitiescustomizedhelp.js.aspx?tstamp=1144437&amp;ver=1888157098" type="text/javascript" src="./EntitiesCustomizedHelp.js.aspx" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/es6-shim.js?ver=1888157098" type="text/javascript" src="./es6-shim.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/performanceui.js?ver=1888157098" type="text/javascript" src="./performanceui.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/crminternalutility.js?ver=1888157098" type="text/javascript" src="./crminternalutility.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/performance.js?ver=1888157098" type="text/javascript" src="./performance.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/maxsessionmonitor.js?ver=1888157098" type="text/javascript" src="./maxsessionmonitor.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/stage.js?ver=1888157098" type="text/javascript" src="./stage.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_root/homepage.js?ver=1888157098" type="text/javascript" src="./homepage.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_forms/form.js?ver=1888157098" type="text/javascript" src="./form.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_forms/select.js?ver=1888157098" type="text/javascript" src="./select.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_grid/gridcontrol.js?ver=1888157098" type="text/javascript" src="./GridControl.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_controls/hinttext/hinttext.js?ver=1888157098" type="text/javascript" src="./HintText.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/glowingimage.js?ver=1888157098" type="text/javascript" src="./glowingimage.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_controls/commandbar/commandbar.js?ver=1888157098" type="text/javascript" src="./commandbar.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_controls/pane/visualizationpane.js?ver=1888157098" type="text/javascript" src="./visualizationpane.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_controls/menuselector/menuselector.js?ver=1888157098" type="text/javascript" src="./menuselector.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/visualization/visualizationactions.js?ver=1888157098" type="text/javascript" src="./visualizationactions.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_controls/gridfilters/gridfilters.js?ver=1888157098" type="text/javascript" src="./GridFilters.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/mscrm.caching.js?ver=1888157098" type="text/javascript" src="./mscrm.caching.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_controls/lookup/lookup.js?ver=1888157098" type="text/javascript" src="./lookup.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_forms/lookupbehavior.js?ver=1888157098" type="text/javascript" src="./lookupbehavior.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_grid/datasetcontrol.js?ver=1888157098" type="text/javascript" src="./DataSetControl.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_forms/checkbox.js?ver=1888157098" type="text/javascript" src="./checkbox.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_forms/textinputbehavior.js?ver=1888157098" type="text/javascript" src="./textinputbehavior.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_controls/ribbon/ribbon.js?ver=1888157098" type="text/javascript" src="./ribbon.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/ribbonactions.js?ver=1888157098" type="text/javascript" src="./ribbonactions.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/commandbaractions.js?ver=1888157098" type="text/javascript" src="./commandbaractions.js.download" async="" dynamic="true" loaded="true"></script><script id="/_controls/ribbon/ribbonlayout.js.aspx?cb=true&amp;econtext=homepagegrid&amp;etn=nmo_referral&amp;hierarchy=00000000-0000-0000-0000-000000000000&amp;id=mscrm.commandbar&amp;ie=0&amp;ise=1&amp;lcid=1033&amp;mver=1144437&amp;oc=0&amp;page=%2f_root%2fhomepage.aspx&amp;relname=&amp;reltype=norelationship&amp;rver=-276374248&amp;ver=1888157098&amp;wrdepver=eafa556b3e344e65a63e67ab5dc1e66f" type="text/javascript" src="./RibbonLayout.js(1).aspx" async="" dynamic="true" loaded="true"></script><script id="/_static/_common/scripts/presence.js?ver=1888157098" type="text/javascript" src="./presence.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_grid/action.js?ver=1888157098" type="text/javascript" src="./action.js.download" async="" dynamic="true" loaded="true"></script><script id="/_static/_forms/addrelated.js?ver=1888157098" type="text/javascript" src="./addrelated.js.download" async="" dynamic="true" loaded="true"></script></body></html>
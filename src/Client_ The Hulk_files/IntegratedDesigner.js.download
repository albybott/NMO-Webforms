var _MicrosoftMars,marsDesigner;(function(n){var t;(function(n){var t;(function(n){"use strict";n.designerScriptsDownloaded=!1;var t=function(){function t(){this.counter=0;var t="localescripts/grid.locale-"+(new n.SearchAnswerPanelApi).getMarket()+".js";this.scripts=[{path:"marsckeditor/ckeditor.js",callback:this.marsCkEditorLoadNext,preload:this.resolveCkeditorConflict},{path:t,callback:this.loadNext,preload:null},{path:"jquery.jqGrid.min.js",callback:this.loadNext,preload:null},{path:"MarsDesigner.js",callback:this.attachPropertyTabToSideBar,preload:null},{path:"Templates.js",callback:this.loadNext,preload:null},{path:"marsckeditor/adapters/jquery.js",callback:this.loadNext,preload:null},{path:"powerbi.min.js",callback:this.loadNext,preload:null}];n.designerScriptsDownloaded=!1;this.loadScripts(this.scripts)}return t.prototype.loadNext=function(){this.counter++;this.counter<this.scripts.length?this.loadScripts(this.scripts):(n.designerScriptsDownloaded=!0,n.MarsLoader.isExternalDesignerTrigger()&&n.MarsLoader.prototype.launchDesigner())},t.prototype.loadScripts=function(n){var t=!0;n[this.counter]&&n[this.counter].preload&&(t=n[this.counter].preload.call(this));t&&this.loadScript(n[this.counter].path,function(){n[this.counter].callback&&n[this.counter].callback.call(this)})},t.prototype.loadScript=function(t,i){var u=this,r;document.getElementById(n.serverUrl+t)?(console.log(t+" already loaded "),i.call(u)):(r=document.createElement("script"),r.onerror=function(){console.log("Error in loading script")},r.onload=function(){console.log(t+" loaded ");i.call(u)},r.src=n.serverUrl+t,r.id=n.serverUrl+t,document.getElementsByTagName("head")[0].appendChild(r))},t.prototype.resolveCkeditorConflict=function(){return n.appContext.isISHPage()&&window.CKEDITOR&&(n.InAppCKEDITOR=window.CKEDITOR,window.CKEDITOR=undefined),!0},t.prototype.marsCkEditorLoadNext=function(){n.appContext.isISHPage()&&window.CKEDITOR&&(n.MarsCKEDITOR=window.CKEDITOR);this.loadNext()},t.prototype.attachPropertyTabToSideBar=function(){window._MicrosoftMars.AnswerPanel.getInstance().attachPropertytab();this.loadNext()},t}();n.IntegratedDesigner=t})(t=n.Loader||(n.Loader={}))})(t=n.Client||(n.Client={}))})(_MicrosoftMars||(_MicrosoftMars={}));marsDesigner=new _MicrosoftMars.Client.Loader.IntegratedDesigner;
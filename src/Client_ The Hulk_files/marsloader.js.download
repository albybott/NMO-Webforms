var _MicrosoftMars;(function(n){var t;(function(t){var i;(function(Loader){"use strict";var i,r;Loader.defaultLanguageLcid=1033;Loader.defaultLcidforTemplates=1033;Loader.isControlsFetched=!1;Loader.validateScenarios=!1;Loader.clientAPIEnabled=!1;Loader.isTabletOSSupported=!1;Loader.isTabletBrowserSupported=!1;Loader.defaultExceptionControlList=[];Loader.contextHomeSidebar=[];Loader.marsUserRole="";Loader.supportedVersions=["8.0.0.0"];Loader.contextAppVersionType="MajorOnly";Loader.testDriveStage="test drive";Loader.scheduleLoadContextHomeSidebar=!1;Loader.isFirstRun=!0;Loader.isReinitialized=!1;Loader.LOADINGSTARTED=!1;Loader.LOADINGFINISHED=!1;Loader.isNPSEnabled=!1;i=function(){function i(n){n===void 0&&(n=!1);this.chromeMinVersion=10;this.firefoxMinVersion=10;this.ieMinVersion=11;this.safariMinVersionForRuntime=8;this.safariMinVersionForDesigner=9;this.counter=0;this.userRoleName="System Administrator";this.isMobile=!1;this.ISHConstant="Ish";this.userSecurityGroupName="Full";this.marsIFrame="marsIFrame";this.allConfigurationKey="allConfigurationKey";this.MARS_ETAGS="ETags";this.MARS_CONFIG_ETAG="ConfigETag";this.INVALIDATE_CONFIG_CACHE_KEY="INVALIDATE_CONFIG_CACHE_KEY";this.INVALIDATE_EXCEPTION_CONTROLS_CACHE_KEY="INVALIDATE_EXCEPTION_CONTROLS_CACHE_KEY";this.isHighContrastMode=!1;this.isHighContrastWhiteMode=!1;this.marshelpIconLoadingCompleted="images/MARS_help_icon_completed_v22.png";this.marshelpIconLoadingCompleted_hcw="images/MARS_help_icon_completed_hcw.png";this.marshelpIconLoadingCompletedRTL="images/MARS_help_icon_completed_RTL_v22.png";this.marshelpIconLoadingCompletedRTL_hcw="images/MARS_help_icon_completed_RTL_hcw.png";this.marshelpIconLoadingState0="images/MARS-icon-LoadingState0.png";this.marshelpIconLoadingState1="images/MARS-icon-LoadingState1.png";this.marshelpIconLoadingState2="images/MARS-icon-LoadingState2.png";this.marshelpIconLoadingState0_hcw="images/MARS-icon-LoadingState0_hcw.png";this.marshelpIconLoadingState1_hcw="images/MARS-icon-LoadingState1_hcw.png";this.marshelpIconLoadingState2_hcw="images/MARS-icon-LoadingState2_hcw.png";this.marshelpIconLoadingRTLState0="images/MARS-icon-LoadingRTLState0.png";this.marshelpIconLoadingRTLState1="images/MARS-icon-LoadingRTLState1.png";this.marshelpIconLoadingRTLState2="images/MARS-icon-LoadingRTLState2.png";this.marshelpIconLoadingRTLState0_hcw="images/MARS-icon-LoadingRTLState0_hcw.png";this.marshelpIconLoadingRTLState1_hcw="images/MARS-icon-LoadingRTLState1_hcw.png";this.marshelpIconLoadingRTLState2_hcw="images/MARS-icon-LoadingRTLState2_hcw.png";this.marshelpIconLoadingStatesArray=[];this.isClientJqueryLoaded=!1;try{if(window.parent.Xrm!=undefined&&window.parent.Xrm.Page!=undefined&&(this.clientType=this.getXrmClientType(),this.clientType!=="Web"&&this.clientType!=="Mobile"))return;if(this.isMailApp())return;Loader.currentInstance=this;i.isUCIShim()&&(this.clientType==null||this.clientType==undefined)&&(this.clientType="Mobile");this.checkAndLogConfigurationInfo();var r=this.IsMocaDevice(),t=this.getXrm(),f=sessionStorage.getItem("authenticationCookiePresent");if(r&&!Loader.allowUnAuthorize&&!(f==="true")&&t&&t.Utility&&t.Utility.beginSecureSessionForResource){var e=Loader.integrationsApiUrl.substring(0,Loader.integrationsApiUrl.indexOf("/MARS/")).replace("https://","").trim(),u=t.Utility.beginSecureSessionForResource(Loader.resourceUrl,"LearningPath-Auth",e),o=this;u.then(function(){sessionStorage.setItem("authenticationCookiePresent","true");o.injectMarsIframe(n,r)});u.error(function(n){console.log("Authentication cookie not set - beginSecure Promise failed"+n);sessionStorage.setItem("authenticationCookiePresent","false")})}else this.injectMarsIframe(n,r)}catch(s){console.error("Learning Path error: "+s)}}return i.isTestDrive=function(){return Loader.testDriveStage==Loader.appContext.CurrentStage.toLowerCase()},i.isDesignerLaunched=function(){return window._MicrosoftMars.Client.Designer&&window._MicrosoftMars.Client.Designer.App.isDesignerLaunched},i.isExternalDesignerTrigger=function(){return localStorage.getItem("launchMARSDesigner")=="true"||window.launchMARSDesigner},i.isUCI=function(){return document.getElementById("ClientApiFrame_MARS")?!0:!1},i.isUCIShim=function(){return i.isUCI()&&n.Client.Loader.currentInstance.IsMocaDevice()},i.prototype.getXrmClientType=function(){var n="";try{n=window.parent.Xrm.Page.context.client.getClient();n==="UnifiedServiceDesk"&&(n="Web")}catch(t){}return n},i.resetExternalDesignerTrigger=function(){window.launchMARSDesigner=!1;localStorage.removeItem("launchMARSDesigner")},i.prototype.isMailApp=function(){try{return window.location.search?window.location.href!==window.top.location.href&&window.location.search.toLowerCase().indexOf("clienthost=3")!=-1:!1}catch(n){return!0}},i.prototype.checkAndLogConfigurationInfo=function(){Loader.serverUrl=n.Client.Loader.serverUrl;Loader.webApiBaseUrl=n.Client.Loader.webApiBaseUrl;Loader.trafficManagerBaseUrl=n.Client.Loader.trafficManagerBaseUrl;Loader.aadClientId=n.Client.Loader.aadClientId;Loader.aadTenantDomain=n.Client.Loader.aadTenantDomain;Loader.allowUnAuthorize=n.Client.Loader.allowUnAuthorize;Loader.serverUrl&&Loader.webApiBaseUrl&&Loader.trafficManagerBaseUrl&&Loader.aadClientId&&Loader.aadTenantDomain?Loader.serverUrl.indexOf("%%")!==0&&Loader.webApiBaseUrl.indexOf("%%")!==0&&Loader.trafficManagerBaseUrl.indexOf("%%")!==0&&Loader.aadClientId.indexOf("%%")!==0&&Loader.aadTenantDomain.indexOf("%%")!==0?console.log("Info: Configuration variables from MarsBootStrap.js are set correctly."):console.log("Error: Not all configuration variables from MarsBootStrap.js are set correctly."):console.log("Error: Not all configuration variables are loaded from MarsBootStrap.js.")},i.prototype.IsMocaDevice=function(){var n=window.parent.Microsoft.Crm.Client.Core.Framework.UserAgent;return n&&n.getInstance().get_PALEnabled()?n.getInstance().get_PALEnabled():!1},i.prototype.loadNext=function(){this.counter++;this.counter<this.scripts.length?this.loadScripts(this.scripts):this.counter=this.scripts.length-1},i.prototype.postUtilityload=function(){this.clientType=Loader.appContext.ClientType;this.initializeMarsAriaLiveRegion();this.localeFilePath=Loader.serverUrl+"Locales/"+Loader.appContext.Locale+"/locale.js";var n=this;this.loadScript(this.localeFilePath,function(){n.initializeLocale();n.checkForHighContrastMode();n.updateHelpIcon();n.loadNext()})},i.prototype.checkForHighContrastMode=function(){var n=this.getBrowserInfo();n.name=="Edge"&&Loader.$mars("<style>@media screen and (-ms-high-contrast: active) {   #marsIFrame { background-image: none !important; }  }<\/style>").appendTo("head");Loader.$mars("#"+this.marsIFrame).css("background-image")==="none"&&(this.isHighContrastMode=!0,Loader.$mars("body").css("background-color")==="rgb(255, 255, 255)"&&(this.isHighContrastWhiteMode=!0))},i.prototype.updateHelpIcon=function(){var e=n.Client.Loader.appContext.isHebrewEnv(),o,u;if(this.isRTL=n.Client.Loader.appContext.isRTL(),o=n.Client.Loader.appContext.isOnline(),o){this.isRTL?this.isHighContrastWhiteMode?(this.marshelpIconLoadingStatesArray[0]=this.marshelpIconLoadingRTLState0_hcw,this.marshelpIconLoadingStatesArray[1]=this.marshelpIconLoadingRTLState1_hcw,this.marshelpIconLoadingStatesArray[2]=this.marshelpIconLoadingRTLState2_hcw):(this.marshelpIconLoadingStatesArray[0]=this.marshelpIconLoadingRTLState0,this.marshelpIconLoadingStatesArray[1]=this.marshelpIconLoadingRTLState1,this.marshelpIconLoadingStatesArray[2]=this.marshelpIconLoadingRTLState2):this.isHighContrastWhiteMode?(this.marshelpIconLoadingStatesArray[0]=this.marshelpIconLoadingState0_hcw,this.marshelpIconLoadingStatesArray[1]=this.marshelpIconLoadingState1_hcw,this.marshelpIconLoadingStatesArray[2]=this.marshelpIconLoadingState2_hcw):(this.marshelpIconLoadingStatesArray[0]=this.marshelpIconLoadingState0,this.marshelpIconLoadingStatesArray[1]=this.marshelpIconLoadingState1,this.marshelpIconLoadingStatesArray[2]=this.marshelpIconLoadingState2);var f=n.Client.Loader.appContext.Util.getHelpIcon(),r=f.parent(),t=r.find(".navTabHelpImageWeb"),s=Loader.appContext.isISHPage();s?(t.length<=0&&f.append('<img class="navTabHelpImageWeb" id="navTabButtonHelpImageIdWeb" unselectable="on" src="">'),n.Client.Loader.appContext.Util.setHelpIconStyle(),t=r.find(".navTabHelpImageWeb"),Loader.LOADINGSTARTED&&!Loader.LOADINGFINISHED?(t=r.find(".navTabHelpImageWeb"),this.animateHelpIcon(parent,this.marshelpIconLoadingStatesArray,0,this.marshelpIconLoadingStatesArray.length,t)):Loader.LOADINGFINISHED&&(this.isRTL&&!e?this.isHighContrastWhiteMode?t.attr("src",n.Client.Loader.serverUrl+this.marshelpIconLoadingCompletedRTL_hcw):t.attr("src",n.Client.Loader.serverUrl+this.marshelpIconLoadingCompletedRTL):this.isHighContrastWhiteMode?t.attr("src",n.Client.Loader.serverUrl+this.marshelpIconLoadingCompleted_hcw):t.attr("src",n.Client.Loader.serverUrl+this.marshelpIconLoadingCompleted))):(t.length<=0&&(r.append('<img class="navTabHelpImageWeb" id="navTabButtonHelpImageIdWeb" unselectable="on" src="">'),f.hide()),t=r.find(".navTabHelpImageWeb"),n.Client.Loader.appContext.Util.setHelpIconStyle(),Loader.LOADINGSTARTED&&!Loader.LOADINGFINISHED?(t.attr("alt",n.Client.Loader.marsLocale.LearningPathLoading),this.UpdateMarsAriaLiveContent(n.Client.Loader.marsLocale.LearningPathLoading,window._MicrosoftMars.Client.Utility.AriaLiveType.assertive),this.animateHelpIcon(parent,this.marshelpIconLoadingStatesArray,0,this.marshelpIconLoadingStatesArray.length,t)):Loader.LOADINGFINISHED&&(t.attr("alt",n.Client.Loader.marsLocale.learningPathHelpAltText),u=n.Client.Loader.appContext.Util.getHelpIconClickableElement(),u&&u.length>0&&(u.attr("role","button"),u.attr("aria-label",n.Client.Loader.marsLocale.learningPathHelp)),this.UpdateMarsAriaLiveContent(n.Client.Loader.marsLocale.LearningPathLoaded,window._MicrosoftMars.Client.Utility.AriaLiveType.assertive),this.isRTL&&!e?(this.isHighContrastWhiteMode?t.attr("src",n.Client.Loader.serverUrl+this.marshelpIconLoadingCompletedRTL_hcw):i.isUCIShim()?t.attr("src",n.Client.Loader.serverUrl+"images/"+n.Client.Loader.marsImageMapping.ImagePath.marshelpIconSidebarLoadCompleteRTL):t.attr("src",n.Client.Loader.serverUrl+this.marshelpIconLoadingCompletedRTL),this.animateHelpIcon(parent,this.marshelpIconLoadingStatesArray,0,this.marshelpIconLoadingStatesArray.length,t)):(this.animateHelpIcon(parent,this.marshelpIconLoadingStatesArray,0,this.marshelpIconLoadingStatesArray.length,t),this.isHighContrastWhiteMode?t.attr("src",n.Client.Loader.serverUrl+this.marshelpIconLoadingCompleted_hcw):i.isUCIShim()?t.attr("src",n.Client.Loader.serverUrl+"images/"+n.Client.Loader.marsImageMapping.ImagePath.marshelpIconSidebarLoadComplete):t.attr("src",n.Client.Loader.serverUrl+this.marshelpIconLoadingCompleted))))}},i.prototype.animateHelpIcon=function(t,i,r,u,f){var e=this;Loader.LOADINGFINISHED||(f.attr("src",n.Client.Loader.serverUrl+i[r]),r=(r+1)%u,setTimeout(function(){e.animateHelpIcon(t,i,r,u,f)},200))},i.prototype.marsjQueryInitialization=function(n){var t=this;n===void 0&&(n=5);Loader.$mars==null?$().jqGrid?(Loader.$mars=$.noConflict(this.isClientJqueryLoaded),this.loadNext()):n<250?setTimeout(function(){return t.marsjQueryInitialization(n*2)},n):(Loader.$mars=$.noConflict(this.isClientJqueryLoaded),this.loadNext()):this.loadNext()},i.prototype.marsBackboneInitialization=function(){Loader.BackboneMars==null&&(Loader.BackboneMars=window.Backbone.noConflict(),Loader.BackboneMars.$=Loader.$mars,window.BackboneMars=Loader.BackboneMars);this.marsUnderScoreInitialization();this.loadNext()},i.prototype.marsUnderScoreInitialization=function(){Loader._mars==null&&(Loader._mars=_.noConflict())},i.prototype.proceedAfterLifeCycleStageConditionsCheck=function(t,r){var u,f;try{if(!window.LoadedFromTestDrive==!0)if(n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_MARS_CRM_PAGE_LOAD_COMPLETE_START"),r==!0)n.Client.Loader.appContext.checkForPageLoad(function(){n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_MARS_CRM_PAGE_LOAD_COMPLETE_END")},window),this.retrieveData.call(this,this);else{if(u=Loader.appContext.isPageLoadEventSupported(),Loader.isFirstRun){if(Loader.isFirstRun=!1,u){Loader.appContext.isPageLoaded()==!0&&(n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_MARS_CRM_PAGE_LOAD_COMPLETE_END"),this.retrieveData.call(this,this));Loader.appContext.addPageLoadEventListener(this.MarsPageLoadHandler,this);Loader.appContext.addPageUnLoadEventListener(this.MarsPageUnLoadHandler,this);return}}else Loader.isReinitialized&&(Loader.isReinitialized=!1,u&&Loader.appContext.isPageLoaded()==!0&&this.retrieveData.call(this,this));u||Loader.appContext.checkForPageLoad(this.retrieveData,this)}f=Loader.appContext.Util.getAuthoringGroupLifeCycleStageMap("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa");f&&f.Name=="First Run (Trial)"&&this.loadMtagConfig();i.highContrastDiv==null&&(i.highContrastDiv=document.createElement("div"),i.highContrastDiv.id="checkHighContrastDiv",i.highContrastDiv.style.cssText="width: 0px; height: 0px; background-image: url('#')",document.getElementsByTagName("body")[0].appendChild(i.highContrastDiv))}catch(e){console.error("Learning Path error: "+e)}},i.prototype.runtimeCallback=function(t,i){window._MicrosoftMars.Client.InAppSupport.Util.isInAppSupportFeatureEnabled(!1)&&setTimeout(function(){window._MicrosoftMars.InAppSupportConfiguration!=null?window._MicrosoftMars.InAppSupportConfiguration.getInstance():(console.log("Error : InAppSupportConfiguration instance not found"),n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.ERROR,"MarsLoader:runtimeCallback : InAppSupportConfiguration instance not found"))});this.processRunner(t,i)},i.prototype.processRunner=function(t,r){var u,e,o,f;Loader.logger=window._MicrosoftMars.Client.Telemetry.Logger.getInstance();this.isMobile&&localStorage.setItem("marsScriptsDownloaded","1");u=this;this.invoker=Loader.$mars(Loader.appContext.Util.getMarsLauncher());this.initializeMarsEmptyDiv();Loader.ServiceProxy.webApiBaseUrl=Loader.webApiBaseUrl;Loader.ServiceProxy.trafficManagerBaseUrl=Loader.trafficManagerBaseUrl;e=window.Microsoft.Mars.Client.ContextResolution.ContextResolutionManager.getInstance();i.isTestDrive()&&u.getTestDriveControlId()!==""&&(o=e.controlById(u.getTestDriveControlId()),o.done(function(t){u.invalidateConfigCacheIfRequired(t);var i=window.Microsoft.Mars.Client.Runtime.Controls.AnswerPanelLauncher;i.isScenarioTriggered?i.isScenarioTriggered=!1:t.Result!=null&&(n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_LAUNCH_PANEL_START"),i.loadAnswerPanel(t.Result),window._MicrosoftMars.AnswerPanel.getInstance().show(0),n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_LAUNCH_PANEL_END"),i.answerPanelResult=t.Result,u.bindEventToNavTabHelp(u,!0))}));Loader.appContext.LoginCount=1;f=window.Microsoft.Mars.Client.Runtime.Controls.LifeCycleStageManager;f&&f.initLifeCycleStage(function(){this.proceedAfterLifeCycleStageConditionsCheck(t,r)}.bind(this))},i.prototype.retrieveData=function(t,r){var e,s,u,o,f;i.isExternalDesignerTrigger()&&t.launchDesigner(t);Loader.logger=window._MicrosoftMars.Client.Telemetry.Logger.getInstance();n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"marsloader:retrieveData START");n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.INFO,"Control render for User role: "+t.userRoleName+", Language: "+Loader.appContext.Locale+", Client Type: "+t.clientType);e=new window._MicrosoftMars.Client.Utility.ContextEngine;Loader.scheduleLoadContextHomeSidebar=!1;s=new n.Client.Loader.ServiceProxy;n.Client.Loader.ServiceProxy.webApiBaseUrl=n.Client.Loader.webApiBaseUrl;n.Client.Loader.ServiceProxy.trafficManagerBaseUrl=n.Client.Loader.trafficManagerBaseUrl;t.loadConfigurationAndInitialize(!1);u=window.Microsoft.Mars.Client.Runtime.Controls.AnswerPanelLauncher;o=window.Microsoft.Mars.Client.ContextResolution.ContextResolutionManager.getInstance();n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_CCR_START");f=o.fetchControls();u.CurrentPagePanel=null;f.done(function(i){var f,s,o,h;try{n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_CCR_END");i.CBCData&&t.invalidateConfigCacheIfRequired(i.CBCData);Loader.LOADINGFINISHED=!0;Loader.isControlsFetched=!0;i.filteredControls?(f=i.filteredControls.sidebar,f?(Loader.validateScenarios&&(s=window.Microsoft.Mars.Client.Validator.JsonResponseValidator,s.ValidateRuntime(e.requestJson,f[0],window.Microsoft.Mars.Client.Validator.ScenarioIds.ControlByContext)),u.CurrentPagePanel=f,u.answerPanelResult=u.CurrentPagePanel):u.answerPanelResult=null,t.updateHelpIcon(),u.isLandingTrigger=t.handleAnswerPanelLaunch(u.answerPanelResult),o=window._MicrosoftMars.Client.Utility.FFFUtility,o.isFeatureEnabled(o.GuidedTaskFeatureName)&&i.filteredControls.stepThrough&&i.filteredControls.stepThrough.length>0&&(h=window.Microsoft.Mars.Client.Runtime.Controls.ScenarioUtil,h.loadScenarios(i.filteredControls.stepThrough))):(n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.WARNING,"MarsLoader:retrieveData call returned with empty results."),console.log("No answer panel found."),console.log("No scenario found."),u.answerPanelResult=null,u.isLandingTrigger=!1,t.updateHelpIcon());u.isLandingTrigger||(u.isScenarioTriggered=!1);t.handlePostCBCActivity(t,!0);r&&r()}catch(c){console.log("Error while rendering sidebar.");t.loadExceptionSidebar(t,u)}});f.fail(function(){console.log("No answer panel found.");console.log("No scenario found.");t.loadExceptionSidebar(t,u)});localStorage.marsTelemetry=="false"||t.captureUserInfo();t.logClientApiRegisteredControls();n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"marsloader:retrieveData END")},i.prototype.handlePostCBCActivity=function(n,t){t===void 0&&(t=!0);n.loadDesignerIfEnabled(n);n.bindEventToNavTabHelp(n,t,!0)},i.prototype.loadExceptionSidebar=function(n,t){t.answerPanelResult=null;t.isLandingTrigger=!1;Loader.marsExceptionHandler.execute("launchanswerpanelexception",Loader.marsLocale.unableToLoadAnswerPanel);var i=!1;i=n.isExceptionSidebarAvailable();n.handlePostCBCActivity(n,i)},i.prototype.isExceptionSidebarAvailable=function(){var n=null;return(Loader.defaultExceptionControlList&&Loader.defaultExceptionControlList.length>0&&(n=Loader.$mars.grep(Loader.defaultExceptionControlList,function(n){return n.ControlType===1})),n&&n.length>0)?!0:!1},i.prototype.invalidateConfigCacheIfRequired=function(n){var t,i,r;jQuery.isEmptyObject(n)||jQuery.isEmptyObject(n.ETags)||(jQuery.isEmptyObject(n.ETags[this.MARS_CONFIG_ETAG])||(t=n.ETags[this.MARS_CONFIG_ETAG].Value),jQuery.isEmptyObject(sessionStorage[this.MARS_ETAGS])||(r=JSON.parse(sessionStorage[this.MARS_ETAGS]),jQuery.isEmptyObject(r[this.MARS_CONFIG_ETAG])||(i=r[this.MARS_CONFIG_ETAG].Value)),jQuery.isEmptyObject(t)||jQuery.isEmptyObject(i)||t===i||(sessionStorage[this.INVALIDATE_CONFIG_CACHE_KEY]="true",sessionStorage[this.INVALIDATE_EXCEPTION_CONTROLS_CACHE_KEY]="true"))},i.prototype.loadConfigurationAndInitialize=function(t){var i=this,f=new window._MicrosoftMars.Client.Utility.Util,r,u;jQuery.isEmptyObject(sessionStorage[i.INVALIDATE_CONFIG_CACHE_KEY])||sessionStorage[i.INVALIDATE_CONFIG_CACHE_KEY]=="true"?(n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_ALL_CONFIG_START"),r=new n.Client.Loader.ConfigurationAPI,u=r.getAllConfigurations(),u.done(function(n){if(n!=null&&n.Result!=null)if(n.Result.ProductOrgDetail==null||n.Result.ProductOrgDetail==undefined){var u=r.getInitializeOrgProvisioning(Loader.ServiceProxy.getInitOrgProvisioningRequest());u.done(function(n){if(n!=null&&n.Result!=null){console.log("Loading Initial auto provisioning details succeed!!!");var u=r.getAllConfigurations();u.done(function(n){console.log("Loading configuration succeed!!!");i.loadConfigurationData(n,t)});u.fail(function(n){console.log("Loading configuration failed."+n)})}else console.log("Loading auto provisioning details returned null data.")});u.fail(function(n){i.showErrorAlert(n.responseJSON)})}else i.loadConfigurationData(n,t);else console.log("Loading configurations returned null data.")}),u.fail(function(n){console.log("Loading configurations failed."+n)})):(f.initializeConfiguration(i),t&&i.loadRuntimeScripts(),i.loadRuntimeStyles())},i.prototype.loadConfigurationData=function(t,i){var f={},e=!1,r=window.Microsoft.Mars.Client.ContextResolution.ControlStoreInvalidator.getInstance(),o,u;localStorage[this.allConfigurationKey]&&(f=r.populateSubscribedPublishGroups(),e=!0);o=new window._MicrosoftMars.Client.Utility.Util;u=JSON.stringify(t.Result);localStorage[this.allConfigurationKey]=u;sessionStorage[this.allConfigurationKey]=u;sessionStorage[this.INVALIDATE_CONFIG_CACHE_KEY]="false";this.addConfigEtagToStore(t);o.initializeConfiguration(this);e&&(r=window.Microsoft.Mars.Client.ContextResolution.ControlStoreInvalidator.getInstance(),r.checkStoreValidity(f));this.loadFFF(i);n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_ALL_CONFIG_END")},i.prototype.invalidateAndClearConfigurationData=function(n){localStorage[n.allConfigurationKey]="";sessionStorage[n.allConfigurationKey]="";sessionStorage[n.INVALIDATE_CONFIG_CACHE_KEY]="false"},i.prototype.captureUserInfo=function(){var t,n,i;try{t="";n=Loader.appContext;i=n.ProductEnvironmentType;Loader.telemetryReporter=window._MicrosoftMars.Client.Telemetry.TelemetryReporter.Instance();Loader.currentInstance.ReportMARSInitEvent()}catch(r){console.log("An unexpected error occurred while capturing user info")}},i.prototype.ReportMARSInitEvent=function(){for(var u,t,n=Loader.appContext,e=this.getBrowserInfo().name,r=Loader.appContext._formFactor.toString(),o=r=="1"?"Desktop":r=="2"?"Tablet":r=="3"?"Phone":"",s=new Loader.RuntimeControlApi,f=[],i=0;i<n.RoleTemplates.length;i++)n.RoleTemplates[i]&&(u=s.getUserRoleName(n.RoleTemplates[i]),u&&f.push(u));n.UserRoleNames=f.toString();t=new window._MicrosoftMars.Client.Telemetry.UserInfoEvent;t.IsActivityIdSet()||(t.SetUserInfo(n.UserId,n.UserRoleNames,n.IsPaid,n.CurrentStage),t.SetEnvInfo(n.getAppName(),n.AppVersion,"",o,n.util.getOS().Os,e,n.locale,n.ClientType),t.SetOrgInfo(n.getOrgName(),n.TenantId,n.OrgType,n.OrgSize,n.OrgLicenses,n.MNC,"",window.location.href,n.Country,""),t.FinishActivity())},i.prototype.MakeCorsRequest=function(n,t,i,r){try{Loader.xhrObj=new XMLHttpRequest;Loader.xhrObj.open(t,n);t==="POST"&&Loader.xhrObj.setRequestHeader("Content-Type","application/json; charset=utf-8");Loader.xhrObj.setRequestHeader("accept","application/json");Loader.xhrResponseFunction=r;Loader.xhrObj.onload=this.XhrResponse;Loader.xhrObj.send(JSON.stringify(i))}catch(u){console.log("An unexpected error occurred while reporting init event")}},i.prototype.XhrResponse=function(){Loader.xhrResponseFunction?Loader.xhrResponseFunction(Loader.xhrObj):console.log("XHR Status: ",Loader.xhrObj.status,"-",Loader.xhrObj.statusText)},i.prototype.loadDesignerScripts=function(){var t=Loader.currentInstance.scripts[Loader.currentInstance.scripts.length-1],n;t.path!=="IntegratedDesigner.js"?(n={path:"IntegratedDesigner.js",callback:Loader.currentInstance.processDesigner,preload:Loader.currentInstance.preLoadDesigner},Loader.currentInstance.scripts.push(n),Loader.currentInstance.loadNext()):Loader.currentInstance.processDesigner()},i.prototype.processDesigner=function(){this.invoker=Loader.$mars(Loader.appContext.Util.getMarsLauncher());Loader.marsUserRole="Admin";i.isExternalDesignerTrigger()||this.turnOnDesignMode()},i.prototype.getMarsUserRole=function(){var n=new window._MicrosoftMars.Client.Loader.DesignerControlApi,t=n.post({},"getUserRole"),i=this;t.done(function(n){Loader.marsUserRole=n.Result;i.turnOnDesignMode()})},i.prototype.turnOnDesignMode=function(){var t,i;if(this.isMobile&&(t=window.Microsoft.Mars.Client.Runtime.Controls.AnswerPanelLauncher,t.answerPanelResult==null))try{window._MicrosoftMars.Client.Loader.appContext.util.getOrCreateOverlay();i=function(){n.Client.Loader.appContext.util.hideOverlay();Loader.$mars("#mars-launcher-options").hide();Loader.appContext.util.hideCustomizationContainer()};Loader.$mars("#lpathRuntimeOverlay").click(i)}catch(r){this.hidelpathRuntimeOverlay(r)}},i.prototype.hidePropertyHomeTabAndAnswerPanel=function(t,i){t===void 0&&(t=!1);i===void 0&&(i=!1);var u=window._MicrosoftMars.propertyHomeTabContainer,r=window._MicrosoftMars.AnswerPanel;u&&u.hide();r&&r.getInstance()&&r.getInstance().hide(null,t,i);n.Client.Loader.appContext.util.hideOverlay()},i.prototype.launchDesigner=function(){var t=this,r=Loader.appContext.appLPAuthoringEnabled(),u,i;if(Loader.allowUnAuthorize){r?t.ProcesslaunchDesigner(t):t.alertDialogWhenAuthoringDisabled(Loader.marsLocale.LPAuthoringDisabledAlert);window._MicrosoftMars.Client.Utility.Util.replaceSVGImageWithInline("img.lpath-svg");return}r?(u=new n.Client.Loader.ConfigurationAPI,i=u.post({},"IsUserMemberOfGroup"),i.done(function(n){if(n!=null&&n.Result!=null&&!n.Result){t.alertDialogWhenAuthoringDisabled(Loader.marsLocale.userNotPartOfSecurityGroupMessage);return}t.ProcesslaunchDesigner(t)}),i.fail(function(n){console.log("IsUserMemberOfGroup failed."+n);t.alertDialogWhenAuthoringDisabled(Loader.marsLocale.userNotPartOfSecurityGroupMessage)})):t.alertDialogWhenAuthoringDisabled(Loader.marsLocale.LPAuthoringDisabledAlert);window._MicrosoftMars.Client.Utility.Util.replaceSVGImageWithInline("img.lpath-svg")},i.prototype.launchDesignerEditControl=function(){var t=this,r=Loader.appContext.appLPAuthoringEnabled(),u,i;if(Loader.allowUnAuthorize){r?t.ProcesslaunchDesignerEditControl(t):t.alertDialogWhenAuthoringDisabled(Loader.marsLocale.LPAuthoringDisabledAlert);return}r?(u=new n.Client.Loader.ConfigurationAPI,i=u.post({},"IsUserMemberOfGroup"),i.done(function(n){if(n!=null&&n.Result!=null&&!n.Result){t.alertDialogWhenAuthoringDisabled(Loader.marsLocale.userNotPartOfSecurityGroupMessage);return}t.ProcesslaunchDesignerEditControl(t)}),i.fail(function(n){console.log("IsUserMemberOfGroup failed."+n);t.alertDialogWhenAuthoringDisabled(Loader.marsLocale.userNotPartOfSecurityGroupMessage)})):t.alertDialogWhenAuthoringDisabled(Loader.marsLocale.LPAuthoringDisabledAlert)},i.prototype.alertDialogWhenAuthoringDisabled=function(n){Loader.appContext.openAlertDialog&&(Loader.appContext.openAlertDialog(n,null),i.resetExternalDesignerTrigger())},i.prototype.proceedLaunchDesigner=function(){var n=window._MicrosoftMars.Client.Designer.App.init();n.done(function(){window._MicrosoftMars.Client.Designer.App.show();i.resetExternalDesignerTrigger()});n.fail(function(){alert("Conent Library could not be initialized")})},i.prototype.proceedLaunchDesignerEditControl=function(n){n.hidePropertyHomeTabAndAnswerPanel(!0,!0);var i=window._MicrosoftMars.Client.Designer,u=i.Util,t=i.App,f=window._MicrosoftMars.Client.Utility,r=t.init();r.done(function(){var e=window._MicrosoftMars.AnswerPanel.getInstance(),i=e.getControlId(),r=Loader.$mars("#lpathRuntimeOverlay");i?t.openControl(i,null,null,r):t.openControl(u.Constants.EmptyGuid,f.ControlTypes.Sidebar,r);t.CancelCaller=n});r.fail(function(){alert("Conent Library could not be initialized")})},i.prototype.isOrgProvisioningComplete=function(){var t=!1,i=n.Client.Loader.appContext.Util.getConfigurationData("OrgDetailSetting");return i&&i.ProvisionState==2&&(t=!0),t},i.prototype.fianalizeOrgProvisioning=function(t){var i=this,r=new n.Client.Loader.ConfigurationAPI,u=r.getFinalizeOrgProvisioning(Loader.ServiceProxy.getOrgProvisioningRequest());u.done(function(n){if(n!=null&&n.Result!=null){console.log("Loading Final auto provisioning details succeed!!!");i.invalidateAndClearConfigurationData(i);var u=r.getAllConfigurations();u.done(function(n){console.log("Loading configuration succeed!!!");i.loadConfigurationData(n,!1);t(i)});u.fail(function(n){console.log("Loading configuration failed."+n)})}else console.log("Loading final auto provisioning details returned null data.")});u.fail(function(n){i.showErrorAlert(n.responseJSON);console.log("Loading Final auto provisioning response failed.")})},i.prototype.getDefaultExceptionCacheKey=function(n){return Loader.appContext.Locale+n+Loader.appContext.UserRoles+Loader.appContext.CurrentStage},i.prototype.loadDefaultExceptionControls=function(){var t=this,r=Loader.appContext.isISHPage()?t.ISHConstant:Loader.appContext.ClientType,o={LcId:Loader.appContext.Locale,Role:Loader.appContext.UserRoles.toString(),stage:Loader.appContext.CurrentStage,UserRole:Loader.appContext.RoleTemplates,FormFactor:Loader.appContext._formFactor.toString(),ClientType:r,ProductVersion:Loader.appContext.getAppVersion()},u=t.getDefaultExceptionCacheKey(r),s=jQuery.isEmptyObject(sessionStorage[t.INVALIDATE_EXCEPTION_CONTROLS_CACHE_KEY])||sessionStorage[t.INVALIDATE_EXCEPTION_CONTROLS_CACHE_KEY]=="true",f=localStorage.getItem(u),i,h;if(f&&!s)i=JSON.parse(f),h=i.Result,Loader.defaultExceptionControlList=i.Result.ErrorSideBarGuidedTask;else{var c=new n.Client.Loader.ConfigurationAPI,e=c.post(o,"GetDefaultExceptionControls");e.done(function(n){localStorage.setItem(u,JSON.stringify(n));Loader.defaultExceptionControlList=n.Result.ErrorSideBarGuidedTask;sessionStorage[t.INVALIDATE_EXCEPTION_CONTROLS_CACHE_KEY]="false";t.addConfigEtagToStore(n)});e.fail(function(n){console.log("Loading exception controls failed."+n)})}},i.prototype.loadUserExperience=function(){Loader.userExperience=new window._MicrosoftMars.Client.Designer.Content.UserExperienceModel;Loader.userExperience=[1,2,3].slice()},i.prototype.handleAnswerPanelLaunch=function(t){var h,u,o,s,r;if(n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_LAUNCH_PANEL_START"),h=window.Microsoft.Mars.Client.Runtime.Controls.UserProgress,h.ANSWERPANELNOTSTARTED=t?!1:!0,u=!1,t){var f=this,c=JSON.parse(t.Events),e=c[0].Trigger;(e=="landing"||e=="delay")&&(o=0,e=="delay"&&(o=parseInt(n.Client.Loader.userExperienceAdvancedOptionsAttributes.Delay)),i.idleSecondsCounter=0,s=f.getLaunchCountForControl(t.ControlId),r=Loader.answerPanelOnLoadThreshold,(r==null||r==undefined||s<r)&&(f.launchSideBarOnPageLoad(o),f.setLaunchCountForControl(t.ControlId,s+1)),u=!0)}return n.Client.Loader.PerfMarker.MarsCaptureModulePerfTime("PERF_M_LAUNCH_PANEL_END"),u},i.prototype.launchSideBarOnPageLoad=function(n){var t=this,r=Loader.appContext.isPageLoaded();r&&i.idleSecondsCounter>=n?t.loadContentAndDisplaySideBar():setTimeout(function(){i.idleSecondsCounter=i.idleSecondsCounter+1e3;t.launchSideBarOnPageLoad(n)},1e3)},i.prototype.loadContentAndDisplaySideBar=function(){var t,n,i;if(t=this,n=window.Microsoft.Mars.Client.Runtime.Controls.AnswerPanelLauncher,n.answerPanelResult=n.CurrentPagePanel,n.answerPanelResult)if(n.isScenarioTriggered)n.isScenarioTriggered=!1;else return i=window.Microsoft.Mars.Client.Runtime.Controls.UserProgress,i.ANSWERPANELNOTSTARTED=!1,n.loadAnswerPanel(n.answerPanelResult),window._MicrosoftMars.AnswerPanel.getInstance().show(0),!0;else setTimeout(function(){t.loadBlankSidebar()},window._MicrosoftMars.AnswerPanel.animationSpeed+100)},i.prototype.loadRunnerAndDesigner=function(){var n=this,t=!0;t=Loader.appContext.allowBindHelpNavTab();t?n.bindEventToNavTabHelp(n):n.launchAnswerPanel(n)},i.prototype.bindEventToNavTabHelp=function(t,i,r){i===void 0&&(i=!1);r===void 0&&(r=!1);var u=Loader.appContext.Util.getMarsLauncher(),f=n.Client.Loader.appContext.isOnline();if(f)if(i&&t.suppresesDefaultHelp(t),Loader.appContext.getClientName()===window._MicrosoftMars.Client.Utility.Constants.MobileClient)Loader.$mars(window.parent.document).find(u).off("click keyup").on("click keyup",function(n){Loader.LOADINGFINISHED&&(n.type==="click"||window._MicrosoftMars.Client.Loader.appContext.Util.isEnterPressed(n,!0))&&(Loader.currentInstance.launchAnswerPanel(t),n.stopPropagation())});else if(Loader.appContext.getClientName()===window._MicrosoftMars.Client.Utility.Constants.UCI)Loader.$mars(u).off("click keyup").on("click keyup",function(n){(n.type==="click"||window._MicrosoftMars.Client.Loader.appContext.Util.isEnterPressed(n,!1))&&Loader.isControlsFetched&&(Loader.currentInstance.launchAnswerPanel(t),n.stopPropagation())});else Loader.$mars(u).parents(".navTabButtonLink").off("click keyup").on("click keyup",function(n){Loader.LOADINGFINISHED&&(n.type==="click"||window._MicrosoftMars.Client.Loader.appContext.Util.isEnterPressed(n,!0))&&(Loader.currentInstance.launchAnswerPanel(t),n.stopPropagation())})},i.prototype.suppresesDefaultHelp=function(n){var t=Loader.appContext.Util.getMarsLauncher(),i=window.Microsoft.Mars.Client.Runtime.Controls.AnswerPanelLauncher;Loader.$mars.when(n.isDesignerEnabledForEnvironment()).done(function(n){(n||i.answerPanelResult)&&(Loader.appContext.getClientName()=="Mobile"?Loader.$mars(window.parent.document).find(t).replaceWith(Loader.$mars(window.parent.document).find(t).clone()):Loader.$mars(t).replaceWith(Loader.$mars(t).clone()))})},i.prototype.loadDesignerIfEnabled=function(n){i.isDesignerLaunched()||Loader.$mars.when(n.isDesignerEnabledForEnvironment()).done(function(n){n&&Loader.currentInstance.loadDesignerScripts()})},i.prototype.launchAnswerPanel=function(){try{return this.loadContentAndDisplaySideBar()}catch(n){this.hidelpathRuntimeOverlay(n)}},i.prototype.loadBlankSidebar=function(){$.when(this.isDesignerEnabledForEnvironment()).done(function(n){if(n){var t=window.Microsoft.Mars.Client.Runtime.Controls.AnswerPanelLauncher;t.loadEmptyPanel();window._MicrosoftMars.AnswerPanel.getInstance().show(0);t.isLandingTrigger=!0}})},i.prototype.hidelpathRuntimeOverlay=function(n){console.log("No sidebar to launch.");console.log(n.message);var t=Loader.$mars("#lpathRuntimeOverlay");t.length>0&&t.hide();this.isMobile&&Loader.appContext.util.hideCustomizationContainer()},i.prototype.isDesignerEnabledForEnvironment=function(){var n=Loader.$mars.Deferred(),t=this;return this.isMobile&&n.resolve(Loader.appContext.isShimDisabled()),Loader.$mars.when(Loader.appContext.isDesignerEnabledforUser).done(function(i){var r=JSON.parse(i);r==!1?n.resolve(!1):n.resolve(t.isLatestBrowser(!0))}),n.promise()},i.prototype.isLatestBrowser=function(n){var t=this.getBrowserInfo();return t.name=="Chrome"&&t.version>=this.chromeMinVersion||t.name=="Firefox"&&t.version>=this.firefoxMinVersion||t.name=="MSIE"&&t.version>=this.ieMinVersion||t.name=="IE"&&t.version>=this.ieMinVersion||t.name=="Edge"||(n==!0?t.name=="Safari"&&t.version>=this.safariMinVersionForDesigner:t.name=="Safari"&&t.version>=this.safariMinVersionForRuntime)?!0:!1},i.prototype.getBrowserInfo=function(){var i=navigator.userAgent,t,n=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE",version:t[1]||""}):n[1]==="Chrome"&&(t=i.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?{name:t[1].replace("OPR","Opera"),version:t[2]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=i.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),{name:n[0],version:n[1]})},i.prototype.processAppContext=function(){Loader.lifecycleStageManager=window._MicrosoftMars.Client.Utility.LifecycleStageManager.getInstance();Loader.marsExceptionHandler=window._MicrosoftMars.Client.Utility.MarsExceptionHandler;Loader.marsImageMapping=window._MicrosoftMars.Client.Utility.ImageMapping},i.prototype.preLoadLocale=function(){return(this.localeFilePath="Locales/"+Loader.appContext.Locale+"/locale.js",this.scripts.length>this.counter)?(this.scripts[this.counter].path=this.localeFilePath,!0):!1},i.prototype.initializeLocale=function(){Loader.marsLocale=window._MicrosoftMars.Client.Utility.Locale;this.loadNext()},i.prototype.initializeMarsEncodeDecode=function(){this.processAppContext();Loader.marsEncodeDecode=window.MarsEncodeDecode;this.loadNext()},i.prototype.preLoadRunner=function(){Loader.ServiceProxy.webApiBaseUrl=Loader.webApiBaseUrl;Loader.ServiceProxy.trafficManagerBaseUrl=Loader.trafficManagerBaseUrl;this.loadConfigurationAndInitialize(!0)},i.prototype.loadFFF=function(t){var i=this,u=new n.Client.Loader.FeatureAPI,f=window._MicrosoftMars.Client.Utility.Util.newGuid(),e={Org:Loader.appContext.getOrgId(),ClientType:Loader.appContext.isISHPage()?i.ISHConstant:Loader.appContext.ClientType,FormFactor:Loader.appContext._formFactor.toString(),Locale:Loader.appContext.Locale,Product:Loader.appContext.getAppName(),ProductVersion:Loader.appContext.getAppVersion(),UserId:Loader.appContext.UserId,UserRole:Loader.appContext.RoleTemplates,AppVersionType:n.Client.Loader.contextAppVersionType,Stage:Loader.appContext.CurrentStage,AuthoringId:Loader.appContext.getAuthoringId(),RequestId:f,DomainName:window.parent.location.hostname.replace(/[^.]*[.]/,""),TenantId:Loader.appContext.tenantId},r=u.getAllEnabledFeatures(e);r.done(function(n){if(n!=null&&n.Result!=null)i.processFeatureList({},n.Result,0),i.loadNPSSurvey();else console.log("FFF returned null data.");t&&i.loadRuntimeScripts()});r.fail(function(n){console.log("Loading Feature List failed."+n);t&&i.loadRuntimeScripts()})},i.prototype.preLoadDesigner=function(){return Loader.appContext.isInternalEnvironment()&&this.userHasSecurityGroup(this.userSecurityGroupName,i.productName)},i.prototype.loadStyles=function(n){var t=0,i=function(n){var r=!0;n[t]&&n[t].preload&&(r=n[t].preload.call(this));r&&this.loadStyle(n[t].path,function(){n[t].callback&&n[t].callback.call(this);t++;t<n.length&&i.call(this,n)})};i.call(this,n)},i.prototype.loadStyle=function(n,t){var r=this,i;if(document.getElementById(n)){if(console.log(n+" already loaded "),t)try{t.call(r)}catch(u){console.error("Learning Path Load Style callback error: "+u)}}else i=document.createElement("link"),i.onerror=function(){console.log("Error in loading style")},r=this,i.onload=function(){console.log(n+" loaded ");t&&t.call(r)},i.href=Loader.serverUrl+n,i.rel="stylesheet",i.type="text/css",i.id=n,document.getElementsByTagName("head")[0].appendChild(i)},i.prototype.loadScripts=function(n){var i=!0,t;n[this.counter]&&n[this.counter].preload&&(i=n[this.counter].preload.call(this));i&&(t=this.counter,this.loadScript(Loader.serverUrl+n[this.counter].path,function(){if(n[t].callback)try{n[t].callback.call(this)}catch(i){console.error("Learning Path Load Script callback error: "+i)}}))},i.prototype.loadScript=function(n,t){var r=this,i;if(document.getElementById(n)){console.log(n+" already loaded ");try{t.call(r)}catch(u){console.error("Learning Path Load Script callback error: "+u)}}else i=document.createElement("script"),i.onerror=function(){console.log("Error in loading script")},i.onload=function(){console.log(n+" loaded ");t.call(r)},i.src=n,i.id=n,i.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(i)},i.prototype.userHasSecurityGroup=function(){return!0},i.prototype.guidsAreEqual=function(n,t){return n==null||t==null?!1:n.replace(/[{}]/g,"").toLowerCase()==t.replace(/[{}]/g,"").toLowerCase()},i.prototype.getTestDriveControlId=function(){return""},i.prototype.getXrm=function(){if(i.isUCI()){var n=document.getElementById("ClientApiFrame_MARS")?!0:!1;return n?document.getElementById("ClientApiFrame_MARS").contentWindow.Lcp:null}return window.parent.Xrm},i.prototype.loadMars=function(n){try{Loader.LOADINGSTARTED=!0;Loader.LOADINGFINISHED=!1;this.clientType=="Mobile"&&(this.isMobile=!0);n=n||i.isDesignerLaunched();Loader.isFirstRun||(Loader.isReinitialized=!0);!n&&(this.isLatestBrowser()||this.isMobile)&&(this.isMobile&&localStorage.setItem("marsScriptsDownloaded","0"),this.scripts=[{path:"jquery-2.1.3.min.js",callback:this.loadNext,preload:null},{path:"jquery-ui.min.js",callback:this.loadNext,preload:null},{path:"handlebars.js",callback:this.loadNext,preload:null},{path:"CssWatch.js",callback:this.loadNext,preload:null},{path:"jquery.jqGrid.min.js",callback:this.loadNext},{path:"jquery.ui.touch-punch.js",callback:this.marsjQueryInitialization,preload:null},{path:"underscore.js",callback:this.loadNext,preload:null},{path:"backbone.js",callback:this.marsBackboneInitialization,preload:null},{path:"MarsUtility.js",callback:this.setTenantPropertiesAndCallback,preload:null},{path:"MarsContextResolution.js",callback:this.loadNext,preload:null},{path:"DesignerActions.js",callback:this.loadNext,preload:null},{path:"RuntimeActions.js",callback:this.loadNext,preload:null},{path:"Crossdomain.js",callback:this.loadNext,preload:null},{path:"MarsCustomScripts.js",callback:this.loadNext,preload:null},{path:"MarsValidator.js",callback:this.loadNext,preload:null},{path:"MarsEncodeDecode.js",callback:this.initializeMarsEncodeDecode,preload:null},{path:"ServiceProxy.js",callback:this.preLoadRunner,preload:null},{path:"LpDynamicContextLib.js",callback:this.loadNext,preload:null}],this.styles=[{path:"jquery-ui-1.9.2.custom.css",callback:null,preload:null},{path:"ui.jqgrid.css",callback:null,preload:null}],this.isClientJqueryLoaded=window.$!=null&&window.jQuery!=null,this.loadScripts(this.scripts),this.loadStyles(this.styles));n&&!i.isDesignerLaunched()&&this.processRunner(n,!1)}catch(t){console.error("Learning Path error: "+t)}},i.prototype.loadNPSSurvey=function(){var t,i,r;n.Client.Loader.appContext.ClientType===window._MicrosoftMars.Client.Utility.Constants.WebClient&&(t=!1,window.FeatureControl!==undefined&&(t=window.FeatureControl["FCB.NPSSurvey"]!==undefined?window.FeatureControl["FCB.NPSSurvey"]:!0),i=window._MicrosoftMars.Client.Utility.FFFUtility,Loader.isNPSEnabled=i.isFeatureEnabled(window._MicrosoftMars.Client.Utility.FFFUtility.NPSSurvey),Loader.isNPSEnabled&&t&&window.npsSurvey===undefined&&(r="https://go.microsoft.com/fwlink/?linkid=851737",this.loadScript(r,function(){console.log("NPS Bootstrap Loaded!!")})))},i.prototype.initializeMarsEmptyDiv=function(){var i=n.Client.Loader.$mars("#sidebarEmptyDiv");i.length===0&&(i=t.Loader.$mars().add('<div id="sidebarEmptyDiv" tabindex= "-1"><\/div>'),n.Client.Loader.$mars("body").append(i))},i.prototype.initializeMarsAriaLiveRegion=function(){var t=n.Client.Loader.$mars(".mars-help-visuallyhidden");t.length===0&&(n.Client.Loader.$mars("body").append("<span class='mars-help-visuallyhidden' role='alert' aria-live='polite' aria-hidden='false'><\/span>"),t=n.Client.Loader.$mars(".mars-help-visuallyhidden"))},i.prototype.UpdateMarsAriaLiveContent=function(t,i){var r,u;i===void 0&&(i=window._MicrosoftMars.Client.Utility.AriaLiveType.polite);r=n.Client.Loader.$mars(".mars-help-visuallyhidden");r&&(u=window._MicrosoftMars.Client.Utility.AriaLiveType[i],r.attr("aria-relevant","additions"),r.attr("aria-live",u),r.html(t))},i.prototype.loadRuntimeScripts=function(){this.isRuntimeSupported()&&(this.scripts.push({path:"TelemetryManager.js",callback:this.loadNext,preload:null},{path:"MarsRuntime.js",callback:this.runtimeCallback,preload:null}),this.loadNext())},i.prototype.loadRuntimeStyles=function(){var n="GreenTheme.css";this.isThemeabilitySupported()&&(n=window._MicrosoftMars.Client.Utility.Util.getThemeName());this.loadStyle(n,null)},i.prototype.isRuntimeSupported=function(){var n=window._MicrosoftMars.Client.Utility.FFFUtility;return n.isFeatureEnabled("Runtime")},i.prototype.isThemeabilitySupported=function(){var n=window._MicrosoftMars.Client.Utility.FFFUtility;return n.isFeatureEnabled("Themeability")},i.prototype.processFeatureList=function(n,t,i){var f;if(i==t.length){localStorage.allEnabledFeatures=JSON.stringify(n);return}var u=this,e=window._MicrosoftMars.Client.Utility.FCBClientContextEvaluation,r=t[i];r.isEnabled==="2"?(f=function(f){r.isEnabled=f.toString();n[r.featureName]=r;u.processFeatureList(n,t,i+1)},e.executeAppMethodAndEvaluate(r,0,f)):(n[r.featureName]=r,u.processFeatureList(n,t,i+1))},i.prototype.injectMarsIframe=function(n,t){var u=this,i,r,f;document.getElementById(this.marsIFrame)?u.loadMars(n):(i=document.createElement("iframe"),i.style.cssText="background-image: url('#')",i.style.visibility="hidden",r="",f=Loader.deploymentType.toLowerCase(),r=t?"moca":"web",i.src=Loader.integrationsApiUrl+"?env="+f+"&clientType="+r+"&clientId="+Loader.aadClientId+"&loginAuthority="+Loader.loginAuthority+"&resourceUrl="+Loader.resourceUrl,i.name=this.marsIFrame,i.id=this.marsIFrame,i.onload=function(){u.loadMars(n)},this.tryInjectElement(i))},i.prototype.tryInjectElement=function(n,t){var i=this;if(t===void 0&&(t=5),n)if(document.getElementsByTagName("body").length>0)document.getElementsByTagName("body")[0].appendChild(n);else if(t<2e4)setTimeout(function(){return i.tryInjectElement(n,t*2)},t);else throw new Error("Error : Cannot inject element to DOM");},i.prototype.MarsPageLoadHandler=function(){i.isDesignerLaunched()||this.processRunner(!0,!0)},i.prototype.MarsPageUnLoadHandler=function(){Loader.isControlsFetched=!1},i.prototype.logClientApiRegisteredControls=function(){var r,f,t,u,i;n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"MarsLoader:logClientApiRegisteredControls START");try{for(r=Loader.appContext.getAllChildRegisteredControl(),f=r.length,t=0;t<f;t++)u=r[t],i=u.getProperties(),n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"ctrlType: "+u.getCtrlType()+", id: "+i.id+" , type:"+i.type+" , parentId:"+i.parentId)}catch(e){n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.ERROR,"MarsLoader:logClientApiRegisteredControls exception")}n.Client.Loader.logger.log(window._MicrosoftMars.Client.Telemetry.Logger.DEBUG,"MarsLoader:logClientApiRegisteredControls END")},i.prototype.loadMtagConfig=function(){n.Client.Utility.FFFUtility.isFeatureEnabled(n.Client.Utility.FFFUtility.LiveChatv2FeatureName)?(this.initTestDriveChatVariablesV2(),this.scripts.push({path:"mtagconfigv2.js",callback:null,preload:null})):(this.initTestDriveChatVariables(),this.scripts.push({path:"mtagconfig.js",callback:null,preload:null}));this.loadNext()},i.prototype.addConfigEtagToStore=function(n){jQuery.isEmptyObject(n)||jQuery.isEmptyObject(n.ETags)||(sessionStorage[this.MARS_ETAGS]=JSON.stringify(n.ETags))},i.prototype.initTestDriveChatVariables=function(){window.lpTag=window.lpTag||{};window.lpMTagConfig=window.lpMTagConfig||{};window.lpTag.vars=window.lpTag.vars||[];window.lpTag.dbs=window.lpTag.dbs||[];window.lpTag.section="DYNAMICS"},i.prototype.initTestDriveChatVariablesV2=function(){window.lpTag=window.lpTag||{};window.lpMTagConfig=window.lpMTagConfig||{};window.lpTag.vars=window.lpTag.vars||[];window.lpTag.dbs=window.lpTag.dbs||[];window.lpTag.sdes=window.lpTag.sdes||[];window.lpTag.section=n.Client.Utility.Util.getLPTagSectionValue();var t=Loader.$mars("#lpChatDynamicsTrial");t.length===0&&Loader.$mars("body").append("<div id='lpChatDynamicsTrial'><\/div>")},i.prototype.getLaunchCountForControl=function(n){var t=JSON.parse(localStorage.getItem("landingAnswerPanelLaunchCount")),i;return t==null||t==undefined?(t={},localStorage.setItem("landingAnswerPanelLaunchCount",JSON.stringify(t)),0):(i=t[n],i==null||i==undefined)?0:i},i.prototype.showErrorAlert=function(responseJSON){if(responseJSON.ErrorCode>0){var localeKey="Error_"+responseJSON.ErrorCode,localeMessage=eval("_MicrosoftMars.Client.Loader.marsLocale."+localeKey);localeMessage?alert(localeMessage):(localeMessage=Loader.marsLocale.errorMessage,alert(localeMessage))}},i.prototype.setLaunchCountForControl=function(n,t){var i=JSON.parse(localStorage.getItem("landingAnswerPanelLaunchCount"));(i==null||i==undefined)&&(i={});i[n]=t;localStorage.setItem("landingAnswerPanelLaunchCount",JSON.stringify(i))},i.prototype.ProcesslaunchDesignerEditControl=function(t){i.isDesignerLaunched()||(n.Client.Loader.designerScriptsDownloaded?Loader.appContext.isAuthoringGroupEnabled()?t.isOrgProvisioningComplete()?t.proceedLaunchDesignerEditControl(t):t.fianalizeOrgProvisioning(t.proceedLaunchDesignerEditControl):t.alertDialogWhenAuthoringDisabled(Loader.marsLocale.LPAuthoringTenantDisabledAlert):i.isExternalDesignerTrigger()?Loader.currentInstance.loadDesignerScripts():alert(Loader.marsLocale.inProgressCaption))},i.prototype.ProcesslaunchDesigner=function(t){if(!i.isDesignerLaunched())if(n.Client.Loader.designerScriptsDownloaded)t.hidePropertyHomeTabAndAnswerPanel(!0,!1),Loader.appContext.isAuthoringGroupEnabled()?t.isOrgProvisioningComplete()?t.proceedLaunchDesigner():t.fianalizeOrgProvisioning(t.proceedLaunchDesigner):t.alertDialogWhenAuthoringDisabled(Loader.marsLocale.LPAuthoringTenantDisabledAlert);else i.isExternalDesignerTrigger()?Loader.currentInstance.loadDesignerScripts():alert(Loader.marsLocale.inProgressCaption)},i.prototype.setTenantPropertiesAndCallback=function(){var n=this;Loader.appContext=window._MicrosoftMars.Client.Utility.AppContextFactory.createAppContext();Loader.appContext.setTenantProperties(function(){n.postUtilityload()})},i.idleSecondsCounter=0,i.highContrastDiv=null,i.postAuthenticationDeferred=null,i.marsAuthToken="",i.marsAuthTokenExpiry=0,i}();Loader.MarsLoader=i;r=function(){function n(){}return n.callService=function(endpointUrl){var service=this.getRequestObject();return service!=null?(service.open("GET",endpointUrl,!1),service.setRequestHeader("X-Requested-Width","XMLHttpRequest"),service.setRequestHeader("Accept","application/json, text/javascript, */*"),service.send(null),eval("("+service.responseText+")").d):null},n.getRequestObject=function(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(n){return null}},n}();Loader.Util=r})(i=t.Loader||(t.Loader={}))})(t=n.Client||(n.Client={}))})(_MicrosoftMars||(_MicrosoftMars={})),function(){localStorage.setItem("marsLoaderInitialized","1");window.marsLoader=new _MicrosoftMars.Client.Loader.MarsLoader(!1)}("docReady",window);